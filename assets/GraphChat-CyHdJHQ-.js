import{d as V,g as x,q as I,c as K,w as T,a as e,e as a,r as y,F as g,b as M,f,k as F,t as i,l as R,s as O,x as z,m as c,o,n as h}from"./index-CkU78Y8D.js";import{_ as H}from"./AdminLayout-Ckvje8ko.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const U={class:"space-y-8"},W={class:"grid gap-4 rounded-3xl border border-gray-200 bg-white p-6 dark:border-gray-800 dark:bg-gray-900 md:grid-cols-3"},J=["onClick"],X={class:"text-lg font-semibold"},Q={class:"grid gap-6 lg:grid-cols-12"},Y={class:"col-span-12 rounded-3xl border border-gray-200 bg-white p-6 dark:border-gray-800 dark:bg-gray-900 lg:col-span-3"},Z={class:"mt-4 space-y-4"},ee={class:"flex items-start justify-between gap-3"},te={class:"text-base font-semibold text-gray-900 dark:text-white"},se={class:"mt-1"},oe=["onClick"],ae={class:"col-span-12 space-y-4 lg:col-span-9"},re={class:"rounded-3xl border border-gray-200 bg-gray-50 p-6 dark:border-gray-800 dark:bg-gray-950"},ne={class:"flex items-center justify-between"},ie={class:"text-xs text-gray-400"},le={class:"mt-4 space-y-4"},de={class:"whitespace-pre-wrap"},ce={class:"mt-1 space-y-1 text-xs text-gray-500 dark:text-gray-400"},ge={key:1,class:"mt-3 space-y-2"},pe={key:0},ue={class:"mt-1 flex flex-wrap gap-2"},xe={key:0,class:"text-[10px] text-gray-500"},ye={key:1},he={class:"mt-1 flex flex-wrap gap-2"},be={key:0,class:"text-[10px] text-gray-500"},fe={class:"rounded-3xl border border-gray-200 bg-white p-5 dark:border-gray-800 dark:bg-gray-900"},me={class:"flex items-center justify-between"},ke={class:"text-xs text-gray-400"},we={class:"mt-4 flex flex-col gap-3"},ve=["placeholder"],_e={class:"flex flex-wrap items-center gap-3"},Ce=["disabled"],$e={key:0,class:"inline-block h-4 w-4 animate-spin rounded-full border-2 border-white/40 border-t-white"},Ae={key:0,class:"text-xs text-rose-500"},Ne=V({__name:"GraphChat",setup(Pe){const B=[{key:"nodeClassification",title:"Node Classification",subtitle:"Node Classification",description:"Tag the node and identify its role or risk.",badgeColor:"bg-sky-400",activeBg:"bg-gradient-to-br from-sky-500 to-indigo-600"},{key:"linkPrediction",title:"Link Prediction",subtitle:"Link Prediction",description:"Check whether two nodes are likely connected.",badgeColor:"bg-rose-400",activeBg:"bg-gradient-to-br from-rose-500 to-fuchsia-600"},{key:"nodeDescription",title:"Node Description",subtitle:"Node Description",description:"Generate a natural-language description with context.",badgeColor:"bg-indigo-400",activeBg:"bg-gradient-to-br from-indigo-500 to-purple-600"}],D={nodeClassification:{exampleTitle:"Classification sample",prompts:[{title:"Label diagnosis",content:"Which supplier roles should node A belong to? Give evidence."},{title:"Risk scoring",content:"Predict credit risk level for node B and list key features."}],placeholder:"e.g. Which business category does node X belong to?",helper:"Answer with classification reasons and citations."},linkPrediction:{exampleTitle:"Link reasoning sample",prompts:[{title:"Potential links",content:"Could node A have an indirect link to node F? Show the path."},{title:"Edge check",content:"If we add edge A-B, does it align with historical behavior?"}],placeholder:"e.g. Are node A and node F potentially connected?",helper:"Return reasoning path, confidence, and query citation."},nodeDescription:{exampleTitle:"Description sample",prompts:[{title:"Context summary",content:"Explain node C in two sentences: role and dependencies."},{title:"Contrast",content:"How do node D and node E differ in roles?"}],placeholder:"e.g. Summarize node C role and its context",helper:"Description should include citations."}},N={nodeClassification:"node_classification",linkPrediction:"link_prediction",nodeDescription:"node_description"},j="http://localhost:8080",p=x("nodeClassification"),u=x(""),b=x(!1),m=x(""),v=x(1),_=x([{id:v.value++,role:"assistant",text:"Hi, I can classify nodes, predict links, and describe nodes based on the graph. Pick a task and ask a question."}]),k=I(()=>D[p.value]),E=r=>{p.value=r},L=r=>{u.value=r},q=r=>{var d,t;const s=[];return(d=r.nodes)!=null&&d.length&&s.push(`Nodes: ${r.nodes.slice(0,5).map(l=>l.name||l.id).join(", ")}`),(t=r.links)!=null&&t.length&&s.push(`Edges: ${r.links.slice(0,5).map(l=>`${l.source}->${l.target}${l.weight!=null?`(w=${l.weight})`:""}`).join(", ")}`),s},S=r=>{(r.ctrlKey||r.metaKey)&&(r.preventDefault(),C())},C=async()=>{const r=u.value.trim();if(!r||b.value)return;m.value="";const s={id:v.value++,role:"user",text:r};_.value.push(s),u.value="",b.value=!0;try{const d=await fetch(`${j}/chat/query`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:r,task:N[p.value]})});if(!d.ok)throw new Error(`API error ${d.status}`);const t=await d.json(),l=q(t),w={id:v.value++,role:"assistant",text:t.answer||"answer field missing, please check backend response or retry.",nodes:t.nodes,links:t.links,references:l};_.value.push(w)}catch(d){m.value=(d==null?void 0:d.message)||"Request failed, please try again later"}finally{b.value=!1}};return(r,s)=>{const d=F("router-link");return o(),K(H,null,{default:T(()=>[e("div",U,[s[11]||(s[11]=e("section",{class:"rounded-3xl border border-gray-200 bg-white p-8 shadow-theme-md dark:border-gray-800 dark:bg-gray-900"},[e("p",{class:"text-sm uppercase tracking-[0.4em] text-gray-400"},"Graph Chat Playground"),e("div",{class:"mt-4 space-y-4"},[e("h1",{class:"text-3xl font-semibold text-gray-900 dark:text-white"},"Ask the graph assistant, get cited answers"),e("p",{class:"max-w-3xl text-base text-gray-600 dark:text-gray-400"}," Blend LLM with graph reasoning. Answers can include node/edge citations and reproducible Cypher, with history and quick prompt templates. ")])],-1)),e("section",W,[(o(),a(g,null,y(B,t=>e("button",{key:t.key,onClick:l=>E(t.key),class:h(["flex flex-col items-start gap-2 rounded-2xl border px-4 py-5 text-left transition",p.value===t.key?"border-transparent text-white shadow-lg "+t.activeBg:"border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-white/5 text-gray-700 dark:text-gray-200"])},[e("span",{class:h(["inline-flex items-center gap-2 rounded-full px-3 py-1 text-xs font-semibold",p.value===t.key?"bg-white/20 text-white":"bg-white text-gray-700"])},[e("span",{class:h(["inline-flex h-3 w-3 rounded-full",t.badgeColor])},null,2),f(" "+i(t.subtitle),1)],2),e("p",X,i(t.title),1),e("p",{class:h(["text-sm",p.value===t.key?"text-white/90":"text-gray-500 dark:text-gray-400"])},i(t.description),3)],10,J)),64))]),e("section",Q,[e("div",Y,[s[3]||(s[3]=e("div",{class:"flex items-center justify-between"},[e("p",{class:"text-sm font-semibold text-gray-500 dark:text-gray-400"},"Prompt templates"),e("span",{class:"text-xs text-gray-400"},"One-click fill")],-1)),e("ul",Z,[(o(!0),a(g,null,y(k.value.prompts,t=>(o(),a("li",{key:t.title,class:"rounded-2xl border border-gray-100 p-4 text-sm text-gray-700 transition hover:border-indigo-500 hover:shadow-sm dark:border-gray-800 dark:text-gray-300"},[e("div",ee,[e("div",null,[e("p",te,i(t.title),1),e("p",se,i(t.content),1)]),e("button",{class:"rounded-full border border-indigo-200 px-3 py-1 text-xs font-semibold text-indigo-600 transition hover:bg-indigo-50 dark:border-indigo-800 dark:text-indigo-200 dark:hover:bg-indigo-900/40",onClick:l=>L(t.content)}," Use ",8,oe)])]))),128))]),M(d,{to:"/graph-insight",class:"mt-6 inline-flex w-full items-center justify-center rounded-2xl bg-gradient-to-r from-indigo-600 to-purple-600 px-4 py-3 text-sm font-semibold text-white shadow-lg transition hover:shadow-xl"},{default:T(()=>[...s[2]||(s[2]=[f(" Need visual insights? Go to Dashboard -> ",-1)])]),_:1})]),e("div",ae,[e("div",re,[e("div",ne,[s[4]||(s[4]=e("p",{class:"text-sm font-semibold text-gray-600 dark:text-gray-400"},"Chat history",-1)),e("span",ie,i(k.value.exampleTitle),1)]),e("div",le,[(o(!0),a(g,null,y(_.value,t=>{var l,w,$,A,P;return o(),a("div",{key:t.id,class:h(["flex gap-3",t.role==="user"?"justify-end":"justify-start"])},[e("div",{class:h(["max-w-3xl whitespace-pre-wrap break-words rounded-2xl px-4 py-3 text-sm leading-relaxed shadow-sm",t.role==="user"?"bg-indigo-600 text-white":"bg-white text-gray-800 dark:bg-gray-900 dark:text-gray-100"])},[e("p",de,i(t.text),1),(l=t.references)!=null&&l.length?(o(),a(g,{key:0},[s[5]||(s[5]=e("p",{class:"mt-3 text-xs font-semibold text-gray-500"},"Citations",-1)),e("ul",ce,[(o(!0),a(g,null,y(t.references,(n,G)=>(o(),a("li",{key:G},"- "+i(n),1))),128))])],64)):c("",!0),(w=t.nodes)!=null&&w.length||($=t.links)!=null&&$.length?(o(),a("div",ge,[(A=t.nodes)!=null&&A.length?(o(),a("div",pe,[s[6]||(s[6]=e("p",{class:"text-xs font-semibold text-gray-500"},"Nodes",-1)),e("div",ue,[(o(!0),a(g,null,y(t.nodes,n=>(o(),a("span",{key:n.id||n.name,class:"inline-flex items-center gap-1 rounded-full bg-indigo-50 px-3 py-1 text-xs font-semibold text-indigo-700 dark:bg-indigo-900/40 dark:text-indigo-100"},[f(i(n.name||n.id)+" ",1),n.type?(o(),a("span",xe,"("+i(n.type)+")",1)):c("",!0)]))),128))])])):c("",!0),(P=t.links)!=null&&P.length?(o(),a("div",ye,[s[7]||(s[7]=e("p",{class:"text-xs font-semibold text-gray-500"},"Edges",-1)),e("div",he,[(o(!0),a(g,null,y(t.links,n=>(o(),a("span",{key:`${n.source}-${n.target}-${n.weight||""}`,class:"inline-flex items-center gap-1 rounded-full bg-slate-100 px-3 py-1 text-xs font-semibold text-slate-700 dark:bg-slate-800 dark:text-slate-100"},[f(i(n.source)+" -> "+i(n.target)+" ",1),n.weight!=null?(o(),a("span",be,"w="+i(n.weight),1)):c("",!0)]))),128))])])):c("",!0)])):c("",!0)],2)],2)}),128))])]),e("div",fe,[e("div",me,[s[8]||(s[8]=e("p",{class:"text-sm font-semibold text-gray-500 dark:text-gray-400"},"Ask",-1)),e("span",ke,i(k.value.helper),1)]),e("div",we,[R(e("textarea",{"onUpdate:modelValue":s[0]||(s[0]=t=>u.value=t),rows:"4",class:"w-full rounded-2xl border border-gray-200 px-4 py-3 text-sm text-gray-700 placeholder:text-gray-400 focus:border-brand-500 focus:outline-none dark:border-gray-700 dark:bg-gray-950 dark:text-gray-100",placeholder:k.value.placeholder,onKeydown:z(S,["enter"])},null,40,ve),[[O,u.value]]),e("div",_e,[e("button",{class:"inline-flex items-center gap-2 rounded-xl bg-gradient-to-r from-indigo-600 to-sky-500 px-5 py-2 text-sm font-semibold text-white shadow-lg transition hover:shadow-xl disabled:cursor-not-allowed disabled:opacity-70",disabled:b.value||!u.value.trim(),onClick:s[1]||(s[1]=t=>C())},[b.value?(o(),a("span",$e)):c("",!0),s[9]||(s[9]=f(" Send to LLaGA ",-1))],8,Ce),m.value?(o(),a("span",Ae,i(m.value),1)):c("",!0),s[10]||(s[10]=e("span",{class:"text-xs text-gray-400"},"Tip: Ctrl/Cmd + Enter to send, Enter for newline",-1))])])])])])])]),_:1})}}});export{Ne as default};
