var _R=Object.defineProperty;var Rb=r=>{throw TypeError(r)};var kR=(r,t,e)=>t in r?_R(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var Me=(r,t,e)=>kR(r,typeof t!="symbol"?t+"":t,e),cd=(r,t,e)=>t.has(r)||Rb("Cannot "+e);var Br=(r,t,e)=>(cd(r,t,"read from private field"),e?e.call(r):t.get(r)),ud=(r,t,e)=>t.has(r)?Rb("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(r):t.set(r,e),Nl=(r,t,e,n)=>(cd(r,t,"write to private field"),n?n.call(r,e):t.set(r,e),e),hd=(r,t,e)=>(cd(r,t,"access private method"),e);import{d as MR,g as ai,h as TR,i as OR,j as Lb,c as AR,w as Ib,a as wt,b as NR,f as dd,k as PR,l as Db,v as Fb,e as Vi,m as Bb,t as Zn,p as CR,r as Pl,F as Cl,o as Ti,n as RR}from"./index-CkU78Y8D.js";import{_ as LR}from"./AdminLayout-Ckvje8ko.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";function Ua(r){"@babel/helpers - typeof";return Ua=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ua(r)}function IR(r,t){if(Ua(r)!="object"||!r)return r;var e=r[Symbol.toPrimitive];if(e!==void 0){var n=e.call(r,t);if(Ua(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function JT(r){var t=IR(r,"string");return Ua(t)=="symbol"?t:t+""}function _t(r,t,e){return(t=JT(t))in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e,r}function zb(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),e.push.apply(e,n)}return e}function Vt(r){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?zb(Object(e),!0).forEach(function(n){_t(r,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):zb(Object(e)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(e,n))})}return r}function ot(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function jb(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,JT(n.key),n)}}function lt(r,t,e){return t&&jb(r.prototype,t),e&&jb(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function Xy(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=Array(t);e<t;e++)n[e]=r[e];return n}function DR(r){if(Array.isArray(r))return Xy(r)}function FR(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function l1(r,t){if(r){if(typeof r=="string")return Xy(r,t);var e={}.toString.call(r).slice(8,-1);return e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set"?Array.from(r):e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Xy(r,t):void 0}}function BR(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ne(r){return DR(r)||FR(r)||l1(r)||BR()}function Fs(r){return Fs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Fs(r)}function QT(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(QT=function(){return!!r})()}function zR(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function jR(r,t){if(t&&(Ua(t)=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zR(r)}function Yt(r,t,e){return t=Fs(t),jR(r,QT()?Reflect.construct(t,e||[],Fs(r).constructor):t.apply(r,e))}function Ky(r,t){return Ky=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,n){return e.__proto__=n,e},Ky(r,t)}function Ht(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&Ky(r,t)}function qR(r){if(Array.isArray(r))return r}function GR(r,t){var e=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var n,i,a,s,o=[],l=!0,c=!1;try{if(a=(e=e.call(r)).next,t===0){if(Object(e)!==e)return;l=!1}else for(;!(l=(n=a.call(e)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(u){c=!0,i=u}finally{try{if(!l&&e.return!=null&&(s=e.return(),Object(s)!==s))return}finally{if(c)throw i}}return o}}function $R(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $t(r,t){return qR(r)||GR(r,t)||l1(r,t)||$R()}var Rl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Au(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function tO(r){if(Object.prototype.hasOwnProperty.call(r,"__esModule"))return r;var t=r.default;if(typeof t=="function"){var e=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(r).forEach(function(n){var i=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:function(){return r[n]}})}),e}var fd={exports:{}},qb;function WR(){return qb||(qb=1,(function(r){var t=Object.prototype.hasOwnProperty,e="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(e=!1));function i(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function a(l,c,u,h,d){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new i(u,h||l,d),g=e?e+c:c;return l._events[g]?l._events[g].fn?l._events[g]=[l._events[g],f]:l._events[g].push(f):(l._events[g]=f,l._eventsCount++),l}function s(l,c){--l._eventsCount===0?l._events=new n:delete l._events[c]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var c=[],u,h;if(this._eventsCount===0)return c;for(h in u=this._events)t.call(u,h)&&c.push(e?h.slice(1):h);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},o.prototype.listeners=function(c){var u=e?e+c:c,h=this._events[u];if(!h)return[];if(h.fn)return[h.fn];for(var d=0,f=h.length,g=new Array(f);d<f;d++)g[d]=h[d].fn;return g},o.prototype.listenerCount=function(c){var u=e?e+c:c,h=this._events[u];return h?h.fn?1:h.length:0},o.prototype.emit=function(c,u,h,d,f,g){var v=e?e+c:c;if(!this._events[v])return!1;var p=this._events[v],y=arguments.length,m,x;if(p.fn){switch(p.once&&this.removeListener(c,p.fn,void 0,!0),y){case 1:return p.fn.call(p.context),!0;case 2:return p.fn.call(p.context,u),!0;case 3:return p.fn.call(p.context,u,h),!0;case 4:return p.fn.call(p.context,u,h,d),!0;case 5:return p.fn.call(p.context,u,h,d,f),!0;case 6:return p.fn.call(p.context,u,h,d,f,g),!0}for(x=1,m=new Array(y-1);x<y;x++)m[x-1]=arguments[x];p.fn.apply(p.context,m)}else{var E=p.length,_;for(x=0;x<E;x++)switch(p[x].once&&this.removeListener(c,p[x].fn,void 0,!0),y){case 1:p[x].fn.call(p[x].context);break;case 2:p[x].fn.call(p[x].context,u);break;case 3:p[x].fn.call(p[x].context,u,h);break;case 4:p[x].fn.call(p[x].context,u,h,d);break;default:if(!m)for(_=1,m=new Array(y-1);_<y;_++)m[_-1]=arguments[_];p[x].fn.apply(p[x].context,m)}}return!0},o.prototype.on=function(c,u,h){return a(this,c,u,h,!1)},o.prototype.once=function(c,u,h){return a(this,c,u,h,!0)},o.prototype.removeListener=function(c,u,h,d){var f=e?e+c:c;if(!this._events[f])return this;if(!u)return s(this,f),this;var g=this._events[f];if(g.fn)g.fn===u&&(!d||g.once)&&(!h||g.context===h)&&s(this,f);else{for(var v=0,p=[],y=g.length;v<y;v++)(g[v].fn!==u||d&&!g[v].once||h&&g[v].context!==h)&&p.push(g[v]);p.length?this._events[f]=p.length===1?p[0]:p:s(this,f)}return this},o.prototype.removeAllListeners=function(c){var u;return c?(u=e?e+c:c,this._events[u]&&s(this,u)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=e,o.EventEmitter=o,r.exports=o})(fd)),fd.exports}var VR=WR();const eO=Au(VR);var Ae=1e-6,sn=typeof Float32Array<"u"?Float32Array:Array,UR="zyx";function nO(){var r=new sn(9);return sn!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function YR(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[4],r[4]=t[5],r[5]=t[6],r[6]=t[8],r[7]=t[9],r[8]=t[10],r}function HR(r,t,e,n,i,a,s,o,l){var c=new sn(9);return c[0]=r,c[1]=t,c[2]=e,c[3]=n,c[4]=i,c[5]=a,c[6]=s,c[7]=o,c[8]=l,c}function ve(){var r=new sn(16);return sn!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r}function rO(r){var t=new sn(16);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t}function Bs(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r}function iO(r,t,e,n,i,a,s,o,l,c,u,h,d,f,g,v){var p=new sn(16);return p[0]=r,p[1]=t,p[2]=e,p[3]=n,p[4]=i,p[5]=a,p[6]=s,p[7]=o,p[8]=l,p[9]=c,p[10]=u,p[11]=h,p[12]=d,p[13]=f,p[14]=g,p[15]=v,p}function Zy(r,t,e,n,i,a,s,o,l,c,u,h,d,f,g,v,p){return r[0]=t,r[1]=e,r[2]=n,r[3]=i,r[4]=a,r[5]=s,r[6]=o,r[7]=l,r[8]=c,r[9]=u,r[10]=h,r[11]=d,r[12]=f,r[13]=g,r[14]=v,r[15]=p,r}function ha(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function aO(r,t){if(r===t){var e=t[1],n=t[2],i=t[3],a=t[6],s=t[7],o=t[11];r[1]=t[4],r[2]=t[8],r[3]=t[12],r[4]=e,r[6]=t[9],r[7]=t[13],r[8]=n,r[9]=a,r[11]=t[14],r[12]=i,r[13]=s,r[14]=o}else r[0]=t[0],r[1]=t[4],r[2]=t[8],r[3]=t[12],r[4]=t[1],r[5]=t[5],r[6]=t[9],r[7]=t[13],r[8]=t[2],r[9]=t[6],r[10]=t[10],r[11]=t[14],r[12]=t[3],r[13]=t[7],r[14]=t[11],r[15]=t[15];return r}function hi(r,t){var e=t[0],n=t[1],i=t[2],a=t[3],s=t[4],o=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],f=t[11],g=t[12],v=t[13],p=t[14],y=t[15],m=e*o-n*s,x=e*l-i*s,E=e*c-a*s,_=n*l-i*o,M=n*c-a*o,O=i*c-a*l,T=u*v-h*g,N=u*p-d*g,P=u*y-f*g,C=h*p-d*v,R=h*y-f*v,I=d*y-f*p,j=m*I-x*R+E*C+_*P-M*N+O*T;return j?(j=1/j,r[0]=(o*I-l*R+c*C)*j,r[1]=(i*R-n*I-a*C)*j,r[2]=(v*O-p*M+y*_)*j,r[3]=(d*M-h*O-f*_)*j,r[4]=(l*P-s*I-c*N)*j,r[5]=(e*I-i*P+a*N)*j,r[6]=(p*E-g*O-y*x)*j,r[7]=(u*O-d*E+f*x)*j,r[8]=(s*R-o*P+c*T)*j,r[9]=(n*P-e*R-a*T)*j,r[10]=(g*M-v*E+y*m)*j,r[11]=(h*E-u*M-f*m)*j,r[12]=(o*N-s*C-l*T)*j,r[13]=(e*C-n*N+i*T)*j,r[14]=(v*x-g*_-p*m)*j,r[15]=(u*_-h*x+d*m)*j,r):null}function XR(r,t){var e=t[0],n=t[1],i=t[2],a=t[3],s=t[4],o=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],f=t[11],g=t[12],v=t[13],p=t[14],y=t[15],m=e*o-n*s,x=e*l-i*s,E=e*c-a*s,_=n*l-i*o,M=n*c-a*o,O=i*c-a*l,T=u*v-h*g,N=u*p-d*g,P=u*y-f*g,C=h*p-d*v,R=h*y-f*v,I=d*y-f*p;return r[0]=o*I-l*R+c*C,r[1]=i*R-n*I-a*C,r[2]=v*O-p*M+y*_,r[3]=d*M-h*O-f*_,r[4]=l*P-s*I-c*N,r[5]=e*I-i*P+a*N,r[6]=p*E-g*O-y*x,r[7]=u*O-d*E+f*x,r[8]=s*R-o*P+c*T,r[9]=n*P-e*R-a*T,r[10]=g*M-v*E+y*m,r[11]=h*E-u*M-f*m,r[12]=o*N-s*C-l*T,r[13]=e*C-n*N+i*T,r[14]=v*x-g*_-p*m,r[15]=u*_-h*x+d*m,r}function sO(r){var t=r[0],e=r[1],n=r[2],i=r[3],a=r[4],s=r[5],o=r[6],l=r[7],c=r[8],u=r[9],h=r[10],d=r[11],f=r[12],g=r[13],v=r[14],p=r[15],y=t*s-e*a,m=t*o-n*a,x=e*o-n*s,E=c*g-u*f,_=c*v-h*f,M=u*v-h*g,O=t*M-e*_+n*E,T=a*M-s*_+o*E,N=c*x-u*m+h*y,P=f*x-g*m+v*y;return l*O-i*T+p*N-d*P}function Bn(r,t,e){var n=t[0],i=t[1],a=t[2],s=t[3],o=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],f=t[10],g=t[11],v=t[12],p=t[13],y=t[14],m=t[15],x=e[0],E=e[1],_=e[2],M=e[3];return r[0]=x*n+E*o+_*h+M*v,r[1]=x*i+E*l+_*d+M*p,r[2]=x*a+E*c+_*f+M*y,r[3]=x*s+E*u+_*g+M*m,x=e[4],E=e[5],_=e[6],M=e[7],r[4]=x*n+E*o+_*h+M*v,r[5]=x*i+E*l+_*d+M*p,r[6]=x*a+E*c+_*f+M*y,r[7]=x*s+E*u+_*g+M*m,x=e[8],E=e[9],_=e[10],M=e[11],r[8]=x*n+E*o+_*h+M*v,r[9]=x*i+E*l+_*d+M*p,r[10]=x*a+E*c+_*f+M*y,r[11]=x*s+E*u+_*g+M*m,x=e[12],E=e[13],_=e[14],M=e[15],r[12]=x*n+E*o+_*h+M*v,r[13]=x*i+E*l+_*d+M*p,r[14]=x*a+E*c+_*f+M*y,r[15]=x*s+E*u+_*g+M*m,r}function Ps(r,t,e){var n=e[0],i=e[1],a=e[2],s,o,l,c,u,h,d,f,g,v,p,y;return t===r?(r[12]=t[0]*n+t[4]*i+t[8]*a+t[12],r[13]=t[1]*n+t[5]*i+t[9]*a+t[13],r[14]=t[2]*n+t[6]*i+t[10]*a+t[14],r[15]=t[3]*n+t[7]*i+t[11]*a+t[15]):(s=t[0],o=t[1],l=t[2],c=t[3],u=t[4],h=t[5],d=t[6],f=t[7],g=t[8],v=t[9],p=t[10],y=t[11],r[0]=s,r[1]=o,r[2]=l,r[3]=c,r[4]=u,r[5]=h,r[6]=d,r[7]=f,r[8]=g,r[9]=v,r[10]=p,r[11]=y,r[12]=s*n+u*i+g*a+t[12],r[13]=o*n+h*i+v*a+t[13],r[14]=l*n+d*i+p*a+t[14],r[15]=c*n+f*i+y*a+t[15]),r}function oO(r,t,e){var n=e[0],i=e[1],a=e[2];return r[0]=t[0]*n,r[1]=t[1]*n,r[2]=t[2]*n,r[3]=t[3]*n,r[4]=t[4]*i,r[5]=t[5]*i,r[6]=t[6]*i,r[7]=t[7]*i,r[8]=t[8]*a,r[9]=t[9]*a,r[10]=t[10]*a,r[11]=t[11]*a,r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r}function KR(r,t,e,n){var i=n[0],a=n[1],s=n[2],o=Math.sqrt(i*i+a*a+s*s),l,c,u,h,d,f,g,v,p,y,m,x,E,_,M,O,T,N,P,C,R,I,j,G;return o<Ae?null:(o=1/o,i*=o,a*=o,s*=o,l=Math.sin(e),c=Math.cos(e),u=1-c,h=t[0],d=t[1],f=t[2],g=t[3],v=t[4],p=t[5],y=t[6],m=t[7],x=t[8],E=t[9],_=t[10],M=t[11],O=i*i*u+c,T=a*i*u+s*l,N=s*i*u-a*l,P=i*a*u-s*l,C=a*a*u+c,R=s*a*u+i*l,I=i*s*u+a*l,j=a*s*u-i*l,G=s*s*u+c,r[0]=h*O+v*T+x*N,r[1]=d*O+p*T+E*N,r[2]=f*O+y*T+_*N,r[3]=g*O+m*T+M*N,r[4]=h*P+v*C+x*R,r[5]=d*P+p*C+E*R,r[6]=f*P+y*C+_*R,r[7]=g*P+m*C+M*R,r[8]=h*I+v*j+x*G,r[9]=d*I+p*j+E*G,r[10]=f*I+y*j+_*G,r[11]=g*I+m*j+M*G,t!==r&&(r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r)}function lO(r,t,e){var n=Math.sin(e),i=Math.cos(e),a=t[4],s=t[5],o=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11];return t!==r&&(r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[4]=a*i+c*n,r[5]=s*i+u*n,r[6]=o*i+h*n,r[7]=l*i+d*n,r[8]=c*i-a*n,r[9]=u*i-s*n,r[10]=h*i-o*n,r[11]=d*i-l*n,r}function cO(r,t,e){var n=Math.sin(e),i=Math.cos(e),a=t[0],s=t[1],o=t[2],l=t[3],c=t[8],u=t[9],h=t[10],d=t[11];return t!==r&&(r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=a*i-c*n,r[1]=s*i-u*n,r[2]=o*i-h*n,r[3]=l*i-d*n,r[8]=a*n+c*i,r[9]=s*n+u*i,r[10]=o*n+h*i,r[11]=l*n+d*i,r}function ZR(r,t,e){var n=Math.sin(e),i=Math.cos(e),a=t[0],s=t[1],o=t[2],l=t[3],c=t[4],u=t[5],h=t[6],d=t[7];return t!==r&&(r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=a*i+c*n,r[1]=s*i+u*n,r[2]=o*i+h*n,r[3]=l*i+d*n,r[4]=c*i-a*n,r[5]=u*i-s*n,r[6]=h*i-o*n,r[7]=d*i-l*n,r}function Ji(r,t){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=t[0],r[13]=t[1],r[14]=t[2],r[15]=1,r}function Ra(r,t){return r[0]=t[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=t[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=t[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function uO(r,t,e){var n=e[0],i=e[1],a=e[2],s=Math.sqrt(n*n+i*i+a*a),o,l,c;return s<Ae?null:(s=1/s,n*=s,i*=s,a*=s,o=Math.sin(t),l=Math.cos(t),c=1-l,r[0]=n*n*c+l,r[1]=i*n*c+a*o,r[2]=a*n*c-i*o,r[3]=0,r[4]=n*i*c-a*o,r[5]=i*i*c+l,r[6]=a*i*c+n*o,r[7]=0,r[8]=n*a*c+i*o,r[9]=i*a*c-n*o,r[10]=a*a*c+l,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r)}function hO(r,t){var e=Math.sin(t),n=Math.cos(t);return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=n,r[6]=e,r[7]=0,r[8]=0,r[9]=-e,r[10]=n,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function dO(r,t){var e=Math.sin(t),n=Math.cos(t);return r[0]=n,r[1]=0,r[2]=-e,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=e,r[9]=0,r[10]=n,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Jy(r,t){var e=Math.sin(t),n=Math.cos(t);return r[0]=n,r[1]=e,r[2]=0,r[3]=0,r[4]=-e,r[5]=n,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function fO(r,t,e){var n=t[0],i=t[1],a=t[2],s=t[3],o=n+n,l=i+i,c=a+a,u=n*o,h=n*l,d=n*c,f=i*l,g=i*c,v=a*c,p=s*o,y=s*l,m=s*c;return r[0]=1-(f+v),r[1]=h+m,r[2]=d-y,r[3]=0,r[4]=h-m,r[5]=1-(u+v),r[6]=g+p,r[7]=0,r[8]=d+y,r[9]=g-p,r[10]=1-(u+f),r[11]=0,r[12]=e[0],r[13]=e[1],r[14]=e[2],r[15]=1,r}function JR(r,t){var e=new sn(3),n=-t[0],i=-t[1],a=-t[2],s=t[3],o=t[4],l=t[5],c=t[6],u=t[7],h=n*n+i*i+a*a+s*s;return h>0?(e[0]=(o*s+u*n+l*a-c*i)*2/h,e[1]=(l*s+u*i+c*n-o*a)*2/h,e[2]=(c*s+u*a+o*i-l*n)*2/h):(e[0]=(o*s+u*n+l*a-c*i)*2,e[1]=(l*s+u*i+c*n-o*a)*2,e[2]=(c*s+u*a+o*i-l*n)*2),fO(r,t,e),r}function Vc(r,t){return r[0]=t[12],r[1]=t[13],r[2]=t[14],r}function zs(r,t){var e=t[0],n=t[1],i=t[2],a=t[4],s=t[5],o=t[6],l=t[8],c=t[9],u=t[10];return r[0]=Math.sqrt(e*e+n*n+i*i),r[1]=Math.sqrt(a*a+s*s+o*o),r[2]=Math.sqrt(l*l+c*c+u*u),r}function Uc(r,t){var e=new sn(3);zs(e,t);var n=1/e[0],i=1/e[1],a=1/e[2],s=t[0]*n,o=t[1]*i,l=t[2]*a,c=t[4]*n,u=t[5]*i,h=t[6]*a,d=t[8]*n,f=t[9]*i,g=t[10]*a,v=s+u+g,p=0;return v>0?(p=Math.sqrt(v+1)*2,r[3]=.25*p,r[0]=(h-f)/p,r[1]=(d-l)/p,r[2]=(o-c)/p):s>u&&s>g?(p=Math.sqrt(1+s-u-g)*2,r[3]=(h-f)/p,r[0]=.25*p,r[1]=(o+c)/p,r[2]=(d+l)/p):u>g?(p=Math.sqrt(1+u-s-g)*2,r[3]=(d-l)/p,r[0]=(o+c)/p,r[1]=.25*p,r[2]=(h+f)/p):(p=Math.sqrt(1+g-s-u)*2,r[3]=(o-c)/p,r[0]=(d+l)/p,r[1]=(h+f)/p,r[2]=.25*p),r}function QR(r,t,e,n){t[0]=n[12],t[1]=n[13],t[2]=n[14];var i=n[0],a=n[1],s=n[2],o=n[4],l=n[5],c=n[6],u=n[8],h=n[9],d=n[10];e[0]=Math.sqrt(i*i+a*a+s*s),e[1]=Math.sqrt(o*o+l*l+c*c),e[2]=Math.sqrt(u*u+h*h+d*d);var f=1/e[0],g=1/e[1],v=1/e[2],p=i*f,y=a*g,m=s*v,x=o*f,E=l*g,_=c*v,M=u*f,O=h*g,T=d*v,N=p+E+T,P=0;return N>0?(P=Math.sqrt(N+1)*2,r[3]=.25*P,r[0]=(_-O)/P,r[1]=(M-m)/P,r[2]=(y-x)/P):p>E&&p>T?(P=Math.sqrt(1+p-E-T)*2,r[3]=(_-O)/P,r[0]=.25*P,r[1]=(y+x)/P,r[2]=(M+m)/P):E>T?(P=Math.sqrt(1+E-p-T)*2,r[3]=(M-m)/P,r[0]=(y+x)/P,r[1]=.25*P,r[2]=(_+O)/P):(P=Math.sqrt(1+T-p-E)*2,r[3]=(y-x)/P,r[0]=(M+m)/P,r[1]=(_+O)/P,r[2]=.25*P),r}function t3(r,t,e,n){var i=t[0],a=t[1],s=t[2],o=t[3],l=i+i,c=a+a,u=s+s,h=i*l,d=i*c,f=i*u,g=a*c,v=a*u,p=s*u,y=o*l,m=o*c,x=o*u,E=n[0],_=n[1],M=n[2];return r[0]=(1-(g+p))*E,r[1]=(d+x)*E,r[2]=(f-m)*E,r[3]=0,r[4]=(d-x)*_,r[5]=(1-(h+p))*_,r[6]=(v+y)*_,r[7]=0,r[8]=(f+m)*M,r[9]=(v-y)*M,r[10]=(1-(h+g))*M,r[11]=0,r[12]=e[0],r[13]=e[1],r[14]=e[2],r[15]=1,r}function Co(r,t,e,n,i){var a=t[0],s=t[1],o=t[2],l=t[3],c=a+a,u=s+s,h=o+o,d=a*c,f=a*u,g=a*h,v=s*u,p=s*h,y=o*h,m=l*c,x=l*u,E=l*h,_=n[0],M=n[1],O=n[2],T=i[0],N=i[1],P=i[2],C=(1-(v+y))*_,R=(f+E)*_,I=(g-x)*_,j=(f-E)*M,G=(1-(d+y))*M,H=(p+m)*M,Z=(g+x)*O,U=(p-m)*O,tt=(1-(d+v))*O;return r[0]=C,r[1]=R,r[2]=I,r[3]=0,r[4]=j,r[5]=G,r[6]=H,r[7]=0,r[8]=Z,r[9]=U,r[10]=tt,r[11]=0,r[12]=e[0]+T-(C*T+j*N+Z*P),r[13]=e[1]+N-(R*T+G*N+U*P),r[14]=e[2]+P-(I*T+H*N+tt*P),r[15]=1,r}function c1(r,t){var e=t[0],n=t[1],i=t[2],a=t[3],s=e+e,o=n+n,l=i+i,c=e*s,u=n*s,h=n*o,d=i*s,f=i*o,g=i*l,v=a*s,p=a*o,y=a*l;return r[0]=1-h-g,r[1]=u+y,r[2]=d-p,r[3]=0,r[4]=u-y,r[5]=1-c-g,r[6]=f+v,r[7]=0,r[8]=d+p,r[9]=f-v,r[10]=1-c-h,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function e3(r,t,e,n,i,a,s){var o=1/(e-t),l=1/(i-n),c=1/(a-s);return r[0]=a*2*o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=a*2*l,r[6]=0,r[7]=0,r[8]=(e+t)*o,r[9]=(i+n)*l,r[10]=(s+a)*c,r[11]=-1,r[12]=0,r[13]=0,r[14]=s*a*2*c,r[15]=0,r}function gO(r,t,e,n,i){var a=1/Math.tan(t/2);if(r[0]=a/e,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=a,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,i!=null&&i!==1/0){var s=1/(n-i);r[10]=(i+n)*s,r[14]=2*i*n*s}else r[10]=-1,r[14]=-2*n;return r}var n3=gO;function r3(r,t,e,n,i){var a=1/Math.tan(t/2);if(r[0]=a/e,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=a,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,i!=null&&i!==1/0){var s=1/(n-i);r[10]=i*s,r[14]=i*n*s}else r[10]=-1,r[14]=-n;return r}function i3(r,t,e,n){var i=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),s=Math.tan(t.leftDegrees*Math.PI/180),o=Math.tan(t.rightDegrees*Math.PI/180),l=2/(s+o),c=2/(i+a);return r[0]=l,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=c,r[6]=0,r[7]=0,r[8]=-((s-o)*l*.5),r[9]=(i-a)*c*.5,r[10]=n/(e-n),r[11]=-1,r[12]=0,r[13]=0,r[14]=n*e/(e-n),r[15]=0,r}function vO(r,t,e,n,i,a,s){var o=1/(t-e),l=1/(n-i),c=1/(a-s);return r[0]=-2*o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*l,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*c,r[11]=0,r[12]=(t+e)*o,r[13]=(i+n)*l,r[14]=(s+a)*c,r[15]=1,r}var pO=vO;function yO(r,t,e,n,i,a,s){var o=1/(t-e),l=1/(n-i),c=1/(a-s);return r[0]=-2*o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*l,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=c,r[11]=0,r[12]=(t+e)*o,r[13]=(i+n)*l,r[14]=a*c,r[15]=1,r}function mO(r,t,e,n){var i,a,s,o,l,c,u,h,d,f,g=t[0],v=t[1],p=t[2],y=n[0],m=n[1],x=n[2],E=e[0],_=e[1],M=e[2];return Math.abs(g-E)<Ae&&Math.abs(v-_)<Ae&&Math.abs(p-M)<Ae?ha(r):(u=g-E,h=v-_,d=p-M,f=1/Math.sqrt(u*u+h*h+d*d),u*=f,h*=f,d*=f,i=m*d-x*h,a=x*u-y*d,s=y*h-m*u,f=Math.sqrt(i*i+a*a+s*s),f?(f=1/f,i*=f,a*=f,s*=f):(i=0,a=0,s=0),o=h*s-d*a,l=d*i-u*s,c=u*a-h*i,f=Math.sqrt(o*o+l*l+c*c),f?(f=1/f,o*=f,l*=f,c*=f):(o=0,l=0,c=0),r[0]=i,r[1]=o,r[2]=u,r[3]=0,r[4]=a,r[5]=l,r[6]=h,r[7]=0,r[8]=s,r[9]=c,r[10]=d,r[11]=0,r[12]=-(i*g+a*v+s*p),r[13]=-(o*g+l*v+c*p),r[14]=-(u*g+h*v+d*p),r[15]=1,r)}function a3(r,t,e,n){var i=t[0],a=t[1],s=t[2],o=n[0],l=n[1],c=n[2],u=i-e[0],h=a-e[1],d=s-e[2],f=u*u+h*h+d*d;f>0&&(f=1/Math.sqrt(f),u*=f,h*=f,d*=f);var g=l*d-c*h,v=c*u-o*d,p=o*h-l*u;return f=g*g+v*v+p*p,f>0&&(f=1/Math.sqrt(f),g*=f,v*=f,p*=f),r[0]=g,r[1]=v,r[2]=p,r[3]=0,r[4]=h*p-d*v,r[5]=d*g-u*p,r[6]=u*v-h*g,r[7]=0,r[8]=u,r[9]=h,r[10]=d,r[11]=0,r[12]=i,r[13]=a,r[14]=s,r[15]=1,r}function s3(r){return"mat4("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+", "+r[8]+", "+r[9]+", "+r[10]+", "+r[11]+", "+r[12]+", "+r[13]+", "+r[14]+", "+r[15]+")"}function o3(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]+r[3]*r[3]+r[4]*r[4]+r[5]*r[5]+r[6]*r[6]+r[7]*r[7]+r[8]*r[8]+r[9]*r[9]+r[10]*r[10]+r[11]*r[11]+r[12]*r[12]+r[13]*r[13]+r[14]*r[14]+r[15]*r[15])}function l3(r,t,e){return r[0]=t[0]+e[0],r[1]=t[1]+e[1],r[2]=t[2]+e[2],r[3]=t[3]+e[3],r[4]=t[4]+e[4],r[5]=t[5]+e[5],r[6]=t[6]+e[6],r[7]=t[7]+e[7],r[8]=t[8]+e[8],r[9]=t[9]+e[9],r[10]=t[10]+e[10],r[11]=t[11]+e[11],r[12]=t[12]+e[12],r[13]=t[13]+e[13],r[14]=t[14]+e[14],r[15]=t[15]+e[15],r}function bO(r,t,e){return r[0]=t[0]-e[0],r[1]=t[1]-e[1],r[2]=t[2]-e[2],r[3]=t[3]-e[3],r[4]=t[4]-e[4],r[5]=t[5]-e[5],r[6]=t[6]-e[6],r[7]=t[7]-e[7],r[8]=t[8]-e[8],r[9]=t[9]-e[9],r[10]=t[10]-e[10],r[11]=t[11]-e[11],r[12]=t[12]-e[12],r[13]=t[13]-e[13],r[14]=t[14]-e[14],r[15]=t[15]-e[15],r}function c3(r,t,e){return r[0]=t[0]*e,r[1]=t[1]*e,r[2]=t[2]*e,r[3]=t[3]*e,r[4]=t[4]*e,r[5]=t[5]*e,r[6]=t[6]*e,r[7]=t[7]*e,r[8]=t[8]*e,r[9]=t[9]*e,r[10]=t[10]*e,r[11]=t[11]*e,r[12]=t[12]*e,r[13]=t[13]*e,r[14]=t[14]*e,r[15]=t[15]*e,r}function u3(r,t,e,n){return r[0]=t[0]+e[0]*n,r[1]=t[1]+e[1]*n,r[2]=t[2]+e[2]*n,r[3]=t[3]+e[3]*n,r[4]=t[4]+e[4]*n,r[5]=t[5]+e[5]*n,r[6]=t[6]+e[6]*n,r[7]=t[7]+e[7]*n,r[8]=t[8]+e[8]*n,r[9]=t[9]+e[9]*n,r[10]=t[10]+e[10]*n,r[11]=t[11]+e[11]*n,r[12]=t[12]+e[12]*n,r[13]=t[13]+e[13]*n,r[14]=t[14]+e[14]*n,r[15]=t[15]+e[15]*n,r}function Qy(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]&&r[4]===t[4]&&r[5]===t[5]&&r[6]===t[6]&&r[7]===t[7]&&r[8]===t[8]&&r[9]===t[9]&&r[10]===t[10]&&r[11]===t[11]&&r[12]===t[12]&&r[13]===t[13]&&r[14]===t[14]&&r[15]===t[15]}function h3(r,t){var e=r[0],n=r[1],i=r[2],a=r[3],s=r[4],o=r[5],l=r[6],c=r[7],u=r[8],h=r[9],d=r[10],f=r[11],g=r[12],v=r[13],p=r[14],y=r[15],m=t[0],x=t[1],E=t[2],_=t[3],M=t[4],O=t[5],T=t[6],N=t[7],P=t[8],C=t[9],R=t[10],I=t[11],j=t[12],G=t[13],H=t[14],Z=t[15];return Math.abs(e-m)<=Ae*Math.max(1,Math.abs(e),Math.abs(m))&&Math.abs(n-x)<=Ae*Math.max(1,Math.abs(n),Math.abs(x))&&Math.abs(i-E)<=Ae*Math.max(1,Math.abs(i),Math.abs(E))&&Math.abs(a-_)<=Ae*Math.max(1,Math.abs(a),Math.abs(_))&&Math.abs(s-M)<=Ae*Math.max(1,Math.abs(s),Math.abs(M))&&Math.abs(o-O)<=Ae*Math.max(1,Math.abs(o),Math.abs(O))&&Math.abs(l-T)<=Ae*Math.max(1,Math.abs(l),Math.abs(T))&&Math.abs(c-N)<=Ae*Math.max(1,Math.abs(c),Math.abs(N))&&Math.abs(u-P)<=Ae*Math.max(1,Math.abs(u),Math.abs(P))&&Math.abs(h-C)<=Ae*Math.max(1,Math.abs(h),Math.abs(C))&&Math.abs(d-R)<=Ae*Math.max(1,Math.abs(d),Math.abs(R))&&Math.abs(f-I)<=Ae*Math.max(1,Math.abs(f),Math.abs(I))&&Math.abs(g-j)<=Ae*Math.max(1,Math.abs(g),Math.abs(j))&&Math.abs(v-G)<=Ae*Math.max(1,Math.abs(v),Math.abs(G))&&Math.abs(p-H)<=Ae*Math.max(1,Math.abs(p),Math.abs(H))&&Math.abs(y-Z)<=Ae*Math.max(1,Math.abs(y),Math.abs(Z))}var xO=Bn,d3=bO;const f3=Object.freeze(Object.defineProperty({__proto__:null,add:l3,adjoint:XR,clone:rO,copy:Bs,create:ve,decompose:QR,determinant:sO,equals:h3,exactEquals:Qy,frob:o3,fromQuat:c1,fromQuat2:JR,fromRotation:uO,fromRotationTranslation:fO,fromRotationTranslationScale:t3,fromRotationTranslationScaleOrigin:Co,fromScaling:Ra,fromTranslation:Ji,fromValues:iO,fromXRotation:hO,fromYRotation:dO,fromZRotation:Jy,frustum:e3,getRotation:Uc,getScaling:zs,getTranslation:Vc,identity:ha,invert:hi,lookAt:mO,mul:xO,multiply:Bn,multiplyScalar:c3,multiplyScalarAndAdd:u3,ortho:pO,orthoNO:vO,orthoZO:yO,perspective:n3,perspectiveFromFieldOfView:i3,perspectiveNO:gO,perspectiveZO:r3,rotate:KR,rotateX:lO,rotateY:cO,rotateZ:ZR,scale:oO,set:Zy,str:s3,sub:d3,subtract:bO,targetTo:a3,translate:Ps,transpose:aO},Symbol.toStringTag,{value:"Module"}));function te(){var r=new sn(3);return sn!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function Oi(r){var t=new sn(3);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t}function Ni(r){var t=r[0],e=r[1],n=r[2];return Math.sqrt(t*t+e*e+n*n)}function we(r,t,e){var n=new sn(3);return n[0]=r,n[1]=t,n[2]=e,n}function di(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r}function Fn(r,t,e,n){return r[0]=t,r[1]=e,r[2]=n,r}function oa(r,t,e){return r[0]=t[0]+e[0],r[1]=t[1]+e[1],r[2]=t[2]+e[2],r}function tm(r,t,e){return r[0]=t[0]-e[0],r[1]=t[1]-e[1],r[2]=t[2]-e[2],r}function g3(r,t,e){return r[0]=t[0]*e[0],r[1]=t[1]*e[1],r[2]=t[2]*e[2],r}function v3(r,t,e){return r[0]=Math.min(t[0],e[0]),r[1]=Math.min(t[1],e[1]),r[2]=Math.min(t[2],e[2]),r}function p3(r,t,e){return r[0]=Math.max(t[0],e[0]),r[1]=Math.max(t[1],e[1]),r[2]=Math.max(t[2],e[2]),r}function Yc(r,t,e){return r[0]=t[0]*e,r[1]=t[1]*e,r[2]=t[2]*e,r}function y3(r,t){var e=t[0]-r[0],n=t[1]-r[1],i=t[2]-r[2];return Math.sqrt(e*e+n*n+i*i)}function qa(r,t){var e=t[0],n=t[1],i=t[2],a=e*e+n*n+i*i;return a>0&&(a=1/Math.sqrt(a)),r[0]=t[0]*a,r[1]=t[1]*a,r[2]=t[2]*a,r}function fi(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]}function Rc(r,t,e){var n=t[0],i=t[1],a=t[2],s=e[0],o=e[1],l=e[2];return r[0]=i*l-a*o,r[1]=a*s-n*l,r[2]=n*o-i*s,r}function em(r,t,e,n){var i=t[0],a=t[1],s=t[2];return r[0]=i+n*(e[0]-i),r[1]=a+n*(e[1]-a),r[2]=s+n*(e[2]-s),r}function zn(r,t,e){var n=t[0],i=t[1],a=t[2],s=e[3]*n+e[7]*i+e[11]*a+e[15];return s=s||1,r[0]=(e[0]*n+e[4]*i+e[8]*a+e[12])/s,r[1]=(e[1]*n+e[5]*i+e[9]*a+e[13])/s,r[2]=(e[2]*n+e[6]*i+e[10]*a+e[14])/s,r}function m3(r,t,e){var n=t[0],i=t[1],a=t[2];return r[0]=n*e[0]+i*e[3]+a*e[6],r[1]=n*e[1]+i*e[4]+a*e[7],r[2]=n*e[2]+i*e[5]+a*e[8],r}function b3(r,t,e){var n=e[0],i=e[1],a=e[2],s=e[3],o=t[0],l=t[1],c=t[2],u=i*c-a*l,h=a*o-n*c,d=n*l-i*o;return u=u+u,h=h+h,d=d+d,r[0]=o+s*u+i*d-a*h,r[1]=l+s*h+a*u-n*d,r[2]=c+s*d+n*h-i*u,r}function oo(r,t){var e=r[0],n=r[1],i=r[2],a=t[0],s=t[1],o=t[2];return Math.abs(e-a)<=Ae*Math.max(1,Math.abs(e),Math.abs(a))&&Math.abs(n-s)<=Ae*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-o)<=Ae*Math.max(1,Math.abs(i),Math.abs(o))}var x3=tm,Gb=y3,wO=Ni;(function(){var r=te();return function(t,e,n,i,a,s){var o,l;for(e||(e=3),n||(n=0),i?l=Math.min(i*e+n,t.length):l=t.length,o=n;o<l;o+=e)r[0]=t[o],r[1]=t[o+1],r[2]=t[o+2],a(r,r,s),t[o]=r[0],t[o+1]=r[1],t[o+2]=r[2];return t}})();function gi(){var r=new sn(4);return sn!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[3]=0),r}function xo(r,t,e,n){var i=new sn(4);return i[0]=r,i[1]=t,i[2]=e,i[3]=n,i}function w3(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r}function E3(r,t,e,n,i){return r[0]=t,r[1]=e,r[2]=n,r[3]=i,r}function S3(r,t){var e=t[0],n=t[1],i=t[2],a=t[3],s=e*e+n*n+i*i+a*a;return s>0&&(s=1/Math.sqrt(s)),r[0]=e*s,r[1]=n*s,r[2]=i*s,r[3]=a*s,r}function Li(r,t,e){var n=t[0],i=t[1],a=t[2],s=t[3];return r[0]=e[0]*n+e[4]*i+e[8]*a+e[12]*s,r[1]=e[1]*n+e[5]*i+e[9]*a+e[13]*s,r[2]=e[2]*n+e[6]*i+e[10]*a+e[14]*s,r[3]=e[3]*n+e[7]*i+e[11]*a+e[15]*s,r}(function(){var r=gi();return function(t,e,n,i,a,s){var o,l;for(e||(e=4),n||(n=0),i?l=Math.min(i*e+n,t.length):l=t.length,o=n;o<l;o+=e)r[0]=t[o],r[1]=t[o+1],r[2]=t[o+2],r[3]=t[o+3],a(r,r,s),t[o]=r[0],t[o+1]=r[1],t[o+2]=r[2],t[o+3]=r[3];return t}})();function nn(){var r=new sn(4);return sn!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function Qi(r,t,e){e=e*.5;var n=Math.sin(e);return r[0]=n*t[0],r[1]=n*t[1],r[2]=n*t[2],r[3]=Math.cos(e),r}function la(r,t,e){var n=t[0],i=t[1],a=t[2],s=t[3],o=e[0],l=e[1],c=e[2],u=e[3];return r[0]=n*u+s*o+i*c-a*l,r[1]=i*u+s*l+a*o-n*c,r[2]=a*u+s*c+n*l-i*o,r[3]=s*u-n*o-i*l-a*c,r}function gd(r,t,e,n){var i=t[0],a=t[1],s=t[2],o=t[3],l=e[0],c=e[1],u=e[2],h=e[3],d,f,g,v,p;return f=i*l+a*c+s*u+o*h,f<0&&(f=-f,l=-l,c=-c,u=-u,h=-h),1-f>Ae?(d=Math.acos(f),g=Math.sin(d),v=Math.sin((1-n)*d)/g,p=Math.sin(n*d)/g):(v=1-n,p=n),r[0]=v*i+p*l,r[1]=v*a+p*c,r[2]=v*s+p*u,r[3]=v*o+p*h,r}function vd(r,t){var e=t[0],n=t[1],i=t[2],a=t[3],s=e*e+n*n+i*i+a*a,o=s?1/s:0;return r[0]=-e*o,r[1]=-n*o,r[2]=-i*o,r[3]=a*o,r}function _3(r,t){var e=t[0]+t[4]+t[8],n;if(e>0)n=Math.sqrt(e+1),r[3]=.5*n,n=.5/n,r[0]=(t[5]-t[7])*n,r[1]=(t[6]-t[2])*n,r[2]=(t[1]-t[3])*n;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[i*3+i]&&(i=2);var a=(i+1)%3,s=(i+2)%3;n=Math.sqrt(t[i*3+i]-t[a*3+a]-t[s*3+s]+1),r[i]=.5*n,n=.5/n,r[3]=(t[a*3+s]-t[s*3+a])*n,r[a]=(t[a*3+i]+t[i*3+a])*n,r[s]=(t[s*3+i]+t[i*3+s])*n}return r}function Ll(r,t,e,n){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:UR,a=Math.PI/360;t*=a,n*=a,e*=a;var s=Math.sin(t),o=Math.cos(t),l=Math.sin(e),c=Math.cos(e),u=Math.sin(n),h=Math.cos(n);switch(i){case"xyz":r[0]=s*c*h+o*l*u,r[1]=o*l*h-s*c*u,r[2]=o*c*u+s*l*h,r[3]=o*c*h-s*l*u;break;case"xzy":r[0]=s*c*h-o*l*u,r[1]=o*l*h-s*c*u,r[2]=o*c*u+s*l*h,r[3]=o*c*h+s*l*u;break;case"yxz":r[0]=s*c*h+o*l*u,r[1]=o*l*h-s*c*u,r[2]=o*c*u-s*l*h,r[3]=o*c*h+s*l*u;break;case"yzx":r[0]=s*c*h+o*l*u,r[1]=o*l*h+s*c*u,r[2]=o*c*u-s*l*h,r[3]=o*c*h-s*l*u;break;case"zxy":r[0]=s*c*h-o*l*u,r[1]=o*l*h+s*c*u,r[2]=o*c*u+s*l*h,r[3]=o*c*h-s*l*u;break;case"zyx":r[0]=s*c*h-o*l*u,r[1]=o*l*h+s*c*u,r[2]=o*c*u-s*l*h,r[3]=o*c*h+s*l*u;break;default:throw new Error("Unknown angle order "+i)}return r}var k3=xo,Il=w3,EO=E3,$b=la,Hc=S3;(function(){var r=te(),t=we(1,0,0),e=we(0,1,0);return function(n,i,a){var s=fi(i,a);return s<-.999999?(Rc(r,t,i),wO(r)<1e-6&&Rc(r,e,i),qa(r,r),Qi(n,r,Math.PI),n):s>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(Rc(r,i,a),n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=1+s,Hc(n,n))}})();(function(){var r=nn(),t=nn();return function(e,n,i,a,s,o){return gd(r,n,s,o),gd(t,i,a,o),gd(e,r,t,2*o*(1-o)),e}})();(function(){var r=nO();return function(t,e,n,i){return r[0]=n[0],r[3]=n[1],r[6]=n[2],r[1]=i[0],r[4]=i[1],r[7]=i[2],r[2]=-e[0],r[5]=-e[1],r[8]=-e[2],Hc(t,_3(t,r))}})();function u1(){var r=new sn(2);return sn!=Float32Array&&(r[0]=0,r[1]=0),r}function M3(r,t){return r[0]=t[0],r[1]=t[1],r}function T3(r,t,e){return r[0]=t,r[1]=e,r}function O3(r,t){var e=t[0],n=t[1],i=e*e+n*n;return i>0&&(i=1/Math.sqrt(i)),r[0]=t[0]*i,r[1]=t[1]*i,r}function A3(r,t){return r[0]*t[0]+r[1]*t[1]}function N3(r,t){return r[0]===t[0]&&r[1]===t[1]}(function(){var r=u1();return function(t,e,n,i,a,s){var o,l;for(e||(e=2),n||(n=0),i?l=Math.min(i*e+n,t.length):l=t.length,o=n;o<l;o+=e)r[0]=t[o],r[1]=t[o+1],a(r,r,s),t[o]=r[0],t[o+1]=r[1];return t}})();var jo=function(r){return r!==null&&typeof r!="function"&&isFinite(r.length)},P3=function(r,t){return jo(r)?r.indexOf(t)>-1:!1},C3=function(r,t){if(!jo(r))return r;for(var e=[],n=0;n<r.length;n++){var i=r[n];t(i,n)&&e.push(i)}return e},R3=function(r,t){return t===void 0&&(t=[]),C3(r,function(e){return!P3(t,e)})};function Tt(r){return typeof r=="function"}function Rt(r){return r==null}function cr(r){return Array.isArray(r)}const Ze=(function(r){var t=typeof r;return r!==null&&t==="object"||t==="function"});function SO(r,t){if(r){var e;if(cr(r))for(var n=0,i=r.length;n<i&&(e=t(r[n],n),e!==!1);n++);else if(Ze(r)){for(var a in r)if(r.hasOwnProperty(a)&&(e=t(r[a],a),e===!1))break}}}var nm=function(r){return typeof r=="object"&&r!==null},L3={}.toString,_O=function(r,t){return L3.call(r)==="[object "+t+"]"},js=function(r){if(!nm(r)||!_O(r,"Object"))return!1;if(Object.getPrototypeOf(r)===null)return!0;for(var t=r;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(r)===t},I3=function(r){if(!cr(r))return[];for(var t=[],e=0;e<r.length;e++)t=t.concat(r[e]);return t};function Xc(r){if(!Array.isArray(r))return-1/0;var t=r.length;if(!t)return-1/0;for(var e=r[0],n=1;n<t;n++)e=Math.max(e,r[n]);return e}const Kc=(function(r){if(cr(r))return r.reduce(function(t,e){return Math.min(t,e)},r[0])});var D3=function(r,t,e){if(!cr(r)&&!js(r))return r;var n=e;return SO(r,function(i,a){n=t(n,i,a)}),n};function ae(r){return typeof r=="string"}function F3(r,t){t===void 0&&(t=new Map);var e=[];if(Array.isArray(r))for(var n=0,i=r.length;n<i;n++){var a=r[n];t.has(a)||(e.push(a),t.set(a,!0))}return e}var B3=Object.prototype.hasOwnProperty;function Nu(r,t){if(!t||!cr(r))return{};for(var e={},n=Tt(t)?t:function(o){return o[t]},i,a=0;a<r.length;a++){var s=r[a];i=n(s),B3.call(e,i)?e[i].push(s):e[i]=[s]}return e}var qe=function(r,t,e){return r<t?t:r>e?e:r};function St(r){return typeof r=="number"}var z3=1e-5;function Ro(r,t,e){return e===void 0&&(e=z3),r===t||Math.abs(r-t)<e}const j3=(function(r,t){if(cr(r)){for(var e,n=-1/0,i=0;i<r.length;i++){var a=r[i],s=Tt(t)?t(a):a[t];s>n&&(e=a,n=s)}return e}}),q3=(function(r,t){if(cr(r)){for(var e,n=1/0,i=0;i<r.length;i++){var a=r[i],s=Tt(t)?t(a):a[t];s<n&&(e=a,n=s)}return e}});var kO=function(r,t){return(r%t+t)%t};const MO=(function(r){return Rt(r)?"":r.toString()});var G3=function(r){var t=MO(r);return t.charAt(0).toLowerCase()+t.substring(1)};function $3(r,t){return!r||!t?r:r.replace(/\\?\{([^{}]+)\}/g,function(e,n){return e.charAt(0)==="\\"?e.slice(1):t[n]===void 0?"":t[n]})}var Zc=function(r){var t=MO(r);return t.charAt(0).toUpperCase()+t.substring(1)},W3={}.toString,V3=function(r){return W3.call(r).replace(/^\[object /,"").replace(/]$/,"")},qo=function(r){return _O(r,"Boolean")};function U3(r){return r instanceof Date}function Y3(r){return r===null}var H3=Object.prototype,X3=function(r){var t=r&&r.constructor,e=typeof t=="function"&&t.prototype||H3;return r===e},Dt=function(r){return r===void 0};function K3(r){return r instanceof Element||r instanceof Document}function Wb(r,t){for(var e in t)t.hasOwnProperty(e)&&e!=="constructor"&&t[e]!==void 0&&(r[e]=t[e])}function Z3(r,t,e,n){return t&&Wb(r,t),e&&Wb(r,e),r}var da=function(r){if(typeof r!="object"||r===null)return r;var t;if(cr(r)){t=[];for(var e=0,n=r.length;e<n;e++)typeof r[e]=="object"&&r[e]!=null?t[e]=da(r[e]):t[e]=r[e]}else{t={};for(var i in r)typeof r[i]=="object"&&r[i]!=null?t[i]=da(r[i]):t[i]=r[i]}return t};function al(r,t,e){var n;return function(){var i=this,a=arguments,s=function(){n=null,r.apply(i,a)};clearTimeout(n),n=setTimeout(s,t)}}function J3(r){var t,e,n,i=r||1;function a(o,l){++t>i&&(n=e,s(1),++t),e[o]=l}function s(o){t=0,e=Object.create(null),o||(n=Object.create(null))}return s(),{clear:s,has:function(o){return e[o]!==void 0||n[o]!==void 0},get:function(o){var l=e[o];if(l!==void 0)return l;if((l=n[o])!==void 0)return a(o,l),l},set:function(o,l){e[o]!==void 0?e[o]=l:a(o,l)}}}var pd=new Map;function rm(r,t,e){e===void 0&&(e=128);var n=function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var s=t?t.apply(this,i):i[0];pd.has(r)||pd.set(r,J3(e));var o=pd.get(r);if(o.has(s))return o.get(s);var l=r.apply(this,i);return o.set(s,l),l};return n}var Q3=5;function tL(r,t){if(Object.hasOwn)return Object.hasOwn(r,t);if(r==null)throw new TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(Object(r),t)}function TO(r,t,e,n){e=e||0,n=n||Q3;for(var i in t)if(tL(t,i)){var a=t[i];a!==null&&js(a)?(js(r[i])||(r[i]={}),e<n?TO(r[i],a,e+1,n):r[i]=t[i]):cr(a)?(r[i]=[],r[i]=r[i].concat(a)):a!==void 0&&(r[i]=a)}}var An=function(r){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];for(var n=0;n<t.length;n+=1)TO(r,t[n]);return r},eL=Object.prototype.hasOwnProperty;function ui(r){if(Rt(r))return!0;if(jo(r))return!r.length;var t=V3(r);if(t==="Map"||t==="Set")return!r.size;if(X3(r))return!Object.keys(r).length;for(var e in r)if(eL.call(r,e))return!1;return!0}var Ge=function(r,t){if(r===t)return!0;if(!r||!t||ae(r)||ae(t))return!1;if(jo(r)||jo(t)){if(r.length!==t.length)return!1;for(var e=!0,n=0;n<r.length&&(e=Ge(r[n],t[n]),!!e);n++);return e}if(nm(r)||nm(t)){var i=Object.keys(r),a=Object.keys(t);if(i.length!==a.length)return!1;for(var e=!0,n=0;n<i.length&&(e=Ge(r[i[n]],t[i[n]]),!!e);n++);return e}return!1};const Mn=(function(r,t,e){for(var n=0,i=ae(t)?t.split("."):t;r&&n<i.length;)r=r[i[n++]];return r===void 0||n<i.length?e:r}),Go=(function(r,t,e){var n=r,i=ae(t)?t.split("."):t;return i.forEach(function(a,s){s<i.length-1?(Ze(n[a])||(n[a]=St(i[s+1])?[]:{}),n=n[a]):n[a]=e}),r});var nL=Object.prototype.hasOwnProperty;const Ya=(function(r,t){if(r===null||!js(r))return{};var e={};return SO(t,function(n){nL.call(r,n)&&(e[n]=r[n])}),e}),h1=(function(r,t){return D3(r,function(e,n,i){return t.includes(i)||(e[i]=n),e},{})}),OO=(function(r,t,e){var n,i,a,s,o=0;e||(e={});var l=function(){o=e.leading===!1?0:Date.now(),n=null,s=r.apply(i,a),n||(i=a=null)},c=function(){var u=Date.now();!o&&e.leading===!1&&(o=u);var h=t-(u-o);return i=this,a=arguments,h<=0||h>t?(n&&(clearTimeout(n),n=null),o=u,s=r.apply(i,a),n||(i=a=null)):!n&&e.trailing!==!1&&(n=setTimeout(l,h)),s};return c.cancel=function(){clearTimeout(n),o=0,n=i=a=null},c});var Dl={};const rL=(function(r){return r=r||"g",Dl[r]?Dl[r]+=1:Dl[r]=1,r+Dl[r]}),yd=(function(){}),im=(function(r){return r});var am=function(r,t){return am=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])},am(r,t)};function Ut(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");am(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var at=function(){return at=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++){e=arguments[n];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])}return t},at.apply(this,arguments)};function Pe(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(e[n[i]]=r[n[i]]);return e}function Xt(r,t,e,n){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((n=n.apply(r,t||[])).next())})}function sl(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function q(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),i,a=[],s;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(o){s={error:o}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(s)throw s.error}}return a}function iL(){for(var r=0,t=0,e=arguments.length;t<e;t++)r+=arguments[t].length;for(var n=Array(r),i=0,t=0;t<e;t++)for(var a=arguments[t],s=0,o=a.length;s<o;s++,i++)n[i]=a[s];return n}function Nt(r,t,e){if(e||arguments.length===2)for(var n=0,i=t.length,a;n<i;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return r.concat(a||Array.prototype.slice.call(t))}function md(r,t,e,n){if(e==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?r!==t||!n:!t.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e==="m"?n:e==="a"?n.call(r):n?n.value:t.get(r)}var AO={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null};function aL(r,t,e){if(r[e].length>7){r[e].shift();for(var n=r[e],i=e;n.length;)t[e]="A",r.splice(i+=1,0,["C"].concat(n.splice(0,6)));r.splice(e,1)}}var Lo={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0};function NO(r){return Array.isArray(r)&&r.every(function(t){var e=t[0].toLowerCase();return Lo[e]===t.length-1&&"achlmqstvz".includes(e)})}function PO(r){return NO(r)&&r.every(function(t){var e=t[0];return e===e.toUpperCase()})}function CO(r){return PO(r)&&r.every(function(t){var e=t[0];return"ACLMQZ".includes(e)})}function Vb(r){for(var t=r.pathValue[r.segmentStart],e=t.toLowerCase(),n=r.data;n.length>=Lo[e]&&(e==="m"&&n.length>2?(r.segments.push([t].concat(n.splice(0,2))),e="l",t=t==="m"?"l":"L"):r.segments.push([t].concat(n.splice(0,Lo[e]))),!!Lo[e]););}function sL(r){var t=r.index,e=r.pathValue,n=e.charCodeAt(t);if(n===48){r.param=0,r.index+=1;return}if(n===49){r.param=1,r.index+=1;return}r.err='[path-util]: invalid Arc flag "'.concat(e[t],'", expecting 0 or 1 at index ').concat(t)}function oL(r){return r>=48&&r<=57||r===43||r===45||r===46}function vs(r){return r>=48&&r<=57}function lL(r){var t=r.max,e=r.pathValue,n=r.index,i=n,a=!1,s=!1,o=!1,l=!1,c;if(i>=t){r.err="[path-util]: Invalid path value at index ".concat(i,', "pathValue" is missing param');return}if(c=e.charCodeAt(i),(c===43||c===45)&&(i+=1,c=e.charCodeAt(i)),!vs(c)&&c!==46){r.err="[path-util]: Invalid path value at index ".concat(i,', "').concat(e[i],'" is not a number');return}if(c!==46){if(a=c===48,i+=1,c=e.charCodeAt(i),a&&i<t&&c&&vs(c)){r.err="[path-util]: Invalid path value at index ".concat(n,', "').concat(e[n],'" illegal number');return}for(;i<t&&vs(e.charCodeAt(i));)i+=1,s=!0;c=e.charCodeAt(i)}if(c===46){for(l=!0,i+=1;vs(e.charCodeAt(i));)i+=1,o=!0;c=e.charCodeAt(i)}if(c===101||c===69){if(l&&!s&&!o){r.err="[path-util]: Invalid path value at index ".concat(i,', "').concat(e[i],'" invalid float exponent');return}if(i+=1,c=e.charCodeAt(i),(c===43||c===45)&&(i+=1),i<t&&vs(e.charCodeAt(i)))for(;i<t&&vs(e.charCodeAt(i));)i+=1;else{r.err="[path-util]: Invalid path value at index ".concat(i,', "').concat(e[i],'" invalid integer exponent');return}}r.index=i,r.param=+r.pathValue.slice(n,i)}function cL(r){var t=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];return r===10||r===13||r===8232||r===8233||r===32||r===9||r===11||r===12||r===160||r>=5760&&t.includes(r)}function Lc(r){for(var t=r.pathValue,e=r.max;r.index<e&&cL(t.charCodeAt(r.index));)r.index+=1}function uL(r){switch(r|32){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:return!0;default:return!1}}function hL(r){return(r|32)===97}function dL(r){var t=r.max,e=r.pathValue,n=r.index,i=e.charCodeAt(n),a=Lo[e[n].toLowerCase()];if(r.segmentStart=n,!uL(i)){r.err='[path-util]: Invalid path value "'.concat(e[n],'" is not a path command');return}if(r.index+=1,Lc(r),r.data=[],!a){Vb(r);return}for(;;){for(var s=a;s>0;s-=1){if(hL(i)&&(s===3||s===4)?sL(r):lL(r),r.err.length)return;r.data.push(r.param),Lc(r),r.index<t&&e.charCodeAt(r.index)===44&&(r.index+=1,Lc(r))}if(r.index>=r.max||!oL(e.charCodeAt(r.index)))break}Vb(r)}var fL=(function(){function r(t){this.pathValue=t,this.segments=[],this.max=t.length,this.index=0,this.param=0,this.segmentStart=0,this.data=[],this.err=""}return r})();function gL(r){if(NO(r))return[].concat(r);var t=new fL(r);for(Lc(t);t.index<t.max&&!t.err.length;)dL(t);return t.err?t.err:t.segments}function vL(r){if(PO(r))return[].concat(r);var t=gL(r),e=0,n=0,i=0,a=0;return t.map(function(s){var o=s.slice(1).map(Number),l=s[0],c=l.toUpperCase();if(l==="M")return e=o[0],n=o[1],i=e,a=n,["M",e,n];var u;if(l!==c)switch(c){case"A":u=[c,o[0],o[1],o[2],o[3],o[4],o[5]+e,o[6]+n];break;case"V":u=[c,o[0]+n];break;case"H":u=[c,o[0]+e];break;default:{var h=o.map(function(f,g){return f+(g%2?n:e)});u=[c].concat(h)}}else u=[c].concat(o);var d=u.length;switch(c){case"Z":e=i,n=a;break;case"H":e=u[1];break;case"V":n=u[1];break;default:e=u[d-2],n=u[d-1],c==="M"&&(i=e,a=n)}return u})}function pL(r,t){var e=r[0],n=t.x1,i=t.y1,a=t.x2,s=t.y2,o=r.slice(1).map(Number),l=r;if("TQ".includes(e)||(t.qx=null,t.qy=null),e==="H")l=["L",r[1],i];else if(e==="V")l=["L",n,r[1]];else if(e==="S"){var c=n*2-a,u=i*2-s;t.x1=c,t.y1=u,l=["C",c,u].concat(o)}else if(e==="T"){var h=n*2-t.qx,d=i*2-t.qy;t.qx=h,t.qy=d,l=["Q",h,d].concat(o)}else if(e==="Q"){var f=o[0],g=o[1];t.qx=f,t.qy=g}return l}function Jc(r){if(CO(r))return[].concat(r);for(var t=vL(r),e=at({},AO),n=0;n<t.length;n+=1){t[n]=pL(t[n],e);var i=t[n],a=i.length;e.x1=+i[a-2],e.y1=+i[a-1],e.x2=+i[a-4]||e.x1,e.y2=+i[a-3]||e.y1}return t}function yL(r){return CO(r)&&r.every(function(t){var e=t[0];return"MC".includes(e)})}function Fl(r,t,e){var n=r*Math.cos(e)-t*Math.sin(e),i=r*Math.sin(e)+t*Math.cos(e);return{x:n,y:i}}function d1(r,t,e,n,i,a,s,o,l,c){var u=r,h=t,d=e,f=n,g=o,v=l,p=Math.PI*120/180,y=Math.PI/180*(+i||0),m=[],x,E,_,M,O;if(c)E=c[0],_=c[1],M=c[2],O=c[3];else{x=Fl(u,h,-y),u=x.x,h=x.y,x=Fl(g,v,-y),g=x.x,v=x.y;var T=(u-g)/2,N=(h-v)/2,P=T*T/(d*d)+N*N/(f*f);P>1&&(P=Math.sqrt(P),d*=P,f*=P);var C=d*d,R=f*f,I=(a===s?-1:1)*Math.sqrt(Math.abs((C*R-C*N*N-R*T*T)/(C*N*N+R*T*T)));M=I*d*N/f+(u+g)/2,O=I*-f*T/d+(h+v)/2,E=Math.asin(((h-O)/f*Math.pow(10,9)>>0)/Math.pow(10,9)),_=Math.asin(((v-O)/f*Math.pow(10,9)>>0)/Math.pow(10,9)),E=u<M?Math.PI-E:E,_=g<M?Math.PI-_:_,E<0&&(E=Math.PI*2+E),_<0&&(_=Math.PI*2+_),s&&E>_&&(E-=Math.PI*2),!s&&_>E&&(_-=Math.PI*2)}var j=_-E;if(Math.abs(j)>p){var G=_,H=g,Z=v;_=E+p*(s&&_>E?1:-1),g=M+d*Math.cos(_),v=O+f*Math.sin(_),m=d1(g,v,d,f,i,0,s,H,Z,[_,G,M,O])}j=_-E;var U=Math.cos(E),tt=Math.sin(E),gt=Math.cos(_),xt=Math.sin(_),ut=Math.tan(j/4),zt=4/3*d*ut,J=4/3*f*ut,W=[u,h],Q=[u+zt*tt,h-J*U],ht=[g+zt*xt,v-J*gt],Et=[g,v];if(Q[0]=2*W[0]-Q[0],Q[1]=2*W[1]-Q[1],c)return Q.concat(ht,Et,m);m=Q.concat(ht,Et,m);for(var Pt=[],Kt=0,pe=m.length;Kt<pe;Kt+=1)Pt[Kt]=Kt%2?Fl(m[Kt-1],m[Kt],y).y:Fl(m[Kt],m[Kt+1],y).x;return Pt}function mL(r,t,e,n,i,a){var s=.3333333333333333,o=2/3;return[s*r+o*e,s*t+o*n,s*i+o*e,s*a+o*n,i,a]}function Ki(r,t,e){var n=r[0],i=r[1],a=t[0],s=t[1];return[n+(a-n)*e,i+(s-i)*e]}var Ub=function(r,t,e,n){var i=.5,a=Ki([r,t],[e,n],i);return Nt(Nt([],a,!0),[e,n,e,n],!1)};function bL(r,t){var e=r[0],n=r.slice(1).map(Number),i=n[0],a=n[1],s,o=t.x1,l=t.y1,c=t.x,u=t.y;switch("TQ".includes(e)||(t.qx=null,t.qy=null),e){case"M":return t.x=i,t.y=a,r;case"A":return s=[o,l].concat(n),["C"].concat(d1(s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7],s[8],s[9]));case"Q":return t.qx=i,t.qy=a,s=[o,l].concat(n),["C"].concat(mL(s[0],s[1],s[2],s[3],s[4],s[5]));case"L":return["C"].concat(Ub(o,l,i,a));case"Z":return o===c&&l===u?["C",o,l,c,u,c,u]:["C"].concat(Ub(o,l,c,u))}return r}function sm(r,t){if(t===void 0&&(t=!1),yL(r)){var e=[].concat(r);return t?[e,[]]:e}for(var n=Jc(r),i=at({},AO),a=[],s="",o=n.length,l,c,u=[],h=0;h<o;h+=1){n[h]&&(s=n[h][0]),a[h]=s;var d=bL(n[h],i);n[h]=d,aL(n,a,h),o=n.length,s==="Z"&&u.push(h),l=n[h],c=l.length,i.x1=+l[c-2],i.y1=+l[c-1],i.x2=+l[c-4]||i.x1,i.y2=+l[c-3]||i.y1}return t?[n,u]:n}function xL(r){return r.map(function(t){return Array.isArray(t)?[].concat(t):t})}function wL(r){var t=r.slice(1).map(function(e,n,i){return n?i[n-1].slice(-2).concat(e.slice(1)):r[0].slice(1).concat(e.slice(1))}).map(function(e){return e.map(function(n,i){return e[e.length-i-2*(1-i%2)]})}).reverse();return[["M"].concat(t[0].slice(0,2))].concat(t.map(function(e){return["C"].concat(e.slice(2))}))}function er(r,t){return Math.sqrt((r[0]-t[0])*(r[0]-t[0])+(r[1]-t[1])*(r[1]-t[1]))}function om(r,t,e,n,i){var a=er([r,t],[e,n]),s={x:0,y:0};if(typeof i=="number")if(i<=0)s={x:r,y:t};else if(i>=a)s={x:e,y:n};else{var o=Ki([r,t],[e,n],i/a),l=o[0],c=o[1];s={x:l,y:c}}return{length:a,point:s,min:{x:Math.min(r,e),y:Math.min(t,n)},max:{x:Math.max(r,e),y:Math.max(t,n)}}}function Yb(r,t){var e=r.x,n=r.y,i=t.x,a=t.y,s=e*i+n*a,o=Math.sqrt((Math.pow(e,2)+Math.pow(n,2))*(Math.pow(i,2)+Math.pow(a,2))),l=e*a-n*i<0?-1:1,c=l*Math.acos(s/o);return c}function EL(r,t,e,n,i,a,s,o,l,c){var u=Math.abs,h=Math.sin,d=Math.cos,f=Math.sqrt,g=Math.PI,v=u(e),p=u(n),y=(i%360+360)%360,m=y*(g/180);if(r===o&&t===l)return{x:r,y:t};if(v===0||p===0)return om(r,t,o,l,c).point;var x=(r-o)/2,E=(t-l)/2,_={x:d(m)*x+h(m)*E,y:-h(m)*x+d(m)*E},M=Math.pow(_.x,2)/Math.pow(v,2)+Math.pow(_.y,2)/Math.pow(p,2);M>1&&(v*=f(M),p*=f(M));var O=Math.pow(v,2)*Math.pow(p,2)-Math.pow(v,2)*Math.pow(_.y,2)-Math.pow(p,2)*Math.pow(_.x,2),T=Math.pow(v,2)*Math.pow(_.y,2)+Math.pow(p,2)*Math.pow(_.x,2),N=O/T;N=N<0?0:N;var P=(a!==s?1:-1)*f(N),C={x:P*(v*_.y/p),y:P*(-(p*_.x)/v)},R={x:d(m)*C.x-h(m)*C.y+(r+o)/2,y:h(m)*C.x+d(m)*C.y+(t+l)/2},I={x:(_.x-C.x)/v,y:(_.y-C.y)/p},j=Yb({x:1,y:0},I),G={x:(-_.x-C.x)/v,y:(-_.y-C.y)/p},H=Yb(I,G);!s&&H>0?H-=2*g:s&&H<0&&(H+=2*g),H%=2*g;var Z=j+H*c,U=v*d(Z),tt=p*h(Z),gt={x:d(m)*U-h(m)*tt+R.x,y:h(m)*U+d(m)*tt+R.y};return gt}function SL(r,t,e,n,i,a,s,o,l,c,u){var h,d=u.bbox,f=d===void 0?!0:d,g=u.length,v=g===void 0?!0:g,p=u.sampleSize,y=p===void 0?30:p,m=typeof c=="number",x=r,E=t,_=0,M=[x,E,_],O=[x,E],T=0,N={x:0,y:0},P=[{x,y:E}];m&&c<=0&&(N={x,y:E});for(var C=0;C<=y;C+=1){if(T=C/y,h=EL(r,t,e,n,i,a,s,o,l,T),x=h.x,E=h.y,f&&P.push({x,y:E}),v&&(_+=er(O,[x,E])),O=[x,E],m&&_>=c&&c>M[2]){var R=(_-c)/(_-M[2]);N={x:O[0]*(1-R)+M[0]*R,y:O[1]*(1-R)+M[1]*R}}M=[x,E,_]}return m&&c>=_&&(N={x:o,y:l}),{length:_,point:N,min:{x:Math.min.apply(null,P.map(function(I){return I.x})),y:Math.min.apply(null,P.map(function(I){return I.y}))},max:{x:Math.max.apply(null,P.map(function(I){return I.x})),y:Math.max.apply(null,P.map(function(I){return I.y}))}}}function _L(r,t,e,n,i,a,s,o,l){var c=1-l;return{x:Math.pow(c,3)*r+3*Math.pow(c,2)*l*e+3*c*Math.pow(l,2)*i+Math.pow(l,3)*s,y:Math.pow(c,3)*t+3*Math.pow(c,2)*l*n+3*c*Math.pow(l,2)*a+Math.pow(l,3)*o}}function RO(r,t,e,n,i,a,s,o,l,c){var u,h=c.bbox,d=h===void 0?!0:h,f=c.length,g=f===void 0?!0:f,v=c.sampleSize,p=v===void 0?10:v,y=typeof l=="number",m=r,x=t,E=0,_=[m,x,E],M=[m,x],O=0,T={x:0,y:0},N=[{x:m,y:x}];y&&l<=0&&(T={x:m,y:x});for(var P=0;P<=p;P+=1){if(O=P/p,u=_L(r,t,e,n,i,a,s,o,O),m=u.x,x=u.y,d&&N.push({x:m,y:x}),g&&(E+=er(M,[m,x])),M=[m,x],y&&E>=l&&l>_[2]){var C=(E-l)/(E-_[2]);T={x:M[0]*(1-C)+_[0]*C,y:M[1]*(1-C)+_[1]*C}}_=[m,x,E]}return y&&l>=E&&(T={x:s,y:o}),{length:E,point:T,min:{x:Math.min.apply(null,N.map(function(R){return R.x})),y:Math.min.apply(null,N.map(function(R){return R.y}))},max:{x:Math.max.apply(null,N.map(function(R){return R.x})),y:Math.max.apply(null,N.map(function(R){return R.y}))}}}function kL(r,t,e,n,i,a,s){var o=1-s;return{x:Math.pow(o,2)*r+2*o*s*e+Math.pow(s,2)*i,y:Math.pow(o,2)*t+2*o*s*n+Math.pow(s,2)*a}}function ML(r,t,e,n,i,a,s,o){var l,c=o.bbox,u=c===void 0?!0:c,h=o.length,d=h===void 0?!0:h,f=o.sampleSize,g=f===void 0?10:f,v=typeof s=="number",p=r,y=t,m=0,x=[p,y,m],E=[p,y],_=0,M={x:0,y:0},O=[{x:p,y}];v&&s<=0&&(M={x:p,y});for(var T=0;T<=g;T+=1){if(_=T/g,l=kL(r,t,e,n,i,a,_),p=l.x,y=l.y,u&&O.push({x:p,y}),d&&(m+=er(E,[p,y])),E=[p,y],v&&m>=s&&s>x[2]){var N=(m-s)/(m-x[2]);M={x:E[0]*(1-N)+x[0]*N,y:E[1]*(1-N)+x[1]*N}}x=[p,y,m]}return v&&s>=m&&(M={x:i,y:a}),{length:m,point:M,min:{x:Math.min.apply(null,O.map(function(P){return P.x})),y:Math.min.apply(null,O.map(function(P){return P.y}))},max:{x:Math.max.apply(null,O.map(function(P){return P.x})),y:Math.max.apply(null,O.map(function(P){return P.y}))}}}function LO(r,t,e){for(var n,i,a,s,o,l,c=Jc(r),u=typeof t=="number",h,d=[],f,g=0,v=0,p=0,y=0,m,x=[],E=[],_=0,M={x:0,y:0},O=M,T=M,N=M,P=0,C=0,R=c.length;C<R;C+=1)m=c[C],f=m[0],h=f==="M",d=h?d:[g,v].concat(m.slice(1)),h?(p=m[1],y=m[2],M={x:p,y},O=M,_=0,u&&t<.001&&(N=M)):f==="L"?(n=om(d[0],d[1],d[2],d[3],(t||0)-P),_=n.length,M=n.min,O=n.max,T=n.point):f==="A"?(i=SL(d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],d[8],(t||0)-P,e||{}),_=i.length,M=i.min,O=i.max,T=i.point):f==="C"?(a=RO(d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],(t||0)-P,e||{}),_=a.length,M=a.min,O=a.max,T=a.point):f==="Q"?(s=ML(d[0],d[1],d[2],d[3],d[4],d[5],(t||0)-P,e||{}),_=s.length,M=s.min,O=s.max,T=s.point):f==="Z"&&(d=[g,v,p,y],o=om(d[0],d[1],d[2],d[3],(t||0)-P),_=o.length,M=o.min,O=o.max,T=o.point),u&&P<t&&P+_>=t&&(N=T),E.push(O),x.push(M),P+=_,l=f!=="Z"?m.slice(-2):[p,y],g=l[0],v=l[1];return u&&t>=P&&(N={x:g,y:v}),{length:P,point:N,min:{x:Math.min.apply(null,x.map(function(I){return I.x})),y:Math.min.apply(null,x.map(function(I){return I.y}))},max:{x:Math.max.apply(null,E.map(function(I){return I.x})),y:Math.max.apply(null,E.map(function(I){return I.y}))}}}function TL(r,t){return LO(r,void 0,at(at({},t),{bbox:!1,length:!0})).length}function OL(r){var t=r.length,e=t-1;return r.map(function(n,i){return r.map(function(a,s){var o=i+s,l;return s===0||r[o]&&r[o][0]==="M"?(l=r[o],["M"].concat(l.slice(-2))):(o>=t&&(o-=e),r[o])})})}function AL(r,t){var e=r.length-1,n=[],i=0,a=0,s=OL(r);return s.forEach(function(o,l){r.slice(1).forEach(function(c,u){a+=er(r[(l+u)%e].slice(-2),t[u%e].slice(-2))}),n[l]=a,a=0}),i=n.indexOf(Math.min.apply(null,n)),s[i]}function NL(r,t,e,n,i,a,s,o){return 3*((o-t)*(e+i)-(s-r)*(n+a)+n*(r-i)-e*(t-a)+o*(i+r/3)-s*(a+t/3))/20}function PL(r){var t=0,e=0,n=0;return sm(r).map(function(i){var a;switch(i[0]){case"M":return t=i[1],e=i[2],0;default:var s=i.slice(1),o=s[0],l=s[1],c=s[2],u=s[3],h=s[4],d=s[5];return n=NL(t,e,o,l,c,u,h,d),a=i.slice(-2),t=a[0],e=a[1],n}}).reduce(function(i,a){return i+a},0)}function Hb(r){return PL(r)>=0}function CL(r,t,e){return LO(r,t,at(at({},e),{bbox:!1,length:!0})).point}var RL=50;function LL(r,t){t===void 0&&(t=.5);var e=r.slice(0,2),n=r.slice(2,4),i=r.slice(4,6),a=r.slice(6,8),s=Ki(e,n,t),o=Ki(n,i,t),l=Ki(i,a,t),c=Ki(s,o,t),u=Ki(o,l,t),h=Ki(c,u,t);return[["C"].concat(s,c,h),["C"].concat(u,l,a)]}function Xb(r){return r.map(function(t,e,n){var i=e&&n[e-1].slice(-2).concat(t.slice(1)),a=e?RO(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8],{bbox:!1}).length:0,s;return e?s=a?LL(i):[t,t]:s=[t],{s:t,ss:s,l:a}})}function IO(r,t,e,n){if(n===void 0&&(n=0),n>RL)return console.warn("Maximum recursion depth reached in equalizeSegments"),[r,t];var i=Xb(r),a=Xb(t),s=i.length,o=a.length,l=i.filter(function(y){return y.l}).length,c=a.filter(function(y){return y.l}).length,u=i.filter(function(y){return y.l}).reduce(function(y,m){var x=m.l;return y+x},0)/l||0,h=a.filter(function(y){return y.l}).reduce(function(y,m){var x=m.l;return y+x},0)/c||0,d=e||Math.max(s,o),f=[u,h],g=[d-s,d-o],v=0,p=[i,a].map(function(y,m){return y.l===d?y.map(function(x){return x.s}):y.map(function(x,E){return v=E&&g[m]&&x.l>=f[m],g[m]-=v?1:0,v?x.ss:[x.s]}).flat()});return p[0].length===p[1].length?p:IO(p[0],p[1],d,n+1)}function lm(r){var t=document.createElement("div");t.innerHTML=r;var e=t.childNodes[0];return e&&t.contains(e)&&t.removeChild(e),e}function IL(r,t){for(;!{}.hasOwnProperty.call(r,t)&&(r=Fs(r))!==null;);return r}function cm(){return cm=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(r,t,e){var n=IL(r,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?r:e):i.value}},cm.apply(null,arguments)}function Kb(r,t,e,n){var i=cm(Fs(r.prototype),t,e);return typeof i=="function"?function(a){return i.apply(e,a)}:i}/*!
 * @antv/g-math
 * @description Geometry util
 * @version 3.0.1
 * @date 5/9/2025, 8:18:51 AM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */function Di(r,t,e,n){var i=r-e,a=t-n;return Math.sqrt(i*i+a*a)}function DO(r,t){var e=Math.min.apply(Math,ne(r)),n=Math.min.apply(Math,ne(t)),i=Math.max.apply(Math,ne(r)),a=Math.max.apply(Math,ne(t));return{x:e,y:n,width:i-e,height:a-n}}function DL(r,t,e){return Math.atan(-t/r*Math.tan(e))}function FL(r,t,e){return Math.atan(t/(r*Math.tan(e)))}function BL(r,t,e,n,i,a){return e*Math.cos(i)*Math.cos(a)-n*Math.sin(i)*Math.sin(a)+r}function zL(r,t,e,n,i,a){return e*Math.sin(i)*Math.cos(a)+n*Math.cos(i)*Math.sin(a)+t}function jL(r,t,e,n,i,a,s){for(var o=DL(e,n,i),l=1/0,c=-1/0,u=[a,s],h=-Math.PI*2;h<=Math.PI*2;h+=Math.PI){var d=o+h;a<s?a<d&&d<s&&u.push(d):s<d&&d<a&&u.push(d)}for(var f=0;f<u.length;f++){var g=BL(r,t,e,n,i,u[f]);g<l&&(l=g),g>c&&(c=g)}for(var v=FL(e,n,i),p=1/0,y=-1/0,m=[a,s],x=-Math.PI*2;x<=Math.PI*2;x+=Math.PI){var E=v+x;a<s?a<E&&E<s&&m.push(E):s<E&&E<a&&m.push(E)}for(var _=0;_<m.length;_++){var M=zL(r,t,e,n,i,m[_]);M<p&&(p=M),M>y&&(y=M)}return{x:l,y:p,width:c-l,height:y-p}}var qL=1e-4;function FO(r,t,e,n,i,a){var s=-1,o=1/0,l=[e,n],c=20;a&&a>200&&(c=a/10);for(var u=1/c,h=u/10,d=0;d<=c;d++){var f=d*u,g=[i.apply(void 0,ne(r.concat([f]))),i.apply(void 0,ne(t.concat([f])))],v=Di(l[0],l[1],g[0],g[1]);v<o&&(s=f,o=v)}if(s===0)return{x:r[0],y:t[0]};if(s===1){var p=r.length;return{x:r[p-1],y:t[p-1]}}o=1/0;for(var y=0;y<32&&!(h<qL);y++){var m=s-h,x=s+h,E=[i.apply(void 0,ne(r.concat([m]))),i.apply(void 0,ne(t.concat([m])))],_=Di(l[0],l[1],E[0],E[1]);if(m>=0&&_<o)s=m,o=_;else{var M=[i.apply(void 0,ne(r.concat([x]))),i.apply(void 0,ne(t.concat([x])))],O=Di(l[0],l[1],M[0],M[1]);x<=1&&O<o?(s=x,o=O):h*=.5}}return{x:i.apply(void 0,ne(r.concat([s]))),y:i.apply(void 0,ne(t.concat([s])))}}function BO(r,t,e,n){return Di(r,t,e,n)}function zO(r,t,e,n,i){return{x:(1-i)*r+i*e,y:(1-i)*t+i*n}}function GL(r,t,e,n,i,a){var s=[e-r,n-t];if(N3(s,[0,0]))return Math.sqrt((i-r)*(i-r)+(a-t)*(a-t));var o=[-s[1],s[0]];O3(o,o);var l=[i-r,a-t];return Math.abs(A3(l,o))}function um(r,t,e,n,i){var a=1-i;return a*a*a*r+3*t*i*a*a+3*e*i*i*a+n*i*i*i}function Zb(r,t,e,n){var i=-3*r+9*t-9*e+3*n,a=6*r-12*t+6*e,s=3*t-3*r,o=[],l,c,u;if(Ro(i,0))Ro(a,0)||(l=-s/a,l>=0&&l<=1&&o.push(l));else{var h=a*a-4*i*s;Ro(h,0)?o.push(-a/(2*i)):h>0&&(u=Math.sqrt(h),l=(-a+u)/(2*i),c=(-a-u)/(2*i),l>=0&&l<=1&&o.push(l),c>=0&&c<=1&&o.push(c))}return o}function $L(r,t,e,n,i,a,s,o){for(var l=[r,s],c=[t,o],u=Zb(r,e,i,s),h=Zb(t,n,a,o),d=0;d<u.length;d++)l.push(um(r,e,i,s,u[d]));for(var f=0;f<h.length;f++)c.push(um(t,n,a,o,h[f]));return DO(l,c)}function WL(r,t,e,n,i,a,s,o,l,c,u){return FO([r,e,i,s],[t,n,a,o],l,c,um,u)}function Jb(r,t,e,n,i,a,s,o,l,c,u){var h=WL(r,t,e,n,i,a,s,o,l,c,u);return Di(h.x,h.y,l,c)}function VL(r){if(r.length<2)return 0;for(var t=0,e=0;e<r.length-1;e++){var n=r[e],i=r[e+1];t+=Di(n[0],n[1],i[0],i[1])}return t}function UL(r){return VL(r)}function hm(r,t,e,n){var i=1-n;return i*i*r+2*n*i*t+n*n*e}function Qb(r,t,e){var n=r+e-2*t;if(Ro(n,0))return[.5];var i=(r-t)/n;return i<=1&&i>=0?[i]:[]}function YL(r,t,e,n,i,a){var s=Qb(r,e,i)[0],o=Qb(t,n,a)[0],l=[r,i],c=[t,a];return s!==void 0&&l.push(hm(r,e,i,s)),o!==void 0&&c.push(hm(t,n,a,o)),DO(l,c)}function HL(r,t,e,n,i,a,s,o){return FO([r,e,i],[t,n,a],s,o,hm)}function XL(r,t,e,n,i,a,s,o){var l=HL(r,t,e,n,i,a,s,o);return Di(l.x,l.y,s,o)}function jO(r,t){this.v=r,this.k=t}function In(r,t,e,n){var i=Object.defineProperty;try{i({},"",{})}catch{i=0}In=function(s,o,l,c){function u(h,d){In(s,h,function(f){return this._invoke(h,d,f)})}o?i?i(s,o,{value:l,enumerable:!c,configurable:!c,writable:!c}):s[o]=l:(u("next",0),u("throw",1),u("return",2))},In(r,t,e,n)}function f1(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var r,t,e=typeof Symbol=="function"?Symbol:{},n=e.iterator||"@@iterator",i=e.toStringTag||"@@toStringTag";function a(f,g,v,p){var y=g&&g.prototype instanceof o?g:o,m=Object.create(y.prototype);return In(m,"_invoke",(function(x,E,_){var M,O,T,N=0,P=_||[],C=!1,R={p:0,n:0,v:r,a:I,f:I.bind(r,4),d:function(G,H){return M=G,O=0,T=r,R.n=H,s}};function I(j,G){for(O=j,T=G,t=0;!C&&N&&!H&&t<P.length;t++){var H,Z=P[t],U=R.p,tt=Z[2];j>3?(H=tt===G)&&(T=Z[(O=Z[4])?5:(O=3,3)],Z[4]=Z[5]=r):Z[0]<=U&&((H=j<2&&U<Z[1])?(O=0,R.v=G,R.n=Z[1]):U<tt&&(H=j<3||Z[0]>G||G>tt)&&(Z[4]=j,Z[5]=G,R.n=tt,O=0))}if(H||j>1)return s;throw C=!0,G}return function(j,G,H){if(N>1)throw TypeError("Generator is already running");for(C&&G===1&&I(G,H),O=G,T=H;(t=O<2?r:T)||!C;){M||(O?O<3?(O>1&&(R.n=-1),I(O,T)):R.n=T:R.v=T);try{if(N=2,M){if(O||(j="next"),t=M[j]){if(!(t=t.call(M,T)))throw TypeError("iterator result is not an object");if(!t.done)return t;T=t.value,O<2&&(O=0)}else O===1&&(t=M.return)&&t.call(M),O<2&&(T=TypeError("The iterator does not provide a '"+j+"' method"),O=1);M=r}else if((t=(C=R.n<0)?T:x.call(E,R))!==s)break}catch(Z){M=r,O=1,T=Z}finally{N=1}}return{value:t,done:C}}})(f,v,p),!0),m}var s={};function o(){}function l(){}function c(){}t=Object.getPrototypeOf;var u=[][n]?t(t([][n]())):(In(t={},n,function(){return this}),t),h=c.prototype=o.prototype=Object.create(u);function d(f){return Object.setPrototypeOf?Object.setPrototypeOf(f,c):(f.__proto__=c,In(f,i,"GeneratorFunction")),f.prototype=Object.create(h),f}return l.prototype=c,In(h,"constructor",c),In(c,"constructor",l),l.displayName="GeneratorFunction",In(c,i,"GeneratorFunction"),In(h),In(h,i,"Generator"),In(h,n,function(){return this}),In(h,"toString",function(){return"[object Generator]"}),(f1=function(){return{w:a,m:d}})()}function Qc(r,t){function e(i,a,s,o){try{var l=r[i](a),c=l.value;return c instanceof jO?t.resolve(c.v).then(function(u){e("next",u,s,o)},function(u){e("throw",u,s,o)}):t.resolve(c).then(function(u){l.value=u,s(l)},function(u){return e("throw",u,s,o)})}catch(u){o(u)}}var n;this.next||(In(Qc.prototype),In(Qc.prototype,typeof Symbol=="function"&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),In(this,"_invoke",function(i,a,s){function o(){return new t(function(l,c){e(i,s,l,c)})}return n=n?n.then(o,o):o()},!0)}function qO(r,t,e,n,i){return new Qc(f1().w(r,t,e,n),i||Promise)}function KL(r,t,e,n,i){var a=qO(r,t,e,n,i);return a.next().then(function(s){return s.done?s.value:a.next()})}function ZL(r){var t=Object(r),e=[];for(var n in t)e.unshift(n);return function i(){for(;e.length;)if((n=e.pop())in t)return i.value=n,i.done=!1,i;return i.done=!0,i}}function tx(r){if(r!=null){var t=r[typeof Symbol=="function"&&Symbol.iterator||"@@iterator"],e=0;if(t)return t.call(r);if(typeof r.next=="function")return r;if(!isNaN(r.length))return{next:function(){return r&&e>=r.length&&(r=void 0),{value:r&&r[e++],done:!r}}}}throw new TypeError(Ua(r)+" is not iterable")}function bn(){var r=f1(),t=r.m(bn),e=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function n(s){var o=typeof s=="function"&&s.constructor;return!!o&&(o===e||(o.displayName||o.name)==="GeneratorFunction")}var i={throw:1,return:2,break:3,continue:3};function a(s){var o,l;return function(c){o||(o={stop:function(){return l(c.a,2)},catch:function(){return c.v},abrupt:function(h,d){return l(c.a,i[h],d)},delegateYield:function(h,d,f){return o.resultName=d,l(c.d,tx(h),f)},finish:function(h){return l(c.f,h)}},l=function(h,d,f){c.p=o.prev,c.n=o.next;try{return h(d,f)}finally{o.next=c.n}}),o.resultName&&(o[o.resultName]=c.v,o.resultName=void 0),o.sent=c.v,o.next=c.n;try{return s.call(this,o)}finally{c.p=o.prev,c.n=o.next}}}return(bn=function(){return{wrap:function(l,c,u,h){return r.w(a(l),c,u,h&&h.reverse())},isGeneratorFunction:n,mark:r.m,awrap:function(l,c){return new jO(l,c)},AsyncIterator:Qc,async:function(l,c,u,h,d){return(n(c)?qO:KL)(a(l),c,u,h,d)},keys:ZL,values:tx}})()}function ex(r,t,e,n,i,a,s){try{var o=r[a](s),l=o.value}catch(c){return void e(c)}o.done?t(l):Promise.resolve(l).then(n,i)}function fa(r){return function(){var t=this,e=arguments;return new Promise(function(n,i){var a=r.apply(t,e);function s(l){ex(a,n,i,s,o,"next",l)}function o(l){ex(a,n,i,s,o,"throw",l)}s(void 0)})}}function La(r,t){var e=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=l1(r))||t){e&&(r=e);var n=0,i=function(){};return{s:i,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a,s=!0,o=!1;return{s:function(){e=e.call(r)},n:function(){var c=e.next();return s=c.done,c},e:function(c){o=!0,a=c},f:function(){try{s||e.return==null||e.return()}finally{if(o)throw a}}}}function JL(r,t){if(r==null)return{};var e={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(t.indexOf(n)!==-1)continue;e[n]=r[n]}return e}function es(r,t){if(r==null)return{};var e,n,i=JL(r,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(r);for(n=0;n<a.length;n++)e=a[n],t.indexOf(e)===-1&&{}.propertyIsEnumerable.call(r,e)&&(i[e]=r[e])}return i}/*!
 * @antv/g-lite
 * @description A core module for rendering engine implements DOM API.
 * @version 2.3.2
 * @date 7/30/2025, 1:34:19 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var QL=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},GO={exports:{}};(function(r,t){(function(e,n){r.exports=n()})(QL,function(){function e(_,M,O,T,N){n(_,M,O||0,T||_.length-1,N||a)}function n(_,M,O,T,N){for(;T>O;){if(T-O>600){var P=T-O+1,C=M-O+1,R=Math.log(P),I=.5*Math.exp(2*R/3),j=.5*Math.sqrt(R*I*(P-I)/P)*(C-P/2<0?-1:1),G=Math.max(O,Math.floor(M-C*I/P+j)),H=Math.min(T,Math.floor(M+(P-C)*I/P+j));n(_,M,G,H,N)}var Z=_[M],U=O,tt=T;for(i(_,O,M),N(_[T],Z)>0&&i(_,O,T);U<tt;){for(i(_,U,tt),U++,tt--;N(_[U],Z)<0;)U++;for(;N(_[tt],Z)>0;)tt--}N(_[O],Z)===0?i(_,O,tt):(tt++,i(_,tt,T)),tt<=M&&(O=tt+1),M<=tt&&(T=tt-1)}}function i(_,M,O){var T=_[M];_[M]=_[O],_[O]=T}function a(_,M){return _<M?-1:_>M?1:0}var s=function(M){M===void 0&&(M=9),this._maxEntries=Math.max(4,M),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()};s.prototype.all=function(){return this._all(this.data,[])},s.prototype.search=function(M){var O=this.data,T=[];if(!m(M,O))return T;for(var N=this.toBBox,P=[];O;){for(var C=0;C<O.children.length;C++){var R=O.children[C],I=O.leaf?N(R):R;m(M,I)&&(O.leaf?T.push(R):y(M,I)?this._all(R,T):P.push(R))}O=P.pop()}return T},s.prototype.collides=function(M){var O=this.data;if(!m(M,O))return!1;for(var T=[];O;){for(var N=0;N<O.children.length;N++){var P=O.children[N],C=O.leaf?this.toBBox(P):P;if(m(M,C)){if(O.leaf||y(M,C))return!0;T.push(P)}}O=T.pop()}return!1},s.prototype.load=function(M){if(!(M&&M.length))return this;if(M.length<this._minEntries){for(var O=0;O<M.length;O++)this.insert(M[O]);return this}var T=this._build(M.slice(),0,M.length-1,0);if(!this.data.children.length)this.data=T;else if(this.data.height===T.height)this._splitRoot(this.data,T);else{if(this.data.height<T.height){var N=this.data;this.data=T,T=N}this._insert(T,this.data.height-T.height-1,!0)}return this},s.prototype.insert=function(M){return M&&this._insert(M,this.data.height-1),this},s.prototype.clear=function(){return this.data=x([]),this},s.prototype.remove=function(M,O){if(!M)return this;for(var T=this.data,N=this.toBBox(M),P=[],C=[],R,I,j;T||P.length;){if(T||(T=P.pop(),I=P[P.length-1],R=C.pop(),j=!0),T.leaf){var G=o(M,T.children,O);if(G!==-1)return T.children.splice(G,1),P.push(T),this._condense(P),this}!j&&!T.leaf&&y(T,N)?(P.push(T),C.push(R),R=0,I=T,T=T.children[0]):I?(R++,T=I.children[R],j=!1):T=null}return this},s.prototype.toBBox=function(M){return M},s.prototype.compareMinX=function(M,O){return M.minX-O.minX},s.prototype.compareMinY=function(M,O){return M.minY-O.minY},s.prototype.toJSON=function(){return this.data},s.prototype.fromJSON=function(M){return this.data=M,this},s.prototype._all=function(M,O){for(var T=[];M;)M.leaf?O.push.apply(O,M.children):T.push.apply(T,M.children),M=T.pop();return O},s.prototype._build=function(M,O,T,N){var P=T-O+1,C=this._maxEntries,R;if(P<=C)return R=x(M.slice(O,T+1)),l(R,this.toBBox),R;N||(N=Math.ceil(Math.log(P)/Math.log(C)),C=Math.ceil(P/Math.pow(C,N-1))),R=x([]),R.leaf=!1,R.height=N;var I=Math.ceil(P/C),j=I*Math.ceil(Math.sqrt(C));E(M,O,T,j,this.compareMinX);for(var G=O;G<=T;G+=j){var H=Math.min(G+j-1,T);E(M,G,H,I,this.compareMinY);for(var Z=G;Z<=H;Z+=I){var U=Math.min(Z+I-1,H);R.children.push(this._build(M,Z,U,N-1))}}return l(R,this.toBBox),R},s.prototype._chooseSubtree=function(M,O,T,N){for(;N.push(O),!(O.leaf||N.length-1===T);){for(var P=1/0,C=1/0,R=void 0,I=0;I<O.children.length;I++){var j=O.children[I],G=f(j),H=v(M,j)-G;H<C?(C=H,P=G<P?G:P,R=j):H===C&&G<P&&(P=G,R=j)}O=R||O.children[0]}return O},s.prototype._insert=function(M,O,T){var N=T?M:this.toBBox(M),P=[],C=this._chooseSubtree(N,this.data,O,P);for(C.children.push(M),u(C,N);O>=0&&P[O].children.length>this._maxEntries;)this._split(P,O),O--;this._adjustParentBBoxes(N,P,O)},s.prototype._split=function(M,O){var T=M[O],N=T.children.length,P=this._minEntries;this._chooseSplitAxis(T,P,N);var C=this._chooseSplitIndex(T,P,N),R=x(T.children.splice(C,T.children.length-C));R.height=T.height,R.leaf=T.leaf,l(T,this.toBBox),l(R,this.toBBox),O?M[O-1].children.push(R):this._splitRoot(T,R)},s.prototype._splitRoot=function(M,O){this.data=x([M,O]),this.data.height=M.height+1,this.data.leaf=!1,l(this.data,this.toBBox)},s.prototype._chooseSplitIndex=function(M,O,T){for(var N,P=1/0,C=1/0,R=O;R<=T-O;R++){var I=c(M,0,R,this.toBBox),j=c(M,R,T,this.toBBox),G=p(I,j),H=f(I)+f(j);G<P?(P=G,N=R,C=H<C?H:C):G===P&&H<C&&(C=H,N=R)}return N||T-O},s.prototype._chooseSplitAxis=function(M,O,T){var N=M.leaf?this.compareMinX:h,P=M.leaf?this.compareMinY:d,C=this._allDistMargin(M,O,T,N),R=this._allDistMargin(M,O,T,P);C<R&&M.children.sort(N)},s.prototype._allDistMargin=function(M,O,T,N){M.children.sort(N);for(var P=this.toBBox,C=c(M,0,O,P),R=c(M,T-O,T,P),I=g(C)+g(R),j=O;j<T-O;j++){var G=M.children[j];u(C,M.leaf?P(G):G),I+=g(C)}for(var H=T-O-1;H>=O;H--){var Z=M.children[H];u(R,M.leaf?P(Z):Z),I+=g(R)}return I},s.prototype._adjustParentBBoxes=function(M,O,T){for(var N=T;N>=0;N--)u(O[N],M)},s.prototype._condense=function(M){for(var O=M.length-1,T=void 0;O>=0;O--)M[O].children.length===0?O>0?(T=M[O-1].children,T.splice(T.indexOf(M[O]),1)):this.clear():l(M[O],this.toBBox)};function o(_,M,O){if(!O)return M.indexOf(_);for(var T=0;T<M.length;T++)if(O(_,M[T]))return T;return-1}function l(_,M){c(_,0,_.children.length,M,_)}function c(_,M,O,T,N){N||(N=x(null)),N.minX=1/0,N.minY=1/0,N.maxX=-1/0,N.maxY=-1/0;for(var P=M;P<O;P++){var C=_.children[P];u(N,_.leaf?T(C):C)}return N}function u(_,M){return _.minX=Math.min(_.minX,M.minX),_.minY=Math.min(_.minY,M.minY),_.maxX=Math.max(_.maxX,M.maxX),_.maxY=Math.max(_.maxY,M.maxY),_}function h(_,M){return _.minX-M.minX}function d(_,M){return _.minY-M.minY}function f(_){return(_.maxX-_.minX)*(_.maxY-_.minY)}function g(_){return _.maxX-_.minX+(_.maxY-_.minY)}function v(_,M){return(Math.max(M.maxX,_.maxX)-Math.min(M.minX,_.minX))*(Math.max(M.maxY,_.maxY)-Math.min(M.minY,_.minY))}function p(_,M){var O=Math.max(_.minX,M.minX),T=Math.max(_.minY,M.minY),N=Math.min(_.maxX,M.maxX),P=Math.min(_.maxY,M.maxY);return Math.max(0,N-O)*Math.max(0,P-T)}function y(_,M){return _.minX<=M.minX&&_.minY<=M.minY&&M.maxX<=_.maxX&&M.maxY<=_.maxY}function m(_,M){return M.minX<=_.maxX&&M.minY<=_.maxY&&M.maxX>=_.minX&&M.maxY>=_.minY}function x(_){return{children:_,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function E(_,M,O,T,N){for(var P=[M,O];P.length;)if(O=P.pop(),M=P.pop(),!(O-M<=T)){var C=M+Math.ceil((O-M)/T/2)*T;e(_,C,M,O,N),P.push(M,C,C,O)}}return s})})(GO);var tI=GO.exports,nt=(function(r){return r.GROUP="g",r.FRAGMENT="fragment",r.CIRCLE="circle",r.ELLIPSE="ellipse",r.IMAGE="image",r.RECT="rect",r.LINE="line",r.POLYLINE="polyline",r.POLYGON="polygon",r.TEXT="text",r.PATH="path",r.HTML="html",r.MESH="mesh",r})({}),Ic=(function(r){return r[r.ZERO=0]="ZERO",r[r.NEGATIVE_ONE=1]="NEGATIVE_ONE",r})({}),pa=(function(){function r(){ot(this,r),this.plugins=[]}return lt(r,[{key:"addRenderingPlugin",value:function(e){this.plugins.push(e),this.context.renderingPlugins.push(e)}},{key:"removeAllRenderingPlugins",value:function(){var e=this;this.plugins.forEach(function(n){var i=e.context.renderingPlugins.indexOf(n);i>=0&&e.context.renderingPlugins.splice(i,1)})}}])})(),eI=(function(){function r(t){ot(this,r),this.clipSpaceNearZ=Ic.NEGATIVE_ONE,this.plugins=[],this.config=Vt({enableDirtyCheck:!0,enableCulling:!1,enableAutoRendering:!0,enableDirtyRectangleRendering:!0,enableDirtyRectangleRenderingDebug:!1,enableSizeAttenuation:!0,enableRenderingOptimization:!1},t)}return lt(r,[{key:"registerPlugin",value:function(e){var n=this.plugins.findIndex(function(i){return i===e});n===-1&&this.plugins.push(e)}},{key:"unregisterPlugin",value:function(e){var n=this.plugins.findIndex(function(i){return i===e});n>-1&&this.plugins.splice(n,1)}},{key:"getPlugins",value:function(){return this.plugins}},{key:"getPlugin",value:function(e){return this.plugins.find(function(n){return n.name===e})}},{key:"getConfig",value:function(){return this.config}},{key:"setConfig",value:function(e){Object.assign(this.config,e)}}])})(),bd=oa,ps=di,nI=p3,rI=v3,nx=Yc,xd=x3,be=(function(){function r(){ot(this,r),this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0]}return lt(r,[{key:"update",value:function(e,n){ps(this.center,e),ps(this.halfExtents,n),xd(this.min,this.center,this.halfExtents),bd(this.max,this.center,this.halfExtents)}},{key:"setMinMax",value:function(e,n){bd(this.center,n,e),nx(this.center,this.center,.5),xd(this.halfExtents,n,e),nx(this.halfExtents,this.halfExtents,.5),ps(this.min,e),ps(this.max,n)}},{key:"getMin",value:function(){return this.min}},{key:"getMax",value:function(){return this.max}},{key:"add",value:function(e){if(!r.isEmpty(e)){if(r.isEmpty(this)){this.setMinMax(e.getMin(),e.getMax());return}var n=this.center,i=n[0],a=n[1],s=n[2],o=this.halfExtents,l=o[0],c=o[1],u=o[2],h=i-l,d=i+l,f=a-c,g=a+c,v=s-u,p=s+u,y=e.center,m=y[0],x=y[1],E=y[2],_=e.halfExtents,M=_[0],O=_[1],T=_[2],N=m-M,P=m+M,C=x-O,R=x+O,I=E-T,j=E+T;N<h&&(h=N),P>d&&(d=P),C<f&&(f=C),R>g&&(g=R),I<v&&(v=I),j>p&&(p=j),n[0]=(h+d)*.5,n[1]=(f+g)*.5,n[2]=(v+p)*.5,o[0]=(d-h)*.5,o[1]=(g-f)*.5,o[2]=(p-v)*.5,this.min[0]=h,this.min[1]=f,this.min[2]=v,this.max[0]=d,this.max[1]=g,this.max[2]=p}}},{key:"setFromTransformedAABB",value:function(e,n){var i=this.center,a=this.halfExtents,s=e.center,o=e.halfExtents,l=n[0],c=n[4],u=n[8],h=n[1],d=n[5],f=n[9],g=n[2],v=n[6],p=n[10],y=Math.abs(l),m=Math.abs(c),x=Math.abs(u),E=Math.abs(h),_=Math.abs(d),M=Math.abs(f),O=Math.abs(g),T=Math.abs(v),N=Math.abs(p);i[0]=n[12]+l*s[0]+c*s[1]+u*s[2],i[1]=n[13]+h*s[0]+d*s[1]+f*s[2],i[2]=n[14]+g*s[0]+v*s[1]+p*s[2],a[0]=y*o[0]+m*o[1]+x*o[2],a[1]=E*o[0]+_*o[1]+M*o[2],a[2]=O*o[0]+T*o[1]+N*o[2],xd(this.min,i,a),bd(this.max,i,a)}},{key:"intersects",value:function(e){var n=this.getMax(),i=this.getMin(),a=e.getMax(),s=e.getMin();return i[0]<=a[0]&&n[0]>=s[0]&&i[1]<=a[1]&&n[1]>=s[1]&&i[2]<=a[2]&&n[2]>=s[2]}},{key:"intersection",value:function(e){if(!this.intersects(e))return null;var n=new r,i=nI([0,0,0],this.getMin(),e.getMin()),a=rI([0,0,0],this.getMax(),e.getMax());return n.setMinMax(i,a),n}},{key:"getNegativeFarPoint",value:function(e){return e.pnVertexFlag===273?ps([0,0,0],this.min):e.pnVertexFlag===272?[this.min[0],this.min[1],this.max[2]]:e.pnVertexFlag===257?[this.min[0],this.max[1],this.min[2]]:e.pnVertexFlag===256?[this.min[0],this.max[1],this.max[2]]:e.pnVertexFlag===17?[this.max[0],this.min[1],this.min[2]]:e.pnVertexFlag===16?[this.max[0],this.min[1],this.max[2]]:e.pnVertexFlag===1?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]]}},{key:"getPositiveFarPoint",value:function(e){return e.pnVertexFlag===273?ps([0,0,0],this.max):e.pnVertexFlag===272?[this.max[0],this.max[1],this.min[2]]:e.pnVertexFlag===257?[this.max[0],this.min[1],this.max[2]]:e.pnVertexFlag===256?[this.max[0],this.min[1],this.min[2]]:e.pnVertexFlag===17?[this.min[0],this.max[1],this.max[2]]:e.pnVertexFlag===16?[this.min[0],this.max[1],this.min[2]]:e.pnVertexFlag===1?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]]}}],[{key:"isEmpty",value:function(e){return!e||e.halfExtents[0]===0&&e.halfExtents[1]===0&&e.halfExtents[2]===0}}])})(),iI=(function(){function r(t,e){ot(this,r),this.distance=t||0,this.normal=e||we(0,1,0),this.updatePNVertexFlag()}return lt(r,[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(+(this.normal[0]>=0)<<8)+(+(this.normal[1]>=0)<<4)+ +(this.normal[2]>=0)}},{key:"distanceToPoint",value:function(e){return fi(e,this.normal)-this.distance}},{key:"normalize",value:function(){var e=1/wO(this.normal);Yc(this.normal,this.normal,e),this.distance*=e}},{key:"intersectsLine",value:function(e,n,i){var a=this.distanceToPoint(e),s=this.distanceToPoint(n),o=a/(a-s),l=o>=0&&o<=1;return l&&i&&em(i,e,n,o),l}}])})(),ys=(function(r){return r[r.OUTSIDE=4294967295]="OUTSIDE",r[r.INSIDE=0]="INSIDE",r[r.INDETERMINATE=2147483647]="INDETERMINATE",r})({}),aI=(function(){function r(t){if(ot(this,r),this.planes=[],t)this.planes=t;else for(var e=0;e<6;e++)this.planes.push(new iI)}return lt(r,[{key:"extractFromVPMatrix",value:function(e){var n=$t(e,16),i=n[0],a=n[1],s=n[2],o=n[3],l=n[4],c=n[5],u=n[6],h=n[7],d=n[8],f=n[9],g=n[10],v=n[11],p=n[12],y=n[13],m=n[14],x=n[15];Fn(this.planes[0].normal,o-i,h-l,v-d),this.planes[0].distance=x-p,Fn(this.planes[1].normal,o+i,h+l,v+d),this.planes[1].distance=x+p,Fn(this.planes[2].normal,o+a,h+c,v+f),this.planes[2].distance=x+y,Fn(this.planes[3].normal,o-a,h-c,v-f),this.planes[3].distance=x-y,Fn(this.planes[4].normal,o-s,h-u,v-g),this.planes[4].distance=x-m,Fn(this.planes[5].normal,o+s,h+u,v+g),this.planes[5].distance=x+m,this.planes.forEach(function(E){E.normalize(),E.updatePNVertexFlag()})}}])})(),Tn=(function(){function r(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;ot(this,r),this.x=0,this.y=0,this.x=t,this.y=e}return lt(r,[{key:"clone",value:function(){return new r(this.x,this.y)}},{key:"copyFrom",value:function(e){this.x=e.x,this.y=e.y}}])})(),qs=(function(){function r(t,e,n,i){ot(this,r),this.x=t,this.y=e,this.width=n,this.height=i,this.left=t,this.right=t+n,this.top=e,this.bottom=e+i}return lt(r,[{key:"toJSON",value:function(){}}],[{key:"fromRect",value:function(e){return new r(e.x,e.y,e.width,e.height)}},{key:"applyTransform",value:function(e,n){var i=xo(e.x,e.y,0,1),a=xo(e.x+e.width,e.y,0,1),s=xo(e.x,e.y+e.height,0,1),o=xo(e.x+e.width,e.y+e.height,0,1),l=gi(),c=gi(),u=gi(),h=gi();Li(l,i,n),Li(c,a,n),Li(u,s,n),Li(h,o,n);var d=Math.min(l[0],c[0],u[0],h[0]),f=Math.min(l[1],c[1],u[1],h[1]),g=Math.max(l[0],c[0],u[0],h[0]),v=Math.max(l[1],c[1],u[1],h[1]);return r.fromRect({x:d,y:f,width:g-d,height:v-f})}}])})(),he="Method not implemented.",ms="Use document.documentElement instead.",sI="Cannot append a destroyed element.";function Cs(r){return r===void 0?0:r>360||r<-360?r%360:r}var wd=te();function Gn(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;return Array.isArray(r)&&r.length===3?n?Oi(r):di(wd,r):St(r)?n?we(r,t,e):Fn(wd,r,t,e):n?we(r[0],r[1]||t,r[2]||e):Fn(wd,r[0],r[1]||t,r[2]||e)}var oI=Math.PI/180;function de(r){return r*oI}var lI=180/Math.PI;function nr(r){return r*lI}function cI(r){return 360*r}var tu=Math.PI/2;function uI(r,t){var e=t[0],n=t[1],i=t[2],a=t[3],s=e*e,o=n*n,l=i*i,c=a*a,u=s+o+l+c,h=e*a-n*i;return h>.499995*u?(r[0]=tu,r[1]=2*Math.atan2(n,e),r[2]=0):h<-.499995*u?(r[0]=-tu,r[1]=2*Math.atan2(n,e),r[2]=0):(r[0]=Math.asin(2*(e*i-a*n)),r[1]=Math.atan2(2*(e*a+n*i),1-2*(l+c)),r[2]=Math.atan2(2*(e*n+i*a),1-2*(o+l))),r}function hI(r,t){var e,n,i=zs(te(),t),a=$t(i,3),s=a[0],o=a[1],l=a[2],c=Math.asin(-t[2]/s);return c<tu?c>-tu?(e=Math.atan2(t[6]/o,t[10]/l),n=Math.atan2(t[1]/s,t[0]/s)):(n=0,e=-Math.atan2(t[4]/o,t[5]/o)):(n=0,e=Math.atan2(t[4]/o,t[5]/o)),r[0]=e,r[1]=c,r[2]=n,r}function Ed(r,t){return t.length===16?hI(r,t):uI(r,t)}function dI(r,t,e,n,i){var a=Math.cos(r),s=Math.sin(r);return HR(n*a,i*s,0,-n*s,i*a,0,t,e,1)}function fI(r,t,e,n,i,a,s){var o=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1,l=2*a,c=e-t,u=n-i,h=l/c,d=l/u,f=(e+t)/c,g=(n+i)/u,v,p,y=s-a,m=s*a;return o?(v=-s/y,p=-m/y):(v=-(s+a)/y,p=-2*m/y),r[0]=h,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=d,r[6]=0,r[7]=0,r[8]=f,r[9]=g,r[10]=v,r[11]=-1,r[12]=0,r[13]=0,r[14]=p,r[15]=0,r}function rx(r){var t=r[0],e=r[1],n=r[3],i=r[4],a=Math.sqrt(t*t+e*e),s=Math.sqrt(n*n+i*i),o=t*i-e*n;if(o<0&&(t<i?a=-a:s=-s),a){var l=1/a;t*=l,e*=l}if(s){var c=1/s;n*=c,i*=c}var u=Math.atan2(e,t),h=nr(u);return[r[6],r[7],a,s,h]}var si=ve(),zr=ve(),lo=gi(),It=[te(),te(),te()],ix=te();function gI(r,t,e,n,i,a){if(!vI(si,r)||(Bs(zr,si),zr[3]=0,zr[7]=0,zr[11]=0,zr[15]=1,Math.abs(sO(zr))<1e-8))return!1;var s=si[3],o=si[7],l=si[11],c=si[12],u=si[13],h=si[14],d=si[15];if(s!==0||o!==0||l!==0){lo[0]=s,lo[1]=o,lo[2]=l,lo[3]=d;var f=hi(zr,zr);if(!f)return!1;aO(zr,zr),Li(i,lo,zr)}else i[0]=i[1]=i[2]=0,i[3]=1;if(t[0]=c,t[1]=u,t[2]=h,pI(It,si),e[0]=Ni(It[0]),qa(It[0],It[0]),n[0]=fi(It[0],It[1]),Sd(It[1],It[1],It[0],1,-n[0]),e[1]=Ni(It[1]),qa(It[1],It[1]),n[0]/=e[1],n[1]=fi(It[0],It[2]),Sd(It[2],It[2],It[0],1,-n[1]),n[2]=fi(It[1],It[2]),Sd(It[2],It[2],It[1],1,-n[2]),e[2]=Ni(It[2]),qa(It[2],It[2]),n[1]/=e[2],n[2]/=e[2],Rc(ix,It[1],It[2]),fi(It[0],ix)<0)for(var g=0;g<3;g++)e[g]*=-1,It[g][0]*=-1,It[g][1]*=-1,It[g][2]*=-1;return a[0]=.5*Math.sqrt(Math.max(1+It[0][0]-It[1][1]-It[2][2],0)),a[1]=.5*Math.sqrt(Math.max(1-It[0][0]+It[1][1]-It[2][2],0)),a[2]=.5*Math.sqrt(Math.max(1-It[0][0]-It[1][1]+It[2][2],0)),a[3]=.5*Math.sqrt(Math.max(1+It[0][0]+It[1][1]+It[2][2],0)),It[2][1]>It[1][2]&&(a[0]=-a[0]),It[0][2]>It[2][0]&&(a[1]=-a[1]),It[1][0]>It[0][1]&&(a[2]=-a[2]),!0}function vI(r,t){var e=t[15];if(e===0)return!1;for(var n=1/e,i=0;i<16;i++)r[i]=t[i]*n;return!0}function pI(r,t){r[0][0]=t[0],r[0][1]=t[1],r[0][2]=t[2],r[1][0]=t[4],r[1][1]=t[5],r[1][2]=t[6],r[2][0]=t[8],r[2][1]=t[9],r[2][2]=t[10]}function Sd(r,t,e,n,i){r[0]=t[0]*n+e[0]*i,r[1]=t[1]*n+e[1]*i,r[2]=t[2]*n+e[2]*i}var ue=(function(r){return r[r.ORBITING=0]="ORBITING",r[r.EXPLORING=1]="EXPLORING",r[r.TRACKING=2]="TRACKING",r})({}),dm=(function(r){return r[r.DEFAULT=0]="DEFAULT",r[r.ROTATIONAL=1]="ROTATIONAL",r[r.TRANSLATIONAL=2]="TRANSLATIONAL",r[r.CINEMATIC=3]="CINEMATIC",r})({}),Ar=(function(r){return r[r.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",r[r.PERSPECTIVE=1]="PERSPECTIVE",r})({}),$O={UPDATED:"updated"},ax=2e-4,WO=(function(){function r(){ot(this,r),this.clipSpaceNearZ=Ic.NEGATIVE_ONE,this.eventEmitter=new eO,this.matrix=ve(),this.right=we(1,0,0),this.up=we(0,1,0),this.forward=we(0,0,1),this.position=we(0,0,1),this.focalPoint=we(0,0,0),this.distanceVector=we(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=ve(),this.projectionMatrixInverse=ve(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=ue.EXPLORING,this.trackingMode=dm.DEFAULT,this.projectionMode=Ar.PERSPECTIVE,this.frustum=new aI,this.orthoMatrix=ve()}return lt(r,[{key:"isOrtho",value:function(){return this.projectionMode===Ar.ORTHOGRAPHIC}},{key:"getProjectionMode",value:function(){return this.projectionMode}},{key:"getPerspective",value:function(){return this.jitteredProjectionMatrix||this.projectionMatrix}},{key:"getPerspectiveInverse",value:function(){return this.projectionMatrixInverse}},{key:"getFrustum",value:function(){return this.frustum}},{key:"getPosition",value:function(){return this.position}},{key:"getFocalPoint",value:function(){return this.focalPoint}},{key:"getDollyingStep",value:function(){return this.dollyingStep}},{key:"getNear",value:function(){return this.near}},{key:"getFar",value:function(){return this.far}},{key:"getZoom",value:function(){return this.zoom}},{key:"getOrthoMatrix",value:function(){return this.orthoMatrix}},{key:"getView",value:function(){return this.view}},{key:"setEnableUpdate",value:function(e){this.enableUpdate=e}},{key:"setType",value:function(e,n){return this.type=e,this.type===ue.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===ue.TRACKING&&n!==void 0&&this.setTrackingMode(n),this}},{key:"setProjectionMode",value:function(e){return this.projectionMode=e,this}},{key:"setTrackingMode",value:function(e){if(this.type!==ue.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=e,this}},{key:"setWorldRotation",value:function(e){return this.rotateWorld=e,this._getAngles(),this}},{key:"getViewTransform",value:function(){return hi(ve(),this.matrix)}},{key:"getWorldTransform",value:function(){return this.matrix}},{key:"jitterProjectionMatrix",value:function(e,n){var i=Ji(ve(),[e,n,0]);this.jitteredProjectionMatrix=Bn(ve(),i,this.projectionMatrix)}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0}},{key:"setMatrix",value:function(e){return this.matrix=e,this._update(),this}},{key:"setProjectionMatrix",value:function(e){this.projectionMatrix=e}},{key:"setFov",value:function(e){return this.setPerspective(this.near,this.far,e,this.aspect),this}},{key:"setAspect",value:function(e){return this.setPerspective(this.near,this.far,this.fov,e),this}},{key:"setNear",value:function(e){return this.projectionMode===Ar.PERSPECTIVE?this.setPerspective(e,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,e,this.far),this}},{key:"setFar",value:function(e){return this.projectionMode===Ar.PERSPECTIVE?this.setPerspective(this.near,e,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,e),this}},{key:"setViewOffset",value:function(e,n,i,a,s,o){return this.aspect=e/n,this.view===void 0&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=a,this.view.width=s,this.view.height=o,this.projectionMode===Ar.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"clearViewOffset",value:function(){return this.view!==void 0&&(this.view.enabled=!1),this.projectionMode===Ar.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"setZoom",value:function(e){return this.zoom=e,this.projectionMode===Ar.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===Ar.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this}},{key:"setZoomByViewportPoint",value:function(e,n){var i=this.canvas.viewport2Canvas({x:n[0],y:n[1]}),a=i.x,s=i.y,o=this.roll;this.rotate(0,0,-o),this.setPosition(a,s),this.setFocalPoint(a,s),this.setZoom(e),this.rotate(0,0,o);var l=this.canvas.viewport2Canvas({x:n[0],y:n[1]}),c=l.x,u=l.y,h=we(c-a,u-s,0),d=fi(h,this.right)/Ni(this.right),f=fi(h,this.up)/Ni(this.up),g=this.getPosition(),v=$t(g,2),p=v[0],y=v[1],m=this.getFocalPoint(),x=$t(m,2),E=x[0],_=x[1];return this.setPosition(p-d,y-f),this.setFocalPoint(E-d,_-f),this}},{key:"setPerspective",value:function(e,n,i,a){var s;this.projectionMode=Ar.PERSPECTIVE,this.fov=i,this.near=e,this.far=n,this.aspect=a;var o=this.near*Math.tan(de(.5*this.fov))/this.zoom,l=2*o,c=this.aspect*l,u=-.5*c;if((s=this.view)!==null&&s!==void 0&&s.enabled){var h=this.view.fullWidth,d=this.view.fullHeight;u+=this.view.offsetX*c/h,o-=this.view.offsetY*l/d,c*=this.view.width/h,l*=this.view.height/d}return fI(this.projectionMatrix,u,u+c,o-l,o,e,this.far,this.clipSpaceNearZ===Ic.ZERO),hi(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this}},{key:"setOrthographic",value:function(e,n,i,a,s,o){var l;this.projectionMode=Ar.ORTHOGRAPHIC,this.rright=n,this.left=e,this.top=i,this.bottom=a,this.near=s,this.far=o;var c=(this.rright-this.left)/(2*this.zoom),u=(this.top-this.bottom)/(2*this.zoom),h=(this.rright+this.left)/2,d=(this.top+this.bottom)/2,f=h-c,g=h+c,v=d+u,p=d-u;if((l=this.view)!==null&&l!==void 0&&l.enabled){var y=(this.rright-this.left)/this.view.fullWidth/this.zoom,m=(this.top-this.bottom)/this.view.fullHeight/this.zoom;f+=y*this.view.offsetX,g=f+y*this.view.width,v-=m*this.view.offsetY,p=v-m*this.view.height}return this.clipSpaceNearZ===Ic.NEGATIVE_ONE?pO(this.projectionMatrix,f,g,v,p,s,o):yO(this.projectionMatrix,f,g,v,p,s,o),hi(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this}},{key:"setPosition",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.position[1],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.position[2],a=Gn(e,n,i);return this._setPosition(a),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this}},{key:"setFocalPoint",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.focalPoint[1],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.focalPoint[2],a=we(0,1,0);if(this.focalPoint=Gn(e,n,i),this.trackingMode===dm.CINEMATIC){var s=tm(te(),this.focalPoint,this.position);e=s[0],n=s[1],i=s[2];var o=Ni(s),l=nr(Math.asin(n/o)),c=90+nr(Math.atan2(i,e)),u=ve();cO(u,u,de(c)),lO(u,u,de(l)),a=zn(te(),[0,1,0],u)}return hi(this.matrix,mO(ve(),this.position,this.focalPoint,a)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this}},{key:"getDistance",value:function(){return this.distance}},{key:"getDistanceVector",value:function(){return this.distanceVector}},{key:"setDistance",value:function(e){if(this.distance===e||e<0)return this;this.distance=e,this.distance<ax&&(this.distance=ax),this.dollyingStep=this.distance/100;var n=te();e=this.distance;var i=this.forward,a=this.focalPoint;return n[0]=e*i[0]+a[0],n[1]=e*i[1]+a[1],n[2]=e*i[2]+a[2],this._setPosition(n),this.triggerUpdate(),this}},{key:"setMaxDistance",value:function(e){return this.maxDistance=e,this}},{key:"setMinDistance",value:function(e){return this.minDistance=e,this}},{key:"setAzimuth",value:function(e){return this.azimuth=Cs(e),this.computeMatrix(),this._getAxes(),this.type===ue.ORBITING||this.type===ue.EXPLORING?this._getPosition():this.type===ue.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getAzimuth",value:function(){return this.azimuth}},{key:"setElevation",value:function(e){return this.elevation=Cs(e),this.computeMatrix(),this._getAxes(),this.type===ue.ORBITING||this.type===ue.EXPLORING?this._getPosition():this.type===ue.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getElevation",value:function(){return this.elevation}},{key:"setRoll",value:function(e){return this.roll=Cs(e),this.computeMatrix(),this._getAxes(),this.type===ue.ORBITING||this.type===ue.EXPLORING?this._getPosition():this.type===ue.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getRoll",value:function(){return this.roll}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate()}},{key:"computeMatrix",value:function(){var e=Qi(nn(),[0,0,1],de(this.roll));ha(this.matrix);var n=Qi(nn(),[1,0,0],de((this.rotateWorld&&this.type!==ue.TRACKING||this.type===ue.TRACKING?1:-1)*this.elevation)),i=Qi(nn(),[0,1,0],de((this.rotateWorld&&this.type!==ue.TRACKING||this.type===ue.TRACKING?1:-1)*this.azimuth)),a=la(nn(),i,n);a=la(nn(),a,e);var s=c1(ve(),a);this.type===ue.ORBITING||this.type===ue.EXPLORING?(Ps(this.matrix,this.matrix,this.focalPoint),Bn(this.matrix,this.matrix,s),Ps(this.matrix,this.matrix,[0,0,this.distance])):this.type===ue.TRACKING&&(Ps(this.matrix,this.matrix,this.position),Bn(this.matrix,this.matrix,s))}},{key:"_setPosition",value:function(e,n,i){this.position=Gn(e,n,i);var a=this.matrix;a[12]=this.position[0],a[13]=this.position[1],a[14]=this.position[2],a[15]=1,this._getOrthoMatrix()}},{key:"_getAxes",value:function(){di(this.right,Gn(Li(gi(),[1,0,0,0],this.matrix))),di(this.up,Gn(Li(gi(),[0,1,0,0],this.matrix))),di(this.forward,Gn(Li(gi(),[0,0,1,0],this.matrix))),qa(this.right,this.right),qa(this.up,this.up),qa(this.forward,this.forward)}},{key:"_getAngles",value:function(){var e=this.distanceVector[0],n=this.distanceVector[1],i=this.distanceVector[2],a=Ni(this.distanceVector);if(a===0){this.elevation=0,this.azimuth=0;return}this.type===ue.TRACKING?(this.elevation=nr(Math.asin(n/a)),this.azimuth=nr(Math.atan2(-e,-i))):this.rotateWorld?(this.elevation=nr(Math.asin(n/a)),this.azimuth=nr(Math.atan2(-e,-i))):(this.elevation=-nr(Math.asin(n/a)),this.azimuth=-nr(Math.atan2(-e,-i)))}},{key:"_getPosition",value:function(){di(this.position,Gn(Li(gi(),[0,0,0,1],this.matrix))),this._getDistance()}},{key:"_getFocalPoint",value:function(){m3(this.distanceVector,[0,0,-this.distance],YR(nO(),this.matrix)),oa(this.focalPoint,this.position,this.distanceVector),this._getDistance()}},{key:"_getDistance",value:function(){this.distanceVector=tm(te(),this.focalPoint,this.position),this.distance=Ni(this.distanceVector),this.dollyingStep=this.distance/100}},{key:"_getOrthoMatrix",value:function(){if(this.projectionMode===Ar.ORTHOGRAPHIC){var e=this.position,n=Qi(nn(),[0,0,1],-this.roll*Math.PI/180);Co(this.orthoMatrix,n,we((this.rright-this.left)/2-e[0],(this.top-this.bottom)/2-e[1],0),we(this.zoom,this.zoom,1),e)}}},{key:"triggerUpdate",value:function(){if(this.enableUpdate){var e=this.getViewTransform(),n=Bn(ve(),this.getPerspective(),e);this.getFrustum().extractFromVPMatrix(n),this.eventEmitter.emit($O.UPDATED)}}},{key:"rotate",value:function(e,n,i){throw new Error(he)}},{key:"pan",value:function(e,n){throw new Error(he)}},{key:"dolly",value:function(e){throw new Error(he)}},{key:"createLandmark",value:function(e,n){throw new Error(he)}},{key:"gotoLandmark",value:function(e,n){throw new Error(he)}},{key:"cancelLandmarkAnimation",value:function(){throw new Error(he)}}])})(),yI=(function(r){return r[r.Standard=0]="Standard",r})({}),eu=(function(r){return r[r.ADDED=0]="ADDED",r[r.REMOVED=1]="REMOVED",r[r.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED",r})({}),mI=te(),co=ve(),bI=nn();function sx(r){if(r.localDirtyFlag){var t=r.localSkew[0]!==0||r.localSkew[1]!==0;if(t){Co(r.localTransform,r.localRotation,r.localPosition,we(1,1,1),r.origin),(r.localSkew[0]!==0||r.localSkew[1]!==0)&&(ha(co),co[4]=Math.tan(r.localSkew[0]),co[1]=Math.tan(r.localSkew[1]),Bn(r.localTransform,r.localTransform,co));var e=Co(co,EO(bI,0,0,0,1),Fn(mI,1,1,1),r.localScale,r.origin);Bn(r.localTransform,r.localTransform,e)}else{var n=r.localTransform,i=r.localPosition,a=r.localRotation,s=r.localScale,o=r.origin,l=i[0]!==0||i[1]!==0||i[2]!==0,c=a[3]!==1||a[0]!==0||a[1]!==0||a[2]!==0,u=s[0]!==1||s[1]!==1||s[2]!==1,h=o[0]!==0||o[1]!==0||o[2]!==0;!c&&!u&&!h?l?Ji(n,i):ha(n):Co(n,a,i,s,o)}r.localDirtyFlag=!1}}function xI(r,t){r.dirtyFlag&&(t?Bn(r.worldTransform,t.worldTransform,r.localTransform):Bs(r.worldTransform,r.localTransform),r.dirtyFlag=!1)}var VO={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new qs(0,0,0,0)},mt=(function(r){return r.COORDINATE="<coordinate>",r.COLOR="<color>",r.PAINT="<paint>",r.NUMBER="<number>",r.ANGLE="<angle>",r.OPACITY_VALUE="<opacity-value>",r.SHADOW_BLUR="<shadow-blur>",r.LENGTH="<length>",r.PERCENTAGE="<percentage>",r.LENGTH_PERCENTAGE="<length> | <percentage>",r.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",r.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",r.LIST_OF_POINTS="<list-of-points>",r.PATH="<path>",r.FILTER="<filter>",r.Z_INDEX="<z-index>",r.OFFSET_DISTANCE="<offset-distance>",r.DEFINED_PATH="<defined-path>",r.MARKER="<marker>",r.TRANSFORM="<transform>",r.TRANSFORM_ORIGIN="<transform-origin>",r.TEXT="<text>",r.TEXT_TRANSFORM="<text-transform>",r})({});function g1(r,t,e){r.prototype=t.prototype=e,e.constructor=r}function UO(r,t){var e=Object.create(r.prototype);for(var n in t)e[n]=t[n];return e}function ol(){}var $o=.7,nu=1/$o,Rs="\\s*([+-]?\\d+)\\s*",Wo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",vi="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",wI=/^#([0-9a-f]{3,8})$/,EI=new RegExp(`^rgb\\(${Rs},${Rs},${Rs}\\)$`),SI=new RegExp(`^rgb\\(${vi},${vi},${vi}\\)$`),_I=new RegExp(`^rgba\\(${Rs},${Rs},${Rs},${Wo}\\)$`),kI=new RegExp(`^rgba\\(${vi},${vi},${vi},${Wo}\\)$`),MI=new RegExp(`^hsl\\(${Wo},${vi},${vi}\\)$`),TI=new RegExp(`^hsla\\(${Wo},${vi},${vi},${Wo}\\)$`),ox={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};g1(ol,Pu,{copy(r){return Object.assign(new this.constructor,this,r)},displayable(){return this.rgb().displayable()},hex:lx,formatHex:lx,formatHex8:OI,formatHsl:AI,formatRgb:cx,toString:cx});function lx(){return this.rgb().formatHex()}function OI(){return this.rgb().formatHex8()}function AI(){return YO(this).formatHsl()}function cx(){return this.rgb().formatRgb()}function Pu(r){var t,e;return r=(r+"").trim().toLowerCase(),(t=wI.exec(r))?(e=t[1].length,t=parseInt(t[1],16),e===6?ux(t):e===3?new ar(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):e===8?Bl(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):e===4?Bl(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=EI.exec(r))?new ar(t[1],t[2],t[3],1):(t=SI.exec(r))?new ar(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=_I.exec(r))?Bl(t[1],t[2],t[3],t[4]):(t=kI.exec(r))?Bl(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=MI.exec(r))?fx(t[1],t[2]/100,t[3]/100,1):(t=TI.exec(r))?fx(t[1],t[2]/100,t[3]/100,t[4]):ox.hasOwnProperty(r)?ux(ox[r]):r==="transparent"?new ar(NaN,NaN,NaN,0):null}function ux(r){return new ar(r>>16&255,r>>8&255,r&255,1)}function Bl(r,t,e,n){return n<=0&&(r=t=e=NaN),new ar(r,t,e,n)}function NI(r){return r instanceof ol||(r=Pu(r)),r?(r=r.rgb(),new ar(r.r,r.g,r.b,r.opacity)):new ar}function PI(r,t,e,n){return arguments.length===1?NI(r):new ar(r,t,e,n??1)}function ar(r,t,e,n){this.r=+r,this.g=+t,this.b=+e,this.opacity=+n}g1(ar,PI,UO(ol,{brighter(r){return r=r==null?nu:Math.pow(nu,r),new ar(this.r*r,this.g*r,this.b*r,this.opacity)},darker(r){return r=r==null?$o:Math.pow($o,r),new ar(this.r*r,this.g*r,this.b*r,this.opacity)},rgb(){return this},clamp(){return new ar(Ga(this.r),Ga(this.g),Ga(this.b),ru(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:hx,formatHex:hx,formatHex8:CI,formatRgb:dx,toString:dx}));function hx(){return`#${Fa(this.r)}${Fa(this.g)}${Fa(this.b)}`}function CI(){return`#${Fa(this.r)}${Fa(this.g)}${Fa(this.b)}${Fa((isNaN(this.opacity)?1:this.opacity)*255)}`}function dx(){const r=ru(this.opacity);return`${r===1?"rgb(":"rgba("}${Ga(this.r)}, ${Ga(this.g)}, ${Ga(this.b)}${r===1?")":`, ${r})`}`}function ru(r){return isNaN(r)?1:Math.max(0,Math.min(1,r))}function Ga(r){return Math.max(0,Math.min(255,Math.round(r)||0))}function Fa(r){return r=Ga(r),(r<16?"0":"")+r.toString(16)}function fx(r,t,e,n){return n<=0?r=t=e=NaN:e<=0||e>=1?r=t=NaN:t<=0&&(r=NaN),new $r(r,t,e,n)}function YO(r){if(r instanceof $r)return new $r(r.h,r.s,r.l,r.opacity);if(r instanceof ol||(r=Pu(r)),!r)return new $r;if(r instanceof $r)return r;r=r.rgb();var t=r.r/255,e=r.g/255,n=r.b/255,i=Math.min(t,e,n),a=Math.max(t,e,n),s=NaN,o=a-i,l=(a+i)/2;return o?(t===a?s=(e-n)/o+(e<n)*6:e===a?s=(n-t)/o+2:s=(t-e)/o+4,o/=l<.5?a+i:2-a-i,s*=60):o=l>0&&l<1?0:s,new $r(s,o,l,r.opacity)}function RI(r,t,e,n){return arguments.length===1?YO(r):new $r(r,t,e,n??1)}function $r(r,t,e,n){this.h=+r,this.s=+t,this.l=+e,this.opacity=+n}g1($r,RI,UO(ol,{brighter(r){return r=r==null?nu:Math.pow(nu,r),new $r(this.h,this.s,this.l*r,this.opacity)},darker(r){return r=r==null?$o:Math.pow($o,r),new $r(this.h,this.s,this.l*r,this.opacity)},rgb(){var r=this.h%360+(this.h<0)*360,t=isNaN(r)||isNaN(this.s)?0:this.s,e=this.l,n=e+(e<.5?e:1-e)*t,i=2*e-n;return new ar(_d(r>=240?r-240:r+120,i,n),_d(r,i,n),_d(r<120?r+240:r-120,i,n),this.opacity)},clamp(){return new $r(gx(this.h),zl(this.s),zl(this.l),ru(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const r=ru(this.opacity);return`${r===1?"hsl(":"hsla("}${gx(this.h)}, ${zl(this.s)*100}%, ${zl(this.l)*100}%${r===1?")":`, ${r})`}`}}));function gx(r){return r=(r||0)%360,r<0?r+360:r}function zl(r){return Math.max(0,Math.min(1,r||0))}function _d(r,t,e){return(r<60?t+(e-t)*r/60:r<180?e:r<240?t+(e-t)*(240-r)/60:t)*255}function Je(r,t){if(typeof r!="function"||t!=null&&typeof t!="function")throw new TypeError("Expected a function");var e=function(){for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];var o=t?t.apply(this,a):a[0],l=e.cache;if(l.has(o))return l.get(o);var c=r.apply(this,a);return e.cache=l.set(o,c)||l,c};return e.cache=new(Je.Cache||Map),Je.cacheList.push(e.cache),e}Je.Cache=Map;Je.cacheList=[];Je.clearCache=function(){Je.cacheList.forEach(function(r){return r.clear()})};var bt=(function(r){return r[r.kUnknown=0]="kUnknown",r[r.kNumber=1]="kNumber",r[r.kPercentage=2]="kPercentage",r[r.kEms=3]="kEms",r[r.kPixels=4]="kPixels",r[r.kRems=5]="kRems",r[r.kDegrees=6]="kDegrees",r[r.kRadians=7]="kRadians",r[r.kGradians=8]="kGradians",r[r.kTurns=9]="kTurns",r[r.kMilliseconds=10]="kMilliseconds",r[r.kSeconds=11]="kSeconds",r[r.kInteger=12]="kInteger",r})({}),Gr=(function(r){return r[r.kUNumber=0]="kUNumber",r[r.kUPercent=1]="kUPercent",r[r.kULength=2]="kULength",r[r.kUAngle=3]="kUAngle",r[r.kUTime=4]="kUTime",r[r.kUOther=5]="kUOther",r})({}),LI=(function(r){return r[r.kYes=0]="kYes",r[r.kNo=1]="kNo",r})({}),II=(function(r){return r[r.kYes=0]="kYes",r[r.kNo=1]="kNo",r})({}),DI=[{name:"em",unit_type:bt.kEms},{name:"px",unit_type:bt.kPixels},{name:"deg",unit_type:bt.kDegrees},{name:"rad",unit_type:bt.kRadians},{name:"grad",unit_type:bt.kGradians},{name:"ms",unit_type:bt.kMilliseconds},{name:"s",unit_type:bt.kSeconds},{name:"rem",unit_type:bt.kRems},{name:"turn",unit_type:bt.kTurns}],Gs=(function(r){return r[r.kUnknownType=0]="kUnknownType",r[r.kUnparsedType=1]="kUnparsedType",r[r.kKeywordType=2]="kKeywordType",r[r.kUnitType=3]="kUnitType",r[r.kSumType=4]="kSumType",r[r.kProductType=5]="kProductType",r[r.kNegateType=6]="kNegateType",r[r.kInvertType=7]="kInvertType",r[r.kMinType=8]="kMinType",r[r.kMaxType=9]="kMaxType",r[r.kClampType=10]="kClampType",r[r.kTransformType=11]="kTransformType",r[r.kPositionType=12]="kPositionType",r[r.kURLImageType=13]="kURLImageType",r[r.kColorType=14]="kColorType",r[r.kUnsupportedColorType=15]="kUnsupportedColorType",r})({}),FI=function(t){return DI.find(function(e){return e.name===t}).unit_type},BI=function(t){return t?t==="number"?bt.kNumber:t==="percent"||t==="%"?bt.kPercentage:FI(t):bt.kUnknown},zI=function(t){switch(t){case bt.kNumber:case bt.kInteger:return Gr.kUNumber;case bt.kPercentage:return Gr.kUPercent;case bt.kPixels:return Gr.kULength;case bt.kMilliseconds:case bt.kSeconds:return Gr.kUTime;case bt.kDegrees:case bt.kRadians:case bt.kGradians:case bt.kTurns:return Gr.kUAngle;default:return Gr.kUOther}},jI=function(t){switch(t){case Gr.kUNumber:return bt.kNumber;case Gr.kULength:return bt.kPixels;case Gr.kUPercent:return bt.kPercentage;case Gr.kUTime:return bt.kSeconds;case Gr.kUAngle:return bt.kDegrees;default:return bt.kUnknown}},vx=function(t){var e=1;switch(t){case bt.kPixels:case bt.kDegrees:case bt.kSeconds:break;case bt.kMilliseconds:e=.001;break;case bt.kRadians:e=180/Math.PI;break;case bt.kGradians:e=.9;break;case bt.kTurns:e=360;break}return e},fm=function(t){switch(t){case bt.kNumber:case bt.kInteger:return"";case bt.kPercentage:return"%";case bt.kEms:return"em";case bt.kRems:return"rem";case bt.kPixels:return"px";case bt.kDegrees:return"deg";case bt.kRadians:return"rad";case bt.kGradians:return"grad";case bt.kMilliseconds:return"ms";case bt.kSeconds:return"s";case bt.kTurns:return"turn"}return""},Cu=(function(){function r(){ot(this,r)}return lt(r,[{key:"toString",value:function(){return this.buildCSSText(LI.kNo,II.kNo,"")}},{key:"isNumericValue",value:function(){return this.getType()>=Gs.kUnitType&&this.getType()<=Gs.kClampType}}],[{key:"isAngle",value:function(e){return e===bt.kDegrees||e===bt.kRadians||e===bt.kGradians||e===bt.kTurns}},{key:"isLength",value:function(e){return e>=bt.kEms&&e<bt.kDegrees}},{key:"isRelativeUnit",value:function(e){return e===bt.kPercentage||e===bt.kEms||e===bt.kRems}},{key:"isTime",value:function(e){return e===bt.kSeconds||e===bt.kMilliseconds}}])})(),qI=(function(r){function t(e){var n;return ot(this,t),n=Yt(this,t),n.colorSpace=e,n}return Ht(t,r),lt(t,[{key:"getType",value:function(){return Gs.kColorType}},{key:"to",value:function(n){return this}}])})(Cu),ta=(function(r){return r[r.Constant=0]="Constant",r[r.LinearGradient=1]="LinearGradient",r[r.RadialGradient=2]="RadialGradient",r})({}),jl=(function(r){function t(e,n){var i;return ot(this,t),i=Yt(this,t),i.type=e,i.value=n,i}return Ht(t,r),lt(t,[{key:"clone",value:function(){return new t(this.type,this.value)}},{key:"buildCSSText",value:function(n,i,a){return a}},{key:"getType",value:function(){return Gs.kColorType}}])})(Cu),Rr=(function(r){function t(e){var n;return ot(this,t),n=Yt(this,t),n.value=e,n}return Ht(t,r),lt(t,[{key:"clone",value:function(){return new t(this.value)}},{key:"getType",value:function(){return Gs.kKeywordType}},{key:"buildCSSText",value:function(n,i,a){return a+this.value}}])})(Cu),GI=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",n="";return Number.isFinite(t)?n="NaN":t>0?n="infinity":n="-infinity",n+=e},gm=function(t){return jI(zI(t))},mn=(function(r){function t(e){var n,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:bt.kNumber;ot(this,t),n=Yt(this,t);var a;return typeof i=="string"?a=BI(i):a=i,n.unit=a,n.value=e,n}return Ht(t,r),lt(t,[{key:"clone",value:function(){return new t(this.value,this.unit)}},{key:"equals",value:function(n){var i=n;return this.value===i.value&&this.unit===i.unit}},{key:"getType",value:function(){return Gs.kUnitType}},{key:"convertTo",value:function(n){if(this.unit===n)return new t(this.value,this.unit);var i=gm(this.unit);if(i!==gm(n)||i===bt.kUnknown)return null;var a=vx(this.unit)/vx(n);return new t(this.value*a,n)}},{key:"buildCSSText",value:function(n,i,a){var s;switch(this.unit){case bt.kUnknown:break;case bt.kInteger:s=Number(this.value).toFixed(0);break;case bt.kNumber:case bt.kPercentage:case bt.kEms:case bt.kRems:case bt.kPixels:case bt.kDegrees:case bt.kRadians:case bt.kGradians:case bt.kMilliseconds:case bt.kSeconds:case bt.kTurns:{var o=-999999,l=999999,c=this.value,u=fm(this.unit);if(c<o||c>l){var h=fm(this.unit);!Number.isFinite(c)||Number.isNaN(c)?s=GI(c,h):s=c+(h||"")}else s="".concat(c).concat(u)}}return a+=s,a}}])})(Cu),jr=new mn(0,"px");new mn(1,"px");var Ha=new mn(0,"deg"),v1=(function(r){function t(e,n,i){var a,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;return ot(this,t),a=Yt(this,t,["rgb"]),a.r=e,a.g=n,a.b=i,a.alpha=s,a.isNone=o,a}return Ht(t,r),lt(t,[{key:"clone",value:function(){return new t(this.r,this.g,this.b,this.alpha)}},{key:"buildCSSText",value:function(n,i,a){return"".concat(a,"rgba(").concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")")}}])})(qI),px=new Rr("unset"),$I=new Rr("initial"),WI=new Rr("inherit"),kd={"":px,unset:px,initial:$I,inherit:WI},VI=function(t){return kd[t]||(kd[t]=new Rr(t)),kd[t]},HO=new v1(0,0,0,0,!0),XO=new v1(0,0,0,0),UI=Je(function(r,t,e,n){return new v1(r,t,e,n)},function(r,t,e,n){return"rgba(".concat(r,",").concat(t,",").concat(e,",").concat(n,")")}),Ne=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:bt.kNumber;return new mn(t,e)};new mn(50,"%");function YI(r){var t=r.type,e=r.value;return t==="hex"?"#".concat(e):t==="literal"?e:t==="rgb"?"rgb(".concat(e.join(","),")"):"rgba(".concat(e.join(","),")")}var HI=(function(){var r={linearGradient:/^(linear\-gradient)/i,repeatingLinearGradient:/^(repeating\-linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,repeatingRadialGradient:/^(repeating\-radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},t="";function e(Z){throw new Error("".concat(t,": ").concat(Z))}function n(){var Z=i();return t.length>0&&e("Invalid input not EOF"),Z}function i(){return x(a)}function a(){return s("linear-gradient",r.linearGradient,l)||s("repeating-linear-gradient",r.repeatingLinearGradient,l)||s("radial-gradient",r.radialGradient,h)||s("repeating-radial-gradient",r.repeatingRadialGradient,h)||s("conic-gradient",r.conicGradient,h)}function s(Z,U,tt){return o(U,function(gt){var xt=tt();return xt&&(G(r.comma)||e("Missing comma before color stops")),{type:Z,orientation:xt,colorStops:x(E)}})}function o(Z,U){var tt=G(Z);if(tt){G(r.startCall)||e("Missing (");var gt=U(tt);return G(r.endCall)||e("Missing )"),gt}}function l(){return c()||u()}function c(){return j("directional",r.sideOrCorner,1)}function u(){return j("angular",r.angleValue,1)}function h(){var Z,U=d(),tt;return U&&(Z=[],Z.push(U),tt=t,G(r.comma)&&(U=d(),U?Z.push(U):t=tt)),Z}function d(){var Z=f()||g();if(Z)Z.at=p();else{var U=v();if(U){Z=U;var tt=p();tt&&(Z.at=tt)}else{var gt=y();gt&&(Z={type:"default-radial",at:gt})}}return Z}function f(){var Z=j("shape",/^(circle)/i,0);return Z&&(Z.style=I()||v()),Z}function g(){var Z=j("shape",/^(ellipse)/i,0);return Z&&(Z.style=C()||v()),Z}function v(){return j("extent-keyword",r.extentKeywords,1)}function p(){if(j("position",/^at/,0)){var Z=y();return Z||e("Missing positioning value"),Z}}function y(){var Z=m();if(Z.x||Z.y)return{type:"position",value:Z}}function m(){return{x:C(),y:C()}}function x(Z){var U=Z(),tt=[];if(U)for(tt.push(U);G(r.comma);)U=Z(),U?tt.push(U):e("One extra comma");return tt}function E(){var Z=_();return Z||e("Expected color definition"),Z.length=C(),Z}function _(){return O()||N()||T()||M()}function M(){return j("literal",r.literalColor,0)}function O(){return j("hex",r.hexColor,1)}function T(){return o(r.rgbColor,function(){return{type:"rgb",value:x(P)}})}function N(){return o(r.rgbaColor,function(){return{type:"rgba",value:x(P)}})}function P(){return G(r.number)[1]}function C(){return j("%",r.percentageValue,1)||R()||I()}function R(){return j("position-keyword",r.positionKeywords,1)}function I(){return j("px",r.pixelValue,1)||j("em",r.emValue,1)}function j(Z,U,tt){var gt=G(U);if(gt)return{type:Z,value:gt[tt]}}function G(Z){var U=/^[\n\r\t\s]+/.exec(t);U&&H(U[0].length);var tt=Z.exec(t);return tt&&H(tt[0].length),tt}function H(Z){t=t.substring(Z)}return function(Z){return t=Z,n()}})();function XI(r,t,e,n){var i=de(n.value),a=0,s=0,o=a+t/2,l=s+e/2,c=Math.abs(t*Math.cos(i))+Math.abs(e*Math.sin(i)),u=r[0]+o-Math.cos(i)*c/2,h=r[1]+l-Math.sin(i)*c/2,d=r[0]+o+Math.cos(i)*c/2,f=r[1]+l+Math.sin(i)*c/2;return{x1:u,y1:h,x2:d,y2:f}}function KI(r,t,e,n,i,a){var s=n.value,o=i.value;n.unit===bt.kPercentage&&(s=n.value/100*t),i.unit===bt.kPercentage&&(o=i.value/100*e);var l=Math.max(er([0,0],[s,o]),er([0,e],[s,o]),er([t,e],[s,o]),er([t,0],[s,o]));return a&&(a instanceof mn?l=a.value:a instanceof Rr&&(a.value==="closest-side"?l=Math.min(s,t-s,o,e-o):a.value==="farthest-side"?l=Math.max(s,t-s,o,e-o):a.value==="closest-corner"&&(l=Math.min(er([0,0],[s,o]),er([0,e],[s,o]),er([t,e],[s,o]),er([t,0],[s,o]))))),{x:s+r[0],y:o+r[1],r:l}}var ZI=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,JI=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,QI=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,KO=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;function tD(r){var t,e=r.length;if(r[e-1].length=(t=r[e-1].length)!==null&&t!==void 0?t:{type:"%",value:"100"},e>1){var n;r[0].length=(n=r[0].length)!==null&&n!==void 0?n:{type:"%",value:"0"}}for(var i=0,a=Number(r[0].length.value),s=1;s<e;s++){var o,l=(o=r[s].length)===null||o===void 0?void 0:o.value;if(!Rt(l)&&!Rt(a)){for(var c=1;c<s-i;c++)r[i+c].length={type:"%",value:"".concat(a+(Number(l)-a)*c/(s-i))};i=s,a=Number(l)}}}var eD={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},nD=Je(function(r){var t;return r.type==="angular"?t=Number(r.value):t=eD[r.value]||0,Ne(t,"deg")}),rD=Je(function(r){var t=50,e=50,n="%",i="%";if((r==null?void 0:r.type)==="position"){var a=r.value,s=a.x,o=a.y;(s==null?void 0:s.type)==="position-keyword"&&(s.value==="left"?t=0:s.value==="center"?t=50:s.value==="right"?t=100:s.value==="top"?e=0:s.value==="bottom"&&(e=100)),(o==null?void 0:o.type)==="position-keyword"&&(o.value==="left"?t=0:o.value==="center"?e=50:o.value==="right"?t=100:o.value==="top"?e=0:o.value==="bottom"&&(e=100)),((s==null?void 0:s.type)==="px"||(s==null?void 0:s.type)==="%"||(s==null?void 0:s.type)==="em")&&(n=s==null?void 0:s.type,t=Number(s.value)),((o==null?void 0:o.type)==="px"||(o==null?void 0:o.type)==="%"||(o==null?void 0:o.type)==="em")&&(i=o==null?void 0:o.type,e=Number(o.value))}return{cx:Ne(t,n),cy:Ne(e,i)}}),iD=Je(function(r){if(r.indexOf("linear")>-1||r.indexOf("radial")>-1){var t=HI(r);return t.map(function(o){var l=o.type,c=o.orientation,u=o.colorStops;tD(u);var h=u.map(function(x){return{offset:Ne(Number(x.length.value),"%"),color:YI(x)}});if(l==="linear-gradient")return new jl(ta.LinearGradient,{angle:c?nD(c):Ha,steps:h});if(l==="radial-gradient"&&(c||(c=[{type:"shape",value:"circle"}]),c[0].type==="shape"&&c[0].value==="circle")){var d=rD(c[0].at),f=d.cx,g=d.cy,v;if(c[0].style){var p=c[0].style,y=p.type,m=p.value;y==="extent-keyword"?v=VI(m):v=Ne(m,y)}return new jl(ta.RadialGradient,{cx:f,cy:g,size:v,steps:h})}})}var e=r[0];if(r[1]==="("||r[2]==="("){if(e==="l"){var n=ZI.exec(r);if(n){var i,a=((i=n[2].match(KO))===null||i===void 0?void 0:i.map(function(o){return o.split(":")}))||[];return[new jl(ta.LinearGradient,{angle:Ne(parseFloat(n[1]),"deg"),steps:a.map(function(o){var l=$t(o,2),c=l[0],u=l[1];return{offset:Ne(Number(c)*100,"%"),color:u}})})]}}else if(e==="r"){var s=aD(r);if(s)if(ae(s))r=s;else return[new jl(ta.RadialGradient,s)]}else if(e==="p")return sD(r)}});function aD(r){var t=JI.exec(r);if(t){var e,n=((e=t[4].match(KO))===null||e===void 0?void 0:e.map(function(i){return i.split(":")}))||[];return{cx:Ne(50,"%"),cy:Ne(50,"%"),steps:n.map(function(i){var a=$t(i,2),s=a[0],o=a[1];return{offset:Ne(Number(s)*100,"%"),color:o}})}}return null}function sD(r){var t=QI.exec(r);if(t){var e=t[1],n=t[2];switch(e){case"a":e="repeat";break;case"x":e="repeat-x";break;case"y":e="repeat-y";break;case"n":e="no-repeat";break;default:e="no-repeat"}return{image:n,repetition:e}}return null}function Xa(r){return r&&!!r.image}function iu(r){return r&&!Rt(r.r)&&!Rt(r.g)&&!Rt(r.b)}var Io=Je(function(r){if(Xa(r))return Vt({repetition:"repeat"},r);if(Rt(r)&&(r=""),r==="transparent")return XO;if(r==="currentColor")r="black";else if(r==="none")return HO;var t=iD(r);if(t)return t;var e=Pu(r),n=[0,0,0,0];return e!==null&&(n[0]=e.r||0,n[1]=e.g||0,n[2]=e.b||0,n[3]=e.opacity),UI.apply(void 0,n)});function oD(r,t){if(!(!iu(r)||!iu(t)))return[[Number(r.r),Number(r.g),Number(r.b),Number(r.alpha)],[Number(t.r),Number(t.g),Number(t.b),Number(t.alpha)],function(e){var n=e.slice();if(n[3])for(var i=0;i<3;i++)n[i]=Math.round(qe(n[i],0,255));return n[3]=qe(n[3],0,1),"rgba(".concat(n.join(","),")")}]}function ll(r,t){if(Rt(t))return Ne(0,"px");if(t="".concat(t).trim().toLowerCase(),isFinite(Number(t))){if("px".search(r)>=0)return Ne(Number(t),"px");if("deg".search(r)>=0)return Ne(Number(t),"deg")}var e=[];t=t.replace(r,function(i){return e.push(i),"U".concat(i)});var n="U(".concat(r.source,")");return e.map(function(i){return Ne(Number(t.replace(new RegExp("U".concat(i),"g"),"").replace(new RegExp(n,"g"),"*0")),i)})[0]}var ZO=function(t){return ll(new RegExp("px","g"),t)},lD=Je(ZO),cD=function(t){return ll(new RegExp("%","g"),t)};Je(cD);var JO=function(t){return St(t)||isFinite(Number(t))?Ne(Number(t)||0,"px"):ll(new RegExp("px|%|em|rem","g"),t)},vm=Je(JO),QO=function(t){return ll(new RegExp("deg|rad|grad|turn","g"),t)},uD=Je(QO);function hD(r,t,e,n){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,a="",s=r.value||0,o=t.value||0,l=gm(r.unit),c=r.convertTo(l),u=t.convertTo(l);return c&&u?(s=c.value,o=u.value,a=fm(r.unit)):(mn.isLength(r.unit)||mn.isLength(t.unit))&&(s=fr(r,i,e),o=fr(t,i,e),a="px"),[s,o,function(h){return h+a}]}function rr(r){var t=0;return r.unit===bt.kDegrees?t=r.value:r.unit===bt.kRadians?t=nr(Number(r.value)):r.unit===bt.kTurns?t=cI(Number(r.value)):r.value&&(t=r.value),t}function yx(r,t){var e;return Array.isArray(r)?e=r.map(function(n){return Number(n)}):ae(r)?e=r.split(" ").map(function(n){return Number(n)}):St(r)&&(e=[r]),t===2?e.length===1?[e[0],e[0]]:[e[0],e[1]]:t===4?e.length===1?[e[0],e[0],e[0],e[0]]:e.length===2?[e[0],e[1],e[0],e[1]]:e.length===3?[e[0],e[1],e[2],e[1]]:[e[0],e[1],e[2],e[3]]:t==="even"&&e.length%2===1?[].concat(ne(e),ne(e)):e}function fr(r,t,e){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(r.unit===bt.kPixels)return Number(r.value);if(r.unit===bt.kPercentage&&e){var i=e.nodeName===nt.GROUP?e.getLocalBounds():e.getGeometryBounds();return(n?i.min[t]:0)+r.value/100*i.halfExtents[t]*2}return 0}var dD=function(t){return ll(/deg|rad|grad|turn|px|%/g,t)},fD=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function gD(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";if(r=r.toLowerCase().trim(),r==="none")return[];for(var t=/\s*([\w-]+)\(([^)]*)\)/g,e=[],n,i=0;n=t.exec(r);){if(n.index!==i)return[];if(i=n.index+n[0].length,fD.indexOf(n[1])>-1&&e.push({name:n[1],params:n[2].split(" ").map(function(a){return dD(a)||Io(a)})}),t.lastIndex===r.length)return e}return[]}function tA(r){return r.toString()}var eA=function(t){return typeof t=="number"?Ne(t):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(t)?Ne(Number(t)):Ne(0)},pm=Je(eA);Je(function(r){return ae(r)?r.split(" ").map(pm):r.map(pm)});function p1(r,t){return[r,t,tA]}function y1(r,t){return function(e,n){return[e,n,function(i){return tA(qe(i,r,t))}]}}function nA(r,t){if(r.length===t.length)return[r,t,function(e){return e}]}function ym(r){return r.parsedStyle.d.totalLength===0&&(r.parsedStyle.d.totalLength=TL(r.parsedStyle.d.absolutePath)),r.parsedStyle.d.totalLength}function vD(r){return r.parsedStyle.points.totalLength===0&&(r.parsedStyle.points.totalLength=UL(r.parsedStyle.points.points)),r.parsedStyle.points.totalLength}function pD(r){for(var t=0;t<r.length;t++){var e=r[t-1],n=r[t],i=n[0];if(i==="M"&&e){var a=e[0],s=[n[1],n[2]],o=void 0;a==="L"||a==="M"?o=[e[1],e[2]]:(a==="C"||a==="A"||a==="Q")&&(o=[e[e.length-2],e[e.length-1]]),o&&au(s,o)&&(r.splice(t,1),t--)}}}function yD(r){for(var t=!1,e=r.length,n=0;n<e;n++){var i=r[n],a=i[0];if(a==="C"||a==="A"||a==="Q"){t=!0;break}}return t}function mD(r){for(var t=[],e=[],n=[],i=0;i<r.length;i++){var a=r[i],s=a[0];s==="M"?(n.length&&(e.push(n),n=[]),n.push([a[1],a[2]])):s==="Z"?n.length&&(t.push(n),n=[]):n.push([a[1],a[2]])}return n.length>0&&e.push(n),{polygons:t,polylines:e}}function au(r,t){return r[0]===t[0]&&r[1]===t[1]}function bD(r,t){for(var e=[],n=[],i=[],a=0;a<r.length;a++){var s=r[a],o=s.currentPoint,l=s.params,c=s.prePoint,u=void 0;switch(s.command){case"Q":u=YL(c[0],c[1],l[1],l[2],l[3],l[4]);break;case"C":u=$L(c[0],c[1],l[1],l[2],l[3],l[4],l[5],l[6]);break;case"A":var h=s.arcParams;u=jL(h.cx,h.cy,h.rx,h.ry,h.xRotation,h.startAngle,h.endAngle);break;default:e.push(o[0]),n.push(o[1]);break}u&&(s.box=u,e.push(u.x,u.x+u.width),n.push(u.y,u.y+u.height))}e=e.filter(function(E){return!Number.isNaN(E)&&E!==1/0&&E!==-1/0}),n=n.filter(function(E){return!Number.isNaN(E)&&E!==1/0&&E!==-1/0});var d=Kc(e),f=Kc(n),g=Xc(e),v=Xc(n);if(i.length===0)return{x:d,y:f,width:g-d,height:v-f};for(var p=0;p<i.length;p++){var y=i[p],m=y.currentPoint,x=void 0;m[0]===d?(x=ql(y,t),d-=x.xExtra):m[0]===g&&(x=ql(y,t),g+=x.xExtra),m[1]===f?(x=ql(y,t),f-=x.yExtra):m[1]===v&&(x=ql(y,t),v+=x.yExtra)}return{x:d,y:f,width:g-d,height:v-f}}function ql(r,t){var e=r.prePoint,n=r.currentPoint,i=r.nextPoint,a=Math.pow(n[0]-e[0],2)+Math.pow(n[1]-e[1],2),s=Math.pow(n[0]-i[0],2)+Math.pow(n[1]-i[1],2),o=Math.pow(e[0]-i[0],2)+Math.pow(e[1]-i[1],2),l=Math.acos((a+s-o)/(2*Math.sqrt(a)*Math.sqrt(s)));if(!l||Math.sin(l)===0||Ro(l,0))return{xExtra:0,yExtra:0};var c=Math.abs(Math.atan2(i[1]-n[1],i[0]-n[0])),u=Math.abs(Math.atan2(i[0]-n[0],i[1]-n[1]));c=c>Math.PI/2?Math.PI-c:c,u=u>Math.PI/2?Math.PI-u:u;var h={xExtra:Math.cos(l/2-c)*(t/2*(1/Math.sin(l/2)))-t/2||0,yExtra:Math.cos(u-l/2)*(t/2*(1/Math.sin(l/2)))-t/2||0};return h}function mx(r,t){return[t[0]+(t[0]-r[0]),t[1]+(t[1]-r[1])]}var bx=function(t,e){var n=t.x*e.x+t.y*e.y,i=Math.sqrt((Math.pow(t.x,2)+Math.pow(t.y,2))*(Math.pow(e.x,2)+Math.pow(e.y,2))),a=t.x*e.y-t.y*e.x<0?-1:1,s=a*Math.acos(n/i);return s},xx=function(t,e,n,i,a,s,o,l){e=Math.abs(e),n=Math.abs(n),i=kO(i,360);var c=de(i);if(t.x===o.x&&t.y===o.y)return{x:t.x,y:t.y,ellipticalArcAngle:0};if(e===0||n===0)return{x:0,y:0,ellipticalArcAngle:0};var u=(t.x-o.x)/2,h=(t.y-o.y)/2,d={x:Math.cos(c)*u+Math.sin(c)*h,y:-Math.sin(c)*u+Math.cos(c)*h},f=Math.pow(d.x,2)/Math.pow(e,2)+Math.pow(d.y,2)/Math.pow(n,2);f>1&&(e*=Math.sqrt(f),n*=Math.sqrt(f));var g=Math.pow(e,2)*Math.pow(n,2)-Math.pow(e,2)*Math.pow(d.y,2)-Math.pow(n,2)*Math.pow(d.x,2),v=Math.pow(e,2)*Math.pow(d.y,2)+Math.pow(n,2)*Math.pow(d.x,2),p=g/v;p=p<0?0:p;var y=(a!==s?1:-1)*Math.sqrt(p),m={x:y*(e*d.y/n),y:y*(-(n*d.x)/e)},x={x:Math.cos(c)*m.x-Math.sin(c)*m.y+(t.x+o.x)/2,y:Math.sin(c)*m.x+Math.cos(c)*m.y+(t.y+o.y)/2},E={x:(d.x-m.x)/e,y:(d.y-m.y)/n},_=bx({x:1,y:0},E),M={x:(-d.x-m.x)/e,y:(-d.y-m.y)/n},O=bx(E,M);!s&&O>0?O-=2*Math.PI:s&&O<0&&(O+=2*Math.PI),O%=2*Math.PI;var T=_+O*l,N=e*Math.cos(T),P=n*Math.sin(T),C={x:Math.cos(c)*N-Math.sin(c)*P+x.x,y:Math.sin(c)*N+Math.cos(c)*P+x.y,ellipticalArcStartAngle:_,ellipticalArcEndAngle:_+O,ellipticalArcAngle:T,ellipticalArcCenter:x,resultantRx:e,resultantRy:n};return C};function xD(r){for(var t=[],e=null,n=null,i=null,a=0,s=r.length,o=0;o<s;o++){var l=r[o];n=r[o+1];var c=l[0],u={command:c,prePoint:e,params:l,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(c){case"M":i=[l[1],l[2]],a=o;break;case"A":var h=wD(e,l);u.arcParams=h;break}if(c==="Z")e=i,n=r[a+1];else{var d=l.length;e=[l[d-2],l[d-1]]}n&&n[0]==="Z"&&(n=r[a],t[a]&&(t[a].prePoint=e)),u.currentPoint=e,t[a]&&au(e,t[a].currentPoint)&&(t[a].prePoint=u.prePoint);var f=n?[n[n.length-2],n[n.length-1]]:null;u.nextPoint=f;var g=u.prePoint;if(["L","H","V"].includes(c))u.startTangent=[g[0]-e[0],g[1]-e[1]],u.endTangent=[e[0]-g[0],e[1]-g[1]];else if(c==="Q"){var v=[l[1],l[2]];u.startTangent=[g[0]-v[0],g[1]-v[1]],u.endTangent=[e[0]-v[0],e[1]-v[1]]}else if(c==="T"){var p=t[o-1],y=mx(p.currentPoint,g);p.command==="Q"?(u.command="Q",u.startTangent=[g[0]-y[0],g[1]-y[1]],u.endTangent=[e[0]-y[0],e[1]-y[1]]):(u.command="TL",u.startTangent=[g[0]-e[0],g[1]-e[1]],u.endTangent=[e[0]-g[0],e[1]-g[1]])}else if(c==="C"){var m=[l[1],l[2]],x=[l[3],l[4]];u.startTangent=[g[0]-m[0],g[1]-m[1]],u.endTangent=[e[0]-x[0],e[1]-x[1]],u.startTangent[0]===0&&u.startTangent[1]===0&&(u.startTangent=[m[0]-x[0],m[1]-x[1]]),u.endTangent[0]===0&&u.endTangent[1]===0&&(u.endTangent=[x[0]-m[0],x[1]-m[1]])}else if(c==="S"){var E=t[o-1],_=mx(E.currentPoint,g),M=[l[1],l[2]];E.command==="C"?(u.command="C",u.startTangent=[g[0]-_[0],g[1]-_[1]],u.endTangent=[e[0]-M[0],e[1]-M[1]]):(u.command="SQ",u.startTangent=[g[0]-M[0],g[1]-M[1]],u.endTangent=[e[0]-M[0],e[1]-M[1]])}else if(c==="A"){var O=wx(u,0),T=O.x,N=O.y,P=wx(u,1,!1),C=P.x,R=P.y;u.startTangent=[T,N],u.endTangent=[C,R]}t.push(u)}return t}function wx(r,t){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,n=r.arcParams,i=n.rx,a=i===void 0?0:i,s=n.ry,o=s===void 0?0:s,l=n.xRotation,c=n.arcFlag,u=n.sweepFlag,h=xx({x:r.prePoint[0],y:r.prePoint[1]},a,o,l,!!c,!!u,{x:r.currentPoint[0],y:r.currentPoint[1]},t),d=xx({x:r.prePoint[0],y:r.prePoint[1]},a,o,l,!!c,!!u,{x:r.currentPoint[0],y:r.currentPoint[1]},e?t+.005:t-.005),f=d.x-h.x,g=d.y-h.y,v=Math.sqrt(f*f+g*g);return{x:-f/v,y:-g/v}}function Gl(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function mm(r,t){return Gl(r)*Gl(t)?(r[0]*t[0]+r[1]*t[1])/(Gl(r)*Gl(t)):1}function Ex(r,t){return(r[0]*t[1]<r[1]*t[0]?-1:1)*Math.acos(mm(r,t))}function wD(r,t){var e=t[1],n=t[2],i=kO(de(t[3]),Math.PI*2),a=t[4],s=t[5],o=r[0],l=r[1],c=t[6],u=t[7],h=Math.cos(i)*(o-c)/2+Math.sin(i)*(l-u)/2,d=-1*Math.sin(i)*(o-c)/2+Math.cos(i)*(l-u)/2,f=h*h/(e*e)+d*d/(n*n);f>1&&(e*=Math.sqrt(f),n*=Math.sqrt(f));var g=e*e*(d*d)+n*n*(h*h),v=g?Math.sqrt((e*e*(n*n)-g)/g):1;a===s&&(v*=-1),isNaN(v)&&(v=0);var p=n?v*e*d/n:0,y=e?v*-n*h/e:0,m=(o+c)/2+Math.cos(i)*p-Math.sin(i)*y,x=(l+u)/2+Math.sin(i)*p+Math.cos(i)*y,E=[(h-p)/e,(d-y)/n],_=[(-1*h-p)/e,(-1*d-y)/n],M=Ex([1,0],E),O=Ex(E,_);return mm(E,_)<=-1&&(O=Math.PI),mm(E,_)>=1&&(O=0),s===0&&O>0&&(O-=2*Math.PI),s===1&&O<0&&(O+=2*Math.PI),{cx:m,cy:x,rx:au(r,[c,u])?0:e,ry:au(r,[c,u])?0:n,startAngle:M,endAngle:M+O,xRotation:i,arcFlag:a,sweepFlag:s}}var rA=function(t){if(t===""||Array.isArray(t)&&t.length===0)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};var e;try{e=Jc(t)}catch{e=Jc(""),console.error("[g]: Invalid SVG Path definition: ".concat(t))}pD(e);var n=yD(e),i=mD(e),a=i.polygons,s=i.polylines,o=xD(e),l=bD(o,0),c=l.x,u=l.y,h=l.width,d=l.height;return{absolutePath:e,hasArc:n,segments:o,polygons:a,polylines:s,totalLength:0,rect:{x:Number.isFinite(c)?c:0,y:Number.isFinite(u)?u:0,width:Number.isFinite(h)?h:0,height:Number.isFinite(d)?d:0}}},ED=Je(rA);function iA(r){return ae(r)?ED(r):rA(r)}function SD(r,t,e){var n=r.curve,i=t.curve;(!n||n.length===0)&&(n=sm(r.absolutePath,!1),r.curve=n),(!i||i.length===0)&&(i=sm(t.absolutePath,!1),t.curve=i);var a=[n,i];n.length!==i.length&&(a=IO(n,i));var s=Hb(a[0])!==Hb(a[1])?wL(a[0]):xL(a[0]);return[s,AL(a[1],s),function(o){return o}]}function _D(r,t){var e;return ae(r)?e=r.split(" ").map(function(n){var i=n.split(","),a=$t(i,2),s=a[0],o=a[1];return[Number(s),Number(o)]}):e=r,{points:e,totalLength:0,segments:[]}}function kD(r,t){return[r.points,t.points,function(e){return e}]}var je=null,Ls=/\s*(\w+)\(([^)]*)\)/g;function Jn(r){return function(t){var e=0;return r.map(function(n){return n===je?t[e++]:n})}}function Sa(r){return r}var Vo={matrix:["NNNNNN",[je,je,0,0,je,je,0,0,0,0,1,0,je,je,0,1],Sa],matrix3d:["NNNNNNNNNNNNNNNN",Sa],rotate:["A"],rotateX:["A"],rotateY:["A"],rotateZ:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",Jn([je,je,new mn(1)]),Sa],scaleX:["N",Jn([je,new mn(1),new mn(1)]),Jn([je,new mn(1)])],scaleY:["N",Jn([new mn(1),je,new mn(1)]),Jn([new mn(1),je])],scaleZ:["N",Jn([new mn(1),new mn(1),je])],scale3d:["NNN",Sa],skew:["Aa",null,Sa],skewX:["A",null,Jn([je,Ha])],skewY:["A",null,Jn([Ha,je])],translate:["Tt",Jn([je,je,jr]),Sa],translateX:["T",Jn([je,jr,jr]),Jn([je,jr])],translateY:["T",Jn([jr,je,jr]),Jn([jr,je])],translateZ:["L",Jn([jr,jr,je])],translate3d:["TTL",Sa]};function aA(r){for(var t=[],e=r.length,n=0;n<e;n++){var i=r[n],a=i[0],s=i.slice(1);a==="translate"||a==="skew"?s.length===1&&s.push(0):a==="scale"&&s.length===1&&s.push(s[0]);var o=Vo[a];if(!o)return[];var l=s.map(function(c){return Ne(c)});t.push({t:a,d:l})}return t}function sA(r){if(Array.isArray(r))return aA(r);if(r=(r||"none").trim(),r==="none")return[];var t=[],e,n=0;for(Ls.lastIndex=0;e=Ls.exec(r);){if(e.index!==n)return[];n=e.index+e[0].length;var i=e[1],a=Vo[i];if(!a)return[];var s=e[2].split(","),o=a[0];if(o.length<s.length)return[];for(var l=[],c=0;c<o.length;c++){var u=s[c],h=o[c],d=void 0;if(u?d={A:function(g){return g.trim()==="0"?Ha:uD(g)},N:pm,T:vm,L:lD}[h.toUpperCase()](u):d={a:Ha,n:l[0],t:jr}[h],d===void 0)return[];l.push(d)}if(t.push({t:i,d:l}),Ls.lastIndex===r.length)return t}return[]}function MD(r){if(Array.isArray(r))return aA(r);if(r=(r||"none").trim(),r==="none")return[];var t=[],e,n=0;for(Ls.lastIndex=0;e=Ls.exec(r);){if(e.index!==n)return[];n=e.index+e[0].length;var i=e[1],a=Vo[i];if(!a)return[];var s=e[2].split(","),o=a[0];if(o.length<s.length)return[];for(var l=[],c=0;c<o.length;c++){var u=s[c],h=o[c],d=void 0;if(u?d={A:function(g){return g.trim()==="0"?Ha:QO(g)},N:eA,T:JO,L:ZO}[h.toUpperCase()](u):d={a:Ha,n:l[0],t:jr}[h],d===void 0)return[];l.push(d)}if(t.push({t:i,d:l}),Ls.lastIndex===r.length)return t}return[]}function TD(r){var t,e,n,i;switch(r.t){case"rotateX":return i=de(rr(r.d[0])),[1,0,0,0,0,Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1];case"rotateY":return i=de(rr(r.d[0])),[Math.cos(i),0,-Math.sin(i),0,0,1,0,0,Math.sin(i),0,Math.cos(i),0,0,0,0,1];case"rotate":case"rotateZ":return i=de(rr(r.d[0])),[Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,1];case"rotate3d":t=r.d[0].value,e=r.d[1].value,n=r.d[2].value,i=de(rr(r.d[3]));var a=t*t+e*e+n*n;if(a===0)t=1,e=0,n=0;else if(a!==1){var s=Math.sqrt(a);t/=s,e/=s,n/=s}var o=Math.sin(i/2),l=o*Math.cos(i/2),c=o*o;return[1-2*(e*e+n*n)*c,2*(t*e*c+n*l),2*(t*n*c-e*l),0,2*(t*e*c-n*l),1-2*(t*t+n*n)*c,2*(e*n*c+t*l),0,2*(t*n*c+e*l),2*(e*n*c-t*l),1-2*(t*t+e*e)*c,0,0,0,0,1];case"scale":return[r.d[0].value,0,0,0,0,r.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scaleX":return[r.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaleY":return[1,0,0,0,0,r.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scaleZ":return[1,0,0,0,0,1,0,0,0,0,r.d[0].value,0,0,0,0,1];case"scale3d":return[r.d[0].value,0,0,0,0,r.d[1].value,0,0,0,0,r.d[2].value,0,0,0,0,1];case"skew":var u=de(rr(r.d[0])),h=de(rr(r.d[1]));return[1,Math.tan(h),0,0,Math.tan(u),1,0,0,0,0,1,0,0,0,0,1];case"skewX":return i=de(rr(r.d[0])),[1,0,0,0,Math.tan(i),1,0,0,0,0,1,0,0,0,0,1];case"skewY":return i=de(rr(r.d[0])),[1,Math.tan(i),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return t=fr(r.d[0],0,null)||0,e=fr(r.d[1],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,t,e,0,1];case"translateX":return t=fr(r.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,t,0,0,1];case"translateY":return e=fr(r.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,e,0,1];case"translateZ":return n=fr(r.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,n,1];case"translate3d":return t=fr(r.d[0],0,null)||0,e=fr(r.d[1],0,null)||0,n=fr(r.d[2],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,t,e,n,1];case"perspective":var d=fr(r.d[0],0,null)||0,f=d?-1/d:0;return[1,0,0,0,0,1,0,0,0,0,1,f,0,0,0,1];case"matrix":return[r.d[0].value,r.d[1].value,0,0,r.d[2].value,r.d[3].value,0,0,0,0,1,0,r.d[4].value,r.d[5].value,0,1];case"matrix3d":return r.d.map(function(g){return g.value})}}function OD(r,t){return[r[0]*t[0]+r[4]*t[1]+r[8]*t[2]+r[12]*t[3],r[1]*t[0]+r[5]*t[1]+r[9]*t[2]+r[13]*t[3],r[2]*t[0]+r[6]*t[1]+r[10]*t[2]+r[14]*t[3],r[3]*t[0]+r[7]*t[1]+r[11]*t[2]+r[15]*t[3],r[0]*t[4]+r[4]*t[5]+r[8]*t[6]+r[12]*t[7],r[1]*t[4]+r[5]*t[5]+r[9]*t[6]+r[13]*t[7],r[2]*t[4]+r[6]*t[5]+r[10]*t[6]+r[14]*t[7],r[3]*t[4]+r[7]*t[5]+r[11]*t[6]+r[15]*t[7],r[0]*t[8]+r[4]*t[9]+r[8]*t[10]+r[12]*t[11],r[1]*t[8]+r[5]*t[9]+r[9]*t[10]+r[13]*t[11],r[2]*t[8]+r[6]*t[9]+r[10]*t[10]+r[14]*t[11],r[3]*t[8]+r[7]*t[9]+r[11]*t[10]+r[15]*t[11],r[0]*t[12]+r[4]*t[13]+r[8]*t[14]+r[12]*t[15],r[1]*t[12]+r[5]*t[13]+r[9]*t[14]+r[13]*t[15],r[2]*t[12]+r[6]*t[13]+r[10]*t[14]+r[14]*t[15],r[3]*t[12]+r[7]*t[13]+r[11]*t[14]+r[15]*t[15]]}function AD(r){return r.length===0?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:r.map(TD).reduce(OD)}function Sx(r){var t=[0,0,0],e=[1,1,1],n=[0,0,0],i=[0,0,0,1],a=[0,0,0,1];return gI(AD(r),t,e,n,i,a),[[t,e,n,a,i]]}var ND=(function(){function r(n,i){for(var a=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],s=0;s<4;s++)for(var o=0;o<4;o++)for(var l=0;l<4;l++)a[s][o]+=i[s][l]*n[l][o];return a}function t(n){return n[0][2]===0&&n[0][3]===0&&n[1][2]===0&&n[1][3]===0&&n[2][0]===0&&n[2][1]===0&&n[2][2]===1&&n[2][3]===0&&n[3][2]===0&&n[3][3]===1}function e(n,i,a,s,o){for(var l=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],c=0;c<4;c++)l[c][3]=o[c];for(var u=0;u<3;u++)for(var h=0;h<3;h++)l[3][u]+=n[h]*l[h][u];var d=s[0],f=s[1],g=s[2],v=s[3],p=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];p[0][0]=1-2*(f*f+g*g),p[0][1]=2*(d*f-g*v),p[0][2]=2*(d*g+f*v),p[1][0]=2*(d*f+g*v),p[1][1]=1-2*(d*d+g*g),p[1][2]=2*(f*g-d*v),p[2][0]=2*(d*g-f*v),p[2][1]=2*(f*g+d*v),p[2][2]=1-2*(d*d+f*f),l=r(l,p);var y=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];a[2]&&(y[2][1]=a[2],l=r(l,y)),a[1]&&(y[2][1]=0,y[2][0]=a[0],l=r(l,y)),a[0]&&(y[2][0]=0,y[1][0]=a[0],l=r(l,y));for(var m=0;m<3;m++)for(var x=0;x<3;x++)l[m][x]*=i[m];return t(l)?[l[0][0],l[0][1],l[1][0],l[1][1],l[3][0],l[3][1]]:l[0].concat(l[1],l[2],l[3])}return e})();function PD(r){return r.toFixed(6).replace(".000000","")}function Md(r,t){var e,n;return r.decompositionPair!==t&&(r.decompositionPair=t,e=Sx(r)),t.decompositionPair!==r&&(t.decompositionPair=r,n=Sx(t)),e[0]===null||n[0]===null?[[!1],[!0],function(i){return i?t[0].d:r[0].d}]:(e[0].push(0),n[0].push(1),[e,n,function(i){var a=RD(e[0][3],n[0][3],i[5]),s=ND(i[0],i[1],i[2],a,i[4]),o=s.map(PD).join(",");return o}])}function CD(r,t){for(var e=0,n=0;n<r.length;n++)e+=r[n]*t[n];return e}function RD(r,t,e){var n=CD(r,t);n=qe(n,-1,1);var i=[];if(n===1)i=r;else for(var a=Math.acos(n),s=Math.sin(e*a)*1/Math.sqrt(1-n*n),o=0;o<4;o++)i.push(r[o]*(Math.cos(e*a)-n*s)+t[o]*s);return i}function Td(r){return r.replace(/[XY]/,"")}function Od(r){return r.replace(/(X|Y|Z|3d)?$/,"3d")}var LD=function(t,e){return t==="perspective"&&e==="perspective"||(t==="matrix"||t==="matrix3d")&&(e==="matrix"||e==="matrix3d")};function ID(r,t,e){var n=!1;if(!r.length||!t.length){r.length||(n=!0,r=t,t=[]);for(var i=function(){var C=r[a],R=C.t,I=C.d,j=R.substring(0,5)==="scale"?1:0;t.push({t:R,d:I.map(function(G){return typeof G=="number"?Ne(j):Ne(j,G.unit)})})},a=0;a<r.length;a++)i()}var s=[],o=[],l=[];if(r.length!==t.length){var c=Md(r,t);s=[c[0]],o=[c[1]],l=[["matrix",[c[2]]]]}else for(var u=0;u<r.length;u++){var h=r[u].t,d=t[u].t,f=r[u].d,g=t[u].d,v=Vo[h],p=Vo[d],y=void 0;if(LD(h,d)){var m=Md([r[u]],[t[u]]);s.push(m[0]),o.push(m[1]),l.push(["matrix",[m[2]]]);continue}else if(h===d)y=h;else if(v[2]&&p[2]&&Td(h)===Td(d))y=Td(h),f=v[2](f),g=p[2](g);else if(v[1]&&p[1]&&Od(h)===Od(d))y=Od(h),f=v[1](f),g=p[1](g);else{var x=Md(r,t);s=[x[0]],o=[x[1]],l=[["matrix",[x[2]]]];break}for(var E=[],_=[],M=[],O=0;O<f.length;O++){var T=hD(f[O],g[O],e,!1,O);E[O]=T[0],_[O]=T[1],M.push(T[2])}s.push(E),o.push(_),l.push([y,M])}if(n){var N=s;s=o,o=N}return[s,o,function(P){return P.map(function(C,R){var I=C.map(function(j,G){return l[R][1][G](j)}).join(",");return l[R][0]==="matrix"&&I.split(",").length===16&&(l[R][0]="matrix3d"),l[R][0]==="matrix3d"&&I.split(",").length===6&&(l[R][0]="matrix"),"".concat(l[R][0],"(").concat(I,")")}).join(" ")}]}var DD=Je(function(r){if(ae(r)){if(r==="text-anchor")return[Ne(0,"px"),Ne(0,"px")];var t=r.split(" ");return t.length===1&&(t[0]==="top"||t[0]==="bottom"?(t[1]=t[0],t[0]="center"):t[1]="center"),t.length!==2?null:[vm(_x(t[0])),vm(_x(t[1]))]}return[Ne(r[0]||0,"px"),Ne(r[1]||0,"px")]});function _x(r){return r==="center"?"50%":r==="left"||r==="top"?"0%":r==="right"||r==="bottom"?"100%":r}var m1=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:mt.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:mt.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:mt.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:mt.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:mt.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:mt.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:mt.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:mt.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:mt.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:mt.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:mt.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:mt.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:mt.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:mt.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:mt.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:mt.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:mt.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:mt.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:mt.FILTER},{n:"clipPath",syntax:mt.DEFINED_PATH},{n:"textPath",syntax:mt.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:mt.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:mt.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:mt.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:mt.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:mt.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:mt.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:mt.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:mt.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:mt.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:mt.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:mt.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:mt.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:mt.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:mt.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:mt.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:mt.COORDINATE},{n:"y1",int:!0,l:!0,syntax:mt.COORDINATE},{n:"z1",int:!0,l:!0,syntax:mt.COORDINATE},{n:"x2",int:!0,l:!0,syntax:mt.COORDINATE},{n:"y2",int:!0,l:!0,syntax:mt.COORDINATE},{n:"z2",int:!0,l:!0,syntax:mt.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:mt.PATH,p:50},{n:"points",int:!0,l:!0,syntax:mt.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:mt.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:mt.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:mt.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:mt.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:mt.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:mt.NUMBER,d:function(t){return t===nt.PATH||t===nt.POLYGON||t===nt.POLYLINE?"4":"10"}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:mt.MARKER},{n:"markerEnd",syntax:mt.MARKER},{n:"markerMid",syntax:mt.MARKER},{n:"markerStartOffset",syntax:mt.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:mt.LENGTH,l:!0,int:!0,d:"0"}],FD=new Set(m1.filter(function(r){return!!r.l}).map(function(r){return r.n})),oA={},BD=(function(){function r(t){var e=this;ot(this,r),this.runtime=t,m1.forEach(function(n){e.registerMetadata(n)})}return lt(r,[{key:"registerMetadata",value:function(e){[e.n].concat(ne(e.a||[])).forEach(function(n){oA[n]=e})}},{key:"getPropertySyntax",value:function(e){return this.runtime.CSSPropertySyntaxFactory[e]}},{key:"processProperties",value:function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{forceUpdateGeometry:!1};Object.assign(e.attributes,n);var a=e.parsedStyle.clipPath,s=e.parsedStyle.offsetPath;zD(e,n);var o=!!i.forceUpdateGeometry;if(!o){for(var l in n)if(FD.has(l)){o=!0;break}}var c=lA(e);c.has("fill")&&n.fill&&(e.parsedStyle.fill=Io(n.fill)),c.has("stroke")&&n.stroke&&(e.parsedStyle.stroke=Io(n.stroke)),c.has("shadowColor")&&n.shadowColor&&(e.parsedStyle.shadowColor=Io(n.shadowColor)),c.has("filter")&&n.filter&&(e.parsedStyle.filter=gD(n.filter)),c.has("radius")&&!Rt(n.radius)&&(e.parsedStyle.radius=yx(n.radius,4)),c.has("lineDash")&&!Rt(n.lineDash)&&(e.parsedStyle.lineDash=yx(n.lineDash,"even")),c.has("points")&&n.points&&(e.parsedStyle.points=_D(n.points)),c.has("d")&&n.d===""&&(e.parsedStyle.d=Vt({},VO)),c.has("d")&&n.d&&(e.parsedStyle.d=iA(n.d)),c.has("textTransform")&&n.textTransform&&this.runtime.CSSPropertySyntaxFactory[mt.TEXT_TRANSFORM].calculator(null,null,{value:n.textTransform},e,null),c.has("clipPath")&&!Dt(n.clipPath)&&this.runtime.CSSPropertySyntaxFactory[mt.DEFINED_PATH].calculator("clipPath",a,n.clipPath,e,this.runtime),c.has("offsetPath")&&n.offsetPath&&this.runtime.CSSPropertySyntaxFactory[mt.DEFINED_PATH].calculator("offsetPath",s,n.offsetPath,e,this.runtime),c.has("transform")&&n.transform&&(e.parsedStyle.transform=sA(n.transform)),c.has("transformOrigin")&&n.transformOrigin&&(e.parsedStyle.transformOrigin=DD(n.transformOrigin)),c.has("markerStart")&&n.markerStart&&(e.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory[mt.MARKER].calculator(null,n.markerStart,n.markerStart,null,null)),c.has("markerEnd")&&n.markerEnd&&(e.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory[mt.MARKER].calculator(null,n.markerEnd,n.markerEnd,null,null)),c.has("markerMid")&&n.markerMid&&(e.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory[mt.MARKER].calculator("",n.markerMid,n.markerMid,null,null)),c.has("zIndex")&&!Rt(n.zIndex)&&this.runtime.CSSPropertySyntaxFactory[mt.Z_INDEX].postProcessor(e),c.has("offsetDistance")&&!Rt(n.offsetDistance)&&this.runtime.CSSPropertySyntaxFactory[mt.OFFSET_DISTANCE].postProcessor(e),c.has("transform")&&n.transform&&this.runtime.CSSPropertySyntaxFactory[mt.TRANSFORM].postProcessor(e),c.has("transformOrigin")&&n.transformOrigin&&this.runtime.CSSPropertySyntaxFactory[mt.TRANSFORM_ORIGIN].postProcessor(e),o&&(e.geometry.dirty=!0,e.dirty(!0,!0),i.forceUpdateGeometry||this.runtime.sceneGraphService.dirtyToRoot(e))}},{key:"updateGeometry",value:function(e){var n=e.nodeName,i=this.runtime.geometryUpdaterFactory[n];if(i){var a=e.geometry;a.contentBounds||(a.contentBounds=new be),a.renderBounds||(a.renderBounds=new be);var s=e.parsedStyle,o=i.update(s,e),l=o.cx,c=l===void 0?0:l,u=o.cy,h=u===void 0?0:u,d=o.cz,f=d===void 0?0:d,g=o.hwidth,v=g===void 0?0:g,p=o.hheight,y=p===void 0?0:p,m=o.hdepth,x=m===void 0?0:m,E=[Math.abs(v),Math.abs(y),x],_=s.stroke,M=s.lineWidth,O=M===void 0?1:M,T=s.increasedLineWidthForHitTesting,N=T===void 0?0:T,P=s.shadowType,C=P===void 0?"outer":P,R=s.shadowColor,I=s.filter,j=I===void 0?[]:I,G=s.transformOrigin,H=[c,h,f];a.contentBounds.update(H,E);var Z=n===nt.POLYLINE||n===nt.POLYGON||n===nt.PATH?Math.SQRT2:.5,U=_&&!_.isNone;if(U){var tt=((O||0)+(N||0))*Z;E[0]+=tt,E[1]+=tt}if(a.renderBounds.update(H,E),R&&C&&C!=="inner"){var gt=a.renderBounds,xt=gt.min,ut=gt.max,zt=s.shadowBlur,J=s.shadowOffsetX,W=s.shadowOffsetY,Q=zt||0,ht=J||0,Et=W||0,Pt=xt[0]-Q+ht,Kt=ut[0]+Q+ht,pe=xt[1]-Q+Et,pn=ut[1]+Q+Et;xt[0]=Math.min(xt[0],Pt),ut[0]=Math.max(ut[0],Kt),xt[1]=Math.min(xt[1],pe),ut[1]=Math.max(ut[1],pn),a.renderBounds.setMinMax(xt,ut)}j.forEach(function(re){var Sr=re.name,_e=re.params;if(Sr==="blur"){var ds=_e[0].value;a.renderBounds.update(a.renderBounds.center,oa(a.renderBounds.halfExtents,a.renderBounds.halfExtents,[ds,ds,0]))}else if(Sr==="drop-shadow"){var _r=_e[0].value,Ye=_e[1].value,Be=_e[2].value,Xn=a.renderBounds,Kn=Xn.min,kr=Xn.max,ki=Kn[0]-Be+_r,ei=kr[0]+Be+_r,fs=Kn[1]-Be+Ye,gs=kr[1]+Be+Ye;Kn[0]=Math.min(Kn[0],ki),kr[0]=Math.max(kr[0],ei),Kn[1]=Math.min(Kn[1],fs),kr[1]=Math.max(kr[1],gs),a.renderBounds.setMinMax(Kn,kr)}}),e.geometry.dirty=!1;var Ce=v<0,Qe=y<0,Qt=(Ce?-1:1)*(G?fr(G[0],0,e,!0):0),Er=(Qe?-1:1)*(G?fr(G[1],1,e,!0):0);(Qt||Er)&&e.setOrigin(Qt,Er)}}},{key:"updateSizeAttenuation",value:function(e,n){e.style.isSizeAttenuation?(e.style.rawLineWidth||(e.style.rawLineWidth=e.style.lineWidth),e.style.lineWidth=(e.style.rawLineWidth||1)/n,e.nodeName===nt.CIRCLE&&(e.style.rawR||(e.style.rawR=e.style.r),e.style.r=(e.style.rawR||1)/n)):(e.style.rawLineWidth&&(e.style.lineWidth=e.style.rawLineWidth,delete e.style.rawLineWidth),e.nodeName===nt.CIRCLE&&e.style.rawR&&(e.style.r=e.style.rawR,delete e.style.rawR))}}])})();function zD(r,t){var e=lA(r);for(var n in t)e.has(n)&&(r.parsedStyle[n]=t[n])}function lA(r){return r.constructor.PARSED_STYLE_LIST}var jD=(function(){function r(){ot(this,r),this.mixer=p1}return lt(r,[{key:"calculator",value:function(e,n,i,a){return rr(i)}}])})(),qD=(function(){function r(){ot(this,r)}return lt(r,[{key:"calculator",value:function(e,n,i,a,s){return i instanceof Rr&&(i=null),s.sceneGraphService.updateDisplayObjectDependency(e,n,i,a),e==="clipPath"&&a.forEach(function(o){o.childNodes.length===0&&s.sceneGraphService.dirtyToRoot(o)}),i}}])})(),GD=(function(){function r(){ot(this,r),this.parser=Io,this.mixer=oD}return lt(r,[{key:"calculator",value:function(e,n,i,a){return i instanceof Rr?i.value==="none"?HO:XO:i}}])})(),$D=(function(){function r(){ot(this,r)}return lt(r,[{key:"calculator",value:function(e,n,i){return i instanceof Rr?[]:i}}])})();function kx(r){var t=r.parsedStyle,e=t.fontSize;return Rt(e)?null:e}var bm=(function(){function r(){ot(this,r),this.mixer=p1}return lt(r,[{key:"calculator",value:function(e,n,i,a,s){if(St(i))return i;if(mn.isRelativeUnit(i.unit)){if(i.unit===bt.kPercentage)return 0;if(i.unit===bt.kEms){if(a.parentNode){var o=kx(a.parentNode);if(o)return o*=i.value,o}return 0}if(i.unit===bt.kRems){var l;if(a!=null&&(l=a.ownerDocument)!==null&&l!==void 0&&l.documentElement){var c=kx(a.ownerDocument.documentElement);if(c)return c*=i.value,c}return 0}}else return i.value}}])})(),WD=(function(){function r(){ot(this,r),this.mixer=nA}return lt(r,[{key:"calculator",value:function(e,n,i){return i.map(function(a){return a.value})}}])})(),VD=(function(){function r(){ot(this,r),this.mixer=nA}return lt(r,[{key:"calculator",value:function(e,n,i){return i.map(function(a){return a.value})}}])})(),UD=(function(){function r(){ot(this,r)}return lt(r,[{key:"calculator",value:function(e,n,i,a){var s;i instanceof Rr&&(i=null);var o=(s=i)===null||s===void 0?void 0:s.cloneNode(!0);return o&&(o.style.isMarker=!0),o}}])})(),YD=(function(){function r(){ot(this,r),this.mixer=p1}return lt(r,[{key:"calculator",value:function(e,n,i){return i.value}}])})(),HD=(function(){function r(){ot(this,r),this.mixer=y1(0,1)}return lt(r,[{key:"calculator",value:function(e,n,i){return i.value}},{key:"postProcessor",value:function(e){var n=e.parsedStyle,i=n.offsetPath,a=n.offsetDistance;if(i){var s=i.nodeName;if(s===nt.LINE||s===nt.PATH||s===nt.POLYLINE){var o=i.getPoint(a);o&&e.setLocalPosition(o.x,o.y)}}}}])})(),XD=(function(){function r(){ot(this,r),this.mixer=y1(0,1)}return lt(r,[{key:"calculator",value:function(e,n,i){return i.value}}])})(),KD=(function(){function r(){ot(this,r),this.parser=iA,this.mixer=SD}return lt(r,[{key:"calculator",value:function(e,n,i){return i instanceof Rr&&i.value==="unset"?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new qs(0,0,0,0)}:i}}])})(),ZD=lt(function r(){ot(this,r),this.mixer=kD}),JD=(function(r){function t(){var e;ot(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=Yt(this,t,[].concat(i)),e.mixer=y1(0,1/0),e}return Ht(t,r),lt(t)})(bm),QD=(function(){function r(){ot(this,r)}return lt(r,[{key:"calculator",value:function(e,n,i,a){return i instanceof Rr?i.value==="unset"?"":i.value:"".concat(i)}},{key:"postProcessor",value:function(e){e.nodeValue="".concat(e.parsedStyle.text)||""}}])})(),t6=(function(){function r(){ot(this,r)}return lt(r,[{key:"calculator",value:function(e,n,i,a){var s=a.getAttribute("text");if(s){var o=s;i.value==="capitalize"?o=s.charAt(0).toUpperCase()+s.slice(1):i.value==="lowercase"?o=s.toLowerCase():i.value==="uppercase"&&(o=s.toUpperCase()),a.parsedStyle.text=o}return i.value}}])})(),Ad=new WeakMap;function e6(r,t,e){if(r){var n=typeof r=="string"?document.getElementById(r):r;Ad.has(n)&&Ad.get(n).destroy(e),Ad.set(n,t)}}var b1=typeof window<"u"&&typeof window.document<"u";function n6(r){return!!r.getAttribute}function r6(r,t){for(var e=0,n=r.length;e<n;){var i=e+n>>>1;cA(r[i],t)<0?e=i+1:n=i}return e}function cA(r,t){var e=Number(r.parsedStyle.zIndex||0),n=Number(t.parsedStyle.zIndex||0);if(e===n){var i=r.parentNode;if(i){var a=i.childNodes||[];return a.indexOf(r)-a.indexOf(t)}}return e-n}function uA(r){var t=r;do{var e,n=(e=t.parsedStyle)===null||e===void 0?void 0:e.clipPath;if(n)return t;t=t.parentElement}while(t!==null);return null}var Mx="px";function i6(r,t,e){b1&&r.style&&(r.style.width=t+Mx,r.style.height=e+Mx)}function hA(r,t){if(b1)return document.defaultView.getComputedStyle(r,null).getPropertyValue(t)}function a6(r){var t=hA(r,"width");return t==="auto"?r.offsetWidth:parseFloat(t)}function s6(r){var t=hA(r,"height");return t==="auto"?r.offsetHeight:parseFloat(t)}var o6=1,l6={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},xm=typeof performance=="object"&&performance.now?performance:Date;function su(r){return r.nodeName===nt.FRAGMENT?!0:r.getRootNode().nodeName===nt.FRAGMENT}function ns(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"auto",t=arguments.length>1?arguments[1]:void 0,e=arguments.length>2?arguments[2]:void 0,n=!1,i=!1,a=!!t&&!t.isNone,s=!!e&&!e.isNone;return r==="visiblepainted"||r==="painted"||r==="auto"?(n=a,i=s):r==="visiblefill"||r==="fill"?n=!0:r==="visiblestroke"||r==="stroke"?i=!0:(r==="visible"||r==="all")&&(n=!0,i=!0),[n,i]}var c6=1,u6=function(){return c6++},pi=typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:{},h6=Date.now(),d6=function(){return pi.performance&&typeof pi.performance.now=="function"?pi.performance.now():Date.now()-h6},wo={},Tx=Date.now(),f6=function(t){if(typeof t!="function")throw new TypeError("".concat(t," is not a function"));var e=Date.now(),n=e-Tx,i=n>16?0:16-n,a=u6();return wo[a]=t,Object.keys(wo).length>1||setTimeout(function(){Tx=e;var s=wo;wo={},Object.keys(s).forEach(function(o){return s[o](d6())})},i),a},g6=function(t){delete wo[t]},v6=["","webkit","moz","ms","o"],dA=function(t){return typeof t!="string"?f6:t===""?pi.requestAnimationFrame:pi["".concat(t,"RequestAnimationFrame")]},p6=function(t){return typeof t!="string"?g6:t===""?pi.cancelAnimationFrame:pi["".concat(t,"CancelAnimationFrame")]||pi["".concat(t,"CancelRequestAnimationFrame")]},y6=function(t,e){for(var n=0;t[n]!==void 0;){if(e(t[n]))return t[n];n+=1}},fA=y6(v6,function(r){return!!dA(r)}),x1=dA(fA),gA=p6(fA);pi.requestAnimationFrame=x1;pi.cancelAnimationFrame=gA;var m6=(function(){function r(){ot(this,r),this.callbacks=[]}return lt(r,[{key:"getCallbacksNum",value:function(){return this.callbacks.length}},{key:"tapPromise",value:function(e,n){this.callbacks.push(n)}},{key:"promise",value:function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Promise.all(this.callbacks.map(function(a){return a.apply(void 0,n)}))}}])})(),b6=(function(){function r(){ot(this,r),this.callbacks=[]}return lt(r,[{key:"tapPromise",value:function(e,n){this.callbacks.push(n)}},{key:"promise",value:(function(){var t=fa(bn().mark(function n(){var i,a,s,o,l=arguments;return bn().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!this.callbacks.length){c.next=6;break}return c.next=1,(i=this.callbacks)[0].apply(i,l);case 1:a=c.sent,s=0;case 2:if(!(s<this.callbacks.length-1)){c.next=5;break}return o=this.callbacks[s],c.next=3,o(a);case 3:a=c.sent;case 4:s++,c.next=2;break;case 5:return c.abrupt("return",a);case 6:return c.abrupt("return",null);case 7:case"end":return c.stop()}},n,this)}));function e(){return t.apply(this,arguments)}return e})()}])})(),jn=(function(){function r(){ot(this,r),this.callbacks=[]}return lt(r,[{key:"tap",value:function(e,n){this.callbacks.push(n)}},{key:"call",value:function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];var a=arguments;this.callbacks.forEach(function(s){s.apply(void 0,a)})}}])})(),Nd=(function(){function r(){ot(this,r),this.callbacks=[]}return lt(r,[{key:"tap",value:function(e,n){this.callbacks.push(n)}},{key:"call",value:function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];if(this.callbacks.length){for(var a=arguments,s=this.callbacks[0].apply(void 0,a),o=0;o<this.callbacks.length-1;o++){var l=this.callbacks[o];s=l(s)}return s}return null}}])})(),x6=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],w6=/([\"\'])[^\'\"]+\1/;function Ox(r){var t=r.fontSize,e=t===void 0?16:t,n=r.fontFamily,i=n===void 0?"sans-serif":n,a=r.fontStyle,s=a===void 0?"normal":a,o=r.fontVariant,l=o===void 0?"normal":o,c=r.fontWeight,u=c===void 0?"normal":c;return{fontSize:e,fontFamily:i,fontStyle:s,fontVariant:l,fontWeight:u}}var Ax=Je(function(t){for(var e=Ox(t),n=e.fontSize,i=e.fontFamily,a=e.fontStyle,s=e.fontVariant,o=e.fontWeight,l=St(n)&&"".concat(n,"px")||"16px",c=i.split(","),u=c.length-1;u>=0;u--){var h=c[u].trim();!w6.test(h)&&x6.indexOf(h)<0&&(h='"'.concat(h,'"')),c[u]=h}return"".concat(a," ").concat(s," ").concat(o," ").concat(l," ").concat(c.join(","))},function(r){var t=Ox(r),e=t.fontSize,n=t.fontFamily,i=t.fontStyle,a=t.fontVariant,s=t.fontWeight;return"".concat(i,"_").concat(a,"_").concat(s,"_").concat(e,"_").concat(n)}),E6=1e-6,uo=function(t){return Math.max(t,E6)};function Pd(r,t,e){return ha(r),r[4]=Math.tan(t),r[1]=Math.tan(e),r}var Xe=ve(),S6=ve(),_6={scale:function(t){Ra(Xe,[t[0].value,t[1].value,1].map(function(e){return uo(e)}))},scaleX:function(t){Ra(Xe,[t[0].value,1,1].map(function(e){return uo(e)}))},scaleY:function(t){Ra(Xe,[1,t[0].value,1].map(function(e){return uo(e)}))},scaleZ:function(t){Ra(Xe,[1,1,t[0].value].map(function(e){return uo(e)}))},scale3d:function(t){Ra(Xe,[t[0].value,t[1].value,t[2].value].map(function(e){return uo(e)}))},translate:function(t){Ji(Xe,[t[0].value,t[1].value,0])},translateX:function(t){Ji(Xe,[t[0].value,0,0])},translateY:function(t){Ji(Xe,[0,t[0].value,0])},translateZ:function(t){Ji(Xe,[0,0,t[0].value])},translate3d:function(t){Ji(Xe,[t[0].value,t[1].value,t[2].value])},rotate:function(t){Jy(Xe,de(rr(t[0])))},rotateX:function(t){hO(Xe,de(rr(t[0])))},rotateY:function(t){dO(Xe,de(rr(t[0])))},rotateZ:function(t){Jy(Xe,de(rr(t[0])))},rotate3d:function(t){uO(Xe,de(rr(t[3])),[t[0].value,t[1].value,t[2].value])},skew:function(t){Pd(Xe,de(t[0].value),de(t[1].value))},skewX:function(t){Pd(Xe,de(t[0].value),0)},skewY:function(t){Pd(Xe,0,de(t[0].value))},matrix:function(t){Zy(Xe,t[0].value,t[1].value,0,0,t[2].value,t[3].value,0,0,0,0,1,0,t[4].value,t[5].value,0,1)},matrix3d:function(t){Zy.apply(f3,[Xe].concat(ne(t.map(function(e){return e.value}))))}},k6=we(1,1,1),M6=te(),Nx={translate:function(t,e){ct.sceneGraphService.setLocalScale(t,k6,!1),ct.sceneGraphService.setLocalEulerAngles(t,M6,void 0,void 0,!1),ct.sceneGraphService.setLocalPosition(t,[e[0].value,e[1].value,0],!1),ct.sceneGraphService.dirtyLocalTransform(t,t.transformable)}};function vA(r,t){if(r.length){if(r.length===1&&Nx[r[0].t]){Nx[r[0].t](t,r[0].d);return}for(var e=ha(S6),n=0;n<r.length;n++){var i=r[n],a=i.t,s=i.d,o=_6[a];o&&(o(s),xO(e,e,Xe))}t.setLocalTransform(e)}else t.resetLocalTransform();return t.getLocalTransform()}var T6=(function(){function r(){ot(this,r),this.parser=MD,this.mixer=ID}return lt(r,[{key:"calculator",value:function(e,n,i,a){return i instanceof Rr?[]:i}},{key:"postProcessor",value:function(e){vA(e.parsedStyle.transform,e)}}])})(),O6=(function(){function r(){ot(this,r)}return lt(r,[{key:"postProcessor",value:function(e){var n=e.parsedStyle.transformOrigin;n[0].unit===bt.kPixels&&n[1].unit===bt.kPixels?e.setOrigin(n[0].value,n[1].value):e.getGeometryBounds()}}])})(),A6=(function(){function r(){ot(this,r)}return lt(r,[{key:"calculator",value:function(e,n,i,a){return i.value}},{key:"postProcessor",value:function(e){if(e.parentNode){var n=e.parentNode,i=n.renderable,a=n.sortable;i&&n.dirty(),a&&(a.dirty=!0,a.dirtyReason=eu.Z_INDEX_CHANGED)}}}])})(),N6=(function(){function r(){ot(this,r)}return lt(r,[{key:"update",value:function(e,n){var i=e.cx,a=i===void 0?0:i,s=e.cy,o=s===void 0?0:s,l=e.r,c=l===void 0?0:l;return{cx:a,cy:o,hwidth:c,hheight:c}}}])})(),P6=(function(){function r(){ot(this,r)}return lt(r,[{key:"update",value:function(e,n){var i=e.cx,a=i===void 0?0:i,s=e.cy,o=s===void 0?0:s,l=e.rx,c=l===void 0?0:l,u=e.ry,h=u===void 0?0:u;return{cx:a,cy:o,hwidth:c,hheight:h}}}])})(),C6=(function(){function r(){ot(this,r)}return lt(r,[{key:"update",value:function(e){var n=e.x1,i=e.y1,a=e.x2,s=e.y2,o=Math.min(n,a),l=Math.max(n,a),c=Math.min(i,s),u=Math.max(i,s),h=l-o,d=u-c,f=h/2,g=d/2;return{cx:o+f,cy:c+g,hwidth:f,hheight:g}}}])})(),R6=(function(){function r(){ot(this,r)}return lt(r,[{key:"update",value:function(e){var n=e.d,i=n.rect,a=i.x,s=i.y,o=i.width,l=i.height,c=o/2,u=l/2;return{cx:a+c,cy:s+u,hwidth:c,hheight:u}}}])})(),L6=(function(){function r(){ot(this,r)}return lt(r,[{key:"update",value:function(e){if(e.points&&cr(e.points.points)){var n=e.points.points,i=Math.min.apply(Math,ne(n.map(function(d){return d[0]}))),a=Math.max.apply(Math,ne(n.map(function(d){return d[0]}))),s=Math.min.apply(Math,ne(n.map(function(d){return d[1]}))),o=Math.max.apply(Math,ne(n.map(function(d){return d[1]}))),l=a-i,c=o-s,u=l/2,h=c/2;return{cx:i+u,cy:s+h,hwidth:u,hheight:h}}return{cx:0,cy:0,hwidth:0,hheight:0}}}])})(),I6=(function(){function r(){ot(this,r)}return lt(r,[{key:"update",value:function(e,n){var i=e.x,a=i===void 0?0:i,s=e.y,o=s===void 0?0:s,l=e.src,c=e.width,u=c===void 0?0:c,h=e.height,d=h===void 0?0:h,f=u,g=d;return l&&!ae(l)&&(f||(f=l.width,e.width=f),g||(g=l.height,e.height=g)),{cx:a+f/2,cy:o+g/2,hwidth:f/2,hheight:g/2}}}])})(),D6=(function(){function r(t){ot(this,r),this.globalRuntime=t}return lt(r,[{key:"isReadyToMeasure",value:function(e,n){var i=e.text;return i}},{key:"update",value:function(e,n){var i,a=e.text,s=e.textAlign,o=s===void 0?"start":s,l=e.lineWidth,c=l===void 0?1:l,u=e.textBaseline,h=u===void 0?"alphabetic":u,d=e.dx,f=d===void 0?0:d,g=e.dy,v=g===void 0?0:g,p=e.x,y=p===void 0?0:p,m=e.y,x=m===void 0?0:m;if(!this.isReadyToMeasure(e,n))return e.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var E=(n==null||(i=n.ownerDocument)===null||i===void 0||(i=i.defaultView)===null||i===void 0?void 0:i.getConfig())||{},_=E.offscreenCanvas,M=this.globalRuntime.textService.measureText(a,e,_);e.metrics=M;var O=M.width,T=M.height,N=O/2,P=T/2,C=y+N;o==="center"||o==="middle"?C+=c/2-N:(o==="right"||o==="end")&&(C+=c-N*2);var R=x-P;return h==="middle"?R+=P:h==="top"||h==="hanging"?R+=P*2:h==="alphabetic"||(h==="bottom"||h==="ideographic")&&(R+=0),f&&(C+=f),v&&(R+=v),{cx:C,cy:R,hwidth:N,hheight:P}}}])})(),F6=(function(){function r(){ot(this,r)}return lt(r,[{key:"update",value:function(e,n){return{cx:0,cy:0,hwidth:0,hheight:0}}}])})(),B6=(function(){function r(){ot(this,r)}return lt(r,[{key:"update",value:function(e,n){var i=e.x,a=i===void 0?0:i,s=e.y,o=s===void 0?0:s,l=e.width,c=l===void 0?0:l,u=e.height,h=u===void 0?0:u;return{cx:a+c/2,cy:o+h/2,hwidth:c/2,hheight:h/2}}}])})(),Ru=(function(){function r(t){ot(this,r),this.eventPhase=r.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new Tn,this.page=new Tn,this.canvas=new Tn,this.viewport=new Tn,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}return lt(r,[{key:"name",get:function(){return this.type}},{key:"layerX",get:function(){return this.layer.x}},{key:"layerY",get:function(){return this.layer.y}},{key:"pageX",get:function(){return this.page.x}},{key:"pageY",get:function(){return this.page.y}},{key:"x",get:function(){return this.canvas.x}},{key:"y",get:function(){return this.canvas.y}},{key:"canvasX",get:function(){return this.canvas.x}},{key:"canvasY",get:function(){return this.canvas.y}},{key:"viewportX",get:function(){return this.viewport.x}},{key:"viewportY",get:function(){return this.viewport.y}},{key:"composedPath",value:function(){return this.manager&&(!this.path||this.path[0]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}},{key:"propagationPath",get:function(){return this.composedPath()}},{key:"preventDefault",value:function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"initEvent",value:function(){}},{key:"initUIEvent",value:function(){}},{key:"clone",value:function(){throw new Error(he)}}])})(),pA=(function(r){function t(){var e;ot(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=Yt(this,t,[].concat(i)),e.client=new Tn,e.movement=new Tn,e.offset=new Tn,e.global=new Tn,e.screen=new Tn,e}return Ht(t,r),lt(t,[{key:"clientX",get:function(){return this.client.x}},{key:"clientY",get:function(){return this.client.y}},{key:"movementX",get:function(){return this.movement.x}},{key:"movementY",get:function(){return this.movement.y}},{key:"offsetX",get:function(){return this.offset.x}},{key:"offsetY",get:function(){return this.offset.y}},{key:"globalX",get:function(){return this.global.x}},{key:"globalY",get:function(){return this.global.y}},{key:"screenX",get:function(){return this.screen.x}},{key:"screenY",get:function(){return this.screen.y}},{key:"getModifierState",value:function(n){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(n)}},{key:"initMouseEvent",value:function(){throw new Error(he)}}])})(Ru),ou=(function(r){function t(){var e;ot(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=Yt(this,t,[].concat(i)),e.width=0,e.height=0,e.isPrimary=!1,e}return Ht(t,r),lt(t,[{key:"getCoalescedEvents",value:function(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}},{key:"getPredictedEvents",value:function(){throw new Error("getPredictedEvents is not supported!")}},{key:"clone",value:function(){return this.manager.clonePointerEvent(this)}}])})(pA),wm=(function(r){function t(){return ot(this,t),Yt(this,t,arguments)}return Ht(t,r),lt(t,[{key:"clone",value:function(){return this.manager.cloneWheelEvent(this)}}])})(pA),rn=(function(r){function t(e,n){var i;return ot(this,t),i=Yt(this,t,[null]),i.type=e,i.detail=n,Object.assign(i,n),i}return Ht(t,r),lt(t)})(Ru),yA=(function(){function r(){ot(this,r),this.emitter=new eO}return lt(r,[{key:"on",value:function(e,n,i){return this.addEventListener(e,n,i),this}},{key:"addEventListener",value:function(e,n,i){var a=!1,s=!1;if(qo(i))a=i;else if(i){var o=i.capture;a=o===void 0?!1:o;var l=i.once;s=l===void 0?!1:l}a&&(e+="capture"),n=Tt(n)?n:n.handleEvent;var c=Tt(n)?void 0:n;return s?this.emitter.once(e,n,c):this.emitter.on(e,n,c),this}},{key:"off",value:function(e,n,i){return e?this.removeEventListener(e,n,i):this.removeAllEventListeners(),this}},{key:"removeAllEventListeners",value:function(){var e;(e=this.emitter)===null||e===void 0||e.removeAllListeners()}},{key:"removeEventListener",value:function(e,n,i){var a;if(!this.emitter)return this;var s=qo(i)?i:i==null?void 0:i.capture;s&&(e+="capture"),n=Tt(n)?n:(a=n)===null||a===void 0?void 0:a.handleEvent;var o=Tt(n)?void 0:n;return this.emitter.off(e,n,o),this}},{key:"emit",value:function(e,n){this.dispatchEvent(new rn(e,n))}},{key:"dispatchEventToSelf",value:function(e){e.target||(e.target=this),e.currentTarget=this,this.emitter.emit(e.type,e)}},{key:"dispatchEvent",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2?arguments[2]:void 0;if(i)return this.dispatchEventToSelf(e),!0;var a;if(this.document)a=this;else if(this.defaultView)a=this.defaultView;else{var s;a=(s=this.ownerDocument)===null||s===void 0?void 0:s.defaultView}if(a){if(e.manager=a.getEventService(),!e.manager)return!1;e.defaultPrevented=!1,e.path?e.path.length=0:e.page=[],n||(e.target=this),e.manager.dispatchEvent(e,e.type,n)}else this.dispatchEventToSelf(e);return!e.defaultPrevented}}])})(),De=(function(r){function t(){var e;ot(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=Yt(this,t,[].concat(i)),e.shadow=!1,e.ownerDocument=null,e.isConnected=!1,e.baseURI="",e.childNodes=[],e.nodeType=0,e.nodeName="",e.nodeValue=null,e.parentNode=null,e.destroyed=!1,e}return Ht(t,r),lt(t,[{key:"textContent",get:function(){var n="";this.nodeName===nt.TEXT&&(n+=this.style.text);var i=La(this.childNodes),a;try{for(i.s();!(a=i.n()).done;){var s=a.value;s.nodeName===nt.TEXT?n+=s.nodeValue:n+=s.textContent}}catch(o){i.e(o)}finally{i.f()}return n},set:function(n){var i=this;this.childNodes.slice().forEach(function(a){i.removeChild(a)}),this.nodeName===nt.TEXT&&(this.style.text="".concat(n))}},{key:"getRootNode",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.parentNode?this.parentNode.getRootNode(n):n.composed&&this.host?this.host.getRootNode(n):this}},{key:"hasChildNodes",value:function(){return this.childNodes.length>0}},{key:"isDefaultNamespace",value:function(n){throw new Error(he)}},{key:"lookupNamespaceURI",value:function(n){throw new Error(he)}},{key:"lookupPrefix",value:function(n){throw new Error(he)}},{key:"normalize",value:function(){throw new Error(he)}},{key:"isEqualNode",value:function(n){return this===n}},{key:"isSameNode",value:function(n){return this.isEqualNode(n)}},{key:"parent",get:function(){return this.parentNode}},{key:"parentElement",get:function(){return null}},{key:"nextSibling",get:function(){return null}},{key:"previousSibling",get:function(){return null}},{key:"firstChild",get:function(){return this.childNodes.length>0?this.childNodes[0]:null}},{key:"lastChild",get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null}},{key:"compareDocumentPosition",value:function(n){if(n===this)return 0;for(var i=n,a=this,s=[i],o=[a];(l=i.parentNode)!==null&&l!==void 0?l:a.parentNode;){var l;i=i.parentNode?(s.push(i.parentNode),i.parentNode):i,a=a.parentNode?(o.push(a.parentNode),a.parentNode):a}if(i!==a)return t.DOCUMENT_POSITION_DISCONNECTED|t.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|t.DOCUMENT_POSITION_PRECEDING;var c=s.length>o.length?s:o,u=c===s?o:s;if(c[c.length-u.length]===u[0])return c===s?t.DOCUMENT_POSITION_CONTAINED_BY|t.DOCUMENT_POSITION_FOLLOWING:t.DOCUMENT_POSITION_CONTAINS|t.DOCUMENT_POSITION_PRECEDING;for(var h=c.length-u.length,d=u.length-1;d>=0;d--){var f=u[d],g=c[h+d];if(g!==f){var v=f.parentNode.childNodes;return v.indexOf(f)<v.indexOf(g)?u===s?t.DOCUMENT_POSITION_PRECEDING:t.DOCUMENT_POSITION_FOLLOWING:c===s?t.DOCUMENT_POSITION_PRECEDING:t.DOCUMENT_POSITION_FOLLOWING}}return t.DOCUMENT_POSITION_FOLLOWING}},{key:"contain",value:function(n){return this.contains(n)}},{key:"contains",value:function(n){for(var i=n;i&&this!==i;)i=i.parentNode;return!!i}},{key:"getAncestor",value:function(n){for(var i=this;n>0&&i;)i=i.parentNode,n--;return i}},{key:"forEach",value:function(n){for(var i=[this];i.length>0;){var a=i.pop(),s=n(a);if(s===!1)break;for(var o=a.childNodes.length-1;o>=0;o--)i.push(a.childNodes[o])}}}],[{key:"isNode",value:function(n){return!!n.childNodes}}])})(yA);De.DOCUMENT_POSITION_DISCONNECTED=1;De.DOCUMENT_POSITION_PRECEDING=2;De.DOCUMENT_POSITION_FOLLOWING=4;De.DOCUMENT_POSITION_CONTAINS=8;De.DOCUMENT_POSITION_CONTAINED_BY=16;De.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32;var z6=2048,j6=(function(){function r(t,e){var n=this;ot(this,r),this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=ve(),this.tmpVec3=te(),this.onPointerDown=function(i){var a=n.createPointerEvent(i);if(n.dispatchEvent(a,"pointerdown"),a.pointerType==="touch")n.dispatchEvent(a,"touchstart");else if(a.pointerType==="mouse"||a.pointerType==="pen"){var s=a.button===2;n.dispatchEvent(a,s?"rightdown":"mousedown")}var o=n.trackingData(i.pointerId);o.pressTargetsByButton[i.button]=a.composedPath(),n.freeEvent(a)},this.onPointerUp=function(i){var a=xm.now(),s=n.createPointerEvent(i,void 0,void 0,n.context.config.alwaysTriggerPointerEventOnCanvas?n.rootTarget:void 0);if(n.dispatchEvent(s,"pointerup"),s.pointerType==="touch")n.dispatchEvent(s,"touchend");else if(s.pointerType==="mouse"||s.pointerType==="pen"){var o=s.button===2;n.dispatchEvent(s,o?"rightup":"mouseup")}var l=n.trackingData(i.pointerId),c=n.findMountedTarget(l.pressTargetsByButton[i.button]),u=c;if(c&&!s.composedPath().includes(c)){for(var h=c;h&&!s.composedPath().includes(h);){if(s.currentTarget=h,n.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch")n.notifyTarget(s,"touchendoutside");else if(s.pointerType==="mouse"||s.pointerType==="pen"){var d=s.button===2;n.notifyTarget(s,d?"rightupoutside":"mouseupoutside")}De.isNode(h)&&(h=h.parentNode)}delete l.pressTargetsByButton[i.button],u=h}if(u){var f,g=n.clonePointerEvent(s,"click");g.target=u,g.path=[],l.clicksByButton[i.button]||(l.clicksByButton[i.button]={clickCount:0,target:g.target,timeStamp:a});var v=n.context.renderingContext.root.ownerDocument.defaultView,p=l.clicksByButton[i.button];p.target===g.target&&a-p.timeStamp<v.getConfig().dblClickSpeed?++p.clickCount:p.clickCount=1,p.target=g.target,p.timeStamp=a,g.detail=p.clickCount,(f=s.detail)!==null&&f!==void 0&&f.preventClick||(!n.context.config.useNativeClickEvent&&(g.pointerType==="mouse"||g.pointerType==="touch")&&n.dispatchEvent(g,"click"),n.dispatchEvent(g,"pointertap")),n.freeEvent(g)}n.freeEvent(s)},this.onPointerMove=function(i){var a=n.createPointerEvent(i,void 0,void 0,n.context.config.alwaysTriggerPointerEventOnCanvas?n.rootTarget:void 0),s=a.pointerType==="mouse"||a.pointerType==="pen",o=n.trackingData(i.pointerId),l=n.findMountedTarget(o.overTargets);if(o.overTargets&&l!==a.target){var c=i.type==="mousemove"?"mouseout":"pointerout",u=n.createPointerEvent(i,c,l||void 0);if(n.dispatchEvent(u,"pointerout"),s&&n.dispatchEvent(u,"mouseout"),!a.composedPath().includes(l)){var h=n.createPointerEvent(i,"pointerleave",l||void 0);for(h.eventPhase=h.AT_TARGET;h.target&&!a.composedPath().includes(h.target);)h.currentTarget=h.target,n.notifyTarget(h),s&&n.notifyTarget(h,"mouseleave"),De.isNode(h.target)&&(h.target=h.target.parentNode);n.freeEvent(h)}n.freeEvent(u)}if(l!==a.target){var d=i.type==="mousemove"?"mouseover":"pointerover",f=n.clonePointerEvent(a,d);n.dispatchEvent(f,"pointerover"),s&&n.dispatchEvent(f,"mouseover");for(var g=l&&De.isNode(l)&&l.parentNode;g&&g!==(De.isNode(n.rootTarget)&&n.rootTarget.parentNode)&&g!==a.target;)g=g.parentNode;var v=!g||g===(De.isNode(n.rootTarget)&&n.rootTarget.parentNode);if(v){var p=n.clonePointerEvent(a,"pointerenter");for(p.eventPhase=p.AT_TARGET;p.target&&p.target!==l&&p.target!==(De.isNode(n.rootTarget)&&n.rootTarget.parentNode);)p.currentTarget=p.target,n.notifyTarget(p),s&&n.notifyTarget(p,"mouseenter"),De.isNode(p.target)&&(p.target=p.target.parentNode);n.freeEvent(p)}n.freeEvent(f)}n.dispatchEvent(a,"pointermove"),a.pointerType==="touch"&&n.dispatchEvent(a,"touchmove"),s&&(n.dispatchEvent(a,"mousemove"),n.cursor=n.getCursor(a.target)),o.overTargets=a.composedPath(),n.freeEvent(a)},this.onPointerOut=function(i){var a=n.trackingData(i.pointerId);if(a.overTargets){var s=i.pointerType==="mouse"||i.pointerType==="pen",o=n.findMountedTarget(a.overTargets),l=n.createPointerEvent(i,"pointerout",o||void 0);n.dispatchEvent(l),s&&n.dispatchEvent(l,"mouseout");var c=n.createPointerEvent(i,"pointerleave",o||void 0);for(c.eventPhase=c.AT_TARGET;c.target&&c.target!==(De.isNode(n.rootTarget)&&n.rootTarget.parentNode);)c.currentTarget=c.target,n.notifyTarget(c),s&&n.notifyTarget(c,"mouseleave"),De.isNode(c.target)&&(c.target=c.target.parentNode);a.overTargets=null,n.freeEvent(l),n.freeEvent(c)}n.cursor=null},this.onPointerOver=function(i){var a=n.trackingData(i.pointerId),s=n.createPointerEvent(i),o=s.pointerType==="mouse"||s.pointerType==="pen";n.dispatchEvent(s,"pointerover"),o&&n.dispatchEvent(s,"mouseover"),s.pointerType==="mouse"&&(n.cursor=n.getCursor(s.target));var l=n.clonePointerEvent(s,"pointerenter");for(l.eventPhase=l.AT_TARGET;l.target&&l.target!==(De.isNode(n.rootTarget)&&n.rootTarget.parentNode);)l.currentTarget=l.target,n.notifyTarget(l),o&&n.notifyTarget(l,"mouseenter"),De.isNode(l.target)&&(l.target=l.target.parentNode);a.overTargets=s.composedPath(),n.freeEvent(s),n.freeEvent(l)},this.onPointerUpOutside=function(i){var a=n.trackingData(i.pointerId),s=n.findMountedTarget(a.pressTargetsByButton[i.button]),o=n.createPointerEvent(i);if(s){for(var l=s;l;)o.currentTarget=l,n.notifyTarget(o,"pointerupoutside"),o.pointerType==="touch"||(o.pointerType==="mouse"||o.pointerType==="pen")&&n.notifyTarget(o,o.button===2?"rightupoutside":"mouseupoutside"),De.isNode(l)&&(l=l.parentNode);delete a.pressTargetsByButton[i.button]}n.freeEvent(o)},this.onWheel=function(i){var a=n.createWheelEvent(i);n.dispatchEvent(a),n.freeEvent(a)},this.onClick=function(i){if(n.context.config.useNativeClickEvent){var a=n.createPointerEvent(i);n.dispatchEvent(a),n.freeEvent(a)}},this.onPointerCancel=function(i){var a=n.createPointerEvent(i,void 0,void 0,n.context.config.alwaysTriggerPointerEventOnCanvas?n.rootTarget:void 0);n.dispatchEvent(a),n.freeEvent(a)},this.globalRuntime=t,this.context=e}return lt(r,[{key:"init",value:function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick)}},{key:"destroy",value:function(){this.mappingTable={},this.mappingState={},this.eventPool.clear()}},{key:"getScale",value:function(){var e=this.context.contextService.getBoundingClientRect(),n=1,i=1,a=this.context.contextService.getDomElement();if(a&&e){var s=a.offsetWidth,o=a.offsetHeight;s&&o&&(n=e.width/s,i=e.height/o)}return{scaleX:n,scaleY:i,bbox:e}}},{key:"client2Viewport",value:function(e){var n=this.getScale(),i=n.scaleX,a=n.scaleY,s=n.bbox;return new Tn((e.x-((s==null?void 0:s.left)||0))/i,(e.y-((s==null?void 0:s.top)||0))/a)}},{key:"viewport2Client",value:function(e){var n=this.getScale(),i=n.scaleX,a=n.scaleY,s=n.bbox;return new Tn((e.x+((s==null?void 0:s.left)||0))*i,(e.y+((s==null?void 0:s.top)||0))*a)}},{key:"viewport2Canvas",value:function(e){var n=e.x,i=e.y,a=this.rootTarget.defaultView,s=a.getCamera(),o=this.context.config,l=o.width,c=o.height,u=s.getPerspectiveInverse(),h=s.getWorldTransform(),d=Bn(this.tmpMatrix,h,u),f=Fn(this.tmpVec3,n/l*2-1,(1-i/c)*2-1,0);return zn(f,f,d),new Tn(f[0],f[1])}},{key:"canvas2Viewport",value:function(e){var n=this.rootTarget.defaultView,i=n.getCamera(),a=i.getPerspective(),s=i.getViewTransform(),o=Bn(this.tmpMatrix,a,s),l=Fn(this.tmpVec3,e.x,e.y,0);zn(this.tmpVec3,this.tmpVec3,o);var c=this.context.config,u=c.width,h=c.height;return new Tn((l[0]+1)/2*u,(1-(l[1]+1)/2)*h)}},{key:"setPickHandler",value:function(e){this.pickHandler=e}},{key:"addEventMapping",value:function(e,n){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:n,priority:0}),this.mappingTable[e].sort(function(i,a){return i.priority-a.priority})}},{key:"mapEvent",value:function(e){if(this.rootTarget){var n=this.mappingTable[e.type];if(n)for(var i=0,a=n.length;i<a;i++)n[i].fn(e);else console.warn("[EventService]: Event mapping not defined for ".concat(e.type))}}},{key:"dispatchEvent",value:function(e,n,i){if(!i)e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,n);else{e.eventPhase=e.AT_TARGET;var a=this.rootTarget.defaultView||null;e.currentTarget=a,this.notifyListeners(e,n)}}},{key:"propagate",value:function(e,n){if(e.target){var i=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(var a=i.length-1;a>=1;a--)if(e.currentTarget=i[a],this.notifyTarget(e,n),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,n),!(e.propagationStopped||e.propagationImmediatelyStopped)){var s=i.indexOf(e.currentTarget);e.eventPhase=e.BUBBLING_PHASE;for(var o=s+1;o<i.length;o++)if(e.currentTarget=i[o],this.notifyTarget(e,n),e.propagationStopped||e.propagationImmediatelyStopped)return}}}},{key:"propagationPath",value:function(e){var n=[e],i=this.rootTarget.defaultView||null;if(i&&i===e)return n.unshift(i.document),n;for(var a=0;a<z6&&e!==this.rootTarget;a++)De.isNode(e)&&e.parentNode&&(n.push(e.parentNode),e=e.parentNode);return i&&n.push(i),n}},{key:"hitTest",value:function(e){var n=e.viewportX,i=e.viewportY,a=this.context.config,s=a.width,o=a.height,l=a.disableHitTesting;return n<0||i<0||n>s||i>o?null:!l&&this.pickHandler(e)||this.rootTarget||null}},{key:"isNativeEventFromCanvas",value:function(e,n){var i,a=n==null?void 0:n.target;if((i=a)!==null&&i!==void 0&&i.shadowRoot&&(a=n.composedPath()[0]),a){if(a===e)return!0;if(e&&e.contains)return e.contains(a)}return n!=null&&n.composedPath?n.composedPath().indexOf(e)>-1:!1}},{key:"getExistedHTML",value:function(e){if(e.nativeEvent.composedPath)for(var n=0,i=e.nativeEvent.composedPath();n<i.length;n++){var a=i[n],s=this.nativeHTMLMap.get(a);if(s)return s}return null}},{key:"pickTarget",value:function(e){return this.hitTest({clientX:e.clientX,clientY:e.clientY,viewportX:e.viewportX,viewportY:e.viewportY,x:e.canvasX,y:e.canvasY})}},{key:"createPointerEvent",value:function(e,n,i,a){var s=this.allocateEvent(ou);this.copyPointerData(e,s),this.copyMouseData(e,s),this.copyData(e,s),s.nativeEvent=e.nativeEvent,s.originalEvent=e;var o=this.getExistedHTML(s),l=this.context.contextService.getDomElement();return s.target=i??(o||this.isNativeEventFromCanvas(l,s.nativeEvent)&&this.pickTarget(s)||a),typeof n=="string"&&(s.type=n),s}},{key:"createWheelEvent",value:function(e){var n=this.allocateEvent(wm);this.copyWheelData(e,n),this.copyMouseData(e,n),this.copyData(e,n),n.nativeEvent=e.nativeEvent,n.originalEvent=e;var i=this.getExistedHTML(n),a=this.context.contextService.getDomElement();return n.target=i||this.isNativeEventFromCanvas(a,n.nativeEvent)&&this.pickTarget(n),n}},{key:"trackingData",value:function(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]}},{key:"cloneWheelEvent",value:function(e){var n=this.allocateEvent(wm);return n.nativeEvent=e.nativeEvent,n.originalEvent=e.originalEvent,this.copyWheelData(e,n),this.copyMouseData(e,n),this.copyData(e,n),n.target=e.target,n.path=e.composedPath().slice(),n.type=e.type,n}},{key:"clonePointerEvent",value:function(e,n){var i=this.allocateEvent(ou);return i.nativeEvent=e.nativeEvent,i.originalEvent=e.originalEvent,this.copyPointerData(e,i),this.copyMouseData(e,i),this.copyData(e,i),i.target=e.target,i.path=e.composedPath().slice(),i.type=n??i.type,i}},{key:"copyPointerData",value:function(e,n){n.pointerId=e.pointerId,n.width=e.width,n.height=e.height,n.isPrimary=e.isPrimary,n.pointerType=e.pointerType,n.pressure=e.pressure,n.tangentialPressure=e.tangentialPressure,n.tiltX=e.tiltX,n.tiltY=e.tiltY,n.twist=e.twist}},{key:"copyMouseData",value:function(e,n){n.altKey=e.altKey,n.button=e.button,n.buttons=e.buttons,n.ctrlKey=e.ctrlKey,n.metaKey=e.metaKey,n.shiftKey=e.shiftKey,n.client.copyFrom(e.client),n.movement.copyFrom(e.movement),n.canvas.copyFrom(e.canvas),n.screen.copyFrom(e.screen),n.global.copyFrom(e.global),n.offset.copyFrom(e.offset)}},{key:"copyWheelData",value:function(e,n){n.deltaMode=e.deltaMode,n.deltaX=e.deltaX,n.deltaY=e.deltaY,n.deltaZ=e.deltaZ}},{key:"copyData",value:function(e,n){n.isTrusted=e.isTrusted,n.timeStamp=xm.now(),n.type=e.type,n.detail=e.detail,n.view=e.view,n.page.copyFrom(e.page),n.viewport.copyFrom(e.viewport)}},{key:"allocateEvent",value:function(e){this.eventPool.has(e)||this.eventPool.set(e,[]);var n=this.eventPool.get(e).pop()||new e(this);return n.eventPhase=n.NONE,n.currentTarget=null,n.path=[],n.target=null,n}},{key:"freeEvent",value:function(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");var n=e.constructor;this.eventPool.has(n)||this.eventPool.set(n,[]),this.eventPool.get(n).push(e)}},{key:"notifyTarget",value:function(e,n){n=n??e.type;var i=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?"".concat(n,"capture"):n;this.notifyListeners(e,i),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,n)}},{key:"notifyListeners",value:function(e,n){var i=e.currentTarget.emitter,a=i._events[n];if(a)if("fn"in a)a.once&&i.removeListener(n,a.fn,void 0,!0),a.fn.call(e.currentTarget||a.context,e);else for(var s=0;s<a.length&&!e.propagationImmediatelyStopped;s++)a[s].once&&i.removeListener(n,a[s].fn,void 0,!0),a[s].fn.call(e.currentTarget||a[s].context,e)}},{key:"findMountedTarget",value:function(e){if(!e)return null;for(var n=e[e.length-1],i=e.length-2;i>=0;i--){var a=e[i];if(a===this.rootTarget||De.isNode(a)&&a.parentNode===n)n=e[i];else break}return n}},{key:"getCursor",value:function(e){for(var n=e;n;){var i=n6(n)&&n.getAttribute("cursor");if(i)return i;n=De.isNode(n)&&n.parentNode}}}])})(),w1=(function(){function r(){ot(this,r)}return lt(r,[{key:"getOrCreateCanvas",value:function(e,n){if(this.canvas)return this.canvas;if(e||ct.offscreenCanvas)this.canvas=e||ct.offscreenCanvas,this.context=this.canvas.getContext("2d",Vt({willReadFrequently:!0},n));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",Vt({willReadFrequently:!0},n)),(!this.context||!this.context.measureText)&&(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"))}catch{this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",Vt({willReadFrequently:!0},n))}return this.canvas.width=10,this.canvas.height=10,this.canvas}},{key:"getOrCreateContext",value:function(e,n){return this.context?this.context:(this.getOrCreateCanvas(e,n),this.context)}}],[{key:"createCanvas",value:function(){try{return new window.OffscreenCanvas(0,0)}catch{}try{return document.createElement("canvas")}catch{}return null}}])})(),Is=(function(r){return r[r.CAMERA_CHANGED=0]="CAMERA_CHANGED",r[r.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",r[r.NONE=2]="NONE",r})({}),q6=(function(){function r(t,e){ot(this,r),this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new jn,initAsync:new m6,dirtycheck:new Nd,cull:new Nd,beginFrame:new jn,beforeRender:new jn,render:new jn,afterRender:new jn,endFrame:new jn,destroy:new jn,pick:new b6,pickSync:new Nd,pointerDown:new jn,pointerUp:new jn,pointerMove:new jn,pointerOut:new jn,pointerOver:new jn,pointerWheel:new jn,pointerCancel:new jn,click:new jn},this.globalRuntime=t,this.context=e}return lt(r,[{key:"init",value:function(e){var n=this,i=Vt(Vt({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach(function(a){a.apply(i,n.globalRuntime)}),this.hooks.init.call(),this.hooks.initAsync.getCallbacksNum()===0?(this.inited=!0,e()):this.hooks.initAsync.promise().then(function(){n.inited=!0,e()}).catch(function(a){})}},{key:"getStats",value:function(){return this.stats}},{key:"disableDirtyRectangleRendering",value:function(){var e=this.context.config.renderer,n=e.getConfig(),i=n.enableDirtyRectangleRendering;return!i||this.context.renderingContext.renderReasons.has(Is.CAMERA_CHANGED)}},{key:"render",value:function(e,n,i){var a=this;this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0;var s=this.context.renderingContext;if(this.globalRuntime.sceneGraphService.syncHierarchy(s.root),this.globalRuntime.sceneGraphService.triggerPendingEvents(),s.renderReasons.size&&this.inited){s.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var o=s.renderReasons.size===1&&s.renderReasons.has(Is.CAMERA_CHANGED),l=!e.disableRenderHooks||!o;l&&this.renderDisplayObject(s.root,e,s),this.hooks.beginFrame.call(n),l&&s.renderListCurrentFrame.forEach(function(c){a.hooks.beforeRender.call(c),a.hooks.render.call(c),a.hooks.afterRender.call(c)}),this.hooks.endFrame.call(n),s.renderListCurrentFrame=[],s.renderReasons.clear(),i()}}},{key:"renderDisplayObject",value:function(e,n,i){var a=this,s=n.renderer.getConfig(),o=s.enableDirtyCheck,l=s.enableCulling;function c(v){var p=v.renderable,y=v.sortable,m=o?p.dirty||i.dirtyRectangleRenderingDisabled?v:null:v,x=null;m&&(x=l?a.hooks.cull.call(m,a.context.camera):m,x&&(a.stats.rendered+=1,i.renderListCurrentFrame.push(x))),v.dirty(!1),y.renderOrder=a.zIndexCounter,a.zIndexCounter+=1,a.stats.total+=1,y.dirty&&(a.sort(v,y),y.dirty=!1,y.dirtyChildren=[],y.dirtyReason=void 0)}for(var u=[e];u.length>0;){var h,d=u.pop();c(d);for(var f=((h=d.sortable)===null||h===void 0||(h=h.sorted)===null||h===void 0?void 0:h.length)>0?d.sortable.sorted:d.childNodes,g=f.length-1;g>=0;g--)u.push(f[g])}}},{key:"sort",value:function(e,n){var i,a;(n==null||(i=n.sorted)===null||i===void 0?void 0:i.length)>0&&n.dirtyReason!==eu.Z_INDEX_CHANGED?n.dirtyChildren.forEach(function(s){var o=n.sorted.indexOf(s);o>-1&&n.sorted.splice(o,1);var l=e.childNodes.indexOf(s);if(l>-1)if(n.sorted.length===0)n.sorted.push(s);else{var c=r6(n.sorted,s);n.sorted.splice(c,0,s)}}):n.sorted=e.childNodes.slice().sort(cA),((a=n.sorted)===null||a===void 0?void 0:a.length)>0&&e.childNodes.filter(function(s){return s.parsedStyle.zIndex}).length===0&&(n.sorted=[])}},{key:"destroy",value:function(){this.inited=!1,this.hooks.destroy.call(),this.globalRuntime.sceneGraphService.clearPendingEvents()}},{key:"dirtify",value:function(){this.context.renderingContext.renderReasons.add(Is.DISPLAY_OBJECT_CHANGED)}}])})(),G6=/\[\s*(.*)=(.*)\s*\]/,$6=(function(){function r(){ot(this,r)}return lt(r,[{key:"selectOne",value:function(e,n){var i=this;if(e.startsWith("."))return n.find(function(l){return((l==null?void 0:l.classList)||[]).indexOf(i.getIdOrClassname(e))>-1});if(e.startsWith("#"))return n.find(function(l){return l.id===i.getIdOrClassname(e)});if(e.startsWith("[")){var a=this.getAttribute(e),s=a.name,o=a.value;return s?n.find(function(l){return n!==l&&(s==="name"?l.name===o:i.attributeToString(l,s)===o)}):null}return n.find(function(l){return n!==l&&l.nodeName===e})}},{key:"selectAll",value:function(e,n){var i=this;if(e.startsWith("."))return n.findAll(function(l){return n!==l&&((l==null?void 0:l.classList)||[]).indexOf(i.getIdOrClassname(e))>-1});if(e.startsWith("#"))return n.findAll(function(l){return n!==l&&l.id===i.getIdOrClassname(e)});if(e.startsWith("[")){var a=this.getAttribute(e),s=a.name,o=a.value;return s?n.findAll(function(l){return n!==l&&(s==="name"?l.name===o:i.attributeToString(l,s)===o)}):[]}return n.findAll(function(l){return n!==l&&l.nodeName===e})}},{key:"is",value:function(e,n){if(e.startsWith("."))return n.className===this.getIdOrClassname(e);if(e.startsWith("#"))return n.id===this.getIdOrClassname(e);if(e.startsWith("[")){var i=this.getAttribute(e),a=i.name,s=i.value;return a==="name"?n.name===s:this.attributeToString(n,a)===s}return n.nodeName===e}},{key:"getIdOrClassname",value:function(e){return e.substring(1)}},{key:"getAttribute",value:function(e){var n=e.match(G6),i="",a="";return n&&n.length>2&&(i=n[1].replace(/"/g,""),a=n[2].replace(/"/g,"")),{name:i,value:a}}},{key:"attributeToString",value:function(e,n){if(!e.getAttribute)return"";var i=e.getAttribute(n);return Rt(i)?"":i.toString?i.toString():""}}])})(),Jt=(function(r){return r.ATTR_MODIFIED="DOMAttrModified",r.INSERTED="DOMNodeInserted",r.MOUNTED="DOMNodeInsertedIntoDocument",r.REMOVED="removed",r.UNMOUNTED="DOMNodeRemovedFromDocument",r.REPARENT="reparent",r.DESTROY="destroy",r.BOUNDS_CHANGED="bounds-changed",r.CULLED="culled",r})({}),yi=(function(r){function t(e,n,i,a,s,o,l,c){var u;return ot(this,t),u=Yt(this,t,[null]),u.relatedNode=n,u.prevValue=i,u.newValue=a,u.attrName=s,u.attrChange=o,u.prevParsedValue=l,u.newParsedValue=c,u.type=e,u}return Ht(t,r),lt(t)})(Ru);yi.ADDITION=2;yi.MODIFICATION=1;yi.REMOVAL=3;var W6=new yi(Jt.REPARENT,null,"","","",0,"",""),V6=u1(),$l=te(),U6=we(1,1,1),Y6=ve(),H6=u1(),_a=te(),X6=ve(),ka=nn(),K6=te(),Z6=nn(),J6=te(),ho=te(),Ma=te(),Wl=ve(),Px=nn(),Cx=nn(),Vl=nn(),Ul={affectChildren:!0},Q6=(function(){function r(t){ot(this,r),this.pendingEvents=new Map,this.boundsChangedEvent=new rn(Jt.BOUNDS_CHANGED),this.displayObjectDependencyMap=new WeakMap,this.runtime=t}return lt(r,[{key:"matches",value:function(e,n){return this.runtime.sceneGraphSelector.is(e,n)}},{key:"querySelector",value:function(e,n){return this.runtime.sceneGraphSelector.selectOne(e,n)}},{key:"querySelectorAll",value:function(e,n){return this.runtime.sceneGraphSelector.selectAll(e,n)}},{key:"attach",value:function(e,n,i){var a,s=!1;e.parentNode&&(s=e.parentNode!==n,this.detach(e));var o=e.nodeName===nt.FRAGMENT,l=su(n);e.parentNode=n;var c=o?e.childNodes:[e];St(i)?c.forEach(function(v){n.childNodes.splice(i,0,v),v.parentNode=n}):c.forEach(function(v){n.childNodes.push(v),v.parentNode=n});var u=n,h=u.sortable;if((h!=null&&(a=h.sorted)!==null&&a!==void 0&&a.length||h.dirty||e.parsedStyle.zIndex)&&(h.dirtyChildren.indexOf(e)===-1&&h.dirtyChildren.push(e),h.dirty=!0,h.dirtyReason=eu.ADDED),!l){if(o)this.dirtifyFragment(e);else{var d=e.transformable;d&&this.dirtyWorldTransform(e,d)}if(s){var f,g=((f=n.ownerDocument)===null||f===void 0||(f=f.defaultView)===null||f===void 0||(f=f.getConfig())===null||f===void 0||(f=f.future)===null||f===void 0?void 0:f.experimentalCancelEventPropagation)===!0;e.dispatchEvent(W6,g,g)}}}},{key:"detach",value:function(e){var n,i;if(e.parentNode){var a=e.transformable,s=e.parentNode,o=s.sortable;(o!=null&&(n=o.sorted)!==null&&n!==void 0&&n.length||(i=e.style)!==null&&i!==void 0&&i.zIndex)&&(o.dirtyChildren.indexOf(e)===-1&&o.dirtyChildren.push(e),o.dirty=!0,o.dirtyReason=eu.REMOVED);var l=e.parentNode.childNodes.indexOf(e);l>-1&&e.parentNode.childNodes.splice(l,1),a&&this.dirtyWorldTransform(e,a),e.parentNode=null}}},{key:"getLocalPosition",value:function(e){return e.transformable.localPosition}},{key:"getLocalRotation",value:function(e){return e.transformable.localRotation}},{key:"getLocalScale",value:function(e){return e.transformable.localScale}},{key:"getLocalSkew",value:function(e){return e.transformable.localSkew}},{key:"getLocalTransform",value:function(e){var n=e.transformable;return sx(n),n.localTransform}},{key:"setLocalPosition",value:function(e,n){var i,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=e.transformable;ho[0]=n[0],ho[1]=n[1],ho[2]=(i=n[2])!==null&&i!==void 0?i:0,!oo(s.localPosition,ho)&&(di(s.localPosition,ho),a&&this.dirtyLocalTransform(e,s))}},{key:"translateLocal",value:function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof n=="number"&&(n=we(n,i,a));var s=e.transformable;oo(n,$l)||(b3(n,n,s.localRotation),oa(s.localPosition,s.localPosition,n),this.dirtyLocalTransform(e,s))}},{key:"setLocalRotation",value:function(e,n,i,a,s){var o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;typeof n=="number"&&(n=EO(ka,n,i,a,s));var l=e.transformable;Il(l.localRotation,n),o&&this.dirtyLocalTransform(e,l)}},{key:"rotateLocal",value:function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof n=="number"&&(n=we(n,i,a));var s=e.transformable;Ll(Cx,n[0],n[1],n[2]),$b(s.localRotation,s.localRotation,Cx),this.dirtyLocalTransform(e,s)}},{key:"setLocalScale",value:function(e,n){var i,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=e.transformable;Fn(_a,n[0],n[1],(i=n[2])!==null&&i!==void 0?i:s.localScale[2]),!oo(_a,s.localScale)&&(di(s.localScale,_a),a&&this.dirtyLocalTransform(e,s))}},{key:"scaleLocal",value:function(e,n){var i,a=e.transformable;g3(a.localScale,a.localScale,Fn(_a,n[0],n[1],(i=n[2])!==null&&i!==void 0?i:1)),this.dirtyLocalTransform(e,a)}},{key:"setLocalSkew",value:function(e,n,i){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;typeof n=="number"&&(n=T3(H6,n,i));var s=e.transformable;M3(s.localSkew,n),a&&this.dirtyLocalTransform(e,s)}},{key:"setLocalEulerAngles",value:function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;typeof n=="number"&&(n=we(n,i,a));var o=e.transformable;Ll(o.localRotation,n[0],n[1],n[2]),s&&this.dirtyLocalTransform(e,o)}},{key:"setLocalTransform",value:function(e,n){var i=Vc(K6,n),a=Uc(Z6,n),s=zs(J6,n);this.setLocalScale(e,s,!1),this.setLocalPosition(e,i,!1),this.setLocalRotation(e,a,void 0,void 0,void 0,!1),this.dirtyLocalTransform(e,e.transformable)}},{key:"resetLocalTransform",value:function(e){this.setLocalScale(e,U6,!1),this.setLocalPosition(e,$l,!1),this.setLocalEulerAngles(e,$l,void 0,void 0,!1),this.setLocalSkew(e,V6,void 0,!1),this.dirtyLocalTransform(e,e.transformable)}},{key:"getPosition",value:function(e){var n=e.transformable;return Vc(n.position,this.getWorldTransform(e,n))}},{key:"getRotation",value:function(e){var n=e.transformable;return Uc(n.rotation,this.getWorldTransform(e,n))}},{key:"getScale",value:function(e){var n=e.transformable;return zs(n.scaling,this.getWorldTransform(e,n))}},{key:"getOrigin",value:function(e){return e.getGeometryBounds(),e.transformable.origin}},{key:"getWorldTransform",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e.transformable;return!n.localDirtyFlag&&!n.dirtyFlag||(e.parentNode&&e.parentNode.transformable&&this.getWorldTransform(e.parentNode),this.internalUpdateTransform(e)),n.worldTransform}},{key:"setPosition",value:function(e,n){var i,a=e.transformable;if(Ma[0]=n[0],Ma[1]=n[1],Ma[2]=(i=n[2])!==null&&i!==void 0?i:0,!oo(this.getPosition(e),Ma)){if(di(a.position,Ma),e.parentNode===null||!e.parentNode.transformable)di(a.localPosition,Ma);else{var s=e.parentNode.transformable;Bs(Wl,s.worldTransform),hi(Wl,Wl),zn(a.localPosition,Ma,Wl)}this.dirtyLocalTransform(e,a)}}},{key:"translate",value:function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof n=="number"&&(n=Fn(_a,n,i,a)),!oo(n,$l)&&(oa(_a,this.getPosition(e),n),this.setPosition(e,_a))}},{key:"setRotation",value:function(e,n,i,a,s){var o=e.transformable;if(typeof n=="number"&&(n=k3(n,i,a,s)),e.parentNode===null||!e.parentNode.transformable)this.setLocalRotation(e,n);else{var l=this.getRotation(e.parentNode);Il(ka,l),vd(ka,ka),la(o.localRotation,ka,n),Hc(o.localRotation,o.localRotation),this.dirtyLocalTransform(e,o)}}},{key:"rotate",value:function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof n=="number"&&(n=we(n,i,a));var s=e.transformable;if(e.parentNode===null||!e.parentNode.transformable)this.rotateLocal(e,n);else{var o=ka;Ll(o,n[0],n[1],n[2]);var l=this.getRotation(e),c=this.getRotation(e.parentNode);Il(Vl,c),vd(Vl,Vl),la(o,Vl,o),la(s.localRotation,o,l),Hc(s.localRotation,s.localRotation),this.dirtyLocalTransform(e,s)}}},{key:"setOrigin",value:function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof n=="number"&&(n=[n,i,a]);var s=e.transformable;if(!(n[0]===s.origin[0]&&n[1]===s.origin[1]&&n[2]===s.origin[2])){var o=s.origin;o[0]=n[0],o[1]=n[1],o[2]=n[2]||0,this.dirtyLocalTransform(e,s)}}},{key:"setEulerAngles",value:function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof n=="number"&&(n=we(n,i,a));var s=e.transformable;if(e.parentNode===null||!e.parentNode.transformable)this.setLocalEulerAngles(e,n);else{Ll(s.localRotation,n[0],n[1],n[2]);var o=this.getRotation(e.parentNode);Il(Px,vd(ka,o)),$b(s.localRotation,s.localRotation,Px),this.dirtyLocalTransform(e,s)}}},{key:"getTransformedGeometryBounds",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2?arguments[2]:void 0,a=this.getGeometryBounds(e,n);if(!be.isEmpty(a)){var s=i||new be;return s.setFromTransformedAABB(a,this.getWorldTransform(e)),s}return null}},{key:"getGeometryBounds",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=e,a=i.geometry;a.dirty&&ct.styleValueRegistry.updateGeometry(e);var s=n?a.renderBounds:a.contentBounds||null;return s||new be}},{key:"getBounds",value:function(e){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=e,s=a.renderable;if(!s.boundsDirty&&!i&&s.bounds)return s.bounds;if(!s.renderBoundsDirty&&i&&s.renderBounds)return s.renderBounds;var o=i?s.renderBounds:s.bounds,l=this.getTransformedGeometryBounds(e,i,o),c=e.childNodes;if(c.forEach(function(d){var f=n.getBounds(d,i);f&&(l?l.add(f):(l=o||new be,l.update(f.center,f.halfExtents)))}),l||(l=new be),i){var u=uA(e);if(u){var h=u.parsedStyle.clipPath.getBounds(i);l?h&&(l=h.intersection(l)):l.update(h.center,h.halfExtents)}}return i?(s.renderBounds=l,s.renderBoundsDirty=!1):(s.bounds=l,s.boundsDirty=!1),l}},{key:"getLocalBounds",value:function(e){if(e.parentNode){var n=Y6;e.parentNode.transformable&&(n=hi(X6,this.getWorldTransform(e.parentNode)));var i=this.getBounds(e);if(!be.isEmpty(i)){var a=new be;return a.setFromTransformedAABB(i,n),a}}return this.getBounds(e)}},{key:"getBoundingClientRect",value:function(e){var n,i,a=this.getGeometryBounds(e);be.isEmpty(a)||(i=new be,i.setFromTransformedAABB(a,this.getWorldTransform(e)));var s=(n=e.ownerDocument)===null||n===void 0||(n=n.defaultView)===null||n===void 0?void 0:n.getContextService().getBoundingClientRect();if(i){var o=i.getMin(),l=$t(o,2),c=l[0],u=l[1],h=i.getMax(),d=$t(h,2),f=d[0],g=d[1];return new qs(c+((s==null?void 0:s.left)||0),u+((s==null?void 0:s.top)||0),f-c,g-u)}return new qs((s==null?void 0:s.left)||0,(s==null?void 0:s.top)||0,0,0)}},{key:"internalUpdateTransform",value:function(e){var n,i=(n=e.parentNode)===null||n===void 0?void 0:n.transformable;sx(e.transformable),xI(e.transformable,i)}},{key:"internalUpdateElement",value:function(e,n){var i,a,s,o,l=((i=e.ownerDocument)===null||i===void 0||(i=i.defaultView)===null||i===void 0||(i=i.getConfig())===null||i===void 0||(i=i.future)===null||i===void 0?void 0:i.experimentalAttributeUpdateOptimization)===!0,c=n[n.length-1],u=(c==null?void 0:c.transformDirty)||((a=e.transformable)===null||a===void 0?void 0:a.localDirtyFlag);if(e.transformable){var h;(h=e.transformable).dirtyFlag||(h.dirtyFlag=u)}if(this.internalUpdateTransform(e),u){var d;(d=e.dirty)===null||d===void 0||d.call(e,!0,!0)}var f=((s=e.renderable)===null||s===void 0?void 0:s.boundsDirty)||((o=e.renderable)===null||o===void 0?void 0:o.renderBoundsDirty);if((u||f)&&(c==null?void 0:c.shapeUpdated)===!1&&l)for(var g=n.length-1;g>=0;){var v,p,y=n[g];if(y.shapeUpdated)break;(v=(p=y.node).dirty)===null||v===void 0||v.call(p,!0,!0),y.shapeUpdated=!0,g-=1}return u}},{key:"syncHierarchy",value:function(e){for(var n,i,a=[e],s=e.parentNode?[{node:e.parentNode,transformDirty:((n=e.parentNode.transformable)===null||n===void 0?void 0:n.localDirtyFlag)||((i=e.parentNode.transformable)===null||i===void 0?void 0:i.dirtyFlag),shapeUpdated:!1}]:[];a.length>0;){for(var o=a.pop(),l=s[s.length-1];s.length>0&&o.parentNode!==l.node;)l=s.pop();var c=this.internalUpdateElement(o,s);if(o.childNodes.length>0){for(var u=o.childNodes.length-1;u>=0;u--)a.push(o.childNodes[u]);s.push({node:o,transformDirty:c,shapeUpdated:!1})}}}},{key:"dirtyLocalTransform",value:function(e,n){su(e)||n.localDirtyFlag||(n.localDirtyFlag=!0,n.dirtyFlag||this.dirtyWorldTransform(e,n))}},{key:"dirtyWorldTransform",value:function(e,n){this.dirtifyWorldInternal(e,n),this.dirtyToRoot(e,!0)}},{key:"dirtifyWorldInternal",value:function(e,n){var i,a=this,s=((i=e.ownerDocument)===null||i===void 0||(i=i.defaultView)===null||i===void 0||(i=i.getConfig())===null||i===void 0||(i=i.future)===null||i===void 0?void 0:i.experimentalAttributeUpdateOptimization)===!0;n.dirtyFlag||(n.dirtyFlag=!0,e.dirty(!0,!0),s||e.childNodes.forEach(function(o){var l=o.transformable;a.dirtifyWorldInternal(o,l)}))}},{key:"dirtyToRoot",value:function(e){for(var n,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=e,s=((n=e.ownerDocument)===null||n===void 0||(n=n.defaultView)===null||n===void 0||(n=n.getConfig())===null||n===void 0||(n=n.future)===null||n===void 0?void 0:n.experimentalAttributeUpdateOptimization)===!0;a;){var o,l;if((o=(l=a).dirty)===null||o===void 0||o.call(l,!0,!0),s)break;a=a.parentNode}i&&e.forEach(function(c){var u;(u=c.dirty)===null||u===void 0||u.call(c,!0,!0)}),this.informDependentDisplayObjects(e),this.pendingEvents.set(e,i)}},{key:"dirtifyFragment",value:function(e){var n,i,a=e.transformable;a&&(a.dirtyFlag=!0,a.localDirtyFlag=!0),(n=(i=e).dirty)===null||n===void 0||n.call(i,!0,!0);for(var s=e.childNodes.length,o=0;o<s;o++)this.dirtifyFragment(e.childNodes[o]);e.nodeName===nt.FRAGMENT&&this.pendingEvents.set(e,!1)}},{key:"triggerPendingEvents",value:function(){var e=this,n=new Set,i,a,s=function(l,c){if(!(!l.isConnected||n.has(l)||l.nodeName===nt.FRAGMENT)){if(e.boundsChangedEvent.detail=c,e.boundsChangedEvent.target=l,l.isMutationObserved)l.dispatchEvent(e.boundsChangedEvent);else{if(i===void 0){var u;i=((u=l.ownerDocument.defaultView)===null||u===void 0||(u=u.getConfig())===null||u===void 0||(u=u.future)===null||u===void 0?void 0:u.experimentalCancelEventPropagation)===!0}l.ownerDocument.defaultView.dispatchEvent(e.boundsChangedEvent,!0,i)}n.add(l)}};this.pendingEvents.forEach(function(o,l){if(l.nodeName!==nt.FRAGMENT){if(a===void 0){var c;a=((c=l.ownerDocument)===null||c===void 0||(c=c.defaultView)===null||c===void 0||(c=c.getConfig())===null||c===void 0||(c=c.future)===null||c===void 0?void 0:c.experimentalAttributeUpdateOptimization)===!0}Ul.affectChildren=o,a?s(l,Ul):o?l.forEach(function(u){s(u,Ul)}):s(l,Ul)}}),n.clear(),this.clearPendingEvents()}},{key:"clearPendingEvents",value:function(){this.pendingEvents.clear()}},{key:"updateDisplayObjectDependency",value:function(e,n,i,a){if(n&&n!==i){var s=this.displayObjectDependencyMap.get(n);if(s&&s[e]){var o=s[e].indexOf(a);s[e].splice(o,1)}}if(i){var l=this.displayObjectDependencyMap.get(i);l||(this.displayObjectDependencyMap.set(i,{}),l=this.displayObjectDependencyMap.get(i)),l[e]||(l[e]=[]),l[e].push(a)}}},{key:"informDependentDisplayObjects",value:function(e){var n,i=this,a=this.displayObjectDependencyMap.get(e);if(a){var s=(n=e.ownerDocument)===null||n===void 0||(n=n.defaultView)===null||n===void 0||(n=n.getConfig())===null||n===void 0||(n=n.future)===null||n===void 0?void 0:n.experimentalCancelEventPropagation;Object.keys(a).forEach(function(o){a[o].forEach(function(l){i.dirtyToRoot(l,!0),l.dispatchEvent(new yi(Jt.ATTR_MODIFIED,l,i,i,o,yi.MODIFICATION,i,i),s,s),l.isCustomElement&&l.isConnected&&l.attributeChangedCallback&&l.attributeChangedCallback(o,i,i)})})}}}])})(),Rx=(function(){function r(t){if(ot(this,r),t<=0)throw new Error("LRU capacity must be a positive number.");this.capacity=t,this.cache=new Map}return lt(r,[{key:"get",value:function(e){if(this.cache.has(e)){var n=this.cache.get(e);return this.cache.delete(e),this.cache.set(e,n),n}}},{key:"put",value:function(e,n){if(this.cache.has(e)&&this.cache.delete(e),this.cache.set(e,n),this.cache.size>this.capacity){var i=this.cache.keys().next().value;this.cache.delete(i)}}},{key:"len",value:function(){return this.cache.size}},{key:"clear",value:function(){this.cache.clear()}}])})(),Ta={MetricsString:"|q",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},Lx=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,tF=/[!%),.:;?\]}'""]/,eF=/[$('"]/,nF=/[!),.:;?\]}'""]/,rF=/[([{'"]/,iF=/[)\]'"?!:;,.]/,aF=/[(['"...]/,sF=/[!%),.:;?\]}'"]/,oF=/[$([{'"#]/,lF=new RegExp("".concat(tF.source,"|").concat(nF.source,"|").concat(iF.source,"|").concat(sF.source)),cF=new RegExp("".concat(eF.source,"|").concat(rF.source,"|").concat(aF.source,"|").concat(oF.source)),uF=(function(){function r(t){var e=this;ot(this,r),this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(n,i){return e.isBreakingSpace(i)?!1:!!(n&&(cF.exec(i)||lF.exec(n)))},this.trimByKinsokuShorui=function(n){var i=ne(n),a=i[i.length-2];if(!a)return n;var s=a[a.length-1];return i[i.length-2]=a.slice(0,-1),i[i.length-1]=s+i[i.length-1],i},this.runtime=t,this.charWidthCache=new Rx(100)}return lt(r,[{key:"measureFont",value:function(e,n){if(this.fontMetricsCache[e])return this.fontMetricsCache[e];var i={ascent:0,descent:0,fontSize:0},a=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(n),s=this.runtime.offscreenCanvasCreator.getOrCreateContext(n,{willReadFrequently:!0});s.font=e;var o=Ta.MetricsString+Ta.BaselineSymbol,l=Math.ceil(s.measureText(o).width),c=Math.ceil(s.measureText(Ta.BaselineSymbol).width),u=Ta.HeightMultiplier*c;c=c*Ta.BaselineMultiplier|0,a.width=l,a.height=u,s.fillStyle="#f00",s.fillRect(0,0,l,u),s.font=e,s.textBaseline="alphabetic",s.fillStyle="#000",s.fillText(o,0,c);var h=s.getImageData(0,0,l||1,u||1).data,d=h.length,f=l*4,g=0,v=0,p=!1;for(g=0;g<c;++g){for(var y=0;y<f;y+=4)if(h[v+y]!==255){p=!0;break}if(!p)v+=f;else break}for(i.ascent=c-g,v=d-f,p=!1,g=u;g>c;--g){for(var m=0;m<f;m+=4)if(h[v+m]!==255){p=!0;break}if(!p)v-=f;else break}return i.descent=g-c,i.fontSize=i.ascent+i.descent,this.fontMetricsCache[e]=i,i}},{key:"measureText",value:function(e,n,i){var a=n.fontSize,s=a===void 0?16:a,o=n.wordWrap,l=o===void 0?!1:o,c=n.lineHeight,u=n.lineWidth,h=u===void 0?1:u,d=n.textBaseline,f=d===void 0?"alphabetic":d,g=n.textAlign,v=g===void 0?"start":g,p=n.letterSpacing,y=p===void 0?0:p,m=n.textPath;n.textPathSide,n.textPathStartOffset;var x=n.leading,E=x===void 0?0:x,_=Ax(n),M=this.measureFont(_,i);M.fontSize===0&&(M.fontSize=s,M.ascent=s);var O=this.runtime.offscreenCanvasCreator.getOrCreateContext(i);O.font=_,n.isOverflowing=!1;var T=l?this.wordWrap(e,n,i):e,N=T.split(/(?:\r\n|\r|\n)/),P=new Array(N.length),C=0;if(m){m.getTotalLength();for(var R=0;R<N.length;R++)O.measureText(N[R]).width+(N[R].length-1)*y}else{for(var I=0;I<N.length;I++){var j=O.measureText(N[I]).width+(N[I].length-1)*y;P[I]=j,C=Math.max(C,j)}var G=C+h,H=c||M.fontSize+h,Z=Math.max(H,M.fontSize+h)+(N.length-1)*(H+E);H+=E;var U=0;return f==="middle"?U=-Z/2:f==="bottom"||f==="alphabetic"||f==="ideographic"?U=-Z:(f==="top"||f==="hanging")&&(U=0),{font:_,width:G,height:Z,lines:N,lineWidths:P,lineHeight:H,maxLineWidth:C,fontProperties:M,lineMetrics:P.map(function(tt,gt){var xt=0;return v==="center"||v==="middle"?xt-=tt/2:(v==="right"||v==="end")&&(xt-=tt),new qs(xt-h/2,U+gt*H,tt+h,H)})}}}},{key:"wordWrap",value:function(e,n,i){var a=this,s=Array.from(e);if(s.length===0)return"";var o=this,l=n.wordWrapWidth,c=l===void 0?0:l,u=n.letterSpacing,h=u===void 0?0:u,d=n.maxLines,f=d===void 0?1/0:d,g=n.textOverflow,v=this.runtime.offscreenCanvasCreator.getOrCreateContext(i),p=c+h,y="";g==="ellipsis"?y="...":g&&g!=="clip"&&(y=g);var m=[""],x=0,E=0,_=-1,M=Ax(n),O=this.charWidthCache.get(M);O||(O=new Rx(500),this.charWidthCache.put(M,O));var T=function(tt){return a.getFromCache(tt,h,O,v)},N=T(y);function P(U,tt,gt,xt){for(;T(U)<xt&&tt<s.length-1&&!o.isNewline(s[tt+1]);)tt+=1,U+=s[tt];for(;T(U)>xt&&tt>=gt;)tt-=1,U=U.slice(0,-1);return{lineTxt:U,txtLastCharIndex:tt}}function C(U,tt){if(!(N<=0||N>p)){if(!m[U]){m[U]=y;return}var gt=P(m[U],tt,_+1,p-N);m[U]=gt.lineTxt+y}}for(var R=0;R<s.length;R++){var I=s[R],j=s[R-1],G=s[R+1],H=T(I);if(this.isNewline(I)){if(x+1>=f){R<s.length-1&&C(x,R-1),n.isOverflowing=!0;break}_=R-1,x+=1,E=0,m[x]="";continue}if(H>p){C(x,R-1),n.isOverflowing=!0;break}if(E>0&&E+H>p){var Z=P(m[x],R-1,_+1,p);if(Z.txtLastCharIndex!==R-1){if(m[x]=Z.lineTxt,Z.txtLastCharIndex===s.length-1)break;R=Z.txtLastCharIndex+1,I=s[R],j=s[R-1],G=s[R+1],H=T(I)}if(x+1>=f){C(x,R-1),n.isOverflowing=!0;break}if(_=R-1,x+=1,E=0,m[x]="",this.isBreakingSpace(I))continue;this.canBreakInLastChar(I)||(m=this.trimToBreakable(m),E=this.sumTextWidthByCache(m[x]||"",T)),this.shouldBreakByKinsokuShorui(I,G)&&(m=this.trimByKinsokuShorui(m),E+=T(j||""))}E+=H,m[x]+=I}return m.join(`
`)}},{key:"isBreakingSpace",value:function(e){return typeof e!="string"?!1:Ta.BreakingSpaces.indexOf(e.charCodeAt(0))>=0}},{key:"isNewline",value:function(e){return typeof e!="string"?!1:Ta.Newlines.indexOf(e.charCodeAt(0))>=0}},{key:"trimToBreakable",value:function(e){var n=ne(e),i=n[n.length-2],a=this.findBreakableIndex(i);if(a===-1||!i)return n;var s=i.slice(a,a+1),o=this.isBreakingSpace(s),l=a+1,c=a+(o?0:1);return n[n.length-1]+=i.slice(l,i.length),n[n.length-2]=i.slice(0,c),n}},{key:"canBreakInLastChar",value:function(e){return!(e&&Lx.test(e))}},{key:"sumTextWidthByCache",value:function(e,n){return e.split("").reduce(function(i,a){return i+n(a)},0)}},{key:"findBreakableIndex",value:function(e){for(var n=e.length-1;n>=0;n--)if(!Lx.test(e[n]))return n;return-1}},{key:"getFromCache",value:function(e,n,i,a){var s=i.get(e);if(typeof s!="number"){var o=e.length*n,l=a.measureText(e);s=l.width+o,i.put(e,s)}return s}},{key:"clearCache",value:function(){this.fontMetricsCache={},this.charWidthCache.clear()}}])})(),ct={},hF=(function(r){var t=new I6,e=new L6;return r={},_t(_t(_t(_t(_t(_t(_t(_t(_t(_t(r,nt.FRAGMENT,null),nt.CIRCLE,new N6),nt.ELLIPSE,new P6),nt.RECT,t),nt.IMAGE,t),nt.GROUP,new F6),nt.LINE,new C6),nt.TEXT,new D6(ct)),nt.POLYLINE,e),nt.POLYGON,e),_t(_t(_t(r,nt.PATH,new R6),nt.HTML,new B6),nt.MESH,null)})(),dF=(function(r){var t=new GD,e=new bm;return r={},_t(_t(_t(_t(_t(_t(_t(_t(_t(_t(r,mt.PERCENTAGE,null),mt.NUMBER,new YD),mt.ANGLE,new jD),mt.DEFINED_PATH,new qD),mt.PAINT,t),mt.COLOR,t),mt.FILTER,new $D),mt.LENGTH,e),mt.LENGTH_PERCENTAGE,e),mt.LENGTH_PERCENTAGE_12,new WD),_t(_t(_t(_t(_t(_t(_t(_t(_t(_t(r,mt.LENGTH_PERCENTAGE_14,new VD),mt.COORDINATE,new bm),mt.OFFSET_DISTANCE,new HD),mt.OPACITY_VALUE,new XD),mt.PATH,new KD),mt.LIST_OF_POINTS,new ZD),mt.SHADOW_BLUR,new JD),mt.TEXT,new QD),mt.TEXT_TRANSFORM,new t6),mt.TRANSFORM,new T6),_t(_t(_t(r,mt.TRANSFORM_ORIGIN,new O6),mt.Z_INDEX,new A6),mt.MARKER,new UD)})(),fF=function(){return typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}};ct.CameraContribution=WO;ct.AnimationTimeline=null;ct.EasingFunction=null;ct.offscreenCanvasCreator=new w1;ct.sceneGraphSelector=new $6;ct.sceneGraphService=new Q6(ct);ct.textService=new uF(ct);ct.geometryUpdaterFactory=hF;ct.CSSPropertySyntaxFactory=dF;ct.styleValueRegistry=new BD(ct);ct.layoutRegistry=null;ct.globalThis=fF();ct.enableStyleSyntax=!0;ct.enableSizeAttenuation=!1;var gF=0,Em=new yi(Jt.INSERTED,null,"","","",0,"",""),Sm=new yi(Jt.REMOVED,null,"","","",0,"",""),mA=new rn(Jt.DESTROY),vF=(function(r){function t(){var e;ot(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=Yt(this,t,[].concat(i)),e.entity=gF++,e.transformable={dirtyFlag:!1,localDirtyFlag:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},e.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},e.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},e.cullable={strategy:yI.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},e.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},e.rBushNode={aabb:void 0},e.namespaceURI="g",e.scrollLeft=0,e.scrollTop=0,e.clientTop=0,e.clientLeft=0,e.style={},e.computedStyle={},e.parsedStyle={},e.attributes={},e}return Ht(t,r),lt(t,[{key:"dirty",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.renderable.dirty=n,i&&(this.renderable.boundsDirty=n,this.renderable.renderBoundsDirty=n)}},{key:"className",get:function(){return this.getAttribute("class")||""},set:function(n){this.setAttribute("class",n)}},{key:"classList",get:function(){return this.className.split(" ").filter(function(n){return n!==""})}},{key:"tagName",get:function(){return this.nodeName}},{key:"children",get:function(){return this.childNodes}},{key:"childElementCount",get:function(){return this.childNodes.length}},{key:"firstElementChild",get:function(){return this.firstChild}},{key:"lastElementChild",get:function(){return this.lastChild}},{key:"parentElement",get:function(){return this.parentNode}},{key:"nextSibling",get:function(){if(this.parentNode){var n=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[n+1]||null}return null}},{key:"previousSibling",get:function(){if(this.parentNode){var n=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[n-1]||null}return null}},{key:"cloneNode",value:function(n){throw new Error(he)}},{key:"appendChild",value:function(n,i){var a;if(n.destroyed)throw new Error(sI);return ct.sceneGraphService.attach(n,this,i),(a=this.ownerDocument)!==null&&a!==void 0&&a.defaultView&&(!su(this)&&n.nodeName===nt.FRAGMENT?this.ownerDocument.defaultView.mountFragment(n):this.ownerDocument.defaultView.mountChildren(n)),this.isMutationObserved&&(Em.relatedNode=this,n.dispatchEvent(Em)),n}},{key:"insertBefore",value:function(n,i){if(!i)this.appendChild(n);else{n.parentElement&&n.parentElement.removeChild(n);var a=this.childNodes.indexOf(i);a===-1?this.appendChild(n):this.appendChild(n,a)}return n}},{key:"replaceChild",value:function(n,i){var a=this.childNodes.indexOf(i);return this.removeChild(i),this.appendChild(n,a),i}},{key:"removeChild",value:function(n){var i,a,s=((i=this.ownerDocument)===null||i===void 0||(i=i.defaultView)===null||i===void 0||(i=i.getConfig().future)===null||i===void 0?void 0:i.experimentalCancelEventPropagation)===!0;return Sm.relatedNode=this,n.dispatchEvent(Sm,s,s),(a=n.ownerDocument)!==null&&a!==void 0&&a.defaultView&&n.ownerDocument.defaultView.unmountChildren(n),ct.sceneGraphService.detach(n),n}},{key:"removeChildren",value:function(){for(var n=this.childNodes.length-1;n>=0;n--){var i=this.childNodes[n];this.removeChild(i)}}},{key:"destroyChildren",value:function(){for(var n=this.childNodes.length-1;n>=0;n--){var i=this.childNodes[n];i.childNodes.length>0&&i.destroyChildren(),i.destroy()}}},{key:"matches",value:function(n){return ct.sceneGraphService.matches(n,this)}},{key:"getElementById",value:function(n){return ct.sceneGraphService.querySelector("#".concat(n),this)}},{key:"getElementsByName",value:function(n){return ct.sceneGraphService.querySelectorAll('[name="'.concat(n,'"]'),this)}},{key:"getElementsByClassName",value:function(n){return ct.sceneGraphService.querySelectorAll(".".concat(n),this)}},{key:"getElementsByTagName",value:function(n){return ct.sceneGraphService.querySelectorAll(n,this)}},{key:"querySelector",value:function(n){return ct.sceneGraphService.querySelector(n,this)}},{key:"querySelectorAll",value:function(n){return ct.sceneGraphService.querySelectorAll(n,this)}},{key:"closest",value:function(n){var i=this;do{if(ct.sceneGraphService.matches(n,i))return i;i=i.parentElement}while(i!==null);return null}},{key:"find",value:function(n){var i=this,a=null;return this.forEach(function(s){return s!==i&&n(s)?(a=s,!1):!0}),a}},{key:"findAll",value:function(n){var i=this,a=[];return this.forEach(function(s){s!==i&&n(s)&&a.push(s)}),a}},{key:"after",value:function(){var n=this;if(this.parentNode){for(var i=this.parentNode.childNodes.indexOf(this),a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];s.forEach(function(l,c){var u;return(u=n.parentNode)===null||u===void 0?void 0:u.appendChild(l,i+c+1)})}}},{key:"before",value:function(){if(this.parentNode){for(var n,i=this.parentNode.childNodes.indexOf(this),a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];var l=s[0],c=s.slice(1);this.parentNode.appendChild(l,i),(n=l).after.apply(n,ne(c))}}},{key:"replaceWith",value:function(){this.after.apply(this,arguments),this.remove()}},{key:"append",value:function(){for(var n=this,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];a.forEach(function(o){return n.appendChild(o)})}},{key:"prepend",value:function(){for(var n=this,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];a.forEach(function(o,l){return n.appendChild(o,l)})}},{key:"replaceChildren",value:function(){for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,arguments)}},{key:"remove",value:function(){return this.parentNode?this.parentNode.removeChild(this):this}},{key:"destroy",value:function(){var n,i=((n=this.ownerDocument)===null||n===void 0||(n=n.defaultView)===null||n===void 0||(n=n.getConfig().future)===null||n===void 0?void 0:n.experimentalCancelEventPropagation)===!0;this.destroyChildren(),this.dispatchEvent(mA,i,i),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0}},{key:"getGeometryBounds",value:function(){return ct.sceneGraphService.getGeometryBounds(this)}},{key:"getRenderBounds",value:function(){return ct.sceneGraphService.getBounds(this,!0)}},{key:"getBounds",value:function(){return ct.sceneGraphService.getBounds(this)}},{key:"getLocalBounds",value:function(){return ct.sceneGraphService.getLocalBounds(this)}},{key:"getBoundingClientRect",value:function(){return ct.sceneGraphService.getBoundingClientRect(this)}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()]}},{key:"computedStyleMap",value:function(){return new Map(Object.entries(this.computedStyle))}},{key:"getAttributeNames",value:function(){return Object.keys(this.attributes)}},{key:"getAttribute",value:function(n){if(typeof n!="symbol"){var i=this.attributes[n];return i}}},{key:"hasAttribute",value:function(n){return this.getAttributeNames().includes(n)}},{key:"hasAttributes",value:function(){return!!this.getAttributeNames().length}},{key:"removeAttribute",value:function(n){this.setAttribute(n,null),delete this.attributes[n]}},{key:"setAttribute",value:function(n,i,a,s){this.attributes[n]=i}},{key:"getAttributeNS",value:function(n,i){throw new Error(he)}},{key:"getAttributeNode",value:function(n){throw new Error(he)}},{key:"getAttributeNodeNS",value:function(n,i){throw new Error(he)}},{key:"hasAttributeNS",value:function(n,i){throw new Error(he)}},{key:"removeAttributeNS",value:function(n,i){throw new Error(he)}},{key:"removeAttributeNode",value:function(n){throw new Error(he)}},{key:"setAttributeNS",value:function(n,i,a){throw new Error(he)}},{key:"setAttributeNode",value:function(n){throw new Error(he)}},{key:"setAttributeNodeNS",value:function(n){throw new Error(he)}},{key:"toggleAttribute",value:function(n,i){throw new Error(he)}}])})(De);function se(r){return!!(r!=null&&r.nodeName)}var pF=ct.globalThis.Proxy?ct.globalThis.Proxy:function(){},ci=new yi(Jt.ATTR_MODIFIED,null,null,null,null,yi.MODIFICATION,null,null),fo=te(),yF=nn(),Se=(function(r){function t(e){var n;return ot(this,t),n=Yt(this,t),n.isCustomElement=!1,n.isMutationObserved=!1,n.activeAnimations=[],n.config=e,n.id=e.id||"",n.name=e.name||"",(e.className||e.class)&&(n.className=e.className||e.class),n.nodeName=e.type||nt.GROUP,e.initialParsedStyle&&Object.assign(n.parsedStyle,e.initialParsedStyle),n.initAttributes(e.style),ct.enableStyleSyntax&&(n.style=new pF({setProperty:function(a,s){n.setAttribute(a,s)},getPropertyValue:function(a){return n.getAttribute(a)},removeProperty:function(a){n.removeAttribute(a)},item:function(){return""}},{get:function(a,s){return a[s]!==void 0?a[s]:n.getAttribute(s)},set:function(a,s,o){return n.setAttribute(s,o),!0}})),n}return Ht(t,r),lt(t,[{key:"destroy",value:function(){Kb(t,"destroy",this)([]),this.getAnimations().forEach(function(n){n.cancel()})}},{key:"cloneNode",value:function(n,i){var a=Vt({},this.attributes);for(var s in a){var o=a[s];se(o)&&s!=="clipPath"&&s!=="offsetPath"&&s!=="textPath"&&(a[s]=o.cloneNode(n)),i&&(a[s]=i(s,o))}var l=new this.constructor(Vt(Vt({},this.config),{},{style:a}));return l.setLocalTransform(this.getLocalTransform()),n&&this.children.forEach(function(c){if(!c.style.isMarker){var u=c.cloneNode(n);l.appendChild(u)}}),l}},{key:"initAttributes",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i={forceUpdateGeometry:!0};ct.styleValueRegistry.processProperties(this,n,i),this.dirty()}},{key:"setAttribute",value:function(n,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;Dt(i)||(a||i!==this.attributes[n])&&(this.internalSetAttribute(n,i,{memoize:s}),Kb(t,"setAttribute",this)([n,i]))}},{key:"internalSetAttribute",value:function(n,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=this.attributes[n],o=this.parsedStyle[n];ct.styleValueRegistry.processProperties(this,_t({},n,i),a),this.dirty();var l=this.parsedStyle[n];if(this.isConnected)if(ci.relatedNode=this,ci.prevValue=s,ci.newValue=i,ci.attrName=n,ci.prevParsedValue=o,ci.newParsedValue=l,this.isMutationObserved)this.dispatchEvent(ci);else{var c,u=((c=this.ownerDocument.defaultView.getConfig().future)===null||c===void 0?void 0:c.experimentalCancelEventPropagation)===!0;ci.target=this,this.ownerDocument.defaultView.dispatchEvent(ci,!0,u)}if(this.isCustomElement&&this.isConnected||!this.isCustomElement){var h,d;(h=(d=this).attributeChangedCallback)===null||h===void 0||h.call(d,n,s,i,o,l)}}},{key:"getBBox",value:function(){var n=this.getBounds(),i=n.getMin(),a=$t(i,2),s=a[0],o=a[1],l=n.getMax(),c=$t(l,2),u=c[0],h=c[1];return new qs(s,o,u-s,h-o)}},{key:"setOrigin",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return ct.sceneGraphService.setOrigin(this,Gn(n,i,a,!1)),this}},{key:"getOrigin",value:function(){return ct.sceneGraphService.getOrigin(this)}},{key:"setPosition",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return ct.sceneGraphService.setPosition(this,Gn(n,i,a,!1)),this}},{key:"setLocalPosition",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return ct.sceneGraphService.setLocalPosition(this,Gn(n,i,a,!1)),this}},{key:"translate",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return ct.sceneGraphService.translate(this,Gn(n,i,a,!1)),this}},{key:"translateLocal",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return ct.sceneGraphService.translateLocal(this,Gn(n,i,a,!1)),this}},{key:"getPosition",value:function(){return ct.sceneGraphService.getPosition(this)}},{key:"getLocalPosition",value:function(){return ct.sceneGraphService.getLocalPosition(this)}},{key:"scale",value:function(n,i,a){return this.scaleLocal(n,i,a)}},{key:"scaleLocal",value:function(n,i,a){return typeof n=="number"&&(i=i||n,a=a||n,n=Gn(n,i,a,!1)),ct.sceneGraphService.scaleLocal(this,n),this}},{key:"setLocalScale",value:function(n,i,a){return typeof n=="number"&&(i=i||n,a=a||n,n=Gn(n,i,a,!1)),ct.sceneGraphService.setLocalScale(this,n),this}},{key:"getLocalScale",value:function(){return ct.sceneGraphService.getLocalScale(this)}},{key:"getScale",value:function(){return ct.sceneGraphService.getScale(this)}},{key:"getEulerAngles",value:function(){var n=Ed(fo,ct.sceneGraphService.getWorldTransform(this)),i=$t(n,3),a=i[2];return nr(a)}},{key:"getLocalEulerAngles",value:function(){var n=Ed(fo,ct.sceneGraphService.getLocalRotation(this)),i=$t(n,3),a=i[2];return nr(a)}},{key:"setEulerAngles",value:function(n){return ct.sceneGraphService.setEulerAngles(this,0,0,n),this}},{key:"setLocalEulerAngles",value:function(n){return ct.sceneGraphService.setLocalEulerAngles(this,0,0,n),this}},{key:"rotateLocal",value:function(n,i,a){return Rt(i)&&Rt(a)?ct.sceneGraphService.rotateLocal(this,0,0,n):ct.sceneGraphService.rotateLocal(this,n,i,a),this}},{key:"rotate",value:function(n,i,a){return Rt(i)&&Rt(a)?ct.sceneGraphService.rotate(this,0,0,n):ct.sceneGraphService.rotate(this,n,i,a),this}},{key:"setRotation",value:function(n,i,a,s){return ct.sceneGraphService.setRotation(this,n,i,a,s),this}},{key:"setLocalRotation",value:function(n,i,a,s){return ct.sceneGraphService.setLocalRotation(this,n,i,a,s),this}},{key:"setLocalSkew",value:function(n,i){return ct.sceneGraphService.setLocalSkew(this,n,i),this}},{key:"getRotation",value:function(){return ct.sceneGraphService.getRotation(this)}},{key:"getLocalRotation",value:function(){return ct.sceneGraphService.getLocalRotation(this)}},{key:"getLocalSkew",value:function(){return ct.sceneGraphService.getLocalSkew(this)}},{key:"getLocalTransform",value:function(){return ct.sceneGraphService.getLocalTransform(this)}},{key:"getWorldTransform",value:function(){return ct.sceneGraphService.getWorldTransform(this)}},{key:"setLocalTransform",value:function(n){return ct.sceneGraphService.setLocalTransform(this,n),this}},{key:"resetLocalTransform",value:function(){ct.sceneGraphService.resetLocalTransform(this)}},{key:"getAnimations",value:function(){return this.activeAnimations}},{key:"animate",value:function(n,i){var a,s=(a=this.ownerDocument)===null||a===void 0?void 0:a.timeline;return s?s.play(this,n,i):null}},{key:"isVisible",value:function(){var n;return((n=this.parsedStyle)===null||n===void 0?void 0:n.visibility)!=="hidden"}},{key:"interactive",get:function(){return this.isInteractive()},set:function(n){this.style.pointerEvents=n?"auto":"none"}},{key:"isInteractive",value:function(){var n;return((n=this.parsedStyle)===null||n===void 0?void 0:n.pointerEvents)!=="none"}},{key:"isCulled",value:function(){return!!(this.cullable&&this.cullable.enable&&!this.cullable.visible)}},{key:"toFront",value:function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,ne(this.parentNode.children.map(function(n){return Number(n.style.zIndex)})))+1),this}},{key:"toBack",value:function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,ne(this.parentNode.children.map(function(n){return Number(n.style.zIndex)})))-1),this}},{key:"getConfig",value:function(){return this.config}},{key:"attr",value:function(){for(var n=this,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];var o=a[0],l=a[1];return o?Ze(o)?(Object.keys(o).forEach(function(c){n.setAttribute(c,o[c])}),this):a.length===2?(this.setAttribute(o,l),this):this.attributes[o]:this.attributes}},{key:"getMatrix",value:function(n){var i=n||this.getWorldTransform(),a=Vc(fo,i),s=$t(a,2),o=s[0],l=s[1],c=zs(fo,i),u=$t(c,2),h=u[0],d=u[1],f=Uc(yF,i),g=Ed(fo,f),v=$t(g,3),p=v[0],y=v[2];return dI(p||y,o,l,h,d)}},{key:"getLocalMatrix",value:function(){return this.getMatrix(this.getLocalTransform())}},{key:"setMatrix",value:function(n){var i=rx(n),a=$t(i,5),s=a[0],o=a[1],l=a[2],c=a[3],u=a[4];this.setEulerAngles(u).setPosition(s,o).setLocalScale(l,c)}},{key:"setLocalMatrix",value:function(n){var i=rx(n),a=$t(i,5),s=a[0],o=a[1],l=a[2],c=a[3],u=a[4];this.setLocalEulerAngles(u).setLocalPosition(s,o).setLocalScale(l,c)}},{key:"show",value:function(){this.forEach(function(n){n.style.visibility="visible"})}},{key:"hide",value:function(){this.forEach(function(n){n.style.visibility="hidden"})}},{key:"getCount",value:function(){return this.childElementCount}},{key:"getParent",value:function(){return this.parentElement}},{key:"getChildren",value:function(){return this.children}},{key:"getFirst",value:function(){return this.firstElementChild}},{key:"getLast",value:function(){return this.lastElementChild}},{key:"getChildByIndex",value:function(n){return this.children[n]||null}},{key:"add",value:function(n,i){return this.appendChild(n,i)}},{key:"set",value:function(n,i){this.config[n]=i}},{key:"get",value:function(n){return this.config[n]}},{key:"moveTo",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return this.setPosition(n,i,a),this}},{key:"move",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return this.setPosition(n,i,a),this}},{key:"setZIndex",value:function(n){return this.style.zIndex=n,this}}])})(vF);Se.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","display","draggable","droppable","fill","fillOpacity","fillRule","filter","increasedLineWidthForHitTesting","lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","hitArea","offsetDistance","offsetPath","offsetX","offsetY","opacity","pointerEvents","shadowColor","shadowType","shadowBlur","shadowOffsetX","shadowOffsetY","stroke","strokeOpacity","strokeWidth","strokeLinecap","strokeLineJoin","strokeDasharray","strokeDashoffset","transform","transformOrigin","textTransform","visibility","zIndex"]);var mi=(function(r){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ot(this,t),Yt(this,t,[Vt({type:nt.CIRCLE},e)])}return Ht(t,r),lt(t)})(Se);mi.PARSED_STYLE_LIST=new Set([].concat(ne(Se.PARSED_STYLE_LIST),["cx","cy","cz","r","isBillboard","isSizeAttenuation"]));var mF=["style"],E1=(function(r){function t(){var e,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=n.style,a=es(n,mF);return ot(this,t),e=Yt(this,t,[Vt({style:i},a)]),e.isCustomElement=!0,e}return Ht(t,r),lt(t)})(Se);E1.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var cl=(function(r){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ot(this,t),Yt(this,t,[Vt({type:nt.ELLIPSE},e)])}return Ht(t,r),lt(t)})(Se);cl.PARSED_STYLE_LIST=new Set([].concat(ne(Se.PARSED_STYLE_LIST),["cx","cy","cz","rx","ry","isBillboard","isSizeAttenuation"]));var bF=(function(r){function t(){return ot(this,t),Yt(this,t,[{type:nt.FRAGMENT}])}return Ht(t,r),lt(t)})(Se);bF.PARSED_STYLE_LIST=new Set(["class","className"]);var gn=(function(r){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ot(this,t),Yt(this,t,[Vt({type:nt.GROUP},e)])}return Ht(t,r),lt(t)})(Se);gn.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var xF=["style"],rs=(function(r){function t(){var e,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=n.style,a=es(n,xF);return ot(this,t),e=Yt(this,t,[Vt({type:nt.HTML,style:i},a)]),e.cullable.enable=!1,e}return Ht(t,r),lt(t,[{key:"getDomElement",value:function(){return this.parsedStyle.$el}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()]}},{key:"getLocalBounds",value:function(){if(this.parentNode){var n=hi(ve(),this.parentNode.getWorldTransform()),i=this.getBounds();if(!be.isEmpty(i)){var a=new be;return a.setFromTransformedAABB(i,n),a}}return this.getBounds()}}])})(Se);rs.PARSED_STYLE_LIST=new Set([].concat(ne(Se.PARSED_STYLE_LIST),["x","y","$el","innerHTML","width","height"]));var ul=(function(r){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ot(this,t),Yt(this,t,[Vt({type:nt.IMAGE},e)])}return Ht(t,r),lt(t)})(Se);ul.PARSED_STYLE_LIST=new Set([].concat(ne(Se.PARSED_STYLE_LIST),["x","y","z","src","width","height","isBillboard","billboardRotation","isSizeAttenuation","keepAspectRatio"]));var wF=["style"],Ka=(function(r){function t(){var e,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=n.style,a=es(n,wF);ot(this,t),e=Yt(this,t,[Vt({type:nt.LINE,style:Vt({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},i)},a)]),e.markerStartAngle=0,e.markerEndAngle=0;var s=e.parsedStyle,o=s.markerStart,l=s.markerEnd;return o&&se(o)&&(e.markerStartAngle=o.getLocalEulerAngles(),e.appendChild(o)),l&&se(l)&&(e.markerEndAngle=l.getLocalEulerAngles(),e.appendChild(l)),e.transformMarker(!0),e.transformMarker(!1),e}return Ht(t,r),lt(t,[{key:"attributeChangedCallback",value:function(n,i,a,s,o){n==="x1"||n==="y1"||n==="x2"||n==="y2"||n==="markerStartOffset"||n==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):n==="markerStart"?(s&&se(s)&&(this.markerStartAngle=0,s.remove()),o&&se(o)&&(this.markerStartAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!0))):n==="markerEnd"&&(s&&se(s)&&(this.markerEndAngle=0,s.remove()),o&&se(o)&&(this.markerEndAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!1)))}},{key:"transformMarker",value:function(n){var i=this.parsedStyle,a=i.markerStart,s=i.markerEnd,o=i.markerStartOffset,l=i.markerEndOffset,c=i.x1,u=i.x2,h=i.y1,d=i.y2,f=n?a:s;if(!(!f||!se(f))){var g=0,v,p,y,m,x,E;n?(y=c,m=h,v=u-c,p=d-h,x=o||0,E=this.markerStartAngle):(y=u,m=d,v=c-u,p=h-d,x=l||0,E=this.markerEndAngle),g=Math.atan2(p,v),f.setLocalEulerAngles(g*180/Math.PI+E),f.setLocalPosition(y+Math.cos(g)*x,m+Math.sin(g)*x)}}},{key:"getPoint",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.parsedStyle,s=a.x1,o=a.y1,l=a.x2,c=a.y2,u=zO(s,o,l,c,n),h=u.x,d=u.y,f=zn(te(),we(h,d,0),i?this.getWorldTransform():this.getLocalTransform());return new Tn(f[0],f[1])}},{key:"getPointAtLength",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPoint(n/this.getTotalLength(),i)}},{key:"getTotalLength",value:function(){var n=this.parsedStyle,i=n.x1,a=n.y1,s=n.x2,o=n.y2;return BO(i,a,s,o)}}])})(Se);Ka.PARSED_STYLE_LIST=new Set([].concat(ne(Se.PARSED_STYLE_LIST),["x1","y1","x2","y2","z1","z2","isBillboard","isSizeAttenuation","markerStart","markerEnd","markerStartOffset","markerEndOffset"]));var EF=["style"],pr=(function(r){function t(){var e,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=n.style,a=es(n,EF);ot(this,t),e=Yt(this,t,[Vt({type:nt.PATH,style:i,initialParsedStyle:{miterLimit:4,d:Vt({},VO)}},a)]),e.markerStartAngle=0,e.markerEndAngle=0,e.markerMidList=[];var s=e.parsedStyle,o=s.markerStart,l=s.markerEnd,c=s.markerMid;return o&&se(o)&&(e.markerStartAngle=o.getLocalEulerAngles(),e.appendChild(o)),c&&se(c)&&e.placeMarkerMid(c),l&&se(l)&&(e.markerEndAngle=l.getLocalEulerAngles(),e.appendChild(l)),e.transformMarker(!0),e.transformMarker(!1),e}return Ht(t,r),lt(t,[{key:"attributeChangedCallback",value:function(n,i,a,s,o){n==="d"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):n==="markerStartOffset"||n==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):n==="markerStart"?(s&&se(s)&&(this.markerStartAngle=0,s.remove()),o&&se(o)&&(this.markerStartAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!0))):n==="markerEnd"?(s&&se(s)&&(this.markerEndAngle=0,s.remove()),o&&se(o)&&(this.markerEndAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!1))):n==="markerMid"&&this.placeMarkerMid(o)}},{key:"transformMarker",value:function(n){var i=this.parsedStyle,a=i.markerStart,s=i.markerEnd,o=i.markerStartOffset,l=i.markerEndOffset,c=n?a:s;if(!(!c||!se(c))){var u=0,h,d,f,g,v,p;if(n){var y=this.getStartTangent(),m=$t(y,2),x=m[0],E=m[1];f=E[0],g=E[1],h=x[0]-E[0],d=x[1]-E[1],v=o||0,p=this.markerStartAngle}else{var _=this.getEndTangent(),M=$t(_,2),O=M[0],T=M[1];f=T[0],g=T[1],h=O[0]-T[0],d=O[1]-T[1],v=l||0,p=this.markerEndAngle}u=Math.atan2(d,h),c.setLocalEulerAngles(u*180/Math.PI+p),c.setLocalPosition(f+Math.cos(u)*v,g+Math.sin(u)*v)}}},{key:"placeMarkerMid",value:function(n){var i=this.parsedStyle.d.segments;if(this.markerMidList.forEach(function(u){u.remove()}),n&&se(n))for(var a=1;a<i.length-1;a++){var s=$t(i[a].currentPoint,2),o=s[0],l=s[1],c=a===1?n:n.cloneNode(!0);this.markerMidList.push(c),this.appendChild(c),c.setLocalPosition(o,l)}}},{key:"getTotalLength",value:function(){return ym(this)}},{key:"getPointAtLength",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.parsedStyle.d.absolutePath,s=CL(a,n),o=s.x,l=s.y,c=zn(te(),we(o,l,0),i?this.getWorldTransform():this.getLocalTransform());return new Tn(c[0],c[1])}},{key:"getPoint",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPointAtLength(n*ym(this),i)}},{key:"getStartTangent",value:function(){var n=this.parsedStyle.d.segments,i=[];if(n.length>1){var a=n[0].currentPoint,s=n[1].currentPoint,o=n[1].startTangent;i=[],o?(i.push([a[0]-o[0],a[1]-o[1]]),i.push([a[0],a[1]])):(i.push([s[0],s[1]]),i.push([a[0],a[1]]))}return i}},{key:"getEndTangent",value:function(){var n=this.parsedStyle.d.segments,i=n.length,a=[];if(i>1){var s=n[i-2].currentPoint,o=n[i-1].currentPoint,l=n[i-1].endTangent;a=[],l?(a.push([o[0]-l[0],o[1]-l[1]]),a.push([o[0],o[1]])):(a.push([s[0],s[1]]),a.push([o[0],o[1]]))}return a}}])})(Se);pr.PARSED_STYLE_LIST=new Set([].concat(ne(Se.PARSED_STYLE_LIST),["d","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard","isSizeAttenuation"]));var SF=["style"],is=(function(r){function t(){var e,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=n.style,a=es(n,SF);ot(this,t),e=Yt(this,t,[Vt({type:nt.POLYGON,style:i,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},a)]),e.markerStartAngle=0,e.markerEndAngle=0,e.markerMidList=[];var s=e.parsedStyle,o=s.markerStart,l=s.markerEnd,c=s.markerMid;return o&&se(o)&&(e.markerStartAngle=o.getLocalEulerAngles(),e.appendChild(o)),c&&se(c)&&e.placeMarkerMid(c),l&&se(l)&&(e.markerEndAngle=l.getLocalEulerAngles(),e.appendChild(l)),e.transformMarker(!0),e.transformMarker(!1),e}return Ht(t,r),lt(t,[{key:"attributeChangedCallback",value:function(n,i,a,s,o){n==="points"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):n==="markerStartOffset"||n==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):n==="markerStart"?(s&&se(s)&&(this.markerStartAngle=0,s.remove()),o&&se(o)&&(this.markerStartAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!0))):n==="markerEnd"?(s&&se(s)&&(this.markerEndAngle=0,s.remove()),o&&se(o)&&(this.markerEndAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!1))):n==="markerMid"&&this.placeMarkerMid(o)}},{key:"transformMarker",value:function(n){var i=this.parsedStyle,a=i.markerStart,s=i.markerEnd,o=i.markerStartOffset,l=i.markerEndOffset,c=i.points,u=c||{},h=u.points,d=n?a:s;if(!(!d||!se(d)||!h)){var f=0,g,v,p,y,m,x;if(p=h[0][0],y=h[0][1],n)g=h[1][0]-h[0][0],v=h[1][1]-h[0][1],m=o||0,x=this.markerStartAngle;else{var E=h.length;this.parsedStyle.isClosed?(g=h[E-1][0]-h[0][0],v=h[E-1][1]-h[0][1]):(p=h[E-1][0],y=h[E-1][1],g=h[E-2][0]-h[E-1][0],v=h[E-2][1]-h[E-1][1]),m=l||0,x=this.markerEndAngle}f=Math.atan2(v,g),d.setLocalEulerAngles(f*180/Math.PI+x),d.setLocalPosition(p+Math.cos(f)*m,y+Math.sin(f)*m)}}},{key:"placeMarkerMid",value:function(n){var i=this.parsedStyle.points,a=i||{},s=a.points;if(this.markerMidList.forEach(function(h){h.remove()}),this.markerMidList=[],n&&se(n)&&s)for(var o=1;o<(this.parsedStyle.isClosed?s.length:s.length-1);o++){var l=s[o][0],c=s[o][1],u=o===1?n:n.cloneNode(!0);this.markerMidList.push(u),this.appendChild(u),u.setLocalPosition(l,c)}}}])})(Se);is.PARSED_STYLE_LIST=new Set([].concat(ne(Se.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isClosed","isBillboard","isSizeAttenuation"]));var _F=["style"],Lu=(function(r){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.style,i=es(e,_F);return ot(this,t),Yt(this,t,[Vt({type:nt.POLYLINE,style:n,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},i)])}return Ht(t,r),lt(t,[{key:"getTotalLength",value:function(){return vD(this)}},{key:"getPointAtLength",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPoint(n/this.getTotalLength(),i)}},{key:"getPoint",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.parsedStyle.points.points;if(this.parsedStyle.points.segments.length===0){var s=[],o=0,l,c,u=this.getTotalLength();a.forEach(function(y,m){a[m+1]&&(l=[0,0],l[0]=o/u,c=BO(y[0],y[1],a[m+1][0],a[m+1][1]),o+=c,l[1]=o/u,s.push(l))}),this.parsedStyle.points.segments=s}var h=0,d=0;this.parsedStyle.points.segments.forEach(function(y,m){n>=y[0]&&n<=y[1]&&(h=(n-y[0])/(y[1]-y[0]),d=m)});var f=zO(a[d][0],a[d][1],a[d+1][0],a[d+1][1],h),g=f.x,v=f.y,p=zn(te(),we(g,v,0),i?this.getWorldTransform():this.getLocalTransform());return new Tn(p[0],p[1])}},{key:"getStartTangent",value:function(){var n=this.parsedStyle.points.points,i=[];return i.push([n[1][0],n[1][1]]),i.push([n[0][0],n[0][1]]),i}},{key:"getEndTangent",value:function(){var n=this.parsedStyle.points.points,i=n.length-1,a=[];return a.push([n[i-1][0],n[i-1][1]]),a.push([n[i][0],n[i][1]]),a}}])})(is);Lu.PARSED_STYLE_LIST=new Set([].concat(ne(is.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard"]));var Nn=(function(r){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ot(this,t),Yt(this,t,[Vt({type:nt.RECT},e)])}return Ht(t,r),lt(t)})(Se);Nn.PARSED_STYLE_LIST=new Set([].concat(ne(Se.PARSED_STYLE_LIST),["x","y","z","width","height","isBillboard","isSizeAttenuation","radius"]));var kF=["style"],as=(function(r){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.style,i=es(e,kF);return ot(this,t),Yt(this,t,[Vt({type:nt.TEXT,style:Vt({fill:"black"},n)},i)])}return Ht(t,r),lt(t,[{key:"getComputedTextLength",value:function(){var n;return this.getGeometryBounds(),((n=this.parsedStyle.metrics)===null||n===void 0?void 0:n.maxLineWidth)||0}},{key:"getLineBoundingRects",value:function(){var n;return this.getGeometryBounds(),((n=this.parsedStyle.metrics)===null||n===void 0?void 0:n.lineMetrics)||[]}},{key:"isOverflowing",value:function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing}}])})(Se);as.PARSED_STYLE_LIST=new Set([].concat(ne(Se.PARSED_STYLE_LIST),["x","y","z","isBillboard","billboardRotation","isSizeAttenuation","text","textAlign","textBaseline","fontStyle","fontSize","fontFamily","fontWeight","fontVariant","lineHeight","letterSpacing","leading","wordWrap","wordWrapWidth","maxLines","textOverflow","isOverflowing","textPath","textDecorationLine","textDecorationColor","textDecorationStyle","textPathSide","textPathStartOffset","metrics","dx","dy"]));var MF=(function(){function r(){ot(this,r),this.registry={},this.define(nt.CIRCLE,mi),this.define(nt.ELLIPSE,cl),this.define(nt.RECT,Nn),this.define(nt.IMAGE,ul),this.define(nt.LINE,Ka),this.define(nt.GROUP,gn),this.define(nt.PATH,pr),this.define(nt.POLYGON,is),this.define(nt.POLYLINE,Lu),this.define(nt.TEXT,as),this.define(nt.HTML,rs)}return lt(r,[{key:"define",value:function(e,n){this.registry[e]=n}},{key:"get",value:function(e){return this.registry[e]}}])})(),bA=(function(r){function t(){var e;ot(this,t),e=Yt(this,t),e.defaultView=null,e.ownerDocument=null,e.nodeName="document";try{e.timeline=new ct.AnimationTimeline(e)}catch{}var n={};return m1.forEach(function(i){var a=i.n,s=i.inh,o=i.d;s&&o&&(n[a]=Tt(o)?o(nt.GROUP):o)}),e.documentElement=new gn({id:"g-root",style:n}),e.documentElement.ownerDocument=e,e.documentElement.parentNode=e,e.childNodes=[e.documentElement],e}return Ht(t,r),lt(t,[{key:"children",get:function(){return this.childNodes}},{key:"childElementCount",get:function(){return this.childNodes.length}},{key:"firstElementChild",get:function(){return this.firstChild}},{key:"lastElementChild",get:function(){return this.lastChild}},{key:"createElement",value:function(n,i){if(n==="svg")return this.documentElement;var a=this.defaultView.customElements.get(n);a||(console.warn("Unsupported tagName: ",n),a=n==="tspan"?as:gn);var s=new a(i);return s.ownerDocument=this,s}},{key:"createElementNS",value:function(n,i,a){return this.createElement(i,a)}},{key:"cloneNode",value:function(n){throw new Error(he)}},{key:"destroy",value:function(){try{this.documentElement.destroyChildren(),this.timeline.destroy()}catch{}}},{key:"elementsFromBBox",value:function(n,i,a,s){var o=this.defaultView.context.rBushRoot,l=o.search({minX:n,minY:i,maxX:a,maxY:s}),c=[];return l.forEach(function(u){var h=u.displayObject,d=h.parsedStyle.pointerEvents,f=d===void 0?"auto":d,g=["auto","visiblepainted","visiblefill","visiblestroke","visible"].includes(f);(!g||g&&h.isVisible())&&!h.isCulled()&&h.isInteractive()&&c.push(h)}),c.sort(function(u,h){return h.sortable.renderOrder-u.sortable.renderOrder}),c}},{key:"elementFromPointSync",value:function(n,i){var a=this.defaultView.canvas2Viewport({x:n,y:i}),s=a.x,o=a.y,l=this.defaultView.getConfig(),c=l.width,u=l.height;if(s<0||o<0||s>c||o>u)return null;var h=this.defaultView.viewport2Client({x:s,y:o}),d=h.x,f=h.y,g=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!0,position:{x:n,y:i,viewportX:s,viewportY:o,clientX:d,clientY:f},picked:[]}),v=g.picked;return v&&v[0]||this.documentElement}},{key:"elementFromPoint",value:(function(){var e=fa(bn().mark(function i(a,s){var o,l,c,u,h,d,f,g,v,p,y;return bn().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(o=this.defaultView.canvas2Viewport({x:a,y:s}),l=o.x,c=o.y,u=this.defaultView.getConfig(),h=u.width,d=u.height,!(l<0||c<0||l>h||c>d)){m.next=1;break}return m.abrupt("return",null);case 1:return f=this.defaultView.viewport2Client({x:l,y:c}),g=f.x,v=f.y,m.next=2,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!0,position:{x:a,y:s,viewportX:l,viewportY:c,clientX:g,clientY:v},picked:[]});case 2:return p=m.sent,y=p.picked,m.abrupt("return",y&&y[0]||this.documentElement);case 3:case"end":return m.stop()}},i,this)}));function n(i,a){return e.apply(this,arguments)}return n})()},{key:"elementsFromPointSync",value:function(n,i){var a=this.defaultView.canvas2Viewport({x:n,y:i}),s=a.x,o=a.y,l=this.defaultView.getConfig(),c=l.width,u=l.height;if(s<0||o<0||s>c||o>u)return[];var h=this.defaultView.viewport2Client({x:s,y:o}),d=h.x,f=h.y,g=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!1,position:{x:n,y:i,viewportX:s,viewportY:o,clientX:d,clientY:f},picked:[]}),v=g.picked;return v[v.length-1]!==this.documentElement&&v.push(this.documentElement),v}},{key:"elementsFromPoint",value:(function(){var e=fa(bn().mark(function i(a,s){var o,l,c,u,h,d,f,g,v,p,y;return bn().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(o=this.defaultView.canvas2Viewport({x:a,y:s}),l=o.x,c=o.y,u=this.defaultView.getConfig(),h=u.width,d=u.height,!(l<0||c<0||l>h||c>d)){m.next=1;break}return m.abrupt("return",[]);case 1:return f=this.defaultView.viewport2Client({x:l,y:c}),g=f.x,v=f.y,m.next=2,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!1,position:{x:a,y:s,viewportX:l,viewportY:c,clientX:g,clientY:v},picked:[]});case 2:return p=m.sent,y=p.picked,y[y.length-1]!==this.documentElement&&y.push(this.documentElement),m.abrupt("return",y);case 3:case"end":return m.stop()}},i,this)}));function n(i,a){return e.apply(this,arguments)}return n})()},{key:"appendChild",value:function(n,i){throw new Error(ms)}},{key:"insertBefore",value:function(n,i){throw new Error(ms)}},{key:"removeChild",value:function(n,i){throw new Error(ms)}},{key:"replaceChild",value:function(n,i,a){throw new Error(ms)}},{key:"append",value:function(){throw new Error(ms)}},{key:"prepend",value:function(){throw new Error(ms)}},{key:"getElementById",value:function(n){return this.documentElement.getElementById(n)}},{key:"getElementsByName",value:function(n){return this.documentElement.getElementsByName(n)}},{key:"getElementsByTagName",value:function(n){return this.documentElement.getElementsByTagName(n)}},{key:"getElementsByClassName",value:function(n){return this.documentElement.getElementsByClassName(n)}},{key:"querySelector",value:function(n){return this.documentElement.querySelector(n)}},{key:"querySelectorAll",value:function(n){return this.documentElement.querySelectorAll(n)}},{key:"find",value:function(n){return this.documentElement.find(n)}},{key:"findAll",value:function(n){return this.documentElement.findAll(n)}}])})(De),xA=(function(){function r(t){ot(this,r),this.strategies=t}return lt(r,[{key:"apply",value:function(e){var n=e.config,i=e.camera,a=e.renderingService,s=e.renderingContext,o=this.strategies;a.hooks.cull.tap(r.tag,function(l){if(l){var c,u=l.cullable;if(o.length===0?u.visible=s.unculledEntities.indexOf(l.entity)>-1:u.visible=o.every(function(d){return d.isVisible(i,l)}),!l.isCulled()&&l.isVisible())return l;var h=((c=n.future)===null||c===void 0?void 0:c.experimentalCancelEventPropagation)===!0;return l.dispatchEvent(new rn(Jt.CULLED),h,h),null}return l}),a.hooks.afterRender.tap(r.tag,function(l){l.cullable.visibilityPlaneMask=-1})}}])})();xA.tag="Culling";var wA=(function(){function r(){var t=this;ot(this,r),this.autoPreventDefault=!1,this.rootPointerEvent=new ou(null),this.rootWheelEvent=new wm(null),this.onPointerMove=function(e){var n,i=(n=t.context.renderingContext.root)===null||n===void 0||(n=n.ownerDocument)===null||n===void 0?void 0:n.defaultView;if(!(i.supportsTouchEvents&&e.pointerType==="touch")){var a=t.normalizeToPointerEvent(e,i),s=La(a),o;try{for(s.s();!(o=s.n()).done;){var l=o.value,c=t.bootstrapEvent(t.rootPointerEvent,l,i,e);t.context.eventService.mapEvent(c)}}catch(u){s.e(u)}finally{s.f()}t.setCursor(t.context.eventService.cursor)}},this.onClick=function(e){var n,i=(n=t.context.renderingContext.root)===null||n===void 0||(n=n.ownerDocument)===null||n===void 0?void 0:n.defaultView,a=t.normalizeToPointerEvent(e,i),s=La(a),o;try{for(s.s();!(o=s.n()).done;){var l=o.value,c=t.bootstrapEvent(t.rootPointerEvent,l,i,e);t.context.eventService.mapEvent(c)}}catch(u){s.e(u)}finally{s.f()}t.setCursor(t.context.eventService.cursor)}}return lt(r,[{key:"apply",value:function(e){var n=this;this.context=e;var i=e.renderingService,a=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(s){var o=n.context.renderingService.hooks.pickSync.call({position:s,picked:[],topmost:!0}),l=o.picked;return l[0]||null}),i.hooks.pointerWheel.tap(r.tag,function(s){var o=n.normalizeWheelEvent(s);n.context.eventService.mapEvent(o)}),i.hooks.pointerDown.tap(r.tag,function(s){if(!(a.supportsTouchEvents&&s.pointerType==="touch")){var o=n.normalizeToPointerEvent(s,a);if(n.autoPreventDefault&&o[0].isNormalized){var l=s.cancelable||!("cancelable"in s);l&&s.preventDefault()}var c=La(o),u;try{for(c.s();!(u=c.n()).done;){var h=u.value,d=n.bootstrapEvent(n.rootPointerEvent,h,a,s);n.context.eventService.mapEvent(d)}}catch(f){c.e(f)}finally{c.f()}n.setCursor(n.context.eventService.cursor)}}),i.hooks.pointerUp.tap(r.tag,function(s){if(!(a.supportsTouchEvents&&s.pointerType==="touch")){var o=n.context.contextService.getDomElement(),l=n.context.eventService.isNativeEventFromCanvas(o,s),c=l?"":"outside",u=n.normalizeToPointerEvent(s,a),h=La(u),d;try{for(h.s();!(d=h.n()).done;){var f=d.value,g=n.bootstrapEvent(n.rootPointerEvent,f,a,s);g.type+=c,n.context.eventService.mapEvent(g)}}catch(v){h.e(v)}finally{h.f()}n.setCursor(n.context.eventService.cursor)}}),i.hooks.pointerMove.tap(r.tag,this.onPointerMove),i.hooks.pointerOver.tap(r.tag,this.onPointerMove),i.hooks.pointerOut.tap(r.tag,this.onPointerMove),i.hooks.click.tap(r.tag,this.onClick),i.hooks.pointerCancel.tap(r.tag,function(s){var o=n.normalizeToPointerEvent(s,a),l=La(o),c;try{for(l.s();!(c=l.n()).done;){var u=c.value,h=n.bootstrapEvent(n.rootPointerEvent,u,a,s);n.context.eventService.mapEvent(h)}}catch(d){l.e(d)}finally{l.f()}n.setCursor(n.context.eventService.cursor)})}},{key:"bootstrapEvent",value:function(e,n,i,a){e.view=i,e.originalEvent=null,e.nativeEvent=a,e.pointerId=n.pointerId,e.width=n.width,e.height=n.height,e.isPrimary=n.isPrimary,e.pointerType=n.pointerType,e.pressure=n.pressure,e.tangentialPressure=n.tangentialPressure,e.tiltX=n.tiltX,e.tiltY=n.tiltY,e.twist=n.twist,this.transferMouseData(e,n);var s=this.context.eventService.client2Viewport({x:n.clientX,y:n.clientY}),o=s.x,l=s.y;e.viewport.x=o,e.viewport.y=l;var c=this.context.eventService.viewport2Canvas(e.viewport),u=c.x,h=c.y;return e.canvas.x=u,e.canvas.y=h,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.isTrusted=a.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=l6[e.type]||e.type),e}},{key:"normalizeWheelEvent",value:function(e){var n=this.rootWheelEvent;this.transferMouseData(n,e),n.deltaMode=e.deltaMode,n.deltaX=e.deltaX,n.deltaY=e.deltaY,n.deltaZ=e.deltaZ;var i=this.context.eventService.client2Viewport({x:e.clientX,y:e.clientY}),a=i.x,s=i.y;n.viewport.x=a,n.viewport.y=s;var o=this.context.eventService.viewport2Canvas(n.viewport),l=o.x,c=o.y;return n.canvas.x=l,n.canvas.y=c,n.global.copyFrom(n.canvas),n.offset.copyFrom(n.canvas),n.nativeEvent=e,n.type=e.type,n}},{key:"transferMouseData",value:function(e,n){e.isTrusted=n.isTrusted,e.srcElement=n.srcElement,e.timeStamp=xm.now(),e.type=n.type,e.altKey=n.altKey,e.metaKey=n.metaKey,e.shiftKey=n.shiftKey,e.ctrlKey=n.ctrlKey,e.button=n.button,e.buttons=n.buttons,e.client.x=n.clientX,e.client.y=n.clientY,e.movement.x=n.movementX,e.movement.y=n.movementY,e.page.x=n.pageX,e.page.y=n.pageY,e.screen.x=n.screenX,e.screen.y=n.screenY,e.relatedTarget=null}},{key:"setCursor",value:function(e){this.context.contextService.applyCursorStyle(e||this.context.config.cursor||"default")}},{key:"normalizeToPointerEvent",value:function(e,n){var i=[];if(n.isTouchEvent(e))for(var a=0;a<e.changedTouches.length;a++){var s=e.changedTouches[a];Dt(s.button)&&(s.button=0),Dt(s.buttons)&&(s.buttons=1),Dt(s.isPrimary)&&(s.isPrimary=e.touches.length===1&&e.type==="touchstart"),Dt(s.width)&&(s.width=s.radiusX||1),Dt(s.height)&&(s.height=s.radiusY||1),Dt(s.tiltX)&&(s.tiltX=0),Dt(s.tiltY)&&(s.tiltY=0),Dt(s.pointerType)&&(s.pointerType="touch"),Dt(s.pointerId)&&(s.pointerId=s.identifier||0),Dt(s.pressure)&&(s.pressure=s.force||.5),Dt(s.twist)&&(s.twist=0),Dt(s.tangentialPressure)&&(s.tangentialPressure=0),s.isNormalized=!0,s.type=e.type,i.push(s)}else if(n.isMouseEvent(e)){var o=e;Dt(o.isPrimary)&&(o.isPrimary=!0),Dt(o.width)&&(o.width=1),Dt(o.height)&&(o.height=1),Dt(o.tiltX)&&(o.tiltX=0),Dt(o.tiltY)&&(o.tiltY=0),Dt(o.pointerType)&&(o.pointerType="mouse"),Dt(o.pointerId)&&(o.pointerId=o6),Dt(o.pressure)&&(o.pressure=.5),Dt(o.twist)&&(o.twist=0),Dt(o.tangentialPressure)&&(o.tangentialPressure=0),o.isNormalized=!0,i.push(o)}else i.push(e);return i}}])})();wA.tag="Event";var TF=[nt.CIRCLE,nt.ELLIPSE,nt.IMAGE,nt.RECT,nt.LINE,nt.POLYLINE,nt.POLYGON,nt.TEXT,nt.PATH,nt.HTML],OF=(function(){function r(){ot(this,r)}return lt(r,[{key:"isVisible",value:function(e,n){var i,a=n.cullable;if(!a.enable)return!0;var s=n.getRenderBounds();if(be.isEmpty(s))return!1;var o=e.getFrustum(),l=(i=n.parentNode)===null||i===void 0||(i=i.cullable)===null||i===void 0?void 0:i.visibilityPlaneMask;return a.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(n,s,l||ys.INDETERMINATE,o.planes),a.visible=a.visibilityPlaneMask!==ys.OUTSIDE,a.visible}},{key:"computeVisibilityWithPlaneMask",value:function(e,n,i,a){if(i===ys.OUTSIDE||i===ys.INSIDE)return i;for(var s=ys.INSIDE,o=TF.indexOf(e.nodeName)>-1,l=0,c=a.length;l<c;++l){var u=1<<l;if((i&u)!==0&&!(o&&(l===4||l===5))){var h=a[l],d=h.normal,f=h.distance;if(fi(d,n.getPositiveFarPoint(a[l]))+f<0)return ys.OUTSIDE;fi(d,n.getNegativeFarPoint(a[l]))+f<0&&(s|=u)}}return s}}])})(),EA=(function(){function r(){ot(this,r),this.syncTasks=new Map,this.isFirstTimeRendering=!0,this.syncing=!1,this.isFirstTimeRenderingFinished=!1}return lt(r,[{key:"apply",value:function(e){var n=this,i,a,s=e.config,o=e.renderingService,l=e.renderingContext,c=e.rBushRoot,u=l.root.ownerDocument.defaultView;this.rBush=c;var h=function(m){o.dirtify()},d=function(m){n.syncTasks.set(m.target,m.detail.affectChildren),o.dirtify()},f=function(m){var x=m.target;ct.enableSizeAttenuation&&ct.styleValueRegistry.updateSizeAttenuation(x,u.getCamera().getZoom())},g=function(m){var x=m.target,E=x.rBushNode;E!=null&&E.aabb&&n.rBush.remove(E.aabb),n.syncTasks.delete(x),ct.sceneGraphService.dirtyToRoot(x),o.dirtify()};o.hooks.init.tap(r.tag,function(){u.addEventListener(Jt.MOUNTED,f),u.addEventListener(Jt.UNMOUNTED,g),u.addEventListener(Jt.ATTR_MODIFIED,h),u.addEventListener(Jt.BOUNDS_CHANGED,d)}),o.hooks.destroy.tap(r.tag,function(){u.removeEventListener(Jt.MOUNTED,f),u.removeEventListener(Jt.UNMOUNTED,g),u.removeEventListener(Jt.ATTR_MODIFIED,h),u.removeEventListener(Jt.BOUNDS_CHANGED,d),n.syncTasks.clear()});var v=(i=ct.globalThis.requestIdleCallback)!==null&&i!==void 0?i:x1.bind(ct.globalThis),p=((a=s.future)===null||a===void 0?void 0:a.experimentalRICSyncRTree)===!0;o.hooks.endFrame.tap(r.tag,function(){n.isFirstTimeRendering?(n.isFirstTimeRendering=!1,n.syncing=!0,v(function(){n.syncRTree(!0),n.isFirstTimeRenderingFinished=!0})):p&&ct.globalThis.requestIdleCallback&&ct.globalThis.cancelIdleCallback?(ct.globalThis.cancelIdleCallback(n.ricSyncRTreeId),n.ricSyncRTreeId=ct.globalThis.requestIdleCallback(function(){return n.syncRTree()})):n.syncRTree()})}},{key:"syncNode",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e.isConnected){var i=e.rBushNode;i.aabb&&this.rBush.remove(i.aabb);var a=e.getRenderBounds();if(a){var s=e.renderable;n&&(s.dirtyRenderBounds||(s.dirtyRenderBounds=new be),s.dirtyRenderBounds.update(a.center,a.halfExtents));var o=a.getMin(),l=$t(o,2),c=l[0],u=l[1],h=a.getMax(),d=$t(h,2),f=d[0],g=d[1];i.aabb||(i.aabb={}),i.aabb.displayObject=e,i.aabb.minX=c,i.aabb.minY=u,i.aabb.maxX=f,i.aabb.maxY=g}if(i.aabb&&!isNaN(i.aabb.maxX)&&!isNaN(i.aabb.maxX)&&!isNaN(i.aabb.minX)&&!isNaN(i.aabb.minY))return i.aabb}}},{key:"syncRTree",value:function(){var e=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!n&&(this.syncing||this.syncTasks.size===0))){this.syncing=!0;var i=[],a=new Set,s=function(l){if(!a.has(l)&&l.renderable){var c=e.syncNode(l,n);c&&(i.push(c),a.add(l))}};this.syncTasks.forEach(function(o,l){o&&l.forEach(s);for(var c=l;c;)s(c),c=c.parentElement}),this.rBush.load(i),i.length=0,this.syncing=!1}}}])})();EA.tag="Prepare";var gr=(function(r){return r.READY="ready",r.BEFORE_RENDER="beforerender",r.RERENDER="rerender",r.AFTER_RENDER="afterrender",r.BEFORE_DESTROY="beforedestroy",r.AFTER_DESTROY="afterdestroy",r.RESIZE="resize",r.DIRTY_RECTANGLE="dirtyrectangle",r.RENDERER_CHANGED="rendererchanged",r})({}),Ix=500,AF=.1,NF=1e3,Yl=new rn(Jt.MOUNTED),Hl=new rn(Jt.UNMOUNTED),Cd=new rn(gr.BEFORE_RENDER),Dx=new rn(gr.RERENDER),Rd=new rn(gr.AFTER_RENDER),_m=(function(r){function t(e){var n;ot(this,t),n=Yt(this,t),n.Element=Se,n.inited=!1,n.context={};var i=e.container,a=e.canvas,s=e.renderer,o=e.width,l=e.height,c=e.background,u=e.cursor,h=e.supportsMutipleCanvasesInOneContainer,d=e.cleanUpOnDestroy,f=d===void 0?!0:d,g=e.offscreenCanvas,v=e.devicePixelRatio,p=e.requestAnimationFrame,y=e.cancelAnimationFrame,m=e.createImage,x=e.supportsTouchEvents,E=e.supportsPointerEvents,_=e.isTouchEvent,M=e.isMouseEvent,O=e.dblClickSpeed,T=o,N=l,P=v||b1&&window.devicePixelRatio||1;return P=P>=1?Math.ceil(P):1,a&&(T=o||a6(a)||a.width/P,N=l||s6(a)||a.height/P),n.customElements=new MF,n.devicePixelRatio=P,n.requestAnimationFrame=p??x1.bind(ct.globalThis),n.cancelAnimationFrame=y??gA.bind(ct.globalThis),n.createImage=m??function(){return new window.Image},n.supportsTouchEvents=x??"ontouchstart"in ct.globalThis,n.supportsPointerEvents=E??!!ct.globalThis.PointerEvent,n.isTouchEvent=_??function(C){return n.supportsTouchEvents&&C instanceof ct.globalThis.TouchEvent},n.isMouseEvent=M??function(C){return!ct.globalThis.MouseEvent||C instanceof ct.globalThis.MouseEvent&&(!n.supportsPointerEvents||!(C instanceof ct.globalThis.PointerEvent))},g&&(ct.offscreenCanvas=g),n.document=new bA,n.document.defaultView=n,h||e6(i,n,f),n.initRenderingContext(Vt(Vt({},e),{},{width:T,height:N,background:c??"transparent",cursor:u??"default",cleanUpOnDestroy:f,devicePixelRatio:P,requestAnimationFrame:n.requestAnimationFrame,cancelAnimationFrame:n.cancelAnimationFrame,createImage:n.createImage,supportsTouchEvents:n.supportsTouchEvents,supportsPointerEvents:n.supportsPointerEvents,isTouchEvent:n.isTouchEvent,isMouseEvent:n.isMouseEvent,dblClickSpeed:O??200})),n.initDefaultCamera(T,N,s.clipSpaceNearZ),n.initRenderer(s,!0),n}return Ht(t,r),lt(t,[{key:"initRenderingContext",value:function(n){this.context.config=n,this.context.renderingContext={root:this.document.documentElement,unculledEntities:[],renderListCurrentFrame:[],renderReasons:new Set,force:!1,dirty:!1}}},{key:"initDefaultCamera",value:function(n,i,a){var s=this,o=new ct.CameraContribution;o.clipSpaceNearZ=a,o.setType(ue.EXPLORING,dm.DEFAULT).setPosition(n/2,i/2,Ix).setFocalPoint(n/2,i/2,0).setOrthographic(n/-2,n/2,i/2,i/-2,AF,NF),o.canvas=this,o.eventEmitter.on($O.UPDATED,function(){s.context.renderingContext.renderReasons.add(Is.CAMERA_CHANGED),ct.enableSizeAttenuation&&s.getConfig().renderer.getConfig().enableSizeAttenuation&&s.updateSizeAttenuation()}),this.context.camera=o}},{key:"updateSizeAttenuation",value:function(){var n=this.getCamera().getZoom();this.document.documentElement.forEach(function(i){ct.styleValueRegistry.updateSizeAttenuation(i,n)})}},{key:"getConfig",value:function(){return this.context.config}},{key:"getRoot",value:function(){return this.document.documentElement}},{key:"getCamera",value:function(){return this.context.camera}},{key:"getContextService",value:function(){return this.context.contextService}},{key:"getEventService",value:function(){return this.context.eventService}},{key:"getRenderingService",value:function(){return this.context.renderingService}},{key:"getRenderingContext",value:function(){return this.context.renderingContext}},{key:"getStats",value:function(){return this.getRenderingService().getStats()}},{key:"ready",get:function(){var n=this;return this.readyPromise||(this.readyPromise=new Promise(function(i){n.resolveReadyPromise=function(){i(n)}}),this.inited&&this.resolveReadyPromise()),this.readyPromise}},{key:"destroy",value:function(){var n,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,a=arguments.length>1?arguments[1]:void 0;Je.clearCache();var s=((n=this.getConfig().future)===null||n===void 0?void 0:n.experimentalCancelEventPropagation)===!0;a||this.dispatchEvent(new rn(gr.BEFORE_DESTROY),s,s),this.frameId&&this.cancelAnimationFrame(this.frameId);var o=this.getRoot();i&&(this.unmountChildren(o),this.document.destroy(),this.getEventService().destroy()),this.getRenderingService().destroy(),this.getContextService().destroy(),this.context.rBushRoot&&this.context.rBushRoot.clear(),a||this.dispatchEvent(new rn(gr.AFTER_DESTROY),s,s);var l=function(u){u.currentTarget=null,u.manager=null,u.target=null,u.relatedNode=null};l(Yl),l(Hl),l(Cd),l(Dx),l(Rd),l(ci),l(Em),l(Sm),l(mA),ct.textService.clearCache()}},{key:"changeSize",value:function(n,i){this.resize(n,i)}},{key:"resize",value:function(n,i){var a,s=this.context.config;s.width=n,s.height=i,this.getContextService().resize(n,i);var o=this.context.camera,l=o.getProjectionMode();o.setPosition(n/2,i/2,Ix).setFocalPoint(n/2,i/2,0),l===Ar.ORTHOGRAPHIC?o.setOrthographic(n/-2,n/2,i/2,i/-2,o.getNear(),o.getFar()):o.setAspect(n/i);var c=((a=s.future)===null||a===void 0?void 0:a.experimentalCancelEventPropagation)===!0;this.dispatchEvent(new rn(gr.RESIZE,{width:n,height:i}),c,c)}},{key:"appendChild",value:function(n,i){return this.document.documentElement.appendChild(n,i)}},{key:"insertBefore",value:function(n,i){return this.document.documentElement.insertBefore(n,i)}},{key:"removeChild",value:function(n){return this.document.documentElement.removeChild(n)}},{key:"removeChildren",value:function(){this.document.documentElement.removeChildren()}},{key:"destroyChildren",value:function(){this.document.documentElement.destroyChildren()}},{key:"render",value:function(n){var i,a=this;n&&(Cd.detail=n,Rd.detail=n);var s=((i=this.getConfig().future)===null||i===void 0?void 0:i.experimentalCancelEventPropagation)===!0;this.dispatchEvent(Cd,s,s);var o=this.getRenderingService();o.render(this.getConfig(),n,function(){a.dispatchEvent(Dx,s,s)}),this.dispatchEvent(Rd,s,s)}},{key:"run",value:function(){var n=this,i=function(s,o){n.render(o),n.frameId=n.requestAnimationFrame(i)};i()}},{key:"initRenderer",value:function(n){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!n)throw new Error("Renderer is required.");this.inited=!1,this.readyPromise=void 0,this.context.rBushRoot=new tI,this.context.renderingPlugins=[],this.context.renderingPlugins.push(new wA,new EA,new xA([new OF])),this.loadRendererContainerModule(n),this.context.contextService=new this.context.ContextService(Vt(Vt({},ct),this.context)),this.context.renderingService=new q6(ct,this.context),this.context.eventService=new j6(ct,this.context),this.context.eventService.init(),this.context.contextService.init?(this.context.contextService.init(),this.initRenderingService(n,a,!0)):this.context.contextService.initAsync().then(function(){i.initRenderingService(n,a)}).catch(function(s){console.error(s)})}},{key:"initRenderingService",value:function(n){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.context.renderingService.init(function(){var o;i.inited=!0;var l=((o=i.getConfig().future)===null||o===void 0?void 0:o.experimentalCancelEventPropagation)===!0;a?s?i.requestAnimationFrame(function(){i.dispatchEvent(new rn(gr.READY),l,l)}):i.dispatchEvent(new rn(gr.READY),l,l):i.dispatchEvent(new rn(gr.RENDERER_CHANGED),l,l),i.readyPromise&&i.resolveReadyPromise(),a||i.getRoot().forEach(function(c){var u,h;(u=(h=c).dirty)===null||u===void 0||u.call(h,!0,!0)}),i.mountChildren(i.getRoot()),n.getConfig().enableAutoRendering&&i.run()})}},{key:"loadRendererContainerModule",value:function(n){var i=this,a=n.getPlugins();a.forEach(function(s){s.context=i.context,s.init(ct)})}},{key:"setRenderer",value:function(n){var i=this.getConfig();if(i.renderer!==n){var a=i.renderer;i.renderer=n,this.destroy(!1,!0),ne((a==null?void 0:a.getPlugins())||[]).reverse().forEach(function(s){s.destroy(ct)}),this.initRenderer(n)}}},{key:"setCursor",value:function(n){var i=this.getConfig();i.cursor=n,this.getContextService().applyCursorStyle(n)}},{key:"unmountChildren",value:function(n){var i=this;if(n.childNodes.forEach(function(o){i.unmountChildren(o)}),this.inited){if(n.isMutationObserved)n.dispatchEvent(Hl);else{var a,s=((a=this.getConfig().future)===null||a===void 0?void 0:a.experimentalCancelEventPropagation)===!0;Hl.target=n,this.dispatchEvent(Hl,!0,s)}n!==this.document.documentElement&&(n.ownerDocument=null),n.isConnected=!1}n.isCustomElement&&n.disconnectedCallback&&n.disconnectedCallback()}},{key:"mountChildren",value:function(n){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:su(n);if(this.inited){if(!n.isConnected&&(n.ownerDocument=this.document,n.isConnected=!0,!a))if(n.isMutationObserved)n.dispatchEvent(Yl);else{var s,o=((s=this.getConfig().future)===null||s===void 0?void 0:s.experimentalCancelEventPropagation)===!0;Yl.target=n,this.dispatchEvent(Yl,!0,o)}}else console.warn("[g]: You are trying to call `canvas.appendChild` before canvas' initialization finished. You can either await `canvas.ready` or listen to `CanvasEvent.READY` manually.","appended child: ",n.nodeName);n.childNodes.forEach(function(l){i.mountChildren(l,a)}),n.isCustomElement&&n.connectedCallback&&n.connectedCallback()}},{key:"mountFragment",value:function(n){this.mountChildren(n,!1)}},{key:"client2Viewport",value:function(n){return this.getEventService().client2Viewport(n)}},{key:"viewport2Client",value:function(n){return this.getEventService().viewport2Client(n)}},{key:"viewport2Canvas",value:function(n){return this.getEventService().viewport2Canvas(n)}},{key:"canvas2Viewport",value:function(n){return this.getEventService().canvas2Viewport(n)}},{key:"getPointByClient",value:function(n,i){return this.client2Viewport({x:n,y:i})}},{key:"getClientByPoint",value:function(n,i){return this.viewport2Client({x:n,y:i})}}])})(yA);/*!
 * @antv/g-camera-api
 * @description A simple implementation of Camera API.
 * @version 2.0.41
 * @date 7/30/2025, 1:34:37 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var PF=(function(r){function t(){var e;ot(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=Yt(this,t,[].concat(i)),e.landmarks=[],e}return Ht(t,r),lt(t,[{key:"rotate",value:function(n,i,a){if(this.relElevation=Cs(i),this.relAzimuth=Cs(n),this.relRoll=Cs(a),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.type===ue.EXPLORING){var s=Qi(nn(),[1,0,0],de((this.rotateWorld?1:-1)*this.relElevation)),o=Qi(nn(),[0,1,0],de((this.rotateWorld?1:-1)*this.relAzimuth)),l=Qi(nn(),[0,0,1],de(this.relRoll)),c=la(nn(),o,s);c=la(nn(),c,l);var u=c1(ve(),c);Ps(this.matrix,this.matrix,[0,0,-this.distance]),Bn(this.matrix,this.matrix,u),Ps(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation)>90)return this;this.computeMatrix()}return this._getAxes(),this.type===ue.ORBITING||this.type===ue.EXPLORING?this._getPosition():this.type===ue.TRACKING&&this._getFocalPoint(),this._update(),this}},{key:"pan",value:function(n,i){var a=Gn(n,i,0),s=Oi(this.position);return oa(s,s,Yc(te(),this.right,a[0])),oa(s,s,Yc(te(),this.up,a[1])),this._setPosition(s),this.triggerUpdate(),this}},{key:"dolly",value:function(n){var i=this.forward,a=Oi(this.position),s=n*this.dollyingStep,o=this.distance+n*this.dollyingStep;return s=Math.max(Math.min(o,this.maxDistance),this.minDistance)-this.distance,a[0]+=s*i[0],a[1]+=s*i[1],a[2]+=s*i[2],this._setPosition(a),this.type===ue.ORBITING||this.type===ue.EXPLORING?this._getDistance():this.type===ue.TRACKING&&oa(this.focalPoint,a,this.distanceVector),this.triggerUpdate(),this}},{key:"cancelLandmarkAnimation",value:function(){this.landmarkAnimationID!==void 0&&this.canvas.cancelAnimationFrame(this.landmarkAnimationID)}},{key:"createLandmark",value:function(n){var i,a,s,o,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},c=l.position,u=c===void 0?this.position:c,h=l.focalPoint,d=h===void 0?this.focalPoint:h,f=l.roll,g=l.zoom,v=new ct.CameraContribution;v.setType(this.type,void 0),v.setPosition(u[0],(i=u[1])!==null&&i!==void 0?i:this.position[1],(a=u[2])!==null&&a!==void 0?a:this.position[2]),v.setFocalPoint(d[0],(s=d[1])!==null&&s!==void 0?s:this.focalPoint[1],(o=d[2])!==null&&o!==void 0?o:this.focalPoint[2]),v.setRoll(f??this.roll),v.setZoom(g??this.zoom);var p={name:n,matrix:rO(v.getWorldTransform()),right:Oi(v.right),up:Oi(v.up),forward:Oi(v.forward),position:Oi(v.getPosition()),focalPoint:Oi(v.getFocalPoint()),distanceVector:Oi(v.getDistanceVector()),distance:v.getDistance(),dollyingStep:v.getDollyingStep(),azimuth:v.getAzimuth(),elevation:v.getElevation(),roll:v.getRoll(),relAzimuth:v.relAzimuth,relElevation:v.relElevation,relRoll:v.relRoll,zoom:v.getZoom()};return this.landmarks.push(p),p}},{key:"gotoLandmark",value:function(n){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=ae(n)?this.landmarks.find(function(C){return C.name===n}):n;if(s){var o=St(a)?{duration:a}:a,l=o.easing,c=l===void 0?"linear":l,u=o.duration,h=u===void 0?100:u,d=o.easingFunction,f=d===void 0?void 0:d,g=o.onfinish,v=g===void 0?void 0:g,p=o.onframe,y=p===void 0?void 0:p,m=.01;this.cancelLandmarkAnimation();var x=s.position,E=s.focalPoint,_=s.zoom,M=s.roll,O=f||ct.EasingFunction(c),T,N=function(){i.setFocalPoint(E),i.setPosition(x),i.setRoll(M),i.setZoom(_),i.computeMatrix(),i.triggerUpdate(),v==null||v()};if(h===0)return N();var P=function(R){T===void 0&&(T=R);var I=R-T;if(I>=h){N();return}var j=O(I/h),G=te(),H=te(),Z=1,U=0;em(G,i.focalPoint,E,j),em(H,i.position,x,j),U=i.roll*(1-j)+M*j,Z=i.zoom*(1-j)+_*j,i.setFocalPoint(G),i.setPosition(H),i.setRoll(U),i.setZoom(Z);var tt=Gb(G,E)+Gb(H,x);if(tt<=m&&_===void 0&&M===void 0)return N();i.computeMatrix(),i.triggerUpdate(),I<h&&(y==null||y(j),i.landmarkAnimationID=i.canvas.requestAnimationFrame(P))};this.canvas.requestAnimationFrame(P)}}}])})(WO);ct.CameraContribution=PF;/*!
 * @antv/g-web-animations-api
 * @description A simple implementation of Web Animations API.
 * @version 2.1.28
 * @date 7/30/2025, 1:36:24 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var Ld=(function(r){function t(e,n,i,a){var s;return ot(this,t),s=Yt(this,t,[e]),s.currentTime=i,s.timelineTime=a,s.target=n,s.type="finish",s.bubbles=!1,s.currentTarget=n,s.defaultPrevented=!1,s.eventPhase=s.AT_TARGET,s.timeStamp=Date.now(),s.currentTime=i,s.timelineTime=a,s}return Ht(t,r),lt(t)})(Ru),CF=0,RF=(function(){function r(t,e){var n;ot(this,r),this.currentTimePending=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._playbackRate=1,this._inTimeline=!0,this.effect=t,t.animation=this,this.timeline=e,this.id="".concat(CF++),this._inEffect=!!this.effect.update(0),this._totalDuration=Number((n=this.effect)===null||n===void 0?void 0:n.getComputedTiming().endTime),this._holdTime=0,this._paused=!1,this.oldPlayState="idle",this.updatePromises()}return lt(r,[{key:"pending",get:function(){return this._startTime===null&&!this._paused&&this.playbackRate!==0||this.currentTimePending}},{key:"playState",get:function(){return this._idle?"idle":this._isFinished?"finished":this._paused?"paused":"running"}},{key:"ready",get:function(){var e=this;return this.readyPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.readyPromise=new Promise(function(n,i){e.resolveReadyPromise=function(){n(e)},e.rejectReadyPromise=function(){i(new Error)}}),this.pending||this.resolveReadyPromise()),this.readyPromise}},{key:"finished",get:function(){var e=this;return this.finishedPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.finishedPromise=new Promise(function(n,i){e.resolveFinishedPromise=function(){n(e)},e.rejectFinishedPromise=function(){i(new Error)}}),this.playState==="finished"&&this.resolveFinishedPromise()),this.finishedPromise}},{key:"currentTime",get:function(){return this.updatePromises(),this._idle||this.currentTimePending?null:this._currentTime},set:function(e){if(e=Number(e),!isNaN(e)){if(this.timeline.restart(),!this._paused&&this._startTime!==null){var n;this._startTime=Number((n=this.timeline)===null||n===void 0?void 0:n.currentTime)-e/this.playbackRate}this.currentTimePending=!1,this._currentTime!==e&&(this._idle&&(this._idle=!1,this._paused=!0),this.tickCurrentTime(e,!0),this.timeline.applyDirtiedAnimation(this))}}},{key:"startTime",get:function(){return this._startTime},set:function(e){if(e!==null){if(this.updatePromises(),e=Number(e),isNaN(e)||this._paused||this._idle)return;this._startTime=e,this.tickCurrentTime((Number(this.timeline.currentTime)-this._startTime)*this.playbackRate),this.timeline.applyDirtiedAnimation(this),this.updatePromises()}}},{key:"playbackRate",get:function(){return this._playbackRate},set:function(e){if(e!==this._playbackRate){this.updatePromises();var n=this.currentTime;this._playbackRate=e,this.startTime=null,this.playState!=="paused"&&this.playState!=="idle"&&(this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this)),n!==null&&(this.currentTime=n),this.updatePromises()}}},{key:"_isFinished",get:function(){return!this._idle&&(this._playbackRate>0&&Number(this._currentTime)>=this._totalDuration||this._playbackRate<0&&Number(this._currentTime)<=0)}},{key:"totalDuration",get:function(){return this._totalDuration}},{key:"_needsTick",get:function(){return this.pending||this.playState==="running"||!this._finishedFlag}},{key:"updatePromises",value:function(){var e;if((e=this.effect.target)!==null&&e!==void 0&&e.destroyed)return this.readyPromise=void 0,this.finishedPromise=void 0,!1;var n=this.oldPlayState,i=this.pending?"pending":this.playState;return this.readyPromise&&i!==n&&(i==="idle"?(this.rejectReadyPromise(),this.readyPromise=void 0):n==="pending"?this.resolveReadyPromise():i==="pending"&&(this.readyPromise=void 0)),this.finishedPromise&&i!==n&&(i==="idle"?(this.rejectFinishedPromise(),this.finishedPromise=void 0):i==="finished"?this.resolveFinishedPromise():n==="finished"&&(this.finishedPromise=void 0)),this.oldPlayState=i,this.readyPromise||this.finishedPromise}},{key:"play",value:function(){this.updatePromises(),this._paused=!1,(this._isFinished||this._idle)&&(this.rewind(),this._startTime=null),this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this),this.timeline.animations.indexOf(this)===-1&&this.timeline.animations.push(this),this.updatePromises()}},{key:"pause",value:function(){this.updatePromises(),this.currentTime&&(this._holdTime=this.currentTime),!this._isFinished&&!this._paused&&!this._idle?this.currentTimePending=!0:this._idle&&(this.rewind(),this._idle=!1),this._startTime=null,this._paused=!0,this.updatePromises()}},{key:"finish",value:function(){this.updatePromises(),!this._idle&&(this.currentTime=this._playbackRate>0?this._totalDuration:0,this._startTime=this._totalDuration-this.currentTime,this.currentTimePending=!1,this.timeline.applyDirtiedAnimation(this),this.updatePromises())}},{key:"cancel",value:function(){var e=this;if(this.updatePromises(),!!this._inEffect&&(this._inEffect=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._startTime=null,this.effect.update(null),this.timeline.applyDirtiedAnimation(this),this.updatePromises(),this.oncancel)){var n=new Ld(null,this,this.currentTime,null);setTimeout(function(){e.oncancel(n)})}}},{key:"reverse",value:function(){this.updatePromises();var e=this.currentTime;this.playbackRate*=-1,this.play(),e!==null&&(this.currentTime=e),this.updatePromises()}},{key:"updatePlaybackRate",value:function(e){this.playbackRate=e}},{key:"targetAnimations",value:function(){var e,n=(e=this.effect)===null||e===void 0?void 0:e.target;return n.getAnimations()}},{key:"markTarget",value:function(){var e=this.targetAnimations();e.indexOf(this)===-1&&e.push(this)}},{key:"unmarkTarget",value:function(){var e=this.targetAnimations(),n=e.indexOf(this);n!==-1&&e.splice(n,1)}},{key:"tick",value:function(e,n){!this._idle&&!this._paused&&(this._startTime===null?n&&(this.startTime=e-this._currentTime/this.playbackRate):this._isFinished||this.tickCurrentTime((e-this._startTime)*this.playbackRate)),n&&(this.currentTimePending=!1,this.fireEvents(e))}},{key:"rewind",value:function(){if(this.playbackRate>=0)this.currentTime=0;else if(this._totalDuration<1/0)this.currentTime=this._totalDuration;else throw new Error("Unable to rewind negative playback rate animation with infinite duration")}},{key:"persist",value:function(){throw new Error(he)}},{key:"addEventListener",value:function(e,n,i){throw new Error(he)}},{key:"removeEventListener",value:function(e,n,i){throw new Error(he)}},{key:"dispatchEvent",value:function(e){throw new Error(he)}},{key:"commitStyles",value:function(){throw new Error(he)}},{key:"ensureAlive",value:function(){if(this.playbackRate<0&&this.currentTime===0){var e;this._inEffect=!!((e=this.effect)!==null&&e!==void 0&&e.update(-1))}else{var n;this._inEffect=!!((n=this.effect)!==null&&n!==void 0&&n.update(this.currentTime))}!this._inTimeline&&(this._inEffect||!this._finishedFlag)&&(this._inTimeline=!0,this.timeline.animations.push(this))}},{key:"tickCurrentTime",value:function(e,n){e!==this._currentTime&&(this._currentTime=e,this._isFinished&&!n&&(this._currentTime=this._playbackRate>0?this._totalDuration:0),this.ensureAlive())}},{key:"fireEvents",value:function(e){var n=this;if(this._isFinished){if(!this._finishedFlag){if(this.onfinish){var i=new Ld(null,this,this.currentTime,e);setTimeout(function(){n.onfinish&&n.onfinish(i)})}this._finishedFlag=!0}}else{if(this.onframe&&this.playState==="running"){var a=new Ld(null,this,this.currentTime,e);this.onframe(a)}this._finishedFlag=!1}}}])})(),LF=4,IF=.001,DF=1e-7,FF=10,Eo=11,Xl=1/(Eo-1),BF=typeof Float32Array=="function",SA=function(t,e){return 1-3*e+3*t},_A=function(t,e){return 3*e-6*t},kA=function(t){return 3*t},lu=function(t,e,n){return((SA(e,n)*t+_A(e,n))*t+kA(e))*t},MA=function(t,e,n){return 3*SA(e,n)*t*t+2*_A(e,n)*t+kA(e)},zF=function(t,e,n,i,a){var s,o,l=0;do o=e+(n-e)/2,s=lu(o,i,a)-t,s>0?n=o:e=o;while(Math.abs(s)>DF&&++l<FF);return o},jF=function(t,e,n,i){for(var a=0;a<LF;++a){var s=MA(e,n,i);if(s===0)return e;var o=lu(e,n,i)-t;e-=o/s}return e},S1=function(t,e,n,i){if(!(t>=0&&t<=1&&n>=0&&n<=1))throw new Error("bezier x values must be in [0, 1] range");if(t===e&&n===i)return function(l){return l};for(var a=BF?new Float32Array(Eo):new Array(Eo),s=0;s<Eo;++s)a[s]=lu(s*Xl,t,n);var o=function(c){for(var u=0,h=1,d=Eo-1;h!==d&&a[h]<=c;++h)u+=Xl;--h;var f=(c-a[h])/(a[h+1]-a[h]),g=u+f*Xl,v=MA(g,t,n);return v>=IF?jF(c,g,t,n):v===0?g:zF(c,u,u+Xl,t,n)};return function(l){return l===0||l===1?l:lu(o(l),e,i)}},qF=function(t){return t=t.replace(/([A-Z])/g,function(e){return"-".concat(e.toLowerCase())}),t.charAt(0)==="-"?t.substring(1):t},Kl=function(t){return Math.pow(t,2)},Zl=function(t){return Math.pow(t,3)},Jl=function(t){return Math.pow(t,4)},Ql=function(t){return Math.pow(t,5)},tc=function(t){return Math.pow(t,6)},ec=function(t){return 1-Math.cos(t*Math.PI/2)},nc=function(t){return 1-Math.sqrt(1-t*t)},rc=function(t){return t*t*(3*t-2)},ic=function(t){for(var e,n=4;t<((e=Math.pow(2,--n))-1)/11;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((e*3-2)/22-t,2)},ac=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=$t(e,2),i=n[0],a=i===void 0?1:i,s=n[1],o=s===void 0?.5:s,l=qe(Number(a),1,10),c=qe(Number(o),.1,2);return t===0||t===1?t:-l*Math.pow(2,10*(t-1))*Math.sin((t-1-c/(Math.PI*2)*Math.asin(1/l))*(Math.PI*2)/c)},go=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,i=$t(e,4),a=i[0],s=a===void 0?1:a,o=i[1],l=o===void 0?100:o,c=i[2],u=c===void 0?10:c,h=i[3],d=h===void 0?0:h;s=qe(s,.1,1e3),l=qe(l,.1,1e3),u=qe(u,.1,1e3),d=qe(d,.1,1e3);var f=Math.sqrt(l/s),g=u/(2*Math.sqrt(l*s)),v=g<1?f*Math.sqrt(1-g*g):0,p=1,y=g<1?(g*f+-d)/v:-d+f,m=n?n*t/1e3:t;return g<1?m=Math.exp(-m*g*f)*(p*Math.cos(v*m)+y*Math.sin(v*m)):m=(p+y*m)*Math.exp(-m*f),t===0||t===1?t:1-m},Id=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=e,i=$t(n,2),a=i[0],s=a===void 0?10:a,o=i[1],l=o==="start"?Math.ceil:Math.floor;return l(qe(t,0,1)*s)/s},Fx=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=$t(e,4),i=n[0],a=n[1],s=n[2],o=n[3];return S1(i,a,s,o)(t)},sc=S1(.42,0,1,1),Mr=function(t){return function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0;return 1-t(1-e,n,i)}},Tr=function(t){return function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0;return e<.5?t(e*2,n,i)/2:1-t(e*-2+2,n,i)/2}},Or=function(t){return function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0;return e<.5?(1-t(1-e*2,n,i))/2:(t(e*2-1,n,i)+1)/2}},Bx={steps:Id,"step-start":function(t){return Id(t,[1,"start"])},"step-end":function(t){return Id(t,[1,"end"])},linear:function(t){return t},"cubic-bezier":Fx,ease:function(t){return Fx(t,[.25,.1,.25,1])},in:sc,out:Mr(sc),"in-out":Tr(sc),"out-in":Or(sc),"in-quad":Kl,"out-quad":Mr(Kl),"in-out-quad":Tr(Kl),"out-in-quad":Or(Kl),"in-cubic":Zl,"out-cubic":Mr(Zl),"in-out-cubic":Tr(Zl),"out-in-cubic":Or(Zl),"in-quart":Jl,"out-quart":Mr(Jl),"in-out-quart":Tr(Jl),"out-in-quart":Or(Jl),"in-quint":Ql,"out-quint":Mr(Ql),"in-out-quint":Tr(Ql),"out-in-quint":Or(Ql),"in-expo":tc,"out-expo":Mr(tc),"in-out-expo":Tr(tc),"out-in-expo":Or(tc),"in-sine":ec,"out-sine":Mr(ec),"in-out-sine":Tr(ec),"out-in-sine":Or(ec),"in-circ":nc,"out-circ":Mr(nc),"in-out-circ":Tr(nc),"out-in-circ":Or(nc),"in-back":rc,"out-back":Mr(rc),"in-out-back":Tr(rc),"out-in-back":Or(rc),"in-bounce":ic,"out-bounce":Mr(ic),"in-out-bounce":Tr(ic),"out-in-bounce":Or(ic),"in-elastic":ac,"out-elastic":Mr(ac),"in-out-elastic":Tr(ac),"out-in-elastic":Or(ac),spring:go,"spring-in":go,"spring-out":Mr(go),"spring-in-out":Tr(go),"spring-out-in":Or(go)},GF=function(t){return qF(t).replace(/^ease-/,"").replace(/(\(|\s).+/,"").toLowerCase().trim()},$F=function(t){return Bx[GF(t)]||Bx.linear},WF=function(t){return t},VF=1,UF=.5,zx=0;function jx(r,t){return function(e){if(e>=1)return 1;var n=1/r;return e+=t*n,e-e%n}}var oc="\\s*(-?\\d+\\.?\\d*|-?\\.\\d+)\\s*",YF=new RegExp("cubic-bezier\\(".concat(oc,",").concat(oc,",").concat(oc,",").concat(oc,"\\)")),HF=/steps\(\s*(\d+)\s*\)/,XF=/steps\(\s*(\d+)\s*,\s*(start|middle|end)\s*\)/;function _1(r){var t=YF.exec(r);if(t)return S1.apply(void 0,ne(t.slice(1).map(Number)));var e=HF.exec(r);if(e)return jx(Number(e[1]),zx);var n=XF.exec(r);return n?jx(Number(n[1]),{start:VF,middle:UF,end:zx}[n[2]]):$F(r)}function KF(r){return Math.abs(ZF(r)/(r.playbackRate||1))}function ZF(r){var t;return r.duration===0||r.iterations===0?0:(r.duration==="auto"?0:Number(r.duration))*((t=r.iterations)!==null&&t!==void 0?t:1)}var TA=0,k1=1,Iu=2,OA=3;function JF(r,t,e){if(t===null)return TA;var n=e.endTime;return t<Math.min(e.delay,n)?k1:t>=Math.min(e.delay+r+e.endDelay,n)?Iu:OA}function QF(r,t,e,n,i){switch(n){case k1:return t==="backwards"||t==="both"?0:null;case OA:return e-i;case Iu:return t==="forwards"||t==="both"?r:null;case TA:return null}}function tB(r,t,e,n,i){var a=i;return r===0?t!==k1&&(a+=e):a+=n/r,a}function eB(r,t,e,n,i,a){var s=r===1/0?t%1:r%1;return s===0&&e===Iu&&n!==0&&(i!==0||a===0)&&(s=1),s}function nB(r,t,e,n){return r===Iu&&t===1/0?1/0:e===1?Math.floor(n)-1:Math.floor(n)}function rB(r,t,e){var n=r;if(r!=="normal"&&r!=="reverse"){var i=t;r==="alternate-reverse"&&(i+=1),n="normal",i!==1/0&&i%2!==0&&(n="reverse")}return n==="normal"?e:1-e}function iB(r,t,e){var n=JF(r,t,e),i=QF(r,e.fill,t,n,e.delay);if(i===null)return null;var a=e.duration==="auto"?0:e.duration,s=tB(a,n,e.iterations,i,e.iterationStart),o=eB(s,e.iterationStart,n,e.iterations,i,a),l=nB(n,e.iterations,o,s),c=rB(e.direction,l,o);return e.currentIteration=l,e.progress=c,e.easingFunction(c)}function aB(r,t,e){var n=sB(r,t),i=oB(n,e);return function(a,s){if(s!==null)i.filter(function(l){return s>=l.applyFrom&&s<l.applyTo}).forEach(function(l){var c=s-l.startOffset,u=l.endOffset-l.startOffset,h=u===0?0:c/u;a.setAttribute(l.property,l.interpolation(h),!1,!1)});else for(var o in n)AA(o)&&a.setAttribute(o,null)}}function AA(r){return r!=="offset"&&r!=="easing"&&r!=="composite"&&r!=="computedOffset"}function sB(r,t){for(var e={},n=0;n<r.length;n++)for(var i in r[n])if(AA(i)){var a={offset:r[n].offset,computedOffset:r[n].computedOffset,easing:r[n].easing,easingFunction:_1(r[n].easing)||t.easingFunction,value:r[n][i]};e[i]=e[i]||[],e[i].push(a)}return e}function oB(r,t){var e=[];for(var n in r)for(var i=r[n],a=0;a<i.length-1;a++){var s=a,o=a+1,l=i[s].computedOffset,c=i[o].computedOffset,u=l,h=c;a===0&&(u=-1/0,c===0&&(o=s)),a===i.length-2&&(h=1/0,l===1&&(s=o)),e.push({applyFrom:u,applyTo:h,startOffset:i[s].computedOffset,endOffset:i[o].computedOffset,easingFunction:i[s].easingFunction,property:n,interpolation:lB(n,i[s].value,i[o].value,t)})}return e.sort(function(d,f){return d.startOffset-f.startOffset}),e}var qx=function(t,e,n){return function(i){var a=NA(t,e,i);return St(a)?a:n(a)}};function lB(r,t,e,n){var i=oA[r];if(i&&i.syntax&&i.int){var a=ct.styleValueRegistry.getPropertySyntax(i.syntax);if(a){var s=a.parser,o=s?s(t,n):t,l=s?s(e,n):e,c=a.mixer(o,l,n);if(c){var u=qx.apply(void 0,ne(c));return function(h){return h===0?t:h===1?e:u(h)}}}}return qx(!1,!0,function(h){return h?e:t})}function NA(r,t,e){if(typeof r=="number"&&typeof t=="number")return r*(1-e)+t*e;if(typeof r=="boolean"&&typeof t=="boolean"||typeof r=="string"&&typeof t=="string")return e<.5?r:t;if(Array.isArray(r)&&Array.isArray(t)){for(var n=r.length,i=t.length,a=Math.max(n,i),s=[],o=0;o<a;o++)s.push(NA(r[o<n?o:n-1],t[o<i?o:i-1],e));return s}throw new Error("Mismatched interpolation arguments ".concat(r,":").concat(t))}var cB=(function(){function r(){ot(this,r),this.delay=0,this.direction="normal",this.duration="auto",this._easing="linear",this.easingFunction=WF,this.endDelay=0,this.fill="auto",this.iterationStart=0,this.iterations=1,this.currentIteration=null,this.progress=null}return lt(r,[{key:"easing",get:function(){return this._easing},set:function(e){this.easingFunction=_1(e),this._easing=e}}])})();function uB(r){var t=[];for(var e in r)if(!(e in["easing","offset","composite"])){var n=r[e];Array.isArray(n)||(n=[n]);for(var i=n.length,a=0;a<i;a++){if(!t[a]){var s={};"offset"in r&&(s.offset=Number(r.offset)),"easing"in r&&(s.easing=r.easing),"composite"in r&&(s.composite=r.composite),t[a]=s}n[a]!==void 0&&n[a]!==null&&(t[a][e]=n[a])}}return t.sort(function(o,l){return(o.computedOffset||0)-(l.computedOffset||0)}),t}function Gx(r,t){if(r===null)return[];Array.isArray(r)||(r=uB(r));for(var e=r.map(function(l){var c={};t!=null&&t.composite&&(c.composite="auto");for(var u in l){var h=l[u];if(u==="offset"){if(h!==null){if(h=Number(h),!isFinite(h))throw new Error("Keyframe offsets must be numbers.");if(h<0||h>1)throw new Error("Keyframe offsets must be between 0 and 1.");c.computedOffset=h}}else if(u==="composite"&&["replace","add","accumulate","auto"].indexOf(h)===-1)throw new Error("".concat(h," compositing is not supported"));c[u]=h}return c.offset===void 0&&(c.offset=null),c.easing===void 0&&(c.easing=(t==null?void 0:t.easing)||"linear"),c.composite===void 0&&(c.composite="auto"),c}),n=!0,i=-1/0,a=0;a<e.length;a++){var s=e[a].offset;if(Rt(s))n=!1;else{if(s<i)throw new TypeError("Keyframes are not loosely sorted by offset. Sort or specify offsets.");i=s}}e=e.filter(function(l){return Number(l.offset)>=0&&Number(l.offset)<=1});function o(){var l,c=e,u=c.length;if(e[u-1].computedOffset=Number((l=e[u-1].offset)!==null&&l!==void 0?l:1),u>1){var h;e[0].computedOffset=Number((h=e[0].offset)!==null&&h!==void 0?h:0)}for(var d=0,f=Number(e[0].computedOffset),g=1;g<u;g++){var v=e[g].computedOffset;if(!Rt(v)&&!Rt(f)){for(var p=1;p<g-d;p++)e[d+p].computedOffset=f+(Number(v)-f)*p/(g-d);d=g,f=Number(v)}}}return n||o(),e}var hB="backwards|forwards|both|none".split("|"),dB="reverse|alternate|alternate-reverse".split("|");function fB(r,t){var e=new cB;return typeof r=="number"&&!isNaN(r)?e.duration=r:r!==void 0&&Object.keys(r).forEach(function(n){if(r[n]!==void 0&&r[n]!==null&&r[n]!=="auto"){if((typeof e[n]=="number"||n==="duration")&&(typeof r[n]!="number"||isNaN(r[n]))||n==="fill"&&hB.indexOf(r[n])===-1||n==="direction"&&dB.indexOf(r[n])===-1)return;e[n]=r[n]}}),e}function gB(r,t){return r=vB(r??{duration:"auto"}),fB(r)}function vB(r){return typeof r=="number"&&(isNaN(r)?r={duration:"auto"}:r={duration:r}),r}var pB=(function(){function r(t,e,n){var i=this;ot(this,r),this.composite="replace",this.iterationComposite="replace",this.target=t,this.timing=gB(n),this.timing.effect=this,this.timing.activeDuration=KF(this.timing),this.timing.endTime=Math.max(0,this.timing.delay+this.timing.activeDuration+this.timing.endDelay),this.normalizedKeyframes=Gx(e,this.timing),this.interpolations=aB(this.normalizedKeyframes,this.timing,this.target);var a=ct.globalThis.Proxy;this.computedTiming=a?new a(this.timing,{get:function(o,l){return l==="duration"?o.duration==="auto"?0:o.duration:l==="fill"?o.fill==="auto"?"none":o.fill:l==="localTime"?i.animation&&i.animation.currentTime||null:l==="currentIteration"?!i.animation||i.animation.playState!=="running"?null:o.currentIteration||0:l==="progress"?!i.animation||i.animation.playState!=="running"?null:o.progress||0:o[l]},set:function(){return!0}}):this.timing}return lt(r,[{key:"applyInterpolations",value:function(){this.interpolations(this.target,Number(this.timeFraction))}},{key:"update",value:function(e){return e===null?!1:(this.timeFraction=iB(this.timing.activeDuration,e,this.timing),this.timeFraction!==null)}},{key:"getKeyframes",value:function(){return this.normalizedKeyframes}},{key:"setKeyframes",value:function(e){this.normalizedKeyframes=Gx(e)}},{key:"getComputedTiming",value:function(){return this.computedTiming}},{key:"getTiming",value:function(){return this.timing}},{key:"updateTiming",value:function(e){var n=this;Object.keys(e||{}).forEach(function(i){n.timing[i]=e[i]})}}])})();function $x(r,t){return Number(r.id)-Number(t.id)}var yB=(function(){function r(t){var e=this;ot(this,r),this.animations=[],this.ticking=!1,this.timelineTicking=!1,this.hasRestartedThisFrame=!1,this.animationsWithPromises=[],this.inTick=!1,this.pendingEffects=[],this.currentTime=null,this.rafId=0,this.rafCallbacks=[],this.webAnimationsNextTick=function(n){e.currentTime=n,e.discardAnimations(),e.animations.length===0?e.timelineTicking=!1:e.requestAnimationFrame(e.webAnimationsNextTick)},this.processRafCallbacks=function(n){var i=e.rafCallbacks;e.rafCallbacks=[],n<Number(e.currentTime)&&(n=Number(e.currentTime)),e.animations.sort($x),e.animations=e.tick(n,!0,e.animations)[0],i.forEach(function(a){a[1](n)}),e.applyPendingEffects()},this.document=t}return lt(r,[{key:"getAnimations",value:function(){return this.discardAnimations(),this.animations.slice()}},{key:"isTicking",value:function(){return this.inTick}},{key:"play",value:function(e,n,i){var a=new pB(e,n,i),s=new RF(a,this);return this.animations.push(s),this.restartWebAnimationsNextTick(),s.updatePromises(),s.play(),s.updatePromises(),s}},{key:"applyDirtiedAnimation",value:function(e){var n=this;if(!this.inTick){e.markTarget();var i=e.targetAnimations();i.sort($x);var a=this.tick(Number(this.currentTime),!1,i.slice())[1];a.forEach(function(s){var o=n.animations.indexOf(s);o!==-1&&n.animations.splice(o,1)}),this.applyPendingEffects()}}},{key:"restart",value:function(){return this.ticking||(this.ticking=!0,this.requestAnimationFrame(function(){}),this.hasRestartedThisFrame=!0),this.hasRestartedThisFrame}},{key:"destroy",value:function(){this.document.defaultView.cancelAnimationFrame(this.frameId)}},{key:"applyPendingEffects",value:function(){this.pendingEffects.forEach(function(e){e==null||e.applyInterpolations()}),this.pendingEffects=[]}},{key:"updateAnimationsPromises",value:function(){this.animationsWithPromises=this.animationsWithPromises.filter(function(e){return e.updatePromises()})}},{key:"discardAnimations",value:function(){this.updateAnimationsPromises(),this.animations=this.animations.filter(function(e){return e.playState!=="finished"&&e.playState!=="idle"})}},{key:"restartWebAnimationsNextTick",value:function(){this.timelineTicking||(this.timelineTicking=!0,this.requestAnimationFrame(this.webAnimationsNextTick))}},{key:"rAF",value:function(e){var n=this.rafId++;return this.rafCallbacks.length===0&&(this.frameId=this.document.defaultView.requestAnimationFrame(this.processRafCallbacks)),this.rafCallbacks.push([n,e]),n}},{key:"requestAnimationFrame",value:function(e){var n=this;return this.rAF(function(i){n.updateAnimationsPromises(),e(i),n.updateAnimationsPromises()})}},{key:"tick",value:function(e,n,i){var a=this,s,o;this.inTick=!0,this.hasRestartedThisFrame=!1,this.currentTime=e,this.ticking=!1;var l=[],c=[],u=[],h=[];return i.forEach(function(d){d.tick(e,n),d._inEffect?(c.push(d.effect),d.markTarget()):(l.push(d.effect),d.unmarkTarget()),d._needsTick&&(a.ticking=!0);var f=d._inEffect||d._needsTick;d._inTimeline=f,f?u.push(d):h.push(d)}),(s=this.pendingEffects).push.apply(s,l),(o=this.pendingEffects).push.apply(o,c),this.ticking&&this.requestAnimationFrame(function(){}),this.inTick=!1,[u,h]}}])})();ct.EasingFunction=_1;ct.AnimationTimeline=yB;const mB={duration:500},bB={duration:1e3,easing:"cubic-bezier(0.250, 0.460, 0.450, 0.940)",iterations:1,fill:"both"};var Oe;(function(r){r.NodeAdded="NodeAdded",r.NodeUpdated="NodeUpdated",r.NodeRemoved="NodeRemoved",r.EdgeAdded="EdgeAdded",r.EdgeUpdated="EdgeUpdated",r.EdgeRemoved="EdgeRemoved",r.ComboAdded="ComboAdded",r.ComboUpdated="ComboUpdated",r.ComboRemoved="ComboRemoved"})(Oe||(Oe={}));var tr;(function(r){r.DRAW="draw",r.COLLAPSE="collapse",r.EXPAND="expand",r.TRANSFORM="transform"})(tr||(tr={}));var Bi;(function(r){r.CLICK="canvas:click",r.DBLCLICK="canvas:dblclick",r.POINTER_OVER="canvas:pointerover",r.POINTER_LEAVE="canvas:pointerleave",r.POINTER_ENTER="canvas:pointerenter",r.POINTER_MOVE="canvas:pointermove",r.POINTER_OUT="canvas:pointerout",r.POINTER_DOWN="canvas:pointerdown",r.POINTER_UP="canvas:pointerup",r.CONTEXT_MENU="canvas:contextmenu",r.DRAG_START="canvas:dragstart",r.DRAG="canvas:drag",r.DRAG_END="canvas:dragend",r.DRAG_ENTER="canvas:dragenter",r.DRAG_OVER="canvas:dragover",r.DRAG_LEAVE="canvas:dragleave",r.DROP="canvas:drop",r.WHEEL="canvas:wheel"})(Bi||(Bi={}));var Ba;(function(r){r.CLICK="combo:click",r.DBLCLICK="combo:dblclick",r.POINTER_OVER="combo:pointerover",r.POINTER_LEAVE="combo:pointerleave",r.POINTER_ENTER="combo:pointerenter",r.POINTER_MOVE="combo:pointermove",r.POINTER_OUT="combo:pointerout",r.POINTER_DOWN="combo:pointerdown",r.POINTER_UP="combo:pointerup",r.CONTEXT_MENU="combo:contextmenu",r.DRAG_START="combo:dragstart",r.DRAG="combo:drag",r.DRAG_END="combo:dragend",r.DRAG_ENTER="combo:dragenter",r.DRAG_OVER="combo:dragover",r.DRAG_LEAVE="combo:dragleave",r.DROP="combo:drop"})(Ba||(Ba={}));var rt;(function(r){r.CLICK="click",r.DBLCLICK="dblclick",r.POINTER_OVER="pointerover",r.POINTER_LEAVE="pointerleave",r.POINTER_ENTER="pointerenter",r.POINTER_MOVE="pointermove",r.POINTER_OUT="pointerout",r.POINTER_DOWN="pointerdown",r.POINTER_UP="pointerup",r.CONTEXT_MENU="contextmenu",r.DRAG_START="dragstart",r.DRAG="drag",r.DRAG_END="dragend",r.DRAG_ENTER="dragenter",r.DRAG_OVER="dragover",r.DRAG_LEAVE="dragleave",r.DROP="drop",r.KEY_DOWN="keydown",r.KEY_UP="keyup",r.WHEEL="wheel",r.PINCH="pinch"})(rt||(rt={}));var Os;(function(r){r.KEY_DOWN="keydown",r.KEY_UP="keyup"})(Os||(Os={}));var cu;(function(r){r.CLICK="edge:click",r.DBLCLICK="edge:dblclick",r.POINTER_OVER="edge:pointerover",r.POINTER_LEAVE="edge:pointerleave",r.POINTER_ENTER="edge:pointerenter",r.POINTER_MOVE="edge:pointermove",r.POINTER_OUT="edge:pointerout",r.POINTER_DOWN="edge:pointerdown",r.POINTER_UP="edge:pointerup",r.CONTEXT_MENU="edge:contextmenu",r.DRAG_ENTER="edge:dragenter",r.DRAG_OVER="edge:dragover",r.DRAG_LEAVE="edge:dragleave",r.DROP="edge:drop"})(cu||(cu={}));var ft;(function(r){r.BEFORE_CANVAS_INIT="beforecanvasinit",r.AFTER_CANVAS_INIT="aftercanvasinit",r.BEFORE_SIZE_CHANGE="beforesizechange",r.AFTER_SIZE_CHANGE="aftersizechange",r.BEFORE_ELEMENT_CREATE="beforeelementcreate",r.AFTER_ELEMENT_CREATE="afterelementcreate",r.BEFORE_ELEMENT_UPDATE="beforeelementupdate",r.AFTER_ELEMENT_UPDATE="afterelementupdate",r.BEFORE_ELEMENT_DESTROY="beforeelementdestroy",r.AFTER_ELEMENT_DESTROY="afterelementdestroy",r.BEFORE_ELEMENT_TRANSLATE="beforeelementtranslate",r.AFTER_ELEMENT_TRANSLATE="afterelementtranslate",r.BEFORE_DRAW="beforedraw",r.AFTER_DRAW="afterdraw",r.BEFORE_RENDER="beforerender",r.AFTER_RENDER="afterrender",r.BEFORE_ANIMATE="beforeanimate",r.AFTER_ANIMATE="afteranimate",r.BEFORE_LAYOUT="beforelayout",r.AFTER_LAYOUT="afterlayout",r.BEFORE_STAGE_LAYOUT="beforestagelayout",r.AFTER_STAGE_LAYOUT="afterstagelayout",r.BEFORE_TRANSFORM="beforetransform",r.AFTER_TRANSFORM="aftertransform",r.BATCH_START="batchstart",r.BATCH_END="batchend",r.BEFORE_DESTROY="beforedestroy",r.AFTER_DESTROY="afterdestroy",r.BEFORE_RENDERER_CHANGE="beforerendererchange",r.AFTER_RENDERER_CHANGE="afterrendererchange"})(ft||(ft={}));var Zi;(function(r){r.UNDO="undo",r.REDO="redo",r.CANCEL="cancel",r.ADD="add",r.CLEAR="clear",r.CHANGE="change"})(Zi||(Zi={}));var Cr;(function(r){r.CLICK="node:click",r.DBLCLICK="node:dblclick",r.POINTER_OVER="node:pointerover",r.POINTER_LEAVE="node:pointerleave",r.POINTER_ENTER="node:pointerenter",r.POINTER_MOVE="node:pointermove",r.POINTER_OUT="node:pointerout",r.POINTER_DOWN="node:pointerdown",r.POINTER_UP="node:pointerup",r.CONTEXT_MENU="node:contextmenu",r.DRAG_START="node:dragstart",r.DRAG="node:drag",r.DRAG_END="node:dragend",r.DRAG_ENTER="node:dragenter",r.DRAG_OVER="node:dragover",r.DRAG_LEAVE="node:dragleave",r.DROP="node:drop"})(Cr||(Cr={}));const ge="combo",vr="tree";var Uo;(function(r){r.NODE="node",r.EDGE="edge",r.COMBO="combo",r.THEME="theme",r.PALETTE="palette",r.LAYOUT="layout",r.BEHAVIOR="behavior",r.PLUGIN="plugin",r.ANIMATION="animation",r.TRANSFORM="transform",r.SHAPE="shape"})(Uo||(Uo={}));const km={animation:{},behavior:{},combo:{},edge:{},layout:{},node:{},palette:{},theme:{},plugin:{},transform:{},shape:{}};function zi(r,t){var e;const n=(e=km[r])===null||e===void 0?void 0:e[t];if(n)return n}const xB="5.0.50",wB="G6";function Ii(r){return`[${wB} v${xB}] ${r}`}const wi={mute:!1,debug:r=>{console.debug(Ii(r))},info:r=>{console.info(Ii(r))},warn:r=>{console.warn(Ii(r))},error:r=>{console.error(Ii(r))}};function PA(r){const{theme:t}=r;if(!t)return{};const e=zi(Uo.THEME,t);return e||(wi.warn(`The theme of ${t} is not registered.`),{})}function M1(r,t){if(Array.isArray(r)&&r.length===0)return null;const e=Array.isArray(r)?r[0]:r,n=Array.isArray(r)?r.slice(1):t||[];return new Proxy(e,{get(i,a){return typeof i[a]=="function"&&!["onframe","onfinish"].includes(a)?(...s)=>{i[a](...s),n.forEach(o=>{var l;return(l=o[a])===null||l===void 0?void 0:l.call(o,...s)})}:a==="finished"?Promise.all([e.finished,...n.map(s=>s.finished)]):Reflect.get(i,a)},set(i,a,s){return["onframe","onfinish"].includes(a)||n.forEach(o=>{o[a]=s}),Reflect.set(i,a,s)}})}function Mm(r){const t=r.reduce((n,i)=>(Object.entries(i).forEach(([a,s])=>{n[a]===void 0?n[a]=[s]:n[a].push(s)}),n),{});Object.entries(t).forEach(([n,i])=>{(i.length!==r.length||i.some(a=>Rt(a))||i.every(a=>!["sourceNode","targetNode","childrenNode"].includes(n)&&Ge(a,i[0])))&&delete t[n]});const e=Object.entries(t).reduce((n,[i,a])=>(a.forEach((s,o)=>{n[o]?n[o][i]=s:n[o]={[i]:s}}),n),[]);return r.length!==0&&e.length===0&&e.push({_:0},{_:0}),e}function Yo(r){switch(r){case"opacity":return 1;case"x":case"y":case"z":case"zIndex":return 0;case"visibility":return"visible";case"collapsed":return!1;case"states":return[];default:return}}function CA(r,t){const{animation:e}=r;if(e===!1||t===!1)return!1;const n=Object.assign({},mB);return Ze(e)&&Object.assign(n,e),Ze(t)&&Object.assign(n,t),n}function EB(r){if(typeof r=="string"){const t=zi(Uo.ANIMATION,r);return t||(wi.warn(`The animation of ${r} is not registered.`),[])}return r}function SB(r,t,e,n){var i,a;const{animation:s}=r;if(s===!1||n===!1)return[];const o=(i=r==null?void 0:r[t])===null||i===void 0?void 0:i.animation;if(o===!1)return[];const l=o==null?void 0:o[e];if(l===!1)return[];const c=(a=PA(r)[t])===null||a===void 0?void 0:a.animation,u=(d=[])=>EB(d).map(f=>Object.assign(Object.assign(Object.assign(Object.assign({},bB),Ze(s)&&s),f),Ze(n)&&n));if(l)return u(l);if(!c)return[];const h=c[e];return h===!1?[]:u(h)}function RA(r,t,e,n=[]){if(!n&&r===0&&t===0&&e===0)return null;if(Array.isArray(n)){let a=-1;const s=[];for(let o=0;o<n.length;o++){const l=n[o];if(l[0]==="translate"){if(l[1]===r&&l[2]===t)return null;a=o,s.push(["translate",r,t])}else if(l[0]==="translate3d"){if(l[1]===r&&l[2]===t&&l[3]===e)return null;a=o,s.push(["translate3d",r,t,e??0])}else s.push(l)}return a===-1&&s.splice(0,0,St(e)?["translate3d",r,t,e??0]:["translate",r,t]),s.length===0?null:s}const i=n?n.replace(/translate(3d)?\([^)]*\)/g,""):"";return e===0?`translate(${r}, ${t})${i}`:`translate3d(${r}, ${t}, ${e})${i}`}var _B=function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(e[n[i]]=r[n[i]]);return e};const kB=(r,t,e)=>{if(!e.length)return null;const[n,i]=t,a=c=>{var u;if(c){const h=r.getShape(c);if(!h)return null;const d=`get${Zc(c)}Style`,f=((u=r==null?void 0:r[d])===null||u===void 0?void 0:u.bind(r))||(p=>p),g=(f==null?void 0:f(n))||{},v=(f==null?void 0:f(i))||{};return{shape:h,fromStyle:g,toStyle:v}}else return{shape:r,fromStyle:n,toStyle:i}};let s;const o=e.map(c=>{var{fields:u,shape:h,states:d}=c,f=_B(c,["fields","shape","states"]);const g=a(h);if(!g)return null;const{shape:v,fromStyle:p,toStyle:y}=g,m=[{},{}];if(u.forEach(E=>{var _,M;Object.assign(m[0],{[E]:(_=p[E])!==null&&_!==void 0?_:Yo(E)}),Object.assign(m[1],{[E]:(M=y[E])!==null&&M!==void 0?M:Yo(E)})}),m.some(E=>Object.keys(E).some(_=>["x","y","z"].includes(_)))){const{x:E=0,y:_=0,z:M,transform:O=""}=v.attributes||{};m.forEach(T=>{var N,P,C;T.transform=RA((N=T.x)!==null&&N!==void 0?N:E,(P=T.y)!==null&&P!==void 0?P:_,(C=T.z)!==null&&C!==void 0?C:M,O)})}const x=v.animate(Mm(m),f);return h===void 0&&(s=x),x}).filter(Boolean),l=s||(o==null?void 0:o[0]);return l?M1(l,o.filter(c=>c!==c)):null},MB=[{fields:["opacity"]}],TB=[{fields:["x","y"]}],LA=[{fields:["x","y"]}],OB=LA,IA=[{fields:["sourceNode","targetNode"]}],AB=IA,DA=[{fields:["childrenNode","x","y"]}],NB=DA;function PB(r){return"source"in r&&"target"in r}function CB(r){return r.length===2}function $s(r){return r instanceof Float32Array?!0:Array.isArray(r)&&(r.length===2||r.length===3)?r.every(t=>typeof t=="number"):!1}function bi(r,t,e){return r>=t&&r<=e}function Lr(r=0){if(Array.isArray(r)){const[t=0,e=t,n=t,i=e]=r;return[t,e,n,i]}return[r,r,r,r]}function RB(r=0){const t=Lr(r);return t[0]+t[2]}function Ei(r){return r.max[0]-r.min[0]}function Si(r){return r.max[1]-r.min[1]}function ya(r){return[Ei(r),Si(r)]}function ea(r,t){const e=$s(r)?T1(r):r.getShape("key").getBounds();return t?ma(e,t):e}function T1(r){const[t,e,n=0]=r,i=new be;return i.setMinMax([t,e,n],[t,e,n]),i}function ma(r,t){const[e,n,i,a]=Lr(t),[s,o,l]=r.min,[c,u,h]=r.max,d=new be;return d.setMinMax([s-a,o-e,l],[c+n,u+i,h]),d}function hl(r){if(r.length===0)return new be;if(r.length===1)return r[0];const t=new be;t.setMinMax(r[0].min,r[0].max);for(let e=1;e<r.length;e++){const n=r[e];t.setMinMax([Math.min(t.min[0],n.min[0]),Math.min(t.min[1],n.min[1]),Math.min(t.min[2],n.min[2])],[Math.max(t.max[0],n.max[0]),Math.max(t.max[1],n.max[1]),Math.max(t.max[2],n.max[2])])}return t}function LB(r,t){const[e,n]=r.min,[i,a]=r.max,[s,o]=t.min,[l,c]=t.max;return e>=s&&i<=l&&n>=o&&a<=c}function Hr(r,t){return bi(r[0],t.min[0],t.max[0])&&bi(r[1],t.min[1],t.max[1])}function FA(r,t,e=!1){const{min:[n,i],max:[a,s]}=t,o=(r[1]===i||r[1]===s)&&(e||bi(r[0],n,a)),l=(r[0]===n||r[0]===a)&&(e||bi(r[1],i,s));return o||l}function IB(r,t){return!Hr(r,t)}function uu(r,t){const{center:e}=t;return r[0]===e[0]&&r[1]===e[1]}function Do(r,t){const[e,n]=r,[i,a]=t.min,[s,o]=t.max,l=e-i,c=s-e,u=n-a,h=o-n,d=Math.min(l,c,u,h);return d===l?"left":d===c?"right":d===u?"top":d===h?"bottom":"left"}function $a(r,t){const e=da(r);if(Hr(r,t))switch(Do(r,t)){case"left":e[0]=t.min[0];break;case"right":e[0]=t.max[0];break;case"top":e[1]=t.min[1];break;case"bottom":e[1]=t.max[1];break}else{const[n,i]=r,[a,s]=t.min,[o,l]=t.max;e[0]=bi(n,a,o)?n:n<a?a:o,e[1]=bi(i,s,l)?i:i<s?s:l}return e}function DB(r,t){const{center:e}=r,[n,i]=ya(r),a=t==="up"||t==="down"?e[0]:t==="right"?e[0]-n/6:e[0]+n/6,s=t==="left"||t==="right"?e[1]:t==="down"?e[1]-i/6:e[1]+i/6;return[a,s]}function FB(r,t){let[e,n]=ya(r);return[e,n]=t==="up"||t==="down"?[e,n]:[n,e],(Math.pow(n,2)-Math.pow(Math.sqrt(Math.pow(e/2,2)+Math.pow(n,2))-e/2,2))/(2*n)}function BB(r){const{min:[t,e],max:[n,i]}=r,a=[t,i],s=[n,i],o=[n,e],l=[t,e];return[[a,s],[s,o],[o,l],[l,a]]}var zB=function(t,e){return t===e},Wx=(function(){function r(t,e){e===void 0&&(e=null),this.value=t,this.next=e}return r.prototype.toString=function(t){return t?t(this.value):"".concat(this.value)},r})(),jB=(function(){function r(t){t===void 0&&(t=zB),this.head=null,this.tail=null,this.compare=t}return r.prototype.prepend=function(t){var e=new Wx(t,this.head);return this.head=e,this.tail||(this.tail=e),this},r.prototype.append=function(t){var e=new Wx(t);return this.head?(this.tail.next=e,this.tail=e,this):(this.head=e,this.tail=e,this)},r.prototype.delete=function(t){if(!this.head)return null;for(var e=null;this.head&&this.compare(this.head.value,t);)e=this.head,this.head=this.head.next;var n=this.head;if(n!==null)for(;n.next;)this.compare(n.next.value,t)?(e=n.next,n.next=n.next.next):n=n.next;return this.compare(this.tail.value,t)&&(this.tail=n),e},r.prototype.find=function(t){var e=t.value,n=e===void 0?void 0:e,i=t.callback,a=i===void 0?void 0:i;if(!this.head)return null;for(var s=this.head;s;){if(a&&a(s.value)||n!==void 0&&this.compare(s.value,n))return s;s=s.next}return null},r.prototype.deleteTail=function(){var t=this.tail;if(this.head===this.tail)return this.head=null,this.tail=null,t;for(var e=this.head;e.next;)e.next.next?e=e.next:e.next=null;return this.tail=e,t},r.prototype.deleteHead=function(){if(!this.head)return null;var t=this.head;return this.head.next?this.head=this.head.next:(this.head=null,this.tail=null),t},r.prototype.fromArray=function(t){var e=this;return t.forEach(function(n){return e.append(n)}),this},r.prototype.toArray=function(){for(var t=[],e=this.head;e;)t.push(e),e=e.next;return t},r.prototype.reverse=function(){for(var t=this.head,e=null,n=null;t;)n=t.next,t.next=e,e=t,t=n;this.tail=this.head,this.head=e},r.prototype.toString=function(t){return t===void 0&&(t=void 0),this.toArray().map(function(e){return e.toString(t)}).toString()},r})(),qB=function(t,e,n){e===void 0&&(e=[]);var i=e.filter(function(l){return l.source===t||l.target===t});if(n==="target"){var a=function(c){return c.source===t};return i.filter(a).map(function(l){return l.target})}if(n==="source"){var s=function(c){return c.target===t};return i.filter(s).map(function(l){return l.source})}var o=function(c){return c.source===t?c.target:c.source};return i.map(o)},GB=function(t,e){return e.filter(function(n){return n.source===t})},$B=function(t,e){return e.filter(function(n){return n.source===t||n.target===t})},WB=function(t){var e={},n=t.nodes,i=n===void 0?[]:n,a=t.edges,s=a===void 0?[]:a;return i.forEach(function(o){e[o.id]={degree:0,inDegree:0,outDegree:0}}),s.forEach(function(o){e[o.source].degree++,e[o.source].outDegree++,e[o.target].degree++,e[o.target].inDegree++}),e},VB={}.toString,O1=function(r,t){return VB.call(r)==="[object "+t+"]"};const BA=(function(r){return O1(r,"Function")}),zA=(function(r){return Array.isArray?Array.isArray(r):O1(r,"Array")}),UB=(function(r){var t=typeof r;return r!==null&&t==="object"||t==="function"});function YB(r,t){if(r){var e;if(zA(r))for(var n=0,i=r.length;n<i&&(e=t(r[n],n),e!==!1);n++);else if(UB(r)){for(var a in r)if(r.hasOwnProperty(a)&&(e=t(r[a],a),e===!1))break}}}const HB=(function(r){return O1(r,"String")});var XB=Object.values?function(r){return Object.values(r)}:function(r){var t=[];return YB(r,function(e,n){BA(r)&&n==="prototype"||t.push(e)}),t};const KB=(function(r,t){if(!BA(r))throw new TypeError("Expected a function");var e=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var a=t?t.apply(this,n):n[0],s=e.cache;if(s.has(a))return s.get(a);var o=r.apply(this,n);return s.set(a,o),o};return e.cache=new Map,e});var lc;KB(function(r,t){t===void 0&&(t={});var e=t.fontSize,n=t.fontFamily,i=t.fontWeight,a=t.fontStyle,s=t.fontVariant;return lc||(lc=document.createElement("canvas").getContext("2d")),lc.font=[a,s,i,e+"px",n].join(" "),lc.measureText(HB(r)?r:"").width},function(r,t){return t===void 0&&(t={}),iL([r],XB(t)).join("")});var ZB=function(t,e,n){for(var i=1/0,a,s=0;s<e.length;s++){var o=e[s].id;!n[o]&&t[o]<=i&&(i=t[o],a=e[s])}return a},JB=function(t,e,n,i){var a=t.nodes,s=a===void 0?[]:a,o=t.edges,l=o===void 0?[]:o,c={},u={},h={};s.forEach(function(m,x){var E=m.id;u[E]=1/0,E===e&&(u[E]=0)});for(var d=s.length,f=function(x){var E=ZB(u,s,c),_=E.id;if(c[_]=!0,u[_]===1/0)return"continue";var M=[];n?M=GB(_,l):M=$B(_,l),M.forEach(function(O){var T=O.target,N=O.source,P=T===_?N:T,C=i&&O[i]?O[i]:1;u[P]>u[E.id]+C?(u[P]=u[E.id]+C,h[P]=[E.id]):u[P]===u[E.id]+C&&h[P].push(E.id)})},g=0;g<d;g++)f();h[e]=[e];var v={};for(var p in u)u[p]!==1/0&&jA(e,p,h,v);var y={};for(var p in v)y[p]=v[p][0];return{length:u,path:y,allPath:v}};function jA(r,t,e,n){if(r===t)return[r];if(n[t])return n[t];for(var i=[],a=0,s=e[t];a<s.length;a++){var o=s[a],l=jA(r,o,e,n);if(!l)return;for(var c=0,u=l;c<u.length;c++){var h=u[c];zA(h)?i.push(Nt(Nt([],h,!0),[t],!1)):i.push([h,t])}}return n[t]=i,n[t]}var qA=function(t,e,n,i,a){var s=JB(t,e,i,a),o=s.length,l=s.path,c=s.allPath;return{length:o[n],path:l[n],allPath:c[n]}},Vx;(function(r){r.EuclideanDistance="euclideanDistance"})(Vx||(Vx={}));var QB=function(t,e,n){typeof e!="number"&&(e=1e-6),typeof n!="number"&&(n=.85);for(var i=1,a=0,s=1e3,o=t.nodes,l=o===void 0?[]:o,c=t.edges,u=c===void 0?[]:c,h=l.length,d,f={},g={},v=0;v<h;++v){var p=l[v],y=p.id;f[y]=1/h,g[y]=1/h}for(var m=WB(t);s>0&&i>e;){a=0;for(var v=0;v<h;++v){var p=l[v],y=p.id;if(d=0,m[p.id].inDegree===0)f[y]=0;else{for(var x=qB(y,u,"source"),E=0;E<x.length;++E){var _=x[E],M=m[_].outDegree;M>0&&(d+=g[_]/M)}f[y]=n*d,a+=f[y]}}a=(1-a)/h,i=0;for(var v=0;v<h;++v){var p=l[v],y=p.id;d=f[y]+a,i+=Math.abs(d-g[y]),g[y]=d}s-=1}return g};(function(){function r(t){t===void 0&&(t=10),this.linkedList=new jB,this.maxStep=t}return Object.defineProperty(r.prototype,"length",{get:function(){return this.linkedList.toArray().length},enumerable:!1,configurable:!0}),r.prototype.isEmpty=function(){return!this.linkedList.head},r.prototype.isMaxStack=function(){return this.toArray().length>=this.maxStep},r.prototype.peek=function(){return this.isEmpty()?null:this.linkedList.head.value},r.prototype.push=function(t){this.linkedList.prepend(t),this.length>this.maxStep&&this.linkedList.deleteTail()},r.prototype.pop=function(){var t=this.linkedList.deleteHead();return t?t.value:null},r.prototype.toArray=function(){return this.linkedList.toArray().map(function(t){return t.value})},r.prototype.clear=function(){for(;!this.isEmpty();)this.pop()},r})();function K(r){if(r.id!==void 0)return r.id;if(r.source!==void 0&&r.target!==void 0)return`${r.source}-${r.target}`;throw new Error(Ii("The datum does not have available id."))}function cc(r){return r.combo}function GA(r,t){const e={nodes:(r.nodes||[]).map(K),edges:(r.edges||[]).map(K),combos:(r.combos||[]).map(K)};return t?Object.values(e).flat():e}const $A=(r,t,e)=>{var n;switch(e.type){case"degree":{const i=new Map;return(n=r.nodes)===null||n===void 0||n.forEach(a=>{const s=t(K(a),e.direction).length;i.set(K(a),s)}),i}case"betweenness":return t5(r,e.directed,e.weightPropertyName);case"closeness":return e5(r,e.directed,e.weightPropertyName);case"eigenvector":return r5(r,e.directed);case"pagerank":return n5(r,e.epsilon,e.linkProb);default:return WA(r)}},WA=r=>{var t;const e=new Map;return(t=r.nodes)===null||t===void 0||t.forEach(n=>{e.set(K(n),0)}),e},t5=(r,t,e)=>{const n=WA(r),{nodes:i=[]}=r;return i.forEach(a=>{i.forEach(s=>{if(a!==s){const{allPath:o}=qA(r,K(a),K(s),t,e),l=o.length;o.flat().forEach(c=>{c!==K(a)&&c!==K(s)&&n.set(c,n.get(c)+1/l)})}})}),n},e5=(r,t,e)=>{const n=new Map,{nodes:i=[]}=r;return i.forEach(a=>{const s=i.reduce((o,l)=>{if(a!==l){const{length:c}=qA(r,K(a),K(l),t,e);o+=c}return o},0);n.set(K(a),1/s)}),n},n5=(r,t,e)=>{var n;const i=new Map,a=QB(r,t,e);return(n=r.nodes)===null||n===void 0||n.forEach(s=>{i.set(K(s),a[K(s)])}),i},r5=(r,t)=>{const{nodes:e=[]}=r,n=i5(r,t),i=a5(n,e.length),a=new Map;return e.forEach((s,o)=>{a.set(K(s),i[o])}),a},i5=(r,t)=>{const{nodes:e=[],edges:n=[]}=r,i=Array(e.length).fill(null).map(()=>Array(e.length).fill(0));return n.forEach(({source:a,target:s})=>{const o=e.findIndex(c=>K(c)===a),l=e.findIndex(c=>K(c)===s);t?i[o][l]=1:(i[o][l]=1,i[l][o]=1)}),i},a5=(r,t,e=100,n=1e-6)=>{let i=Array(t).fill(1),a=1/0;for(let s=0;s<e&&a>n;s++){const o=Array(t).fill(0);for(let c=0;c<t;c++)for(let u=0;u<t;u++)o[c]+=r[c][u]*i[u];const l=Math.sqrt(o.reduce((c,u)=>c+u*u,0));for(let c=0;c<t;c++)o[c]/=l;a=Math.sqrt(o.reduce((c,u,h)=>c+(u-i[h])*u,0)),i=o}return i};function ca(r,t,e,n=Ge){const i=new Map(r.map(d=>[e(d),d])),a=new Map(t.map(d=>[e(d),d])),s=new Set(i.keys()),o=new Set(a.keys()),l=[],c=[],u=[],h=[];return o.forEach(d=>{s.has(d)?n(i.get(d),a.get(d))?h.push(a.get(d)):c.push(a.get(d)):l.push(a.get(d))}),s.forEach(d=>{o.has(d)||u.push(i.get(d))}),{enter:l,exit:u,keep:h,update:c}}function Za(r,t,e){const n=i=>{e&&!e(i)||(i.style.visibility=t)};r.forEach(i=>{n(i)})}function s5(r,t,e){const n={},i=a=>(a in n||(n[a]=0),`${t}-${a}-${n[a]++}`);return e.map(a=>typeof a=="string"?{type:a,key:i(a)}:typeof a=="function"?a.call(r):a.key?a:Object.assign(Object.assign({},a),{key:i(a.type)}))}class A1{constructor(t){this.extensions=[],this.extensionMap={},this.context=t}setExtensions(t){const e=s5(this.context.graph,this.category,t),{enter:n,update:i,exit:a,keep:s}=ca(this.extensions,e,o=>o.key);this.createExtensions(n),this.updateExtensions([...i,...s]),this.destroyExtensions(a),this.extensions=e}createExtension(t){const{category:e}=this,{key:n,type:i}=t,a=zi(e,i);if(!a)return wi.warn(`The extension ${i} of ${e} is not registered.`);const s=new a(this.context,t);s.initialized=!0,this.extensionMap[n]=s}createExtensions(t){t.forEach(e=>this.createExtension(e))}updateExtension(t){const{key:e}=t,n=this.extensionMap[e];n&&n.update(t)}updateExtensions(t){t.forEach(e=>this.updateExtension(e))}destroyExtension(t){const e=this.extensionMap[t];e&&(e.initialized&&!e.destroyed&&e.destroy(),delete this.extensionMap[t])}destroyExtensions(t){t.forEach(({key:e})=>this.destroyExtension(e))}destroy(){this.destroyExtensions(this.extensions),this.context={},this.extensions=[],this.extensionMap={}}}class N1{constructor(t,e){this.events=[],this.initialized=!1,this.destroyed=!1,this.context=t,this.options=e}update(t){this.options=Object.assign(this.options,t)}destroy(){this.context={},this.options={},this.destroyed=!0}}class wr extends N1{}class Du extends wr{constructor(t,e){super(t,Object.assign({},Du.defaultOptions,e)),this.isOverlapping=(n,i)=>i.some(a=>n.intersects(a)),this.occupiedBounds=[],this.detectLabelCollision=n=>{const i=this.context.viewport,a={show:[],hide:[]};return this.occupiedBounds=[],n.forEach(s=>{const o=s.getShape("label").getRenderBounds();i.isInViewport(o,!0)&&!this.isOverlapping(o,this.occupiedBounds)?(a.show.push(s),this.occupiedBounds.push(ma(o,this.options.padding))):a.hide.push(s)}),a},this.hideLabelIfExceedViewport=(n,i)=>{const{exit:a}=ca(n,i,s=>s.id);a==null||a.forEach(this.hideLabel)},this.nodeCentralities=new Map,this.sortNodesByCentrality=(n,i)=>{const{model:a}=this.context,s=a.getData(),o=a.getRelatedEdgesData.bind(a);return n.map(c=>(this.nodeCentralities.has(c.id)||(this.nodeCentralities=$A(s,o,i)),{node:c,centrality:this.nodeCentralities.get(c.id)})).sort((c,u)=>u.centrality-c.centrality).map(c=>c.node)},this.sortLabelElementsInView=n=>{const{sort:i,sortNode:a,sortCombo:s,sortEdge:o}=this.options,{model:l}=this.context;if(Tt(i))return n.sort((v,p)=>i(l.getElementDataById(v.id),l.getElementDataById(p.id)));const{node:c=[],edge:u=[],combo:h=[]}=Nu(n,v=>v.type),d=Tt(s)?h.sort((v,p)=>s(...l.getComboData([v.id,p.id]))):h,f=Tt(a)?c.sort((v,p)=>a(...l.getNodeData([v.id,p.id]))):this.sortNodesByCentrality(c,a),g=Tt(o)?u.sort((v,p)=>o(...l.getEdgeData([v.id,p.id]))):u;return[...d,...f,...g]},this.labelElementsInView=[],this.isFirstRender=!0,this.onToggleVisibility=n=>{var i;if(((i=n.data)===null||i===void 0?void 0:i.stage)==="zIndex")return;if(!this.validate(n)){this.hiddenElements.size>0&&(this.hiddenElements.forEach(this.showLabel),this.hiddenElements.clear());return}const a=this.isFirstRender?this.getLabelElements():this.getLabelElementsInView();this.hideLabelIfExceedViewport(this.labelElementsInView,a),this.labelElementsInView=a;const s=this.sortLabelElementsInView(this.labelElementsInView),{show:o,hide:l}=this.detectLabelCollision(s);for(let c=o.length-1;c>=0;c--)this.showLabel(o[c]);l.forEach(this.hideLabel)},this.hiddenElements=new Map,this.hideLabel=n=>{const i=n.getShape("label");i&&Za(i,"hidden"),this.hiddenElements.set(n.id,n)},this.showLabel=n=>{const i=n.getShape("label");i&&Za(i,"visible"),n.toFront(),this.hiddenElements.delete(n.id)},this.onTransform=OO(this.onToggleVisibility,this.options.throttle,{leading:!0}),this.enableToggle=!0,this.toggle=n=>{this.enableToggle&&this.onToggleVisibility(n)},this.onBeforeRender=()=>{this.enableToggle=!1},this.onAfterRender=n=>{this.onToggleVisibility(n),this.enableToggle=!0},this.bindEvents()}update(t){this.unbindEvents(),super.update(t),this.bindEvents(),this.onToggleVisibility({})}getLabelElements(){const{elementMap:t}=this.context.element,e=[];for(const n in t){const i=t[n];i.isVisible()&&i.getShape("label")&&e.push(i)}return e}getLabelElementsInView(){const t=this.context.viewport;return this.getLabelElements().filter(e=>t.isInViewport(e.getShape("key").getRenderBounds()))}bindEvents(){const{graph:t}=this.context;t.on(ft.BEFORE_RENDER,this.onBeforeRender),t.on(ft.AFTER_RENDER,this.onAfterRender),t.on(ft.AFTER_DRAW,this.toggle),t.on(ft.AFTER_LAYOUT,this.toggle),t.on(ft.AFTER_TRANSFORM,this.onTransform)}unbindEvents(){const{graph:t}=this.context;t.off(ft.BEFORE_RENDER,this.onBeforeRender),t.off(ft.AFTER_RENDER,this.onAfterRender),t.off(ft.AFTER_DRAW,this.toggle),t.off(ft.AFTER_LAYOUT,this.toggle),t.off(ft.AFTER_TRANSFORM,this.onTransform)}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return Tt(e)?e(t):!!e}destroy(){this.unbindEvents(),super.destroy()}}Du.defaultOptions={enable:!0,throttle:100,padding:0,sortNode:{type:"degree"}};const Ux=[0,0,0];function qt(r,t){return r.map((e,n)=>e+t[n])}function fe(r,t){return r.map((e,n)=>e-t[n])}function Wr(r,t){return typeof t=="number"?r.map(e=>e*t):r.map((e,n)=>e*t[n])}function Xr(r,t){return typeof t=="number"?r.map(e=>e/t):r.map((e,n)=>e/t[n])}function o5(r,t){return r.reduce((e,n,i)=>e+n*t[i],0)}function l5(r,t){const e=Ho(r),n=Ho(t);return[e[1]*n[2]-e[2]*n[1],e[2]*n[0]-e[0]*n[2],e[0]*n[1]-e[1]*n[0]]}function na(r,t){return r.map(e=>e*t)}function Ee(r,t){return Math.sqrt(r.reduce((e,n,i)=>e+Math.pow(n-t[i]||0,2),0))}function hu(r,t){return r.reduce((e,n,i)=>e+Math.abs(n-t[i]),0)}function Fi(r){const t=r.reduce((e,n)=>e+Math.pow(n,2),0);return r.map(e=>e/Math.sqrt(t))}function P1(r,t,e=!1){const n=r[0]*t[1]-r[1]*t[0];let i=Math.acos(Wr(r,t).reduce((a,s)=>a+s,0)/(Ee(r,Ux)*Ee(t,Ux)));return e&&n<0&&(i=2*Math.PI-i),i}function Fu(r,t=!0){return t?[-r[1],r[0]]:[r[1],-r[0]]}function Dd(r,t){return r.map(e=>e%t)}function Ja(r){return[r[0],r[1]]}function Ho(r){return CB(r)?[r[0],r[1],0]:r}function VA(r){const[t,e]=r;return!t&&!e?0:Math.atan2(e,t)}function UA(r,t){const[e,n]=r;if(t%360===0)return[e,n];const i=t*Math.PI/180,a=Math.cos(i),s=Math.sin(i);return[e*a-n*s,e*s+n*a]}function YA(r,t){const[e,n]=r,[i,a]=t,s=fe(e,n),o=fe(i,a);return l5(s,o).every(l=>l===0)}function C1(r,t,e=!1){if(YA(r,t))return;const[n,i]=r,[a,s]=t,o=((n[0]-a[0])*(a[1]-s[1])-(n[1]-a[1])*(a[0]-s[0]))/((n[0]-i[0])*(a[1]-s[1])-(n[1]-i[1])*(a[0]-s[0])),l=s[0]-a[0]?(n[0]-a[0]+o*(i[0]-n[0]))/(s[0]-a[0]):(n[1]-a[1]+o*(i[1]-n[1]))/(s[1]-a[1]);if(!(!e&&(!bi(o,0,1)||!bi(l,0,1))))return[n[0]+o*(i[0]-n[0]),n[1]+o*(i[1]-n[1])]}function HA(r){if(Array.isArray(r))return bi(r[0],0,1)&&bi(r[1],0,1)?r:[.5,.5];const t=r.split("-"),e=t.includes("left")?0:t.includes("right")?1:.5,n=t.includes("top")?0:t.includes("bottom")?1:.5;return[e,n]}function dn(r){const{x:t=0,y:e=0,z:n=0}=r.style||{};return[+t,+e,+n]}function c5(r){const{x:t,y:e,z:n}=r.style||{};return t!==void 0||e!==void 0||n!==void 0}function u5(r,t){const[e,n]=t,{min:i,max:a}=r;return[i[0]+e*(a[0]-i[0]),i[1]+n*(a[1]-i[1])]}function Pi(r,t="center"){const e=HA(t);return u5(r,e)}function On(r){var t;return[r.x,r.y,(t=r.z)!==null&&t!==void 0?t:0]}function Vr(r){var t;return{x:r[0],y:r[1],z:(t=r[2])!==null&&t!==void 0?t:0}}function vo(r,t=0){return r.map(e=>parseFloat(e.toFixed(t)))}function ua(r,t,e,n=!1){if(Ge(r,t))return r;const i=n?fe(r,t):fe(t,r),a=Fi(i),s=[a[0]*e,a[1]*e];return qt(Ja(r),s)}function XA(r,t){return r[1]===t[1]}function h5(r,t){return r[0]===t[0]}function d5(r,t){return XA(r,t)||h5(r,t)}function KA(r,t,e){return YA([r,t],[t,e])}function ZA(r,t){return[2*t[0]-r[0],2*t[1]-r[1]]}function JA(r,t,e,n=!0,i=!1){for(let a=0;a<e.length;a++){let s=e[a],o=e[(a+1)%e.length];n&&(s=qt(t,s),o=qt(t,o));const l=i?ZA(r,t):r,c=C1([t,l],[s,o]);if(c)return{point:c,line:[s,o]}}return{point:t,line:void 0}}function f5(r,t,e,n){const i=r[0],a=r[1];let s=!1;e===void 0&&(e=0),n===void 0&&(n=t.length);const o=n-e;for(let l=0,c=o-1;l<o;c=l++){const u=t[l+e][0],h=t[l+e][1],d=t[c+e][0],f=t[c+e][1];h>a!=f>a&&i<(d-u)*(a-h)/(f-h)+u&&(s=!s)}return s}function g5(r,t,e=!1){const n=Pi(t,"center"),i=[Pi(t,"left-top"),Pi(t,"right-top"),Pi(t,"right-bottom"),Pi(t,"left-bottom")];return JA(r,n,i,!1,e).point}function Bu(r,t,e=!1){const n=t.center,i=e?ZA(r,n):r,a=fe(i,t.center),s=Math.atan2(a[1],a[0]);if(isNaN(s))return n;const o=Ei(t)/2,l=Si(t)/2,c=n[0]+o*Math.cos(s),u=n[1]+l*Math.sin(s);return[c,u]}function v5(r,t){let e=1/0,n=[r[0],t[0]];return r.forEach(i=>{t.forEach(a=>{const s=Ee(i,a);s<e&&(e=s,n=[i,a])})}),n}function p5(r,t){let e=1/0,n=[[0,0],[0,0]];return t.forEach(i=>{const a=y5(r,i);a<e&&(e=a,n=i)}),n}function y5(r,t){const e=QA(r,t);return Ee(r,e)}function QA(r,t){const[e,n]=t[0],[i,a]=t[1],[s,o]=r,l=i-e,c=a-n;if(l===0&&c===0)return[e,n];let u=((s-e)*l+(o-n)*c)/(l*l+c*c);u>1?u=1:u<0&&(u=0);const h=e+u*l,d=n+u*c;return[h,d]}function m5(r){const t=r.reduce((e,n)=>qt(e,n),[0,0]);return Xr(t,r.length)}function R1(r,t=!0){const e=m5(r);return r.sort(([n,i],[a,s])=>{const o=Math.atan2(i-e[1],n-e[0]),l=Math.atan2(s-e[1],a-e[0]);return t?l-o:o-l})}function Yx(r,t){return[r,[r[0],t[1]],t,[t[0],r[1]]]}class Ke{constructor(t,e,n){if(this.phase=e,this.pointerByTouch=[],this.initialDistance=null,this.emitter=t,Ke.instance)return Ke.callbacks[this.phase].push(n),Ke.instance;this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.bindEvents(),Ke.instance=this,Ke.callbacks[this.phase].push(n)}bindEvents(){const{emitter:t}=this;t.on(rt.POINTER_DOWN,this.onPointerDown),t.on(rt.POINTER_MOVE,this.onPointerMove),t.on(rt.POINTER_UP,this.onPointerUp)}updatePointerPosition(t,e,n){const i=this.pointerByTouch.findIndex(a=>a.pointerId===t);i>=0&&(this.pointerByTouch[i]={x:e,y:n,pointerId:t})}onPointerDown(t){const{x:e,y:n}=t.client||{};if(!(e===void 0||n===void 0)&&(this.pointerByTouch.push({x:e,y:n,pointerId:t.pointerId}),t.pointerType==="touch"&&this.pointerByTouch.length===2)){Ke.isPinching=!0;const i=this.pointerByTouch[0].x-this.pointerByTouch[1].x,a=this.pointerByTouch[0].y-this.pointerByTouch[1].y;this.initialDistance=Math.sqrt(i*i+a*a),Ke.callbacks.pinchstart.forEach(s=>s(t,{scale:0}))}}onPointerMove(t){if(this.pointerByTouch.length!==2||this.initialDistance===null)return;const{x:e,y:n}=t.client||{};if(e===void 0||n===void 0)return;this.updatePointerPosition(t.pointerId,e,n);const i=this.pointerByTouch[0].x-this.pointerByTouch[1].x,a=this.pointerByTouch[0].y-this.pointerByTouch[1].y,o=Math.sqrt(i*i+a*a)/this.initialDistance;Ke.callbacks.pinchmove.forEach(l=>l(t,{scale:(o-1)*5}))}onPointerUp(t){var e;Ke.callbacks.pinchend.forEach(n=>n(t,{scale:0})),Ke.isPinching=!1,this.initialDistance=null,this.pointerByTouch=[],(e=Ke.instance)===null||e===void 0||e.tryDestroy()}destroy(){this.emitter.off(rt.POINTER_DOWN,this.onPointerDown),this.emitter.off(rt.POINTER_MOVE,this.onPointerMove),this.emitter.off(rt.POINTER_UP,this.onPointerUp),Ke.instance=null}off(t,e){const n=Ke.callbacks[t].indexOf(e);n>-1&&Ke.callbacks[t].splice(n,1),this.tryDestroy()}tryDestroy(){Object.values(Ke.callbacks).every(t=>t.length===0)&&this.destroy()}}Ke.isPinching=!1;Ke.instance=null;Ke.callbacks={pinchstart:[],pinchmove:[],pinchend:[]};const Hx=r=>r.map(t=>ae(t)?t.toLocaleLowerCase():t);class Ys{constructor(t){this.map=new Map,this.boundHandlePinch=()=>{},this.recordKey=new Set,this.onKeyDown=e=>{e!=null&&e.key&&(this.recordKey.add(e.key),this.trigger(e))},this.onKeyUp=e=>{e!=null&&e.key&&this.recordKey.delete(e.key)},this.onWheel=e=>{this.triggerExtendKey(rt.WHEEL,e)},this.onDrag=e=>{this.triggerExtendKey(rt.DRAG,e)},this.handlePinch=(e,n)=>{this.triggerExtendKey(rt.PINCH,Object.assign(Object.assign({},e),n))},this.onFocus=()=>{this.recordKey.clear()},this.emitter=t,this.bindEvents()}bind(t,e){t.length!==0&&(t.includes(rt.PINCH)&&!this.pinchHandler&&(this.boundHandlePinch=this.handlePinch.bind(this),this.pinchHandler=new Ke(this.emitter,"pinchmove",this.boundHandlePinch)),this.map.set(t,e))}unbind(t,e){this.map.forEach((n,i)=>{Ge(i,t)&&(!e||e===n)&&this.map.delete(i)})}unbindAll(){this.map.clear()}match(t){const e=Hx(Array.from(this.recordKey)).sort(),n=Hx(t).sort();return Ge(e,n)}bindEvents(){var t;const{emitter:e}=this;e.on(rt.KEY_DOWN,this.onKeyDown),e.on(rt.KEY_UP,this.onKeyUp),e.on(rt.WHEEL,this.onWheel),e.on(rt.DRAG,this.onDrag),(t=globalThis.addEventListener)===null||t===void 0||t.call(globalThis,"focus",this.onFocus)}trigger(t){this.map.forEach((e,n)=>{this.match(n)&&e(t)})}triggerExtendKey(t,e){this.map.forEach((n,i)=>{i.includes(t)&&Ge(Array.from(this.recordKey),i.filter(a=>a!==t))&&n(e)})}destroy(){var t,e;this.unbindAll(),this.emitter.off(rt.KEY_DOWN,this.onKeyDown),this.emitter.off(rt.KEY_UP,this.onKeyUp),this.emitter.off(rt.WHEEL,this.onWheel),this.emitter.off(rt.DRAG,this.onDrag),(t=this.pinchHandler)===null||t===void 0||t.off("pinchmove",this.boundHandlePinch),(e=globalThis.removeEventListener)===null||e===void 0||e.call(globalThis,"blur",this.onFocus)}}class dl extends wr{constructor(t,e){super(t,An({},dl.defaultOptions,e)),this.shortcut=new Ys(t.graph),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.clearStates=this.clearStates.bind(this),this.bindEvents()}onPointerDown(t){if(!this.validate(t)||!this.isKeydown()||this.startPoint)return;const{canvas:e,graph:n}=this.context,i=Object.assign({},this.options.style);this.options.style.lineWidth&&(i.lineWidth=+this.options.style.lineWidth/n.getZoom()),this.rectShape=new Nn({id:"g6-brush-select",style:i}),e.appendChild(this.rectShape),this.startPoint=[t.canvas.x,t.canvas.y]}onPointerMove(t){var e;if(!this.startPoint)return;const{immediately:n,mode:i}=this.options;this.endPoint=du(t,this.context.graph),(e=this.rectShape)===null||e===void 0||e.attr({x:Math.min(this.endPoint[0],this.startPoint[0]),y:Math.min(this.endPoint[1],this.startPoint[1]),width:Math.abs(this.endPoint[0]-this.startPoint[0]),height:Math.abs(this.endPoint[1]-this.startPoint[1])}),n&&i==="default"&&this.updateElementsStates(Yx(this.startPoint,this.endPoint))}onPointerUp(t){if(this.startPoint){if(!this.endPoint){this.clearBrush();return}this.endPoint=du(t,this.context.graph),this.updateElementsStates(Yx(this.startPoint,this.endPoint)),this.clearBrush()}}clearStates(){this.endPoint||this.clearElementsStates()}clearElementsStates(){const{graph:t}=this.context,e=Object.values(t.getData()).reduce((n,i)=>Object.assign({},n,i.reduce((a,s)=>{var o;const l=(o=s.states||[])===null||o===void 0?void 0:o.filter(c=>c!==this.options.state);return a[K(s)]=l,a},{})),{});t.setElementState(e,this.options.animation)}updateElementsStates(t){const{graph:e}=this.context,{enableElements:n,state:i,mode:a,onSelect:s}=this.options,o=this.selector(e,t,n);let l={};switch(a){case"union":o.forEach(c=>{l[c]=[...e.getElementState(c),i]});break;case"diff":o.forEach(c=>{const u=e.getElementState(c);l[c]=u.includes(i)?u.filter(h=>h!==i):[...u,i]});break;case"intersect":o.forEach(c=>{const u=e.getElementState(c);l[c]=u.includes(i)?[i]:[]});break;case"default":default:o.forEach(c=>{l[c]=[i]});break}Tt(s)&&(l=s(l)),e.setElementState(l,this.options.animation)}selector(t,e,n){if(!n||n.length===0)return[];const i=[],a=t.getData();if(n.forEach(s=>{a[`${s}s`].forEach(o=>{const l=K(o);t.getElementVisibility(l)!=="hidden"&&f5(t.getElementPosition(l),e)&&i.push(l)})}),n.includes("edge")){const s=a.edges;s==null||s.forEach(o=>{const{source:l,target:c}=o;i.includes(l)&&i.includes(c)&&i.push(K(o))})}return i}clearBrush(){var t;(t=this.rectShape)===null||t===void 0||t.remove(),this.rectShape=void 0,this.startPoint=void 0,this.endPoint=void 0}isKeydown(){const{trigger:t}=this.options,e=Array.isArray(t)?t:[t];return this.shortcut.match(e.filter(n=>n!=="drag"))}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return Tt(e)?e(t):!!e}bindEvents(){const{graph:t}=this.context;t.on(rt.POINTER_DOWN,this.onPointerDown),t.on(rt.POINTER_MOVE,this.onPointerMove),t.on(rt.POINTER_UP,this.onPointerUp),t.on(Bi.CLICK,this.clearStates)}unbindEvents(){const{graph:t}=this.context;t.off(rt.POINTER_DOWN,this.onPointerDown),t.off(rt.POINTER_MOVE,this.onPointerMove),t.off(rt.POINTER_UP,this.onPointerUp),t.off(Bi.CLICK,this.clearStates)}update(t){this.unbindEvents(),this.options=An(this.options,t),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy()}}dl.defaultOptions={animation:!1,enable:!0,enableElements:["node","combo","edge"],immediately:!1,mode:"default",state:"selected",trigger:["shift"],style:{width:0,height:0,lineWidth:1,fill:"#1677FF",stroke:"#1677FF",fillOpacity:.1,zIndex:2,pointerEvents:"none"}};const du=(r,t)=>{if((r.targetType==="node"||r.targetType==="combo")&&!(r.nativeEvent.target instanceof HTMLCanvasElement)){const[e,n]=t.getCanvasByClient([r.client.x,r.client.y]);return[e,n]}return[r.canvas.x,r.canvas.y]},ji=.8,Qa=["node","edge","combo"];function Ds(r,t,e,n,i=0){n==="TB"&&t(r,i);const a=e(r);if(a)for(const s of a)Ds(s,t,e,n,i+1);n==="BT"&&t(r,i)}function b5(r,t,e){const n=[[r,0]];for(;n.length;){const[i,a]=n.shift();t(i,a);const s=e(i);if(s)for(const o of s)n.push([o,a+1])}}function tN(r,t,e,n,i="both"){if(t==="combo"||t==="node")return Fd(r,e,n,i);const a=r.getEdgeData(e);if(!a)return[];const s=Fd(r,a.source,n-1,i),o=Fd(r,a.target,n-1,i);return Array.from(new Set([...s,...o,e]))}function Fd(r,t,e,n="both"){const i=new Set,a=new Set,s=new Set;return b5(t,(o,l)=>{l>e||(s.add(o),r.getRelatedEdgesData(o,n).forEach(c=>{const u=K(c);!a.has(u)&&l<e&&(s.add(u),a.add(u))}))},o=>r.getRelatedEdgesData(o,n).map(l=>l.source===o?l.target:l.source).filter(l=>i.has(l)?!1:(i.add(l),!0))),Array.from(s)}function Bd(r){return r.states||[]}var uc=function(r,t,e,n){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((n=n.apply(r,t||[])).next())})};class zu extends wr{constructor(t,e){super(t,Object.assign({},zu.defaultOptions,e)),this.onClickSelect=n=>uc(this,void 0,void 0,function*(){var i,a;this.validate(n)&&(yield this.updateState(n),(a=(i=this.options).onClick)===null||a===void 0||a.call(i,n))}),this.onClickCanvas=n=>uc(this,void 0,void 0,function*(){var i,a;this.validate(n)&&(yield this.clearState(),(a=(i=this.options).onClick)===null||a===void 0||a.call(i,n))}),this.shortcut=new Ys(t.graph),this.bindEvents()}bindEvents(){const{graph:t}=this.context;this.unbindEvents(),Qa.forEach(e=>{t.on(`${e}:${rt.CLICK}`,this.onClickSelect)}),t.on(Bi.CLICK,this.onClickCanvas)}get isMultipleSelect(){const{multiple:t,trigger:e}=this.options;return t&&this.shortcut.match(e)}getNeighborIds(t){const{target:e,targetType:n}=t,{graph:i}=this.context,{degree:a}=this.options;return tN(i,n,e.id,typeof a=="function"?a(t):a).filter(s=>s!==e.id)}updateState(t){return uc(this,void 0,void 0,function*(){const{state:e,unselectedState:n,neighborState:i,animation:a}=this.options;if(!e&&!i&&!n)return;const{target:s}=t,{graph:o}=this.context,l=o.getElementData(s.id),c=Bd(l).includes(e)?"unselect":"select",u={},h=this.isMultipleSelect,d=[s.id],f=this.getNeighborIds(t);if(h)if(Object.assign(u,this.getDataStates()),c==="select"){const g=(v,p)=>{v.forEach(y=>{const m=new Set(o.getElementState(y));m.add(p),m.delete(n),u[y]=Array.from(m)})};g(d,e),g(f,i),n&&Object.keys(u).forEach(v=>{const p=u[v];!p.includes(e)&&!p.includes(i)&&!p.includes(n)&&u[v].push(n)})}else{const g=u[s.id];u[s.id]=g.filter(v=>v!==e&&v!==i),g.includes(n)||u[s.id].push(n),f.forEach(v=>{u[v]=u[v].filter(p=>p!==i),u[v].includes(e)||u[v].push(n)})}else if(c==="select"){Object.assign(u,this.getClearStates(!!n));const g=(v,p)=>{v.forEach(y=>{u[y]||(u[y]=o.getElementState(y)),u[y].push(p)})};g(d,e),g(f,i),n&&Object.keys(u).forEach(v=>{!d.includes(v)&&!f.includes(v)&&u[v].push(n)})}else Object.assign(u,this.getClearStates());yield o.setElementState(u,a)})}getDataStates(){const{graph:t}=this.context,{nodes:e,edges:n,combos:i}=t.getData(),a={};return[...e,...n,...i].forEach(s=>{a[K(s)]=Bd(s)}),a}getClearStates(t=!1){const{graph:e}=this.context,{state:n,unselectedState:i,neighborState:a}=this.options,s=new Set([n,i,a]),{nodes:o,edges:l,combos:c}=e.getData(),u={};return[...o,...l,...c].forEach(h=>{const d=Bd(h),f=d.filter(g=>!s.has(g));(t||f.length!==d.length)&&(u[K(h)]=f)}),u}clearState(){return uc(this,void 0,void 0,function*(){const{graph:t}=this.context;yield t.setElementState(this.getClearStates(),this.options.animation)})}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return Tt(e)?e(t):!!e}unbindEvents(){const{graph:t}=this.context;Qa.forEach(e=>{t.off(`${e}:${rt.CLICK}`,this.onClickSelect)}),t.off(Bi.CLICK,this.onClickCanvas)}destroy(){this.unbindEvents(),super.destroy()}}zu.defaultOptions={animation:!0,enable:!0,multiple:!1,trigger:["shift"],state:"selected",neighborState:"selected",unselectedState:void 0,degree:0};function ir(r){var t;return!!(!((t=r.style)===null||t===void 0)&&t.collapsed)}function fu(r,t){if(!r.startsWith(t))return!1;const e=r[t.length];return e>="A"&&e<="Z"}function x5(r,t){return`${t}${Zc(r)}`}function w5(r,t,e=!0){if(!t||!fu(r,t))return r;const n=r.slice(t.length);return e?G3(n):n}function Ue(r,t){const e=Object.entries(r).reduce((n,[i,a])=>(i==="className"||i==="class"||fu(i,t)&&Object.assign(n,{[w5(i,t)]:a}),n),{});if("opacity"in r){const n=x5("opacity",t),i=r.opacity;if(n in r){const a=r[n];Object.assign(e,{opacity:i*a})}else Object.assign(e,{opacity:i})}return e}function Tm(r,t){const e=t.length;return Object.keys(r).reduce((n,i)=>{if(i.startsWith(t)){const a=i.slice(e);n[a]=r[i]}return n},{})}function eN(r,t){const e=typeof t=="string"?[t]:t,n={};return Object.keys(r).forEach(i=>{e.find(a=>i.startsWith(a))||(n[i]=r[i])}),n}function br(r=0){if(typeof r=="number")return[r,r,r];const[t,e=t,n=t]=r;return[t,e,n]}var E5=function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(e[n[i]]=r[n[i]]);return e};function Xx(r,t){const{datum:e,graph:n}=t;return typeof r=="function"?r.call(n,e):Object.fromEntries(Object.entries(r).map(([i,a])=>typeof a=="function"?[i,a.call(n,e)]:[i,a]))}function wn(r,t){const e=(r==null?void 0:r.style)||{},n=(t==null?void 0:t.style)||{};for(const i in e)i in n||(n[i]=e[i]);return Object.assign({},r,t,{style:n})}function S5(r){const{x:t,y:e,z:n,class:i,className:a,transform:s,transformOrigin:o,zIndex:l,visibility:c}=r;return E5(r,["x","y","z","class","className","transform","transformOrigin","zIndex","visibility"])}function _5(r,t){const e=br(r);let n={};return t.text&&!t.fontSize&&(n={fontSize:Math.min(...e)*.5}),t.src&&(!t.width||!t.height)&&(n={width:e[0]*.5,height:e[1]*.5}),n}function Kx(r){if(r)return typeof r=="string"||typeof r=="function"||Array.isArray(r)?{type:"group",field:t=>t.id,color:r,invert:!1}:r}function k5(r,t){if(!t)return{};const{type:e,color:n,field:i,invert:a}=t,s=l=>{const c=typeof n=="string"?zi("palette",n):n;if(typeof c=="function"){const u={};return l.forEach(([h,d])=>{u[h]=c(a?1-d:d)}),u}else if(Array.isArray(c)){const u=a?[...c].reverse():c,h={};return l.forEach(([d,f])=>{h[d]=u[f%c.length]}),h}return{}},o=(l,c)=>{var u;return typeof l=="string"?(u=c.data)===null||u===void 0?void 0:u[l]:l==null?void 0:l(c)};if(e==="group"){const l=Nu(r,d=>{if(!i)return"default";const f=o(i,d);return f?String(f):"default"}),c=Object.keys(l),u=s(c.map((d,f)=>[d,f])),h={};return Object.entries(l).forEach(([d,f])=>{f.forEach(g=>{h[K(g)]=u[d]})}),h}else if(e==="value"){const[l,c]=r.reduce(([h,d],f)=>{const g=o(i,f);if(typeof g!="number")throw new Error(Ii(`Palette field ${i} is not a number`));return[Math.min(h,g),Math.max(d,g)]},[1/0,-1/0]),u=c-l;return s(r.map(h=>[h.id,(o(i,h)-l)/u]))}}function nN(r){const t=typeof r=="string"?zi("palette",r):r;if(typeof t!="function")return t}function rN(r,t){let e=2*r;return typeof t=="string"?e=r*Number(t.replace("%",""))/100:typeof t=="number"&&(e=t),isNaN(e)&&(e=2*r),e}function iN(r,t,e=1,n=!1){const i=n?e:1,a=(r.max[0]-r.min[0])*i;return rN(a,t)}function M5(r,t,e=1){const n=Ee(r[0],r[1])*e;return rN(n,t)}class fl extends E1{constructor(t){Zx(t.style),super(t),this.shapeMap={},this.animateMap={},this.render(this.attributes,this),this.setVisibility(),this.bindEvents()}get parsedAttributes(){return this.attributes}upsert(t,e,n,i,a){var s,o,l,c,u,h,d,f;const g=this.shapeMap[t];if(n===!1){g&&((s=a==null?void 0:a.beforeDestroy)===null||s===void 0||s.call(a,g),i.removeChild(g),delete this.shapeMap[t],(o=a==null?void 0:a.afterDestroy)===null||o===void 0||o.call(a,g));return}const v=typeof e=="string"?zi(Uo.SHAPE,e):e;if(!v)throw new Error(Ii(`Shape ${e} not found`));if(!g||g.destroyed||!(g instanceof v)){g&&((l=a==null?void 0:a.beforeDestroy)===null||l===void 0||l.call(a,g),g==null||g.destroy(),(c=a==null?void 0:a.afterDestroy)===null||c===void 0||c.call(a,g)),(u=a==null?void 0:a.beforeCreate)===null||u===void 0||u.call(a);const p=new v({className:t,style:n});return i.appendChild(p),this.shapeMap[t]=p,(h=a==null?void 0:a.afterCreate)===null||h===void 0||h.call(a,p),p}return(d=a==null?void 0:a.beforeUpdate)===null||d===void 0||d.call(a,g),Im(g,n),(f=a==null?void 0:a.afterUpdate)===null||f===void 0||f.call(a,g),g}update(t={}){const e=Object.assign({},this.attributes,t);Zx(e),xz(this,e),this.render(e,this),this.setVisibility()}bindEvents(){}getGraphicStyle(t){return S5(t)}get compositeShapes(){return[["badges","badge-"],["ports","port-"]]}animate(t,e){if(t.length===0)return null;const n=[];if(t[0].x!==void 0||t[0].y!==void 0||t[0].z!==void 0){const{x:a=0,y:s=0,z:o=0}=this.attributes;t.forEach(l=>{const{x:c=a,y:u=s,z:h=o}=l;Object.assign(l,{transform:h?[["translate3d",c,u,h]]:[["translate",c,u]]})})}const i=super.animate(t,e);if(i&&(zd(this,i),n.push(i)),Array.isArray(t)&&t.length>0){const a=["transform","transformOrigin","x","y","z","zIndex"];if(Object.keys(t[0]).some(s=>!a.includes(s))){Object.entries(this.shapeMap).forEach(([o,l])=>{const c=`get${Zc(o)}Style`,u=this[c];if(Tt(u)){const h=t.map(f=>u.call(this,Object.assign(Object.assign({},this.attributes),f))),d=l.animate(Mm(h),e);d&&(zd(l,d),n.push(d))}});const s=(o,l)=>{if(!ui(o)){const c=`get${Zc(l)}Style`,u=this[c];if(Tt(u)){const h=t.map(d=>u.call(this,Object.assign(Object.assign({},this.attributes),d)));Object.entries(h[0]).map(([d])=>{const f=h.map(v=>v[d]),g=o[d];if(g){const v=g.animate(Mm(f),e);v&&(zd(g,v),n.push(v))}})}}};this.compositeShapes.forEach(([o,l])=>{const c=Tm(this.shapeMap,l);s(c,o)})}}return M1(n)}getShape(t){return this.shapeMap[t]}setVisibility(){const{visibility:t}=this.attributes;Za(this,t)}destroy(){this.shapeMap={},this.animateMap={},super.destroy()}}function zd(r,t){t==null||t.finished.then(()=>{const e=r.activeAnimations.findIndex(n=>n===t);e>-1&&r.activeAnimations.splice(e,1)})}function Zx(r){if(!r)return{};if("x"in r||"y"in r||"z"in r){const{x:t=0,y:e=0,z:n,transform:i}=r,a=RA(t,e,n,i);a&&(r.transform=a)}return r}var T5=function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(e[n[i]]=r[n[i]]);return e};class xi extends fl{constructor(t){super(wn({style:xi.defaultStyleProps},t))}isTextStyle(t){return fu(t,"label")}isBackgroundStyle(t){return fu(t,"background")}getTextStyle(t){const e=this.getGraphicStyle(t),{padding:n}=e,i=T5(e,["padding"]);return eN(i,"background")}getBackgroundStyle(t){if(t.background===!1)return!1;const e=this.getGraphicStyle(t),{wordWrap:n,wordWrapWidth:i,padding:a}=e,s=Ue(e,"background"),{min:[o,l],center:[c,u],halfExtents:[h,d]}=this.shapeMap.text.getGeometryBounds(),[f,g,v,p]=Lr(a),y=h*2+p+g,{width:m,height:x}=s;m&&x?Object.assign(s,{x:c-Number(m)/2,y:u-Number(x)/2}):Object.assign(s,{x:o-p,y:l-f,width:n?Math.min(y,i+p+g):y,height:d*2+f+v});const{radius:E}=s;if(typeof E=="string"&&E.endsWith("%")){const _=Number(E.replace("%",""))/100;s.radius=Math.min(+s.width,+s.height)*_}return s}render(t=this.parsedAttributes,e=this){this.upsert("text",as,this.getTextStyle(t),e),this.upsert("background",Nn,this.getBackgroundStyle(t),e)}getGeometryBounds(){return(this.getShape("background")||this.getShape("text")).getGeometryBounds()}}xi.defaultStyleProps={padding:0,fontSize:12,fontFamily:"system-ui, sans-serif",wordWrap:!0,maxLines:1,wordWrapWidth:128,textOverflow:"...",textBaseline:"middle",backgroundOpacity:.75,backgroundZIndex:-1,backgroundLineWidth:0};class Hs extends fl{constructor(t){super(wn({style:Hs.defaultStyleProps},t))}getBadgeStyle(t){return this.getGraphicStyle(t)}render(t=this.parsedAttributes,e=this){this.upsert("label",xi,this.getBadgeStyle(t),e)}getGeometryBounds(){const t=this.getShape("label");return(t.getShape("background")||t.getShape("text")).getGeometryBounds()}}Hs.defaultStyleProps={padding:[2,4,2,4],fontSize:10,wordWrap:!1,backgroundRadius:"50%",backgroundOpacity:1};function O5(r,t=!0){const e=[];return r.forEach((n,i)=>{e.push([i===0?"M":"L",...n])}),t&&e.push(["Z"]),e}const Jx={M:["x","y"],m:["dx","dy"],H:["x"],h:["dx"],V:["y"],v:["dy"],L:["x","y"],l:["dx","dy"],Z:[],z:[],C:["x1","y1","x2","y2","x","y"],c:["dx1","dy1","dx2","dy2","dx","dy"],S:["x2","y2","x","y"],s:["dx2","dy2","dx","dy"],Q:["x1","y1","x","y"],q:["dx1","dy1","dx","dy"],T:["x","y"],t:["dx","dy"],A:["rx","ry","rotation","large-arc","sweep","x","y"],a:["rx","ry","rotation","large-arc","sweep","dx","dy"]};function A5(r){const t=r.replace(/[\n\r]/g,"").replace(/-/g," -").replace(/(\d*\.)(\d+)(?=\.)/g,"$1$2 ").trim().split(/\s*,|\s+/),e=[];let n="",i={};for(;t.length>0;){let a=t.shift();a in Jx?n=a:t.unshift(a),i={type:n},Jx[n].forEach(l=>{a=t.shift(),i[l]=a}),n==="M"?n="L":n==="m"&&(n="l");const[s,...o]=Object.values(i);e.push([s,...o.map(Number)])}return e}function N5(r){const t=[];return(typeof r=="string"?A5(r):r).forEach(n=>{const i=n[0];if(i==="Z"){t.push(t[0]);return}if(i!=="A")for(let a=1;a<n.length;a=a+2)t.push([n[a],n[a+1],0]);else{const a=n.length;t.push([n[a-2],n[a-1],0])}}),t}const aN=r=>{if(r.length<2)return[["M",0,0],["L",0,0]];const t=r[0],e=r[1],n=r[r.length-1],i=r[r.length-2];r.unshift(i,n),r.push(t,e);const a=[["M",n[0],n[1]]];for(let s=1;s<r.length-2;s+=1){const[o,l]=r[s-1],[c,u]=r[s],[h,d]=r[s+1],[f,g]=s!==r.length-2?r[s+2]:[h,d],v=c+(h-o)/6,p=u+(d-l)/6,y=h-(f-c)/6,m=d-(g-u)/6;a.push(["C",v,p,y,m,h,d])}return a};function P5(r,t,e,n,i,a,s){const[o,l]=Pi(r,t),c={textAlign:t==="left"?"right":t==="right"?"left":"center",textBaseline:t==="top"?"bottom":t==="bottom"?"top":"middle",transform:[["translate",o+e,l+n]]};if(t==="center"||!i)return c;const u=N5(a);if(!u||u.length<=3)return c;const h=u.map((g,v)=>{const p=g,y=u[(v+1)%u.length];return Ge(p,y)?null:[p,y]}).filter(Boolean),d=p5([o,l],h),f=QA([o,l],d);if(f&&d&&(c.transform=[["translate",f[0]+e,f[1]+n]],s)){const g=Math.atan((d[0][1]-d[1][1])/(d[0][0]-d[1][0]));c.transform.push(["rotate",g/Math.PI*180]),c.textAlign="center",(t==="right"||t==="left")&&(g>0?c.textBaseline=t==="right"?"bottom":"top":c.textBaseline=t==="right"?"top":"bottom")}return c}var C5=function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(e[n[i]]=r[n[i]]);return e};class gl extends fl{constructor(t){super(wn({style:gl.defaultStyleProps},t))}getLabelStyle(t){if(!t.label||!t.d||t.d.length===0)return!1;const e=Ue(this.getGraphicStyle(t),"label"),{maxWidth:n,offsetX:i,offsetY:a,autoRotate:s,placement:o,closeToPath:l}=e,c=C5(e,["maxWidth","offsetX","offsetY","autoRotate","placement","closeToPath"]),u=this.shapeMap.key,h=u==null?void 0:u.getRenderBounds();return Object.assign(P5(h,o,i,a,l,t.d,s),{wordWrapWidth:iN(h,n)},c)}getKeyStyle(t){return this.getGraphicStyle(t)}render(t,e){this.upsert("key",pr,this.getKeyStyle(t),e),this.upsert("label",xi,this.getLabelStyle(t),e)}}gl.defaultStyleProps={label:!0,labelPlacement:"bottom",labelCloseToPath:!0,labelAutoRotate:!0,labelOffsetX:0,labelOffsetY:0};function R5(r){const t=[],e=n=>{n!=null&&n.children.length&&n.children.forEach(i=>{t.push(i),e(i)})};return e(r),t}function L5(r){const t=[];let e=r.parentNode;for(;e;)t.push(e),e=e.parentNode;return t}let L1=class extends ul{constructor(t){super(t),this.onMounted=()=>{this.handleRadius()},this.onAttrModified=()=>{this.handleRadius()},ks=this,this.isMutationObserved=!0,this.addEventListener(Jt.MOUNTED,this.onMounted),this.addEventListener(Jt.ATTR_MODIFIED,this.onAttrModified)}handleRadius(){const{radius:t,clipPath:e,width:n=0,height:i=0}=this.attributes;if(t&&n&&i){const[a,s]=this.getBounds().min,o={x:a,y:s,radius:t,width:n,height:i};if(e)Object.assign(this.parsedStyle.clipPath.style,o);else{const l=new Nn({style:o});this.style.clipPath=l}}else e&&(this.style.clipPath=null)}};const Om=new WeakMap;let ks=null;const I1=r=>{if(ks&&L5(ks).includes(r)){const t=Om.get(r);t?t.includes(ks)||t.push(ks):Om.set(r,[ks])}},D1=r=>{const t=Om.get(r);t&&t.forEach(e=>e.handleRadius())};class sN extends fl{constructor(t){super(t)}isImage(){const{src:t}=this.attributes;return!!t}getIconStyle(t=this.attributes){const{width:e=0,height:n=0}=t,i=this.getGraphicStyle(t);return this.isImage()?Object.assign({x:-e/2,y:-n/2},i):Object.assign({textBaseline:"middle",textAlign:"center"},i)}render(t=this.attributes,e=this){this.upsert("icon",this.isImage()?L1:as,this.getIconStyle(t),e)}}class oN extends fl{get context(){return this.config.context}get parsedAttributes(){return this.attributes}onframe(){}animate(t,e){const n=super.animate(t,e);return n&&(n.onframe=()=>this.onframe(),n.finished.then(()=>this.onframe())),n}}var hc=function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(e[n[i]]=r[n[i]]);return e};class Zr extends oN{constructor(t){super(wn({style:Zr.defaultStyleProps},t)),this.type="node"}getSize(t=this.attributes){const{size:e}=t;return br(e)}getKeyStyle(t){const e=this.getGraphicStyle(t);return Object.assign(eN(e,["label","halo","icon","badge","port"]))}getLabelStyle(t){if(t.label===!1||!t.labelText)return!1;const e=Ue(this.getGraphicStyle(t),"label"),{placement:n,maxWidth:i,offsetX:a,offsetY:s}=e,o=hc(e,["placement","maxWidth","offsetX","offsetY"]),l=this.getShape("key").getLocalBounds();return Object.assign(gw(l,n,a,s),{wordWrapWidth:iN(l,i)},o)}getHaloStyle(t){if(t.halo===!1)return!1;const e=this.getKeyStyle(t),{fill:n}=e,i=hc(e,["fill"]),a=Ue(this.getGraphicStyle(t),"halo");return Object.assign(Object.assign(Object.assign({},i),{stroke:n}),a)}getIconStyle(t){if(t.icon===!1||!t.iconText&&!t.iconSrc)return!1;const e=Ue(this.getGraphicStyle(t),"icon");return Object.assign(_5(t.size,e),e)}getBadgesStyle(t){var e;const n=Tm(this.shapeMap,"badge-"),i={};if(Object.keys(n).forEach(h=>{i[h]=!1}),t.badge===!1||!(!((e=t.badges)===null||e===void 0)&&e.length))return i;const{badges:a=[],badgePalette:s,opacity:o=1}=t,l=hc(t,["badges","badgePalette","opacity"]),c=nN(s),u=Ue(this.getGraphicStyle(l),"badge");return a.forEach((h,d)=>{i[d]=Object.assign(Object.assign({backgroundFill:c?c[d%(c==null?void 0:c.length)]:void 0,opacity:o},u),this.getBadgeStyle(h))}),i}getBadgeStyle(t){const e=this.getShape("key"),{placement:n="top",offsetX:i,offsetY:a}=t,s=hc(t,["placement","offsetX","offsetY"]),o=gw(e.getLocalBounds(),n,i,a,!0);return Object.assign(Object.assign({},o),s)}getPortsStyle(t){var e;const n=this.getPorts(),i={};if(Object.keys(n).forEach(o=>{i[o]=!1}),t.port===!1||!(!((e=t.ports)===null||e===void 0)&&e.length))return i;const a=Ue(this.getGraphicStyle(t),"port"),{ports:s=[]}=t;return s.forEach((o,l)=>{const c=o.key||l,u=Object.assign(Object.assign({},a),o);if(ON(u))i[c]=!1;else{const[h,d]=this.getPortXY(t,o);i[c]=Object.assign({transform:[["translate",h,d]]},u)}}),i}getPortXY(t,e){const{placement:n="left"}=e,i=this.getShape("key");return q1(I5(this.context,i),n)}getPorts(){return Tm(this.shapeMap,"port-")}getCenter(){return this.getShape("key").getBounds().center}getIntersectPoint(t,e=!1){const n=this.getShape("key").getBounds();return g5(t,n,e)}drawHaloShape(t,e){const n=this.getHaloStyle(t),i=this.getShape("key");this.upsert("halo",i.constructor,n,e)}drawIconShape(t,e){const n=this.getIconStyle(t);this.upsert("icon",sN,n,e),I1(this)}drawBadgeShapes(t,e){const n=this.getBadgesStyle(t);Object.keys(n).forEach(i=>{const a=n[i];this.upsert(`badge-${i}`,Hs,a,e)})}drawPortShapes(t,e){const n=this.getPortsStyle(t);Object.keys(n).forEach(i=>{const a=n[i],s=`port-${i}`;this.upsert(s,mi,a,e)})}drawLabelShape(t,e){const n=this.getLabelStyle(t);this.upsert("label",xi,n,e)}_drawKeyShape(t,e){return this.drawKeyShape(t,e)}render(t=this.parsedAttributes,e=this){this._drawKeyShape(t,e),this.getShape("key")&&(this.drawHaloShape(t,e),this.drawIconShape(t,e),this.drawBadgeShapes(t,e),this.drawLabelShape(t,e),this.drawPortShapes(t,e))}update(t){super.update(t),t&&("x"in t||"y"in t||"z"in t)&&D1(this)}onframe(){this.drawBadgeShapes(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this)}}Zr.defaultStyleProps={x:0,y:0,size:32,droppable:!0,draggable:!0,port:!0,ports:[],portZIndex:2,portLinkToCenter:!1,badge:!0,badges:[],badgeZIndex:3,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloStrokeOpacity:.25,haloPointerEvents:"none",haloZIndex:-1,icon:!0,iconZIndex:1,label:!0,labelIsBillboard:!0,labelMaxWidth:"200%",labelPlacement:"bottom",labelWordWrap:!1,labelZIndex:0};function I5(r,t){if(!r)return t.getLocalBounds();const e=r.canvas.getLayer(),n=t.cloneNode();Za(n,"hidden"),e.appendChild(n);const i=n.getLocalBounds();return n.destroy(),i}let vl=class lN extends Zr{constructor(t){super(wn({style:lN.defaultStyleProps},t))}drawKeyShape(t,e){return this.upsert("key",mi,this.getKeyStyle(t),e)}getKeyStyle(t){const e=super.getKeyStyle(t);return Object.assign(Object.assign({},e),{r:Math.min(...this.getSize(t))/2})}getIconStyle(t){const e=super.getIconStyle(t),{r:n}=this.getShape("key").attributes,i=n*2*ji;return e?Object.assign({width:i,height:i},e):!1}getIntersectPoint(t,e=!1){const n=this.getShape("key").getBounds();return Bu(t,n,e)}};vl.defaultStyleProps={size:32};class ju extends Zr{constructor(t){super(t)}get parsedAttributes(){return this.attributes}drawKeyShape(t,e){return this.upsert("key",is,this.getKeyStyle(t),e)}getKeyStyle(t){const e=super.getKeyStyle(t);return Object.assign(Object.assign({},e),{points:this.getPoints(t)})}getIntersectPoint(t,e=!1){var n,i;const{points:a}=this.getShape("key").attributes,s=[+(((n=this.attributes)===null||n===void 0?void 0:n.x)||0),+(((i=this.attributes)===null||i===void 0?void 0:i.y)||0)];return JA(t,s,a,!0,e).point}}class D5 extends ju{constructor(t){super(t)}getPoints(t){const[e,n]=this.getSize(t);return bz(e,n)}}var F5=function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(e[n[i]]=r[n[i]]);return e};class qu extends vl{constructor(t){super(wn({style:qu.defaultStyleProps},t))}parseOuterR(){const{size:t}=this.parsedAttributes;return Math.min(...br(t))/2}parseInnerR(){const{innerR:t}=this.parsedAttributes;return ae(t)?parseInt(t)/100*this.parseOuterR():t}drawDonutShape(t,e){const{donuts:n}=t;if(!(n!=null&&n.length))return;const i=n.map(h=>St(h)?{value:h}:h),a=Ue(this.getGraphicStyle(t),"donut"),s=nN(t.donutPalette);if(!s)return;const o=i.reduce((h,d)=>{var f;return h+((f=d.value)!==null&&f!==void 0?f:0)},0),l=this.parseOuterR(),c=this.parseInnerR();let u=0;i.forEach((h,d)=>{const{value:f=0,color:g=s[d%s.length]}=h,v=F5(h,["value","color"]),p=(o===0?1/i.length:f/o)*360;this.upsert(`round${d}`,pr,Object.assign(Object.assign(Object.assign({},a),{d:j5(l,c,u,u+p),fill:g}),v),e),u+=p})}render(t,e=this){super.render(t,e),this.drawDonutShape(t,e)}}qu.defaultStyleProps={innerR:"50%",donuts:[],donutPalette:"tableau"};const dc=(r,t,e,n)=>[r+Math.sin(n)*e,t-Math.cos(n)*e],B5=(r,t,e,n)=>n<=0||e<=n?[["M",r-e,t],["A",e,e,0,1,1,r+e,t],["A",e,e,0,1,1,r-e,t],["Z"]]:[["M",r-e,t],["A",e,e,0,1,1,r+e,t],["A",e,e,0,1,1,r-e,t],["Z"],["M",r+n,t],["A",n,n,0,1,0,r-n,t],["A",n,n,0,1,0,r+n,t],["Z"]],z5=(r,t,e,n,i,a)=>{const[s,o]=[i/360*2*Math.PI,a/360*2*Math.PI],l=[dc(r,t,n,s),dc(r,t,e,s),dc(r,t,e,o),dc(r,t,n,o)],c=o-s>Math.PI?1:0;return[["M",l[0][0],l[0][1]],["L",l[1][0],l[1][1]],["A",e,e,0,c,1,l[2][0],l[2][1]],["L",l[3][0],l[3][1]],["A",n,n,0,c,0,l[0][0],l[0][1]],["Z"]]},j5=(r=0,t=0,e,n)=>{const[i,a]=[0,0];return Math.abs(e-n)%360<1e-6?B5(i,a,r,t):z5(i,a,r,t,e,n)};class Gu extends Zr{constructor(t){super(wn({style:Gu.defaultStyleProps},t))}drawKeyShape(t,e){return this.upsert("key",cl,this.getKeyStyle(t),e)}getKeyStyle(t){const e=super.getKeyStyle(t),[n,i]=this.getSize(t);return Object.assign(Object.assign({},e),{rx:n/2,ry:i/2})}getIconStyle(t){const e=super.getIconStyle(t),{rx:n,ry:i}=this.getShape("key").attributes,a=Math.min(+n,+i)*2*ji;return e?Object.assign({width:a,height:a},e):!1}getIntersectPoint(t,e=!1){const n=this.getShape("key").getBounds();return Bu(t,n,e)}}Gu.defaultStyleProps={size:[45,35]};class q5 extends ju{constructor(t){super(t)}getOuterR(t){return t.outerR||Math.min(...this.getSize(t))/2}getPoints(t){return wz(this.getOuterR(t))}getIconStyle(t){const e=super.getIconStyle(t),n=this.getOuterR(t)*ji;return e?Object.assign({width:n,height:n},e):!1}}/*!
 * @antv/g-plugin-canvas-path-generator
 * @description A G plugin of path generator with Canvas2D API
 * @version 2.1.22
 * @date 7/30/2025, 1:35:25 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */function G5(r,t){var e=t.cx,n=e===void 0?0:e,i=t.cy,a=i===void 0?0:i,s=t.r;r.arc(n,a,s,0,Math.PI*2,!1)}function $5(r,t){var e=t.cx,n=e===void 0?0:e,i=t.cy,a=i===void 0?0:i,s=t.rx,o=t.ry;if(r.ellipse)r.ellipse(n,a,s,o,0,0,Math.PI*2,!1);else{var l=s>o?s:o,c=s>o?1:s/o,u=s>o?o/s:1;r.save(),r.scale(c,u),r.arc(n,a,l,0,Math.PI*2)}}function W5(r,t){var e=t.x1,n=t.y1,i=t.x2,a=t.y2,s=t.markerStart,o=t.markerEnd,l=t.markerStartOffset,c=t.markerEndOffset,u=0,h=0,d=0,f=0,g=0,v,p;s&&se(s)&&l&&(v=i-e,p=a-n,g=Math.atan2(p,v),u=Math.cos(g)*(l||0),h=Math.sin(g)*(l||0)),o&&se(o)&&c&&(v=e-i,p=n-a,g=Math.atan2(p,v),d=Math.cos(g)*(c||0),f=Math.sin(g)*(c||0)),r.moveTo(e+u,n+h),r.lineTo(i+d,a+f)}function V5(r,t){var e=t.markerStart,n=t.markerEnd,i=t.markerStartOffset,a=t.markerEndOffset,s=t.d,o=s.absolutePath,l=s.segments,c=0,u=0,h=0,d=0,f=0,g,v;if(e&&se(e)&&i){var p=e.parentNode.getStartTangent(),y=$t(p,2),m=y[0],x=y[1];g=m[0]-x[0],v=m[1]-x[1],f=Math.atan2(v,g),c=Math.cos(f)*(i||0),u=Math.sin(f)*(i||0)}if(n&&se(n)&&a){var E=n.parentNode.getEndTangent(),_=$t(E,2),M=_[0],O=_[1];g=M[0]-O[0],v=M[1]-O[1],f=Math.atan2(v,g),h=Math.cos(f)*(a||0),d=Math.sin(f)*(a||0)}for(var T=0;T<o.length;T++){var N=o[T],P=N[0],C=o[T+1],R=T===0&&(c!==0||u!==0),I=(T===o.length-1||C&&(C[0]==="M"||C[0]==="Z"))&&h!==0&&d!==0,j=R?[c,u]:[0,0],G=$t(j,2),H=G[0],Z=G[1],U=I?[h,d]:[0,0],tt=$t(U,2),gt=tt[0],xt=tt[1];switch(P){case"M":r.moveTo(N[1]+H,N[2]+Z);break;case"L":r.lineTo(N[1]+gt,N[2]+xt);break;case"Q":r.quadraticCurveTo(N[1],N[2],N[3]+gt,N[4]+xt);break;case"C":r.bezierCurveTo(N[1],N[2],N[3],N[4],N[5]+gt,N[6]+xt);break;case"A":{var ut=l[T].arcParams,zt=ut.cx,J=ut.cy,W=ut.rx,Q=ut.ry,ht=ut.startAngle,Et=ut.endAngle,Pt=ut.xRotation,Kt=ut.sweepFlag;if(r.ellipse)r.ellipse(zt,J,W,Q,Pt,ht,Et,!!(1-Kt));else{var pe=W>Q?W:Q,pn=W>Q?1:W/Q,Ce=W>Q?Q/W:1;r.translate(zt,J),r.rotate(Pt),r.scale(pn,Ce),r.arc(0,0,pe,ht,Et,!!(1-Kt)),r.scale(1/pn,1/Ce),r.rotate(-Pt),r.translate(-zt,-J)}I&&r.lineTo(N[6]+h,N[7]+d);break}case"Z":r.closePath();break}}}function U5(r,t){var e=t.markerStart,n=t.markerEnd,i=t.markerStartOffset,a=t.markerEndOffset,s=t.points.points,o=s.length,l=s[0][0],c=s[0][1],u=s[o-1][0],h=s[o-1][1],d=0,f=0,g=0,v=0,p=0,y,m;e&&se(e)&&i&&(y=s[1][0]-s[0][0],m=s[1][1]-s[0][1],p=Math.atan2(m,y),d=Math.cos(p)*(i||0),f=Math.sin(p)*(i||0)),n&&se(n)&&a&&(y=s[o-1][0]-s[0][0],m=s[o-1][1]-s[0][1],p=Math.atan2(m,y),g=Math.cos(p)*(a||0),v=Math.sin(p)*(a||0)),r.moveTo(l+(d||g),c+(f||v));for(var x=1;x<o-1;x++){var E=s[x];r.lineTo(E[0],E[1])}r.lineTo(u,h)}function Y5(r,t){var e=t.markerStart,n=t.markerEnd,i=t.markerStartOffset,a=t.markerEndOffset,s=t.points.points,o=s.length,l=s[0][0],c=s[0][1],u=s[o-1][0],h=s[o-1][1],d=0,f=0,g=0,v=0,p=0,y,m;e&&se(e)&&i&&(y=s[1][0]-s[0][0],m=s[1][1]-s[0][1],p=Math.atan2(m,y),d=Math.cos(p)*(i||0),f=Math.sin(p)*(i||0)),n&&se(n)&&a&&(y=s[o-2][0]-s[o-1][0],m=s[o-2][1]-s[o-1][1],p=Math.atan2(m,y),g=Math.cos(p)*(a||0),v=Math.sin(p)*(a||0)),r.moveTo(l+d,c+f);for(var x=1;x<o-1;x++){var E=s[x];r.lineTo(E[0],E[1])}r.lineTo(u+g,h+v)}function H5(r,t){var e=t.x,n=e===void 0?0:e,i=t.y,a=i===void 0?0:i,s=t.radius,o=t.width,l=t.height,c=o,u=l,h=s&&s.some(function(_){return _!==0});if(!h)r.rect(n,a,c,u);else{var d=o>0?1:-1,f=l>0?1:-1,g=d+f===0,v=s.map(function(_){return qe(_,0,Math.min(Math.abs(c)/2,Math.abs(u)/2))}),p=$t(v,4),y=p[0],m=p[1],x=p[2],E=p[3];r.moveTo(d*y+n,a),r.lineTo(c-d*m+n,a),m!==0&&r.arc(c-d*m+n,f*m+a,m,-f*Math.PI/2,d>0?0:Math.PI,g),r.lineTo(c+n,u-f*x+a),x!==0&&r.arc(c-d*x+n,u-f*x+a,x,d>0?0:Math.PI,f>0?Math.PI/2:1.5*Math.PI,g),r.lineTo(d*E+n,u+a),E!==0&&r.arc(d*E+n,u-f*E+a,E,f>0?Math.PI/2:-Math.PI/2,d>0?Math.PI:0,g),r.lineTo(n,f*y+a),y!==0&&r.arc(d*y+n,f*y+a,y,d>0?Math.PI:0,f>0?Math.PI*1.5:Math.PI/2,g)}}var X5=(function(r){function t(){var e;ot(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=Yt(this,t,[].concat(i)),e.name="canvas-path-generator",e}return Ht(t,r),lt(t,[{key:"init",value:function(){var n,i=(n={},_t(_t(_t(_t(_t(_t(_t(_t(_t(_t(n,nt.CIRCLE,G5),nt.ELLIPSE,$5),nt.RECT,H5),nt.LINE,W5),nt.POLYLINE,Y5),nt.POLYGON,U5),nt.PATH,V5),nt.TEXT,void 0),nt.GROUP,void 0),nt.IMAGE,void 0),_t(_t(_t(n,nt.HTML,void 0),nt.MESH,void 0),nt.FRAGMENT,void 0));this.context.pathGeneratorFactory=i}},{key:"destroy",value:function(){delete this.context.pathGeneratorFactory}}])})(pa);/*!
 * @antv/g-plugin-canvas-picker
 * @description A G plugin for picking in canvas
 * @version 2.1.27
 * @date 7/30/2025, 1:37:32 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var K5=te(),Z5=te(),J5=te(),Q5=ve(),cN=(function(){function r(){var t=this;ot(this,r),this.isHit=function(e,n,i,a){var s=t.context.pointInPathPickerFactory[e.nodeName];if(s){var o=hi(Q5,i),l=zn(Z5,Fn(J5,n[0],n[1],0),o);if(s(e,new Tn(l[0],l[1]),a,t.isPointInPath,t.context,t.runtime))return!0}return!1},this.isPointInPath=function(e,n){var i=t.runtime.offscreenCanvasCreator.getOrCreateContext(t.context.config.offscreenCanvas),a=t.context.pathGeneratorFactory[e.nodeName];return a&&(i.beginPath(),a(i,e.parsedStyle),i.closePath()),i.isPointInPath(n.x,n.y)}}return lt(r,[{key:"apply",value:function(e,n){var i,a=this,s=e.renderingService,o=e.renderingContext;this.context=e,this.runtime=n;var l=(i=o.root)===null||i===void 0?void 0:i.ownerDocument;s.hooks.pick.tapPromise(r.tag,(function(){var c=fa(bn().mark(function u(h){return bn().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",a.pick(l,h));case 1:case"end":return d.stop()}},u)}));return function(u){return c.apply(this,arguments)}})()),s.hooks.pickSync.tap(r.tag,function(c){return a.pick(l,c)})}},{key:"pick",value:function(e,n){var i=n.topmost,a=n.position,s=a.x,o=a.y,l=Fn(K5,s,o,0),c=e.elementsFromBBox(l[0],l[1],l[0],l[1]),u=[],h=La(c),d;try{for(h.s();!(d=h.n()).done;){var f=d.value,g=f.getWorldTransform(),v=this.isHit(f,l,g,!1);if(v){var p=uA(f);if(p){var y=p.parsedStyle.clipPath,m=this.isHit(y,l,y.getWorldTransform(),!0);if(m){if(i)return n.picked=[f],n;u.push(f)}}else{if(i)return n.picked=[f],n;u.push(f)}}}}catch(x){h.e(x)}finally{h.f()}return n.picked=u,n}}])})();cN.tag="CanvasPicker";function t4(r,t,e){var n=r.parsedStyle,i=n.cx,a=i===void 0?0:i,s=n.cy,o=s===void 0?0:s,l=n.r,c=n.fill,u=n.stroke,h=n.lineWidth,d=h===void 0?1:h,f=n.increasedLineWidthForHitTesting,g=f===void 0?0:f,v=n.pointerEvents,p=v===void 0?"auto":v,y=(d+g)/2,m=Di(a,o,t.x,t.y),x=ns(p,c,u),E=$t(x,2),_=E[0],M=E[1];return _&&M||e?m<=l+y:_?m<=l:M?m>=l-y&&m<=l+y:!1}function fc(r,t,e,n){return r/(e*e)+t/(n*n)}function e4(r,t,e){var n=r.parsedStyle,i=n.cx,a=i===void 0?0:i,s=n.cy,o=s===void 0?0:s,l=n.rx,c=n.ry,u=n.fill,h=n.stroke,d=n.lineWidth,f=d===void 0?1:d,g=n.increasedLineWidthForHitTesting,v=g===void 0?0:g,p=n.pointerEvents,y=p===void 0?"auto":p,m=t.x,x=t.y,E=ns(y,u,h),_=$t(E,2),M=_[0],O=_[1],T=(f+v)/2,N=(m-a)*(m-a),P=(x-o)*(x-o);return M&&O||e?fc(N,P,l+T,c+T)<=1:M?fc(N,P,l,c)<=1:O?fc(N,P,l-T,c-T)>=1&&fc(N,P,l+T,c+T)<=1:!1}function za(r,t,e,n,i,a){return i>=r&&i<=r+e&&a>=t&&a<=t+n}function n4(r,t,e,n,i,a,s){var o=i/2;return za(r-o,t-o,e,i,a,s)||za(r+e-o,t-o,i,n,a,s)||za(r+o,t+n-o,e,i,a,s)||za(r-o,t+o,i,n,a,s)}function gc(r,t,e,n,i,a,s,o){var l=(Math.atan2(o-t,s-r)+Math.PI*2)%(Math.PI*2),c={x:r+e*Math.cos(l),y:t+e*Math.sin(l)};return Di(c.x,c.y,s,o)<=a/2}function ra(r,t,e,n,i,a,s){var o=Math.min(r,e),l=Math.max(r,e),c=Math.min(t,n),u=Math.max(t,n),h=i/2;return a>=o-h&&a<=l+h&&s>=c-h&&s<=u+h?GL(r,t,e,n,a,s)<=i/2:!1}function uN(r,t,e,n,i){var a=r.length;if(a<2)return!1;for(var s=0;s<a-1;s++){var o=r[s][0],l=r[s][1],c=r[s+1][0],u=r[s+1][1];if(ra(o,l,c,u,t,e,n))return!0}if(i){var h=r[0],d=r[a-1];if(ra(h[0],h[1],d[0],d[1],t,e,n))return!0}return!1}var r4=1e-6;function jd(r){return Math.abs(r)<r4?0:r<0?-1:1}function i4(r,t,e){return(e[0]-r[0])*(t[1]-r[1])===(t[0]-r[0])*(e[1]-r[1])&&Math.min(r[0],t[0])<=e[0]&&e[0]<=Math.max(r[0],t[0])&&Math.min(r[1],t[1])<=e[1]&&e[1]<=Math.max(r[1],t[1])}function hN(r,t,e){var n=!1,i=r.length;if(i<=2)return!1;for(var a=0;a<i;a++){var s=r[a],o=r[(a+1)%i];if(i4(s,o,[t,e]))return!0;jd(s[1]-e)>0!=jd(o[1]-e)>0&&jd(t-(e-s[1])*(s[0]-o[0])/(s[1]-o[1])-s[0])<0&&(n=!n)}return n}function Qx(r,t,e){for(var n=!1,i=0;i<r.length;i++){var a=r[i];if(n=hN(a,t,e),n)break}return n}function a4(r,t,e){var n=r.parsedStyle,i=n.x1,a=n.y1,s=n.x2,o=n.y2,l=n.lineWidth,c=l===void 0?1:l,u=n.increasedLineWidthForHitTesting,h=u===void 0?0:u,d=n.pointerEvents,f=d===void 0?"auto":d,g=n.fill,v=n.stroke,p=ns(f,g,v),y=$t(p,2),m=y[1];return!m&&!e||!c?!1:ra(i,a,s,o,c+h,t.x,t.y)}function s4(r,t,e,n,i){for(var a=!1,s=t/2,o=0;o<r.length;o++){var l=r[o],c=l.currentPoint,u=l.params,h=l.prePoint,d=l.box;if(!(d&&!za(d.x-s,d.y-s,d.width+t,d.height+t,e,n)))switch(l.command){case"L":case"Z":if(a=ra(h[0],h[1],c[0],c[1],t,e,n),a)return!0;break;case"Q":var f=XL(h[0],h[1],u[1],u[2],u[3],u[4],e,n);if(a=f<=t/2,a)return!0;break;case"C":var g=Jb(h[0],h[1],u[1],u[2],u[3],u[4],u[5],u[6],e,n,i);if(a=g<=t/2,a)return!0;break;case"A":l.cubicParams||(l.cubicParams=d1(h[0],h[1],u[1],u[2],u[3],u[4],u[5],u[6],u[7],void 0));for(var v=l.cubicParams,p=h,y=0;y<v.length;y+=6){var m=Jb(p[0],p[1],v[y],v[y+1],v[y+2],v[y+3],v[y+4],v[y+5],e,n,i);if(p=[v[y+4],v[y+5]],a=m<=t/2,a)return!0}break}}return a}function o4(r,t,e,n,i,a){var s=r.parsedStyle,o=s.lineWidth,l=o===void 0?1:o,c=s.increasedLineWidthForHitTesting,u=c===void 0?0:c,h=s.stroke,d=s.fill,f=s.d,g=s.pointerEvents,v=g===void 0?"auto":g,p=f.segments,y=f.hasArc,m=f.polylines,x=f.polygons,E=ns(v,(x==null?void 0:x.length)&&d,h),_=$t(E,2),M=_[0],O=_[1],T=ym(r),N=!1;return M||e?(y?N=n(r,t):N=Qx(x,t.x,t.y)||Qx(m,t.x,t.y),N):((O||e)&&(N=s4(p,l+u,t.x,t.y,T)),N)}function l4(r,t,e){var n=r.parsedStyle,i=n.stroke,a=n.fill,s=n.lineWidth,o=s===void 0?1:s,l=n.increasedLineWidthForHitTesting,c=l===void 0?0:l,u=n.points,h=n.pointerEvents,d=h===void 0?"auto":h,f=ns(d,a,i),g=$t(f,2),v=g[0],p=g[1],y=!1;return(p||e)&&(y=uN(u.points,o+c,t.x,t.y,!0)),!y&&(v||e)&&(y=hN(u.points,t.x,t.y)),y}function c4(r,t,e){var n=r.parsedStyle,i=n.lineWidth,a=i===void 0?1:i,s=n.increasedLineWidthForHitTesting,o=s===void 0?0:s,l=n.points,c=n.pointerEvents,u=c===void 0?"auto":c,h=n.fill,d=n.stroke,f=ns(u,h,d),g=$t(f,2),v=g[1];return!v&&!e||!a?!1:uN(l.points,a+o,t.x,t.y,!1)}function u4(r,t,e,n,i){var a=r.parsedStyle,s=a.radius,o=a.fill,l=a.stroke,c=a.lineWidth,u=c===void 0?1:c,h=a.increasedLineWidthForHitTesting,d=h===void 0?0:h,f=a.x,g=f===void 0?0:f,v=a.y,p=v===void 0?0:v,y=a.width,m=a.height,x=a.pointerEvents,E=x===void 0?"auto":x,_=ns(E,o,l),M=$t(_,2),O=M[0],T=M[1],N=s&&s.some(function(I){return I!==0}),P=u+d;if(N){var R=!1;return(T||e)&&(R=h4(g,p,y,m,s.map(function(I){return qe(I,0,Math.min(Math.abs(y)/2,Math.abs(m)/2))}),P,t.x,t.y)),!R&&(O||e)&&(R=n(r,t)),R}else{var C=P/2;if(O&&T||e)return za(g-C,p-C,y+C,m+C,t.x,t.y);if(O)return za(g,p,y,m,t.x,t.y);if(T)return n4(g,p,y,m,P,t.x,t.y)}return!1}function h4(r,t,e,n,i,a,s,o){var l=$t(i,4),c=l[0],u=l[1],h=l[2],d=l[3];return ra(r+c,t,r+e-u,t,a,s,o)||ra(r+e,t+u,r+e,t+n-h,a,s,o)||ra(r+e-h,t+n,r+d,t+n,a,s,o)||ra(r,t+n-d,r,t+c,a,s,o)||gc(r+e-u,t+u,u,1.5*Math.PI,2*Math.PI,a,s,o)||gc(r+e-h,t+n-h,h,0,.5*Math.PI,a,s,o)||gc(r+d,t+n-d,d,.5*Math.PI,Math.PI,a,s,o)||gc(r+c,t+c,c,Math.PI,1.5*Math.PI,a,s,o)}function d4(r,t,e,n,i,a){var s=r.parsedStyle,o=s.pointerEvents,l=o===void 0?"auto":o,c=s.x,u=c===void 0?0:c,h=s.y,d=h===void 0?0:h,f=s.width,g=s.height;if(l==="non-transparent-pixel"){var v=i.config.offscreenCanvas,p=a.offscreenCanvasCreator.getOrCreateCanvas(v),y=a.offscreenCanvasCreator.getOrCreateContext(v,{willReadFrequently:!0});p.width=f,p.height=g,i.defaultStyleRendererFactory[nt.IMAGE].render(y,Vt(Vt({},r.parsedStyle),{},{x:0,y:0}),r,void 0,void 0,void 0);var m=y.getImageData(t.x-u,t.y-d,1,1).data;return m.every(function(x){return x!==0})}return!0}function f4(r,t,e,n){var i=r.getGeometryBounds();return t.x>=i.min[0]&&t.y>=i.min[1]&&t.x<=i.max[0]&&t.y<=i.max[1]}var g4=(function(r){function t(){var e;ot(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=Yt(this,t,[].concat(i)),e.name="canvas-picker",e}return Ht(t,r),lt(t,[{key:"init",value:function(){var n,i=(n={},_t(_t(_t(_t(_t(_t(_t(_t(_t(_t(n,nt.CIRCLE,t4),nt.ELLIPSE,e4),nt.RECT,u4),nt.LINE,a4),nt.POLYLINE,c4),nt.POLYGON,l4),nt.PATH,o4),nt.TEXT,f4),nt.GROUP,null),nt.IMAGE,d4),_t(_t(n,nt.HTML,null),nt.MESH,null));this.context.pointInPathPickerFactory=i,this.addRenderingPlugin(new cN)}},{key:"destroy",value:function(){delete this.context.pointInPathPickerFactory,this.removeAllRenderingPlugins()}}])})(pa);function oi(r,t){if(!{}.hasOwnProperty.call(r,t))throw new TypeError("attempted to use private field on non-instance");return r}var v4=0;function p4(r){return"__private_"+v4+++"_"+r}/*!
 * @antv/g-plugin-image-loader
 * @description A G plugin for loading image
 * @version 2.1.26
 * @date 7/30/2025, 1:35:52 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var y4=(function(){function r(){ot(this,r),this.cacheStore=new Map}return lt(r,[{key:"onRefAdded",value:function(e){}},{key:"has",value:function(e){return this.cacheStore.has(e)}},{key:"put",value:function(e,n,i){return this.cacheStore.has(e)?!1:(this.cacheStore.set(e,{value:n,counter:new Set([i.entity])}),this.onRefAdded(i),!0)}},{key:"get",value:function(e,n){var i=this.cacheStore.get(e);return i?(i.counter.has(n.entity)||(i.counter.add(n.entity),this.onRefAdded(n)),i.value):null}},{key:"update",value:function(e,n,i){var a=this.cacheStore.get(e);return a?(a.value=Vt(Vt({},a.value),n),a.counter.has(i.entity)||(a.counter.add(i.entity),this.onRefAdded(i)),!0):!1}},{key:"release",value:function(e,n){var i=this.cacheStore.get(e);return i?(i.counter.delete(n.entity),i.counter.size<=0&&this.cacheStore.delete(e),!0):!1}},{key:"releaseRef",value:function(e){var n=this;Array.from(this.cacheStore.keys()).forEach(function(i){n.release(i,e)})}},{key:"getSize",value:function(){return this.cacheStore.size}},{key:"clear",value:function(){this.cacheStore.clear()}}])})(),qd=[],Gd=[],Am=(function(){function r(){ot(this,r)}return lt(r,null,[{key:"stop",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:r.api;r.rafId&&(e.cancelAnimationFrame(r.rafId),r.rafId=null)}},{key:"executeTask",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:r.api;qd.length<=0&&Gd.length<=0||(Gd.forEach(function(n){return n()}),Gd=qd.splice(0,r.TASK_NUM_PER_FRAME),r.rafId=e.requestAnimationFrame(function(){r.executeTask(e)}))}},{key:"sliceImage",value:function(e,n,i,a){for(var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:r.api,l=e.naturalWidth||e.width,c=e.naturalHeight||e.height,u=n-s,h=i-s,d=Math.ceil(l/u),f=Math.ceil(c/h),g={tileSize:[n,i],gridSize:[f,d],tiles:Array(f).fill(null).map(function(){return Array(d).fill(null)})},v=function(m){for(var x=function(M){qd.push(function(){var O=M*u,T=m*h,N=[Math.min(n,l-O),Math.min(i,c-T)],P=N[0],C=N[1],R=o.createCanvas();R.width=n,R.height=i;var I=R.getContext("2d");I.drawImage(e,O,T,P,C,0,0,P,C),g.tiles[m][M]={x:O,y:T,tileX:M,tileY:m,data:R},a()})},E=0;E<d;E++)x(E)},p=0;p<f;p++)v(p);return r.stop(),r.executeTask(),g}}])})();Am.TASK_NUM_PER_FRAME=10;var dr=new y4;dr.onRefAdded=function(t){var e=this;t.addEventListener(Jt.DESTROY,function(){e.releaseRef(t)},{once:!0})};var F1=(function(){function r(t,e){ot(this,r),this.gradientCache={},this.patternCache={},this.context=t,this.runtime=e}return lt(r,[{key:"getImageSync",value:function(e,n,i){var a=ae(e)?e:e.src;if(dr.has(a)){var s=dr.get(a,n);if(s.img.complete)return i==null||i(s),s}return this.getOrCreateImage(e,n).then(function(o){i==null||i(o)}).catch(function(o){console.error(o)}),null}},{key:"getOrCreateImage",value:function(e,n){var i=this,a=ae(e)?e:e.src;if(!ae(e)&&!dr.has(a)){var s={img:e,size:[e.naturalWidth||e.width,e.naturalHeight||e.height],tileSize:vc(e)};dr.put(a,s,n)}if(dr.has(a)){var o=dr.get(a,n);return o.img.complete?Promise.resolve(o):new Promise(function(l,c){o.img.addEventListener("load",function(){o.size=[o.img.naturalWidth||o.img.width,o.img.naturalHeight||o.img.height],o.tileSize=vc(o.img),l(o)}),o.img.addEventListener("error",function(u){c(u)})})}return new Promise(function(l,c){var u=i.context.config.createImage();if(u){var h={img:u,size:[0,0],tileSize:vc(u)};dr.put(a,h,n),u.onload=function(){h.size=[u.naturalWidth||u.width,u.naturalHeight||u.height],h.tileSize=vc(h.img),l(h)},u.onerror=function(d){c(d)},u.crossOrigin="Anonymous",u.src=a}})}},{key:"createDownSampledImage",value:(function(){var t=fa(bn().mark(function n(i,a){var s,o,l,c,u,h,d,f,g,v,p,y,m,x;return bn().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=1,this.getOrCreateImage(i,a);case 1:if(s=E.sent,!(typeof s.downSamplingRate<"u")){E.next=2;break}return E.abrupt("return",s);case 2:if(o=this.context.config.enableLargeImageOptimization,l=typeof o=="boolean"?{}:o,c=l.maxDownSampledImageSize,u=c===void 0?2048:c,h=l.downSamplingRateThreshold,d=h===void 0?.5:h,f=this.runtime.globalThis.createImageBitmap,g=$t(s.size,2),v=g[0],p=g[1],y=s.img,m=Math.min((u+u)/(v+p),Math.max(.01,Math.min(d,.5))),x=Vt(Vt({},s),{},{downSamplingRate:m}),dr.update(s.img.src,x,a),!f){E.next=7;break}return E.prev=3,E.next=4,f(s.img,{resizeWidth:v*m,resizeHeight:p*m});case 4:y=E.sent,E.next=6;break;case 5:E.prev=5,E.catch(3),m=1;case 6:E.next=8;break;case 7:m=1;case 8:return x=Vt(Vt({},this.getImageSync(i,a)),{},{downSampled:y,downSamplingRate:m}),dr.update(s.img.src,x,a),E.abrupt("return",x);case 9:case"end":return E.stop()}},n,this,[[3,5]])}));function e(n,i){return t.apply(this,arguments)}return e})()},{key:"createImageTiles",value:(function(){var t=fa(bn().mark(function n(i,a,s,o){var l,c,u,h,d;return bn().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=1,this.getOrCreateImage(i,o);case 1:return l=f.sent,c=o.ownerDocument.defaultView,u=c.requestAnimationFrame,h=c.cancelAnimationFrame,Am.api={requestAnimationFrame:u,cancelAnimationFrame:h,createCanvas:function(){return w1.createCanvas()}},d=Vt(Vt({},l),Am.sliceImage(l.img,l.tileSize[0],l.tileSize[0],s)),dr.update(l.img.src,d,o),f.abrupt("return",d);case 2:case"end":return f.stop()}},n,this)}));function e(n,i,a,s){return t.apply(this,arguments)}return e})()},{key:"releaseImage",value:function(e,n){dr.release(ae(e)?e:e.src,n)}},{key:"releaseImageRef",value:function(e){dr.releaseRef(e)}},{key:"getOrCreatePatternSync",value:function(e,n,i,a,s,o,l){var c=this.generatePatternKey(n);if(c&&this.patternCache[c])return this.patternCache[c];var u=n.image,h=n.repetition,d=n.transform,f,g=!1;if(ae(u)){var v=this.getImageSync(u,e,l);f=v==null?void 0:v.img}else a?(f=a,g=!0):f=u;var p=f&&i.createPattern(f,h);if(p){var y;d?y=vA(sA(d),new Se({})):y=ha(ve()),g&&oO(y,y,[1/s,1/s,1]),p.setTransform({a:y[0],b:y[1],c:y[4],d:y[5],e:y[12]+o[0],f:y[13]+o[1]})}return c&&p&&(this.patternCache[c]=p),p}},{key:"getOrCreateGradient",value:function(e,n){var i=this.generateGradientKey(e),a=e.type,s=e.steps,o=e.min,l=e.width,c=e.height,u=e.angle,h=e.cx,d=e.cy,f=e.size;if(this.gradientCache[i])return this.gradientCache[i];var g=null;if(a===ta.LinearGradient){var v=XI(o,l,c,u),p=v.x1,y=v.y1,m=v.x2,x=v.y2;g=n.createLinearGradient(p,y,m,x)}else if(a===ta.RadialGradient){var E=KI(o,l,c,h,d,f),_=E.x,M=E.y,O=E.r;g=n.createRadialGradient(_,M,0,_,M,O)}return g&&(s.forEach(function(T){var N=T.offset,P=T.color;if(N.unit===bt.kPercentage){var C;(C=g)===null||C===void 0||C.addColorStop(N.value/100,P.toString())}}),this.gradientCache[i]=g),this.gradientCache[i]}},{key:"generateGradientKey",value:function(e){var n=e.type,i=e.min,a=e.width,s=e.height,o=e.steps,l=e.angle,c=e.cx,u=e.cy,h=e.size;return"gradient-".concat(n,"-").concat((l==null?void 0:l.toString())||0,"-").concat((c==null?void 0:c.toString())||0,"-").concat((u==null?void 0:u.toString())||0,"-").concat((h==null?void 0:h.toString())||0,"-").concat(i[0],"-").concat(i[1],"-").concat(a,"-").concat(s,"-").concat(o.map(function(d){var f=d.offset,g=d.color;return"".concat(f).concat(g)}).join("-"))}},{key:"generatePatternKey",value:function(e){var n=e.image,i=e.repetition;if(ae(n))return"pattern-".concat(n,"-").concat(i);if(n.nodeName==="rect")return"pattern-".concat(n.entity,"-").concat(i)}}])})();F1.isSupportTile=!!w1.createCanvas();function vc(r){if(!r.complete)return[0,0];var t=r.naturalWidth||r.width,e=r.naturalHeight||r.height,n=256;return[256,512].forEach(function(i){var a=Math.ceil(e/i),s=Math.ceil(t/i);a*s<1e3&&(n=i)}),[n,n]}var dN=(function(){function r(){ot(this,r)}return lt(r,[{key:"apply",value:function(e){var n=e.renderingService,i=e.renderingContext,a=e.imagePool,s=i.root.ownerDocument.defaultView,o=function(h,d,f){var g=h.parsedStyle,v=g.width,p=g.height;v&&!p?h.setAttribute("height",f/d*v):!v&&p&&h.setAttribute("width",d/f*p)},l=function(h){var d=h.target,f=d.nodeName,g=d.attributes;if(f===nt.IMAGE){var v=g.src,p=g.keepAspectRatio;a.getImageSync(v,d,function(y){var m=y.img,x=m.width,E=m.height;p&&o(d,x,E),d.renderable.dirty=!0,n.dirtify()})}},c=function(h){var d=h.target,f=h.attrName,g=h.prevValue,v=h.newValue;d.nodeName!==nt.IMAGE||f!=="src"||(g!==v&&a.releaseImage(g,d),ae(v)&&a.getOrCreateImage(v,d).then(function(p){var y=p.img,m=y.width,x=y.height;d.attributes.keepAspectRatio&&o(d,m,x),d.renderable.dirty=!0,n.dirtify()}).catch(function(){}))};n.hooks.init.tap(r.tag,function(){s.addEventListener(Jt.MOUNTED,l),s.addEventListener(Jt.ATTR_MODIFIED,c)}),n.hooks.destroy.tap(r.tag,function(){s.removeEventListener(Jt.MOUNTED,l),s.removeEventListener(Jt.ATTR_MODIFIED,c)})}}])})();dN.tag="LoadImage";var m4=(function(r){function t(){var e;ot(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=Yt(this,t,[].concat(i)),e.name="image-loader",e}return Ht(t,r),lt(t,[{key:"init",value:function(n){this.context.imagePool=new F1(this.context,n),this.addRenderingPlugin(new dN)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])})(pa);/*!
 * @antv/g-plugin-canvas-renderer
 * @description A G plugin of renderer implementation with Canvas2D API
 * @version 2.3.3
 * @date 7/30/2025, 1:36:40 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var He=p4("renderState"),fN=(function(){function r(t){ot(this,r),this.removedRBushNodeAABBs=[],this.renderQueue=[],Object.defineProperty(this,He,{writable:!0,value:{restoreStack:[],prevObject:null,currentContext:new Map}}),this.clearFullScreenLastFrame=!1,this.clearFullScreen=!1,this.vpMatrix=ve(),this.dprMatrix=ve(),this.tmpMat4=ve(),this.vec3a=te(),this.vec3b=te(),this.vec3c=te(),this.vec3d=te(),this.canvasRendererPluginOptions=t}return lt(r,[{key:"apply",value:function(e,n){var i=this;this.context=e;var a=this.context,s=a.config,o=a.camera,l=a.renderingService,c=a.renderingContext,u=a.rBushRoot,h=a.pathGeneratorFactory,d=s.renderer.getConfig().enableRenderingOptimization;s.renderer.getConfig().enableDirtyCheck=!1,s.renderer.getConfig().enableDirtyRectangleRendering=!1,this.rBush=u,this.pathGeneratorFactory=h;var f=e.contextService,g=c.root.ownerDocument.defaultView,v=function(E){var _=E.target,M=_.rBushNode;M!=null&&M.aabb&&i.removedRBushNodeAABBs.push(M.aabb)},p=function(E){var _=E.target,M=_.rBushNode;M.aabb&&i.removedRBushNodeAABBs.push(M.aabb)};l.hooks.init.tap(r.tag,function(){g.addEventListener(Jt.UNMOUNTED,v),g.addEventListener(Jt.CULLED,p);var x=f.getDPR(),E=s.width,_=s.height,M=f.getContext();i.clearRect(M,0,0,E*x,_*x,s.background)}),l.hooks.destroy.tap(r.tag,function(){g.removeEventListener(Jt.UNMOUNTED,v),g.removeEventListener(Jt.CULLED,p),i.renderQueue=[],i.removedRBushNodeAABBs=[],oi(i,He)[He]={restoreStack:[],prevObject:null,currentContext:null}});var y=function(){var E,_=f.getContext(),M=f.getDPR(),O=s.width,T=s.height,N=i.canvasRendererPluginOptions,P=N.dirtyObjectNumThreshold,C=N.dirtyObjectRatioThreshold,R=l.getStats(),I=R.total,j=R.rendered,G=j/I;i.clearFullScreen=i.clearFullScreenLastFrame||!((E=g.context.renderingPlugins[1])!==null&&E!==void 0&&E.isFirstTimeRenderingFinished)||l.disableDirtyRectangleRendering()||j>P&&G>C,_&&(typeof _.resetTransform=="function"?_.resetTransform():_.setTransform(1,0,0,1,0,0),i.clearFullScreen&&i.clearRect(_,0,0,O*M,T*M,s.background))},m=function(E,_){for(var M=[E];M.length>0;){var O,T=M.pop();T.isVisible()&&!T.isCulled()&&(d?i.renderDisplayObjectOptimized(T,_,i.context,oi(i,He)[He],n):i.renderDisplayObject(T,_,i.context,oi(i,He)[He],n));for(var N=((O=T.sortable)===null||O===void 0||(O=O.sorted)===null||O===void 0?void 0:O.length)>0?T.sortable.sorted:T.childNodes,P=N.length-1;P>=0;P--)M.push(N[P])}};l.hooks.endFrame.tap(r.tag,function(){if(y(),c.root.childNodes.length===0){i.clearFullScreenLastFrame=!0;return}d=s.renderer.getConfig().enableRenderingOptimization,oi(i,He)[He]={restoreStack:[],prevObject:null,currentContext:oi(i,He)[He].currentContext},oi(i,He)[He].currentContext.clear(),i.clearFullScreenLastFrame=!1;var x=f.getContext(),E=f.getDPR();if(Ra(i.dprMatrix,[E,E,1]),Bn(i.vpMatrix,i.dprMatrix,o.getOrthoMatrix()),i.clearFullScreen)d?(x.save(),m(c.root,x),x.restore()):m(c.root,x),i.removedRBushNodeAABBs=[];else{var _=i.safeMergeAABB.apply(i,[i.mergeDirtyAABBs(i.renderQueue)].concat(ne(i.removedRBushNodeAABBs.map(function(Q){var ht=Q.minX,Et=Q.minY,Pt=Q.maxX,Kt=Q.maxY,pe=new be;return pe.setMinMax([ht,Et,0],[Pt,Kt,0]),pe}))));if(i.removedRBushNodeAABBs=[],be.isEmpty(_)){i.renderQueue=[];return}var M=i.convertAABB2Rect(_),O=M.x,T=M.y,N=M.width,P=M.height,C=zn(i.vec3a,[O,T,0],i.vpMatrix),R=zn(i.vec3b,[O+N,T,0],i.vpMatrix),I=zn(i.vec3c,[O,T+P,0],i.vpMatrix),j=zn(i.vec3d,[O+N,T+P,0],i.vpMatrix),G=Math.min(C[0],R[0],j[0],I[0]),H=Math.min(C[1],R[1],j[1],I[1]),Z=Math.max(C[0],R[0],j[0],I[0]),U=Math.max(C[1],R[1],j[1],I[1]),tt=Math.floor(G),gt=Math.floor(H),xt=Math.ceil(Z-G),ut=Math.ceil(U-H);x.save(),i.clearRect(x,tt,gt,xt,ut,s.background),x.beginPath(),x.rect(tt,gt,xt,ut),x.clip(),x.setTransform(i.vpMatrix[0],i.vpMatrix[1],i.vpMatrix[4],i.vpMatrix[5],i.vpMatrix[12],i.vpMatrix[13]);var zt=s.renderer.getConfig(),J=zt.enableDirtyRectangleRenderingDebug;J&&g.dispatchEvent(new rn(gr.DIRTY_RECTANGLE,{dirtyRect:{x:tt,y:gt,width:xt,height:ut}}));var W=i.searchDirtyObjects(_);W.sort(function(Q,ht){return Q.sortable.renderOrder-ht.sortable.renderOrder}).forEach(function(Q){Q&&Q.isVisible()&&!Q.isCulled()&&i.renderDisplayObject(Q,x,i.context,oi(i,He)[He],n)}),x.restore(),i.renderQueue.forEach(function(Q){i.saveDirtyAABB(Q)}),i.renderQueue=[]}oi(i,He)[He].restoreStack.forEach(function(){x.restore()}),oi(i,He)[He].restoreStack=[]}),l.hooks.render.tap(r.tag,function(x){i.clearFullScreen||i.renderQueue.push(x)})}},{key:"clearRect",value:function(e,n,i,a,s,o){e.clearRect(n,i,a,s),o&&(e.fillStyle=o,e.fillRect(n,i,a,s))}},{key:"renderDisplayObjectOptimized",value:function(e,n,i,a,s){var o=e.nodeName,l=!1,c=!1,u=this.context.styleRendererFactory[o],h=this.pathGeneratorFactory[o],d=e.parsedStyle.clipPath;if(d){l=!a.prevObject||!Qy(d.getWorldTransform(),a.prevObject.getWorldTransform()),l&&(this.applyWorldTransform(n,d),a.prevObject=null);var f=this.pathGeneratorFactory[d.nodeName];f&&(n.save(),c=!0,n.beginPath(),f(n,d.parsedStyle),n.closePath(),n.clip())}if(u){l=!a.prevObject||!Qy(e.getWorldTransform(),a.prevObject.getWorldTransform()),l&&this.applyWorldTransform(n,e);var g=!a.prevObject;if(!g){var v=a.prevObject.nodeName;o===nt.TEXT?g=v!==nt.TEXT:o===nt.IMAGE?g=v!==nt.IMAGE:g=v===nt.TEXT||v===nt.IMAGE}u.applyStyleToContext(n,e,g,a),a.prevObject=e}h&&(n.beginPath(),h(n,e.parsedStyle),o!==nt.LINE&&o!==nt.PATH&&o!==nt.POLYLINE&&n.closePath()),u&&u.drawToContext(n,e,oi(this,He)[He],this,s),c&&n.restore(),e.dirty(!1)}},{key:"renderDisplayObject",value:function(e,n,i,a,s){var o=e.nodeName,l=a.restoreStack[a.restoreStack.length-1];l&&!(e.compareDocumentPosition(l)&De.DOCUMENT_POSITION_CONTAINS)&&(n.restore(),a.restoreStack.pop());var c=this.context.styleRendererFactory[o],u=this.pathGeneratorFactory[o],h=e.parsedStyle.clipPath;if(h){this.applyWorldTransform(n,h);var d=this.pathGeneratorFactory[h.nodeName];d&&(n.save(),a.restoreStack.push(e),n.beginPath(),d(n,h.parsedStyle),n.closePath(),n.clip())}c&&(this.applyWorldTransform(n,e),n.save(),this.applyAttributesToContext(n,e)),u&&(n.beginPath(),u(n,e.parsedStyle),o!==nt.LINE&&o!==nt.PATH&&o!==nt.POLYLINE&&n.closePath()),c&&(c.render(n,e.parsedStyle,e,i,this,s),n.restore()),e.dirty(!1)}},{key:"applyAttributesToContext",value:function(e,n){var i=n.parsedStyle,a=i.stroke,s=i.fill,o=i.opacity,l=i.lineDash,c=i.lineDashOffset;l&&e.setLineDash(l),Rt(c)||(e.lineDashOffset=c),Rt(o)||(e.globalAlpha*=o),!Rt(a)&&!Array.isArray(a)&&!a.isNone&&(e.strokeStyle=n.attributes.stroke),!Rt(s)&&!Array.isArray(s)&&!s.isNone&&(e.fillStyle=n.attributes.fill)}},{key:"convertAABB2Rect",value:function(e){var n=e.getMin(),i=e.getMax(),a=Math.floor(n[0]),s=Math.floor(n[1]),o=Math.ceil(i[0]),l=Math.ceil(i[1]),c=o-a,u=l-s;return{x:a,y:s,width:c,height:u}}},{key:"mergeDirtyAABBs",value:function(e){var n=new be;return e.forEach(function(i){var a=i.getRenderBounds();n.add(a);var s=i.renderable.dirtyRenderBounds;s&&n.add(s)}),n}},{key:"searchDirtyObjects",value:function(e){var n=e.getMin(),i=$t(n,2),a=i[0],s=i[1],o=e.getMax(),l=$t(o,2),c=l[0],u=l[1],h=this.rBush.search({minX:a,minY:s,maxX:c,maxY:u});return h.map(function(d){var f=d.displayObject;return f})}},{key:"saveDirtyAABB",value:function(e){var n=e.renderable;n.dirtyRenderBounds||(n.dirtyRenderBounds=new be);var i=e.getRenderBounds();i&&n.dirtyRenderBounds.update(i.center,i.halfExtents)}},{key:"applyWorldTransform",value:function(e,n,i){i?(Bs(this.tmpMat4,n.getLocalTransform()),Bn(this.tmpMat4,i,this.tmpMat4),Bn(this.tmpMat4,this.vpMatrix,this.tmpMat4)):(Bs(this.tmpMat4,n.getWorldTransform()),Bn(this.tmpMat4,this.vpMatrix,this.tmpMat4)),e.setTransform(this.tmpMat4[0],this.tmpMat4[1],this.tmpMat4[4],this.tmpMat4[5],this.tmpMat4[12],this.tmpMat4[13])}},{key:"safeMergeAABB",value:function(){for(var e=new be,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return i.forEach(function(s){e.add(s)}),e}}])})();fN.tag="CanvasRenderer";function gu(r,t,e,n,i,a,s){var o,l;if(r.image.nodeName==="rect"){var c=r.image.parsedStyle,u=c.width,h=c.height;l=n.contextService.getDPR();var d=n.config.offscreenCanvas;o=a.offscreenCanvasCreator.getOrCreateCanvas(d),o.width=u*l,o.height=h*l;var f=a.offscreenCanvasCreator.getOrCreateContext(d),g={restoreStack:[],prevObject:null,currentContext:new Map};r.image.forEach(function(p){i.renderDisplayObject(p,f,n,g,a)}),g.restoreStack.forEach(function(){f.restore()})}var v=s.getOrCreatePatternSync(t,r,e,o,l,t.getGeometryBounds().min,function(){t.dirty(),n.renderingService.dirtify()});return v}function vu(r,t,e,n){var i;if(r.type===ta.LinearGradient||r.type===ta.RadialGradient){var a=t.getGeometryBounds(),s=a&&a.halfExtents[0]*2||1,o=a&&a.halfExtents[1]*2||1,l=a&&a.min||[0,0];i=n.getOrCreateGradient(Vt(Vt({type:r.type},r.value),{},{min:l,width:s,height:o}),e)}return i}var pc=["shadowBlur","shadowOffsetX","shadowOffsetY"],tw=["lineCap","lineJoin","miterLimit"],en={globalAlpha:1,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"#000",filter:"none",globalCompositeOperation:"source-over",strokeStyle:"#000",strokeOpacity:1,lineWidth:1,lineDash:[],lineDashOffset:0,lineCap:"butt",lineJoin:"miter",miterLimit:10,fillStyle:"#000",fillOpacity:1},ew={};function ze(r,t,e,n){var i=n.has(t)?n.get(t):en[t];return i!==e&&(t==="lineDash"?r.setLineDash(e):r[t]=e,n.set(t,e)),i}var b4=(function(){function r(t){ot(this,r),this.imagePool=t}return lt(r,[{key:"applyAttributesToContext",value:function(e,n){}},{key:"render",value:function(e,n,i,a,s,o){}},{key:"applyCommonStyleToContext",value:function(e,n,i,a){var s=i?ew:a.prevObject.parsedStyle,o=n.parsedStyle;(i||o.opacity!==s.opacity)&&ze(e,"globalAlpha",Rt(o.opacity)?en.globalAlpha:o.opacity,a.currentContext),(i||o.blend!==s.blend)&&ze(e,"globalCompositeOperation",Rt(o.blend)?en.globalCompositeOperation:o.blend,a.currentContext)}},{key:"applyStrokeFillStyleToContext",value:function(e,n,i,a){var s=i?ew:a.prevObject.parsedStyle,o=n.parsedStyle,l=o.lineWidth,c=l===void 0?en.lineWidth:l,u=o.fill&&!o.fill.isNone,h=o.stroke&&!o.stroke.isNone&&c>0;if(h){if(i||n.attributes.stroke!==a.prevObject.attributes.stroke){var d=!Rt(o.stroke)&&!Array.isArray(o.stroke)&&!o.stroke.isNone?n.attributes.stroke:en.strokeStyle;ze(e,"strokeStyle",d,a.currentContext)}(i||o.lineWidth!==s.lineWidth)&&ze(e,"lineWidth",Rt(o.lineWidth)?en.lineWidth:o.lineWidth,a.currentContext),(i||o.lineDash!==s.lineDash)&&ze(e,"lineDash",o.lineDash||en.lineDash,a.currentContext),(i||o.lineDashOffset!==s.lineDashOffset)&&ze(e,"lineDashOffset",Rt(o.lineDashOffset)?en.lineDashOffset:o.lineDashOffset,a.currentContext);for(var f=0;f<tw.length;f++){var g=tw[f];(i||o[g]!==s[g])&&ze(e,g,Rt(o[g])?en[g]:o[g],a.currentContext)}}if(u&&(i||n.attributes.fill!==a.prevObject.attributes.fill)){var v=!Rt(o.fill)&&!Array.isArray(o.fill)&&!o.fill.isNone?n.attributes.fill:en.fillStyle;ze(e,"fillStyle",v,a.currentContext)}}},{key:"applyStyleToContext",value:function(e,n,i,a){var s=n.nodeName;this.applyCommonStyleToContext(e,n,i,a),s===nt.IMAGE||this.applyStrokeFillStyleToContext(e,n,i,a)}},{key:"applyShadowAndFilterStyleToContext",value:function(e,n,i,a){var s=n.parsedStyle;if(i){ze(e,"shadowColor",s.shadowColor.toString(),a.currentContext);for(var o=0;o<pc.length;o++){var l=pc[o];ze(e,l,s[l]||en[l],a.currentContext)}}s.filter&&s.filter.length&&ze(e,"filter",n.attributes.filter,a.currentContext)}},{key:"clearShadowAndFilterStyleForContext",value:function(e,n,i,a){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(n){ze(e,"shadowColor",en.shadowColor,a.currentContext);for(var o=0;o<pc.length;o++){var l=pc[o];ze(e,l,en[l],a.currentContext)}}if(i)if(n&&s){var c=e.filter;!Rt(c)&&c.indexOf("drop-shadow")>-1&&ze(e,"filter",c.replace(/drop-shadow\([^)]*\)/,"").trim()||en.filter,a.currentContext)}else ze(e,"filter",en.filter,a.currentContext)}},{key:"fillToContext",value:function(e,n,i,a,s){var o=this,l=n.parsedStyle,c=l.fill,u=l.fillRule,h=null;if(Array.isArray(c)&&c.length>0)c.forEach(function(f){var g=ze(e,"fillStyle",vu(f,n,e,o.imagePool),i.currentContext);h=h??g,u?e.fill(u):e.fill()});else{if(Xa(c)){var d=gu(c,n,e,n.ownerDocument.defaultView.context,a,s,this.imagePool);d&&(e.fillStyle=d,h=!0)}u?e.fill(u):e.fill()}h!==null&&ze(e,"fillStyle",h,i.currentContext)}},{key:"strokeToContext",value:function(e,n,i,a,s){var o=this,l=n.parsedStyle.stroke,c=null;if(Array.isArray(l)&&l.length>0)l.forEach(function(d){var f=ze(e,"strokeStyle",vu(d,n,e,o.imagePool),i.currentContext);c=c??f,e.stroke()});else{if(Xa(l)){var u=gu(l,n,e,n.ownerDocument.defaultView.context,a,s,this.imagePool);if(u){var h=ze(e,"strokeStyle",u,i.currentContext);c=c??h}}e.stroke()}c!==null&&ze(e,"strokeStyle",c,i.currentContext)}},{key:"drawToContext",value:function(e,n,i,a,s){var o,l=n.nodeName,c=n.parsedStyle,u=c.opacity,h=u===void 0?en.globalAlpha:u,d=c.fillOpacity,f=d===void 0?en.fillOpacity:d,g=c.strokeOpacity,v=g===void 0?en.strokeOpacity:g,p=c.lineWidth,y=p===void 0?en.lineWidth:p,m=c.fill&&!c.fill.isNone,x=c.stroke&&!c.stroke.isNone&&y>0;if(!(!m&&!x)){var E=!Rt(c.shadowColor)&&c.shadowBlur>0,_=c.shadowType==="inner",M=((o=c.fill)===null||o===void 0?void 0:o.alpha)===0,O=!!(c.filter&&c.filter.length),T=E&&x&&(l===nt.PATH||l===nt.LINE||l===nt.POLYLINE||M||_),N=null;if(m){T||this.applyShadowAndFilterStyleToContext(e,n,E,i);var P=h*f;N=ze(e,"globalAlpha",P,i.currentContext),this.fillToContext(e,n,i,a,s),T||this.clearShadowAndFilterStyleForContext(e,E,O,i)}if(x){var C=!1,R=h*v,I=ze(e,"globalAlpha",R,i.currentContext);if(N=m?N:I,T&&(this.applyShadowAndFilterStyleToContext(e,n,E,i),C=!0,_)){var j=e.globalCompositeOperation;e.globalCompositeOperation="source-atop",this.strokeToContext(e,n,i,a,s),e.globalCompositeOperation=j,this.clearShadowAndFilterStyleForContext(e,E,O,i,!0)}this.strokeToContext(e,n,i,a,s),C&&this.clearShadowAndFilterStyleForContext(e,E,O,i)}N!==null&&ze(e,"globalAlpha",N,i.currentContext)}}}])})(),B1=(function(r){function t(){return ot(this,t),Yt(this,t,arguments)}return Ht(t,r),lt(t,[{key:"render",value:function(n,i,a,s,o,l){var c=i.fill,u=i.fillRule,h=i.opacity,d=h===void 0?1:h,f=i.fillOpacity,g=f===void 0?1:f,v=i.stroke,p=i.strokeOpacity,y=p===void 0?1:p,m=i.lineWidth,x=m===void 0?1:m,E=i.lineCap,_=i.lineJoin,M=i.shadowType,O=i.shadowColor,T=i.shadowBlur,N=i.filter,P=i.miterLimit,C=c&&!c.isNone,R=v&&!v.isNone&&x>0,I=(c==null?void 0:c.alpha)===0,j=!!(N&&N.length),G=!Rt(O)&&T>0,H=a.nodeName,Z=M==="inner",U=R&&G&&(H===nt.PATH||H===nt.LINE||H===nt.POLYLINE||I||Z);C&&(n.globalAlpha=d*g,U||pu(a,n,G),gN(n,a,c,u,s,o,l,this.imagePool),U||this.clearShadowAndFilter(n,j,G)),R&&(n.globalAlpha=d*y,n.lineWidth=x,Rt(P)||(n.miterLimit=P),Rt(E)||(n.lineCap=E),Rt(_)||(n.lineJoin=_),U&&(Z&&(n.globalCompositeOperation="source-atop"),pu(a,n,!0),Z&&(Nm(n,a,v,s,o,l,this.imagePool),n.globalCompositeOperation=en.globalCompositeOperation,this.clearShadowAndFilter(n,j,!0))),Nm(n,a,v,s,o,l,this.imagePool))}},{key:"clearShadowAndFilter",value:function(n,i,a){if(a&&(n.shadowColor="transparent",n.shadowBlur=0),i){var s=n.filter;!Rt(s)&&s.indexOf("drop-shadow")>-1&&(n.filter=s.replace(/drop-shadow\([^)]*\)/,"").trim()||"none")}}}])})(b4);function pu(r,t,e){var n=r.parsedStyle,i=n.filter,a=n.shadowColor,s=n.shadowBlur,o=n.shadowOffsetX,l=n.shadowOffsetY;i&&i.length&&(t.filter=r.style.filter),e&&(t.shadowColor=a.toString(),t.shadowBlur=s||0,t.shadowOffsetX=o||0,t.shadowOffsetY=l||0)}function gN(r,t,e,n,i,a,s,o){var l=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1;Array.isArray(e)?e.forEach(function(c){r.fillStyle=vu(c,t,r,o),l||(n?r.fill(n):r.fill())}):(Xa(e)&&(r.fillStyle=gu(e,t,r,i,a,s,o)),l||(n?r.fill(n):r.fill()))}function Nm(r,t,e,n,i,a,s){var o=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1;Array.isArray(e)?e.forEach(function(l){r.strokeStyle=vu(l,t,r,s),o||r.stroke()}):(Xa(e)&&(r.strokeStyle=gu(e,t,r,n,i,a,s)),o||r.stroke())}function x4(r,t){var e=$t(r,4),n=e[0],i=e[1],a=e[2],s=e[3],o=$t(t,4),l=o[0],c=o[1],u=o[2],h=o[3],d=Math.max(n,l),f=Math.max(i,c),g=Math.min(n+a,l+u),v=Math.min(i+s,c+h);return g<=d||v<=f?null:[d,f,g-d,v-f]}function w4(r,t){var e=zn(te(),[r[0],r[1],0],t),n=zn(te(),[r[0]+r[2],r[1],0],t),i=zn(te(),[r[0],r[1]+r[3],0],t),a=zn(te(),[r[0]+r[2],r[1]+r[3],0],t);return[Math.min(e[0],n[0],i[0],a[0]),Math.min(e[1],n[1],i[1],a[1]),Math.max(e[0],n[0],i[0],a[0])-Math.min(e[0],n[0],i[0],a[0]),Math.max(e[1],n[1],i[1],a[1])-Math.min(e[1],n[1],i[1],a[1])]}var E4=(function(r){function t(){return ot(this,t),Yt(this,t,arguments)}return Ht(t,r),lt(t,[{key:"renderDownSampled",value:function(n,i,a,s){var o=s.src,l=s.imageCache;if(!l.downSampled){this.imagePool.createDownSampledImage(o,a).then(function(){a.ownerDocument&&(a.dirty(),a.ownerDocument.defaultView.context.renderingService.dirtify())}).catch(function(c){console.error(c)});return}n.drawImage(l.downSampled,Math.floor(s.drawRect[0]),Math.floor(s.drawRect[1]),Math.ceil(s.drawRect[2]),Math.ceil(s.drawRect[3]))}},{key:"renderTile",value:function(n,i,a,s){var o=s.src,l=s.imageCache,c=s.imageRect,u=s.drawRect,h=l.size,d=n.getTransform(),f=d.a,g=d.b,v=d.c,p=d.d,y=d.e,m=d.f;if(n.resetTransform(),!(l!=null&&l.gridSize)){this.imagePool.createImageTiles(o,[],function(){a.ownerDocument&&(a.dirty(),a.ownerDocument.defaultView.context.renderingService.dirtify())},a).catch(function(G){console.error(G)});return}for(var x=[h[0]/c[2],h[1]/c[3]],E=[l.tileSize[0]/x[0],l.tileSize[1]/x[1]],_=[Math.floor((u[0]-c[0])/E[0]),Math.ceil((u[0]+u[2]-c[0])/E[0])],M=_[0],O=_[1],T=[Math.floor((u[1]-c[1])/E[1]),Math.ceil((u[1]+u[3]-c[1])/E[1])],N=T[0],P=T[1],C=N;C<=P;C++)for(var R=M;R<=O;R++){var I=l.tiles[C][R];if(I){var j=[Math.floor(c[0]+I.tileX*E[0]),Math.floor(c[1]+I.tileY*E[1]),Math.ceil(E[0]),Math.ceil(E[1])];n.drawImage(I.data,j[0],j[1],j[2],j[3])}}n.setTransform(f,g,v,p,y,m)}},{key:"render",value:function(n,i,a){var s=i.x,o=s===void 0?0:s,l=i.y,c=l===void 0?0:l,u=i.width,h=i.height,d=i.src,f=i.shadowColor,g=i.shadowBlur,v=this.imagePool.getImageSync(d,a),p=v==null?void 0:v.img,y=u,m=h;if(p){y||(y=p.width),m||(m=p.height);var x=!Rt(f)&&g>0;pu(a,n,x);try{var E=a.ownerDocument.defaultView.getContextService().getDomElement(),_=E.width,M=E.height,O=n.getTransform(),T=O.a,N=O.b,P=O.c,C=O.d,R=O.e,I=O.f,j=iO(T,P,0,0,N,C,0,0,0,0,1,0,R,I,0,1),G=w4([o,c,y,m],j),H=x4([0,0,_,M],G);if(!H)return;if(!a.ownerDocument.defaultView.getConfig().enableLargeImageOptimization){t.renderFull(n,i,a,{image:p,drawRect:[o,c,y,m]});return}var Z=G[2]/v.size[0];if(Z<(v.downSamplingRate||.5)){this.renderDownSampled(n,i,a,{src:d,imageCache:v,drawRect:[o,c,y,m]});return}if(!F1.isSupportTile){t.renderFull(n,i,a,{image:p,drawRect:[o,c,y,m]});return}this.renderTile(n,i,a,{src:d,imageCache:v,imageRect:G,drawRect:H})}catch{}}}},{key:"drawToContext",value:function(n,i,a,s,o){this.render(n,i.parsedStyle,i)}}],[{key:"renderFull",value:function(n,i,a,s){n.drawImage(s.image,Math.floor(s.drawRect[0]),Math.floor(s.drawRect[1]),Math.ceil(s.drawRect[2]),Math.ceil(s.drawRect[3]))}}])})(B1),S4=(function(r){function t(){return ot(this,t),Yt(this,t,arguments)}return Ht(t,r),lt(t,[{key:"render",value:function(n,i,a,s,o,l){a.getBounds();var c=i.lineWidth,u=c===void 0?1:c,h=i.textAlign,d=h===void 0?"start":h,f=i.textBaseline,g=f===void 0?"alphabetic":f,v=i.lineJoin,p=v===void 0?"miter":v,y=i.miterLimit,m=y===void 0?10:y,x=i.letterSpacing,E=x===void 0?0:x,_=i.stroke,M=i.fill,O=i.fillRule,T=i.fillOpacity,N=T===void 0?1:T,P=i.strokeOpacity,C=P===void 0?1:P,R=i.opacity,I=R===void 0?1:R,j=i.metrics,G=i.x,H=G===void 0?0:G,Z=i.y,U=Z===void 0?0:Z,tt=i.dx,gt=i.dy,xt=i.shadowColor,ut=i.shadowBlur,zt=j.font,J=j.lines,W=j.height,Q=j.lineHeight,ht=j.lineMetrics;n.font=zt,n.lineWidth=u,n.textAlign=d==="middle"?"center":d;var Et=g;Et==="alphabetic"&&(Et="bottom"),n.lineJoin=p,Rt(m)||(n.miterLimit=m);var Pt=U;g==="middle"?Pt+=-W/2-Q/2:g==="bottom"||g==="alphabetic"||g==="ideographic"?Pt+=-W:(g==="top"||g==="hanging")&&(Pt+=-Q);var Kt=H+(tt||0);Pt+=gt||0,J.length===1&&(Et==="bottom"?(Et="middle",Pt-=.5*W):Et==="top"&&(Et="middle",Pt+=.5*W)),n.textBaseline=Et;var pe=!Rt(xt)&&ut>0;pu(a,n,pe);for(var pn=0;pn<J.length;pn++){var Ce=u/2+Kt;Pt+=Q,!Rt(_)&&!_.isNone&&u&&this.drawLetterSpacing(n,a,J[pn],ht[pn],d,Ce,Pt,E,M,O,N,_,C,I,!0,s,o,l),Rt(M)||this.drawLetterSpacing(n,a,J[pn],ht[pn],d,Ce,Pt,E,M,O,N,_,C,I,!1,s,o,l)}}},{key:"drawLetterSpacing",value:function(n,i,a,s,o,l,c,u,h,d,f,g,v,p,y,m,x,E){if(u===0){y?this.strokeText(n,i,a,l,c,g,v,m,x,E):this.fillText(n,i,a,l,c,h,d,f,p,m,x,E);return}var _=n.textAlign;n.textAlign="left";var M=l;o==="center"||o==="middle"?M=l-s.width/2:(o==="right"||o==="end")&&(M=l-s.width);for(var O=Array.from(a),T=n.measureText(a).width,N=0,P=0;P<O.length;++P){var C=O[P];y?this.strokeText(n,i,C,M,c,g,v,m,x,E):this.fillText(n,i,C,M,c,h,d,f,p,m,x,E),N=n.measureText(a.substring(P+1)).width,M+=T-N+u,T=N}n.textAlign=_}},{key:"fillText",value:function(n,i,a,s,o,l,c,u,h,d,f,g){gN(n,i,l,c,d,f,g,this.imagePool,!0);var v,p=!Rt(u)&&u!==1;p&&(v=n.globalAlpha,n.globalAlpha=u*h),n.fillText(a,s,o),p&&(n.globalAlpha=v)}},{key:"strokeText",value:function(n,i,a,s,o,l,c,u,h,d){Nm(n,i,l,u,h,d,this.imagePool,!0);var f,g=!Rt(c)&&c!==1;g&&(f=n.globalAlpha,n.globalAlpha=c),n.strokeText(a,s,o),g&&(n.globalAlpha=f)}},{key:"drawToContext",value:function(n,i,a,s,o){this.render(n,i.parsedStyle,i,i.ownerDocument.defaultView.context,s,o)}}])})(B1),_4=(function(r){function t(){var e,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ot(this,t),e=Yt(this,t),e.name="canvas-renderer",e.options=n,e}return Ht(t,r),lt(t,[{key:"init",value:function(){var n,i=Vt({dirtyObjectNumThreshold:500,dirtyObjectRatioThreshold:.8},this.options),a=this.context.imagePool,s=new B1(a),o=(n={},_t(_t(_t(_t(_t(_t(_t(_t(_t(_t(n,nt.CIRCLE,s),nt.ELLIPSE,s),nt.RECT,s),nt.IMAGE,new E4(a)),nt.TEXT,new S4(a)),nt.LINE,s),nt.POLYLINE,s),nt.POLYGON,s),nt.PATH,s),nt.GROUP,void 0),_t(_t(_t(n,nt.HTML,void 0),nt.MESH,void 0),nt.FRAGMENT,void 0));this.context.defaultStyleRendererFactory=o,this.context.styleRendererFactory=o,this.addRenderingPlugin(new fN(i))}},{key:"destroy",value:function(){this.removeAllRenderingPlugins(),delete this.context.defaultStyleRendererFactory,delete this.context.styleRendererFactory}}])})(pa);/*!
 * @antv/g-plugin-dom-interaction
 * @description A G plugin
 * @version 2.1.27
 * @date 7/30/2025, 1:35:38 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var vN=(function(){function r(){ot(this,r)}return lt(r,[{key:"apply",value:function(e,n){var i=this,a=e.renderingService,s=e.renderingContext,o=e.config;this.context=e;var l=s.root.ownerDocument.defaultView,c=function(T){a.hooks.pointerMove.call(T)},u=function(T){a.hooks.pointerUp.call(T)},h=function(T){a.hooks.pointerDown.call(T)},d=function(T){a.hooks.pointerOver.call(T)},f=function(T){a.hooks.pointerOut.call(T)},g=function(T){a.hooks.pointerCancel.call(T)},v=function(T){a.hooks.pointerWheel.call(T)},p=function(T){a.hooks.click.call(T)},y=function(T){n.globalThis.document.addEventListener("pointermove",c,!0),T.addEventListener("pointerdown",h,!0),T.addEventListener("pointerleave",f,!0),T.addEventListener("pointerover",d,!0),n.globalThis.addEventListener("pointerup",u,!0),n.globalThis.addEventListener("pointercancel",g,!0)},m=function(T){T.addEventListener("touchstart",h,!0),T.addEventListener("touchend",u,!0),T.addEventListener("touchmove",c,!0),T.addEventListener("touchcancel",g,!0)},x=function(T){n.globalThis.document.addEventListener("mousemove",c,!0),T.addEventListener("mousedown",h,!0),T.addEventListener("mouseout",f,!0),T.addEventListener("mouseover",d,!0),n.globalThis.addEventListener("mouseup",u,!0)},E=function(T){n.globalThis.document.removeEventListener("pointermove",c,!0),T.removeEventListener("pointerdown",h,!0),T.removeEventListener("pointerleave",f,!0),T.removeEventListener("pointerover",d,!0),n.globalThis.removeEventListener("pointerup",u,!0),n.globalThis.removeEventListener("pointercancel",g,!0)},_=function(T){T.removeEventListener("touchstart",h,!0),T.removeEventListener("touchend",u,!0),T.removeEventListener("touchmove",c,!0),T.removeEventListener("touchcancel",g,!0)},M=function(T){n.globalThis.document.removeEventListener("mousemove",c,!0),T.removeEventListener("mousedown",h,!0),T.removeEventListener("mouseout",f,!0),T.removeEventListener("mouseover",d,!0),n.globalThis.removeEventListener("mouseup",u,!0)};a.hooks.init.tap(r.tag,function(){var O=i.context.contextService.getDomElement();n.globalThis.navigator.msPointerEnabled?(O.style.msContentZooming="none",O.style.msTouchAction="none"):l.supportsPointerEvents&&(O.style.touchAction="none"),l.supportsPointerEvents?y(O):x(O),l.supportsTouchEvents&&m(O),o.useNativeClickEvent&&O.addEventListener("click",p,!0),O.addEventListener("wheel",v,{passive:!0,capture:!0})}),a.hooks.destroy.tap(r.tag,function(){var O=i.context.contextService.getDomElement();n.globalThis.navigator.msPointerEnabled?(O.style.msContentZooming="",O.style.msTouchAction=""):l.supportsPointerEvents&&(O.style.touchAction=""),l.supportsPointerEvents?E(O):M(O),l.supportsTouchEvents&&_(O),o.useNativeClickEvent&&O.removeEventListener("click",p,!0),O.removeEventListener("wheel",v,!0)})}}])})();vN.tag="DOMInteraction";var k4=(function(r){function t(){var e;ot(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=Yt(this,t,[].concat(i)),e.name="dom-interaction",e}return Ht(t,r),lt(t,[{key:"init",value:function(){this.addRenderingPlugin(new vN)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])})(pa);/*!
 * @antv/g-plugin-html-renderer
 * @description A G plugin for rendering HTML
 * @version 2.1.27
 * @date 7/30/2025, 1:35:48 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var M4="g-canvas-camera",pN=(function(){function r(){ot(this,r),this.displayObjectHTMLElementMap=new WeakMap}return lt(r,[{key:"joinTransformMatrix",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];return"matrix(".concat([e[0],e[1],e[4],e[5],e[12]+n[0],e[13]+n[1]].join(","),")")}},{key:"apply",value:function(e,n){var i=this,a=e.camera,s=e.renderingContext,o=e.renderingService;this.context=e;var l=s.root.ownerDocument.defaultView,c=l.context.eventService.nativeHTMLMap,u=function(y,m){m.style.transform=i.joinTransformMatrix(y.getWorldTransform(),y.getOrigin())},h=function(y){var m=y.target;if(m.nodeName===nt.HTML){i.$camera||(i.$camera=i.createCamera(a));var x=i.getOrCreateEl(m);i.$camera.appendChild(x),Object.keys(m.attributes).forEach(function(E){i.updateAttribute(E,m)}),u(m,x),c.set(x,m)}},d=function(y){var m=y.target;if(m.nodeName===nt.HTML&&i.$camera){var x=i.getOrCreateEl(m);x&&(x.remove(),c.delete(x))}},f=function(y){var m=y.target;if(m.nodeName===nt.HTML){var x=y.attrName;i.updateAttribute(x,m)}},g=function(y){var m=y.target,x=m.nodeName===nt.FRAGMENT?m.childNodes:[m];x.forEach(function(E){if(E.nodeName===nt.HTML){var _=i.getOrCreateEl(E);u(E,_)}})},v=function(){if(i.$camera){var y=i.context.config,m=y.width,x=y.height;i.$camera.parentElement.style.width="".concat(m||0,"px"),i.$camera.parentElement.style.height="".concat(x||0,"px")}};o.hooks.init.tap(r.tag,function(){l.addEventListener(gr.RESIZE,v),l.addEventListener(Jt.MOUNTED,h),l.addEventListener(Jt.UNMOUNTED,d),l.addEventListener(Jt.ATTR_MODIFIED,f),l.addEventListener(Jt.BOUNDS_CHANGED,g)}),o.hooks.endFrame.tap(r.tag,function(){i.$camera&&s.renderReasons.has(Is.CAMERA_CHANGED)&&(i.$camera.style.transform=i.joinTransformMatrix(a.getOrthoMatrix()))}),o.hooks.destroy.tap(r.tag,function(){i.$camera&&i.$camera.remove(),l.removeEventListener(gr.RESIZE,v),l.removeEventListener(Jt.MOUNTED,h),l.removeEventListener(Jt.UNMOUNTED,d),l.removeEventListener(Jt.ATTR_MODIFIED,f),l.removeEventListener(Jt.BOUNDS_CHANGED,g)})}},{key:"createCamera",value:function(e){var n=this.context.config,i=n.document,a=n.width,s=n.height,o=this.context.contextService.getDomElement(),l=o.parentNode;if(l){var c=M4,u=l.querySelector("#".concat(c));if(!u){var h=(i||document).createElement("div");h.style.overflow="hidden",h.style.pointerEvents="none",h.style.position="absolute",h.style.left="0px",h.style.top="0px",h.style.width="".concat(a||0,"px"),h.style.height="".concat(s||0,"px");var d=(i||document).createElement("div");u=d,d.id=c,d.style.position="absolute",d.style.left="".concat(o.offsetLeft||0,"px"),d.style.top="".concat(o.offsetTop||0,"px"),d.style.transformOrigin="left top",d.style.transform=this.joinTransformMatrix(e.getOrthoMatrix()),d.style.pointerEvents="none",d.style.width="100%",d.style.height="100%",h.appendChild(d),l.appendChild(h)}return u}return null}},{key:"getOrCreateEl",value:function(e){var n=this.context.config.document,i=this.displayObjectHTMLElementMap.get(e);return i||(i=(n||document).createElement("div"),e.parsedStyle.$el=i,this.displayObjectHTMLElementMap.set(e,i),e.id&&(i.id=e.id),e.name&&i.setAttribute("name",e.name),e.className&&(i.className=e.className),i.style.position="absolute",i.style["will-change"]="transform",i.style.transform=this.joinTransformMatrix(e.getWorldTransform(),e.getOrigin())),i}},{key:"updateAttribute",value:function(e,n){var i=this.getOrCreateEl(n);switch(e){case"innerHTML":var a=n.parsedStyle.innerHTML;ae(a)?i.innerHTML=a:(i.innerHTML="",i.appendChild(a));break;case"x":i.style.left="".concat(n.parsedStyle.x,"px");break;case"y":i.style.top="".concat(n.parsedStyle.y,"px");break;case"transformOrigin":var s=n.parsedStyle.transformOrigin;i.style["transform-origin"]="".concat(s[0].buildCSSText(null,null,"")," ").concat(s[1].buildCSSText(null,null,""));break;case"width":var o=n.parsedStyle.width;i.style.width=St(o)?"".concat(o,"px"):o.toString();break;case"height":var l=n.parsedStyle.height;i.style.height=St(l)?"".concat(l,"px"):l.toString();break;case"zIndex":var c=n.parsedStyle.zIndex;i.style["z-index"]="".concat(c);break;case"visibility":var u=n.parsedStyle.visibility;i.style.visibility=u;break;case"pointerEvents":var h=n.parsedStyle.pointerEvents,d=h===void 0?"auto":h;i.style.pointerEvents=d;break;case"opacity":var f=n.parsedStyle.opacity;i.style.opacity="".concat(f);break;case"fill":var g=n.parsedStyle.fill,v="";iu(g)?g.isNone?v="transparent":v=n.getAttribute("fill"):Array.isArray(g)?v=n.getAttribute("fill"):Xa(g),i.style.background=v;break;case"stroke":var p=n.parsedStyle.stroke,y="";iu(p)?p.isNone?y="transparent":y=n.getAttribute("stroke"):Array.isArray(p)?y=n.getAttribute("stroke"):Xa(p),i.style["border-color"]=y,i.style["border-style"]="solid";break;case"lineWidth":var m=n.parsedStyle.lineWidth;i.style["border-width"]="".concat(m||0,"px");break;case"lineDash":i.style["border-style"]="dashed";break;case"filter":var x=n.style.filter;i.style.filter=x;break;default:!Rt(n.style[e])&&n.style[e]!==""&&(i.style[e]=n.style[e])}}}])})();pN.tag="HTMLRendering";var T4=(function(r){function t(){var e;ot(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=Yt(this,t,[].concat(i)),e.name="html-renderer",e}return Ht(t,r),lt(t,[{key:"init",value:function(){this.addRenderingPlugin(new pN)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])})(pa);/*!
 * @antv/g-canvas
 * @description A renderer implemented by Canvas 2D API
 * @version 2.0.48
 * @date 7/30/2025, 1:38:18 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var O4=(function(){function r(t){ot(this,r),this.renderingContext=t.renderingContext,this.canvasConfig=t.config}return lt(r,[{key:"init",value:function(){var e=this.canvasConfig,n=e.container,i=e.canvas;if(i)this.$canvas=i,n&&i.parentElement!==n&&n.appendChild(i),this.$container=i.parentElement,this.canvasConfig.container=this.$container;else if(n&&(this.$container=ae(n)?document.getElementById(n):n,this.$container)){var a=document.createElement("canvas");this.$container.appendChild(a),this.$container.style.position||(this.$container.style.position="relative"),this.$canvas=a}this.context=this.$canvas.getContext("2d"),this.resize(this.canvasConfig.width,this.canvasConfig.height)}},{key:"getContext",value:function(){return this.context}},{key:"getDomElement",value:function(){return this.$canvas}},{key:"getDPR",value:function(){return this.dpr}},{key:"getBoundingClientRect",value:function(){if(this.$canvas.getBoundingClientRect)return this.$canvas.getBoundingClientRect()}},{key:"destroy",value:function(){this.$container&&this.$canvas&&this.$canvas.parentNode&&this.$container.removeChild(this.$canvas)}},{key:"resize",value:function(e,n){var i=this.canvasConfig.devicePixelRatio;this.dpr=i,this.$canvas&&(this.$canvas.width=this.dpr*e,this.$canvas.height=this.dpr*n,i6(this.$canvas,e,n)),this.renderingContext.renderReasons.add(Is.CAMERA_CHANGED)}},{key:"applyCursorStyle",value:function(e){this.$container&&this.$container.style&&(this.$container.style.cursor=e)}},{key:"toDataURL",value:(function(){var t=fa(bn().mark(function n(){var i,a,s,o=arguments;return bn().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return i=o.length>0&&o[0]!==void 0?o[0]:{},a=i.type,s=i.encoderOptions,l.abrupt("return",this.context.canvas.toDataURL(a,s));case 1:case"end":return l.stop()}},n,this)}));function e(){return t.apply(this,arguments)}return e})()}])})(),A4=(function(r){function t(){var e;ot(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=Yt(this,t,[].concat(i)),e.name="canvas-context-register",e}return Ht(t,r),lt(t,[{key:"init",value:function(){this.context.ContextService=O4}},{key:"destroy",value:function(){delete this.context.ContextService}}])})(pa),Xo=(function(r){function t(e){var n;return ot(this,t),n=Yt(this,t,[e]),n.registerPlugin(new A4),n.registerPlugin(new m4),n.registerPlugin(new X5),n.registerPlugin(new _4),n.registerPlugin(new k4),n.registerPlugin(new g4),n.registerPlugin(new T4),n}return Ht(t,r),lt(t)})(eI),N4=function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(e[n[i]]=r[n[i]]);return e};class $u extends Zr{constructor(t){super(Object.assign(Object.assign({},t),{style:Object.assign({},$u.defaultStyleProps,t.style)})),this.rootPointerEvent=new ou(null),this.forwardEvents=e=>{const n=this.context.canvas,i=n.context.renderingContext.root.ownerDocument.defaultView;this.normalizeToPointerEvent(e,i).forEach(s=>{const o=this.bootstrapEvent(this.rootPointerEvent,s,i,e);Go(n.context.eventService,"mappingTable.pointerupoutside",[]),n.context.eventService.mapEvent(o)})}}get eventService(){return this.context.canvas.context.eventService}get events(){return[rt.CLICK,rt.POINTER_DOWN,rt.POINTER_MOVE,rt.POINTER_UP,rt.POINTER_OVER,rt.POINTER_LEAVE]}getDomElement(){return this.getShape("key").getDomElement()}render(t=this.parsedAttributes,e=this){this.drawKeyShape(t,e),this.drawPortShapes(t,e)}getKeyStyle(t){const e=Ya(t,["dx","dy","innerHTML","pointerEvents","cursor"]),{dx:n=0,dy:i=0}=e,a=N4(e,["dx","dy"]),[s,o]=this.getSize(t);return Object.assign(Object.assign({x:n,y:i},a),{width:s,height:o})}drawKeyShape(t,e){const n=this.getKeyStyle(t),{x:i,y:a,width:s=0,height:o=0}=n,l=this.upsert("key-container",Nn,{x:i,y:a,width:s,height:o,opacity:0},e);return this.upsert("key",rs,n,l)}connectedCallback(){if(!(this.context.canvas.getRenderer("main")instanceof Xo))return;const n=this.getDomElement();this.events.forEach(i=>{n.addEventListener(i,this.forwardEvents)})}attributeChangedCallback(t,e,n){t==="zIndex"&&e!==n&&(this.getDomElement().style.zIndex=n)}destroy(){const t=this.getDomElement();this.events.forEach(e=>{t.removeEventListener(e,this.forwardEvents)}),super.destroy()}normalizeToPointerEvent(t,e){const n=[];if(e.isTouchEvent(t))for(let i=0;i<t.changedTouches.length;i++){const a=t.changedTouches[i];Dt(a.button)&&(a.button=0),Dt(a.buttons)&&(a.buttons=1),Dt(a.isPrimary)&&(a.isPrimary=t.touches.length===1&&t.type==="touchstart"),Dt(a.width)&&(a.width=a.radiusX||1),Dt(a.height)&&(a.height=a.radiusY||1),Dt(a.tiltX)&&(a.tiltX=0),Dt(a.tiltY)&&(a.tiltY=0),Dt(a.pointerType)&&(a.pointerType="touch"),Dt(a.pointerId)&&(a.pointerId=a.identifier||0),Dt(a.pressure)&&(a.pressure=a.force||.5),Dt(a.twist)&&(a.twist=0),Dt(a.tangentialPressure)&&(a.tangentialPressure=0),a.isNormalized=!0,a.type=t.type,n.push(a)}else if(e.isMouseEvent(t)){const i=t;Dt(i.isPrimary)&&(i.isPrimary=!0),Dt(i.width)&&(i.width=1),Dt(i.height)&&(i.height=1),Dt(i.tiltX)&&(i.tiltX=0),Dt(i.tiltY)&&(i.tiltY=0),Dt(i.pointerType)&&(i.pointerType="mouse"),Dt(i.pointerId)&&(i.pointerId=1),Dt(i.pressure)&&(i.pressure=.5),Dt(i.twist)&&(i.twist=0),Dt(i.tangentialPressure)&&(i.tangentialPressure=0),i.isNormalized=!0,n.push(i)}else n.push(t);return n}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.ctrlKey=e.ctrlKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.screen.x=e.screenX,t.screen.y=e.screenY,t.relatedTarget=null}bootstrapEvent(t,e,n,i){t.view=n,t.originalEvent=null,t.nativeEvent=i,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);const{x:a,y:s}=this.getViewportXY(e);t.viewport.x=a,t.viewport.y=s;const[o,l]=this.context.canvas.getCanvasByViewport([a,s]);return t.canvas.x=o,t.canvas.y=l,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=i.isTrusted,t.type==="pointerleave"&&(t.type="pointerout"),t}getViewportXY(t){let e,n;const{offsetX:i,offsetY:a,clientX:s,clientY:o}=t;if(!Rt(i)&&!Rt(a))e=i,n=a;else{const l=this.eventService.client2Viewport({x:s,y:o});e=l.x,n=l.y}return{x:e,y:n}}onframe(){super.onframe();const{opacity:t}=this.attributes;this.getDomElement().style.opacity=`${t}`}}$u.defaultStyleProps={size:[160,80],halo:!1,icon:!1,label:!1,pointerEvents:"auto"};var nw=function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(e[n[i]]=r[n[i]]);return e};let yN=class mN extends Zr{constructor(t){super(wn({style:mN.defaultStyleProps},t))}getKeyStyle(t){const[e,n]=this.getSize(t),i=super.getKeyStyle(t),{fillOpacity:a,opacity:s=a}=i,o=nw(i,["fillOpacity","opacity"]);return Object.assign(Object.assign({opacity:s},o),{width:e,height:n,x:-e/2,y:-n/2})}getBounds(){return this.getShape("key").getBounds()}getHaloStyle(t){if(t.halo===!1)return!1;const e=this.getShape("key").attributes,{fill:n,stroke:i}=e;nw(e,["fill","stroke"]);const a=Ue(this.getGraphicStyle(t),"halo"),s=Number(a.lineWidth),[o,l]=qt(this.getSize(t),[s,s]),{lineWidth:c}=a,u={fill:"transparent",lineWidth:c/2,width:o-c/2,height:l-c/2,x:-(o-c/2)/2,y:-(l-c/2)/2};return Object.assign(Object.assign({},a),u)}getIconStyle(t){const e=super.getIconStyle(t),[n,i]=this.getSize(t);return e?Object.assign({width:n*ji,height:i*ji},e):!1}drawKeyShape(t,e){const n=this.upsert("key",L1,this.getKeyStyle(t),e);return I1(this),n}drawHaloShape(t,e){this.upsert("halo",Nn,this.getHaloStyle(t),e)}update(t){super.update(t),t&&("x"in t||"y"in t||"z"in t)&&D1(this)}};yN.defaultStyleProps={size:32};class P4 extends Zr{constructor(t){super(t)}getKeyStyle(t){const[e,n]=this.getSize(t);return Object.assign(Object.assign({},super.getKeyStyle(t)),{width:e,height:n,x:-e/2,y:-n/2})}getIconStyle(t){const e=super.getIconStyle(t),{width:n,height:i}=this.getShape("key").attributes;return e?Object.assign({width:n*ji,height:i*ji},e):!1}drawKeyShape(t,e){return this.upsert("key",Nn,this.getKeyStyle(t),e)}}class C4 extends ju{constructor(t){super(t)}getInnerR(t){return t.innerR||this.getOuterR(t)*3/8}getOuterR(t){return Math.min(...this.getSize(t))/2}getPoints(t){return vz(this.getOuterR(t),this.getInnerR(t))}getIconStyle(t){const e=super.getIconStyle(t),n=this.getInnerR(t)*2*ji;return e?Object.assign({width:n,height:n},e):!1}getPortXY(t,e){const{placement:n="top"}=e,i=this.getShape("key").getLocalBounds(),a=pz(this.getOuterR(t),this.getInnerR(t));return q1(i,n,a,!1)}}class Wu extends ju{constructor(t){super(wn({style:Wu.defaultStyleProps},t))}getPoints(t){const{direction:e}=t,[n,i]=this.getSize(t);return yz(n,i,e)}getPortXY(t,e){const{direction:n}=t,{placement:i="top"}=e,a=this.getShape("key").getLocalBounds(),[s,o]=this.getSize(t),l=mz(s,o,n);return q1(a,i,l,!1)}getIconStyle(t){const{icon:e,iconText:n,iconSrc:i,direction:a}=t;if(e===!1||ui(n||i))return!1;const s=Ue(this.getGraphicStyle(t),"icon"),o=this.getShape("key").getLocalBounds(),[l,c]=DB(o,a),u=FB(o,a)*2*ji;return Object.assign({x:l,y:c,width:u,height:u},s)}}Wu.defaultStyleProps={size:40,direction:"up"};var rw=function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(e[n[i]]=r[n[i]]);return e};class Xs extends Zr{constructor(t){super(wn({style:Xs.defaultStyleProps},t)),this.type="combo",this.updateComboPosition(this.parsedAttributes)}getKeySize(t){const{collapsed:e,childrenNode:n=[]}=t;return n.length===0?this.getEmptyKeySize(t):e?this.getCollapsedKeySize(t):this.getExpandedKeySize(t)}getEmptyKeySize(t){const{padding:e,collapsedSize:n}=t,[i,a,s,o]=Lr(e);return qt(br(n),[o+a,i+s,0])}getCollapsedKeySize(t){return br(t.collapsedSize)}getExpandedKeySize(t){const e=this.getContentBBox(t);return[Ei(e),Si(e),0]}getContentBBox(t){const{childrenNode:e=[],padding:n}=t,i=e.map(s=>this.context.element.getElement(s)).filter(Boolean);if(i.length===0){const s=new be,{x:o=0,y:l=0,size:c}=t,[u,h]=br(c);return s.setMinMax([o-u/2,l-h/2,0],[o+u/2,l+h/2,0]),s}const a=hl(i.map(s=>s.getBounds()));return n?ma(a,n):a}drawCollapsedMarkerShape(t,e){const n=this.getCollapsedMarkerStyle(t);this.upsert("collapsed-marker",sN,n,e),I1(this)}getCollapsedMarkerStyle(t){if(!t.collapsed||!t.collapsedMarker)return!1;const e=Ue(this.getGraphicStyle(t),"collapsedMarker"),{type:n}=e,i=rw(e,["type"]),a=this.getShape("key"),[s,o]=Pi(a.getLocalBounds(),"center"),l=Object.assign(Object.assign({},i),{x:s,y:o});if(n){const c=this.getCollapsedMarkerText(n,t);Object.assign(l,{text:c})}return l}getCollapsedMarkerText(t,e){const{childrenData:n=[]}=e,{model:i}=this.context;return t==="descendant-count"?i.getDescendantsData(this.id).length.toString():t==="child-count"?n.length.toString():t==="node-count"?i.getDescendantsData(this.id).filter(a=>i.getElementType(K(a))==="node").length.toString():Tt(t)?t(n):""}getComboPosition(t){const{x:e=0,y:n=0,collapsed:i,childrenData:a=[]}=t;if(a.length===0)return[+e,+n,0];if(i){const{model:s}=this.context,o=s.getDescendantsData(this.id).filter(l=>!s.isCombo(K(l)));if(o.length>0&&o.some(c5)){const l=o.reduce((c,u)=>qt(c,dn(u)),[0,0,0]);return Xr(l,o.length)}return[+e,+n,0]}return this.getContentBBox(t).center}getComboStyle(t){const[e,n]=this.getComboPosition(t);return{x:e,y:n,transform:[["translate",e,n]]}}updateComboPosition(t){const e=this.getComboStyle(t);Object.assign(this.style,e);const{x:n,y:i}=e;this.context.model.syncNodeLikeDatum({id:this.id,style:{x:n,y:i}}),D1(this)}render(t,e=this){super.render(t,e),this.drawCollapsedMarkerShape(t,e)}update(t={}){super.update(t),this.updateComboPosition(this.parsedAttributes)}onframe(){super.onframe(),this.attributes.collapsed||this.updateComboPosition(this.parsedAttributes),this.drawKeyShape(this.parsedAttributes,this)}animate(t,e){const n=super.animate(this.attributes.collapsed?t:t.map(i=>{var{x:a,y:s,z:o,transform:l}=i,c=rw(i,["x","y","z","transform"]);return c}),e);return n&&new Proxy(n,{set:(i,a,s)=>(a==="currentTime"&&Promise.resolve().then(()=>this.onframe()),Reflect.set(i,a,s))})}}Xs.defaultStyleProps={childrenNode:[],droppable:!0,draggable:!0,collapsed:!1,collapsedSize:32,collapsedMarker:!0,collapsedMarkerZIndex:1,collapsedMarkerFontSize:12,collapsedMarkerTextAlign:"center",collapsedMarkerTextBaseline:"middle",collapsedMarkerType:"child-count"};class R4 extends Xs{constructor(t){super(t)}drawKeyShape(t,e){return this.upsert("key",mi,this.getKeyStyle(t),e)}getKeyStyle(t){const{collapsed:e}=t,n=super.getKeyStyle(t),[i]=this.getKeySize(t);return Object.assign(Object.assign(Object.assign({},n),e&&Ue(n,"collapsed")),{r:i/2})}getCollapsedKeySize(t){const[e,n]=br(t.collapsedSize),i=Math.max(e,n)/2;return[i*2,i*2,0]}getExpandedKeySize(t){const e=this.getContentBBox(t),[n,i]=ya(e),a=Math.sqrt(Math.pow(n,2)+Math.pow(i,2))/2;return[a*2,a*2,0]}getIntersectPoint(t,e=!1){const n=this.getShape("key").getBounds();return Bu(t,n,e)}}class L4 extends Xs{constructor(t){super(t)}drawKeyShape(t,e){return this.upsert("key",Nn,this.getKeyStyle(t),e)}getKeyStyle(t){const e=super.getKeyStyle(t),[n,i]=this.getKeySize(t);return Object.assign(Object.assign(Object.assign({},e),t.collapsed&&Ue(e,"collapsed")),{width:n,height:i,x:-n/2,y:-i/2})}}const I4={padding:10};function iw(r,t,e,n,i,a){const{padding:s}=Object.assign(I4,a),o=ea(e,s),l=ea(n,s),c=[r,...i,t];let u=null;const h=[];for(let d=0,f=c.length;d<f-1;d++){const g=d+1,v=c[d],p=c[g],y=d5(v,p);let m=null;if(d===0)if(g===f-1)if(o.intersects(l))m=$d(v,p,o,l);else if(!uu(v,o)&&!uu(p,l)){const x=$a(v,o),E=$a(p,l);m=sw(x,E,Un(x,E)),m.points.unshift(x),m.points.push(E)}else y||(m=F4(v,p,o,l));else Hr(p,o)?m=$d(v,p,o,ea(p,s),u):y||(m=Dc(v,p,o));else g===f-1?Hr(v,l)?m=$d(v,p,ea(v,s),l,u):y||(m=bN(v,p,l,u)):y||(m=sw(v,p,u));m?(h.push(...m.points),u=m.direction):u=Un(v,p),g<f-1&&h.push(p)}return h.map(Ja)}const D4={N:"S",S:"N",W:"E",E:"W"},aw={N:-Math.PI/2,S:Math.PI/2,E:0,W:Math.PI};function Un(r,t){const[e,n]=r,[i,a]=t;return e===i?n>a?"N":"S":n===a?e>i?"W":"E":null}function Pm(r,t){return t==="N"||t==="S"?Si(r):Ei(r)}function sw(r,t,e){const n=[r[0],t[1]],i=[t[0],r[1]],a=Un(r,n),s=Un(r,i),o=e?D4[e]:null,l=a===e||a!==o&&s!==e?n:i;return{points:[l],direction:Un(l,t)}}function Dc(r,t,e){if(uu(r,e)){const n=Ko(r,t,e);return{points:[n],direction:Un(n,t)}}else{const n=$a(r,e),a=["left","right"].includes(Do(r,e))?[t[0],n[1]]:[n[0],t[1]];return{points:[a],direction:Un(a,t)}}}function bN(r,t,e,n){const i=uu(t,e)?t:$a(t,e),a=[[i[0],r[1]],[r[0],i[1]]],s=a.filter(l=>IB(l,e)&&!FA(l,e,!0)),o=s.filter(l=>Un(l,r)!==n);if(o.length>0){const l=o.find(c=>Un(r,c)===n)||o[0];return{points:[l],direction:Un(l,t)}}else{const l=R3(a,s)[0],c=ua(t,l,Pm(e,n)/2);return{points:[Ko(c,r,e),c],direction:Un(c,t)}}}function F4(r,t,e,n){let i=Dc(r,t,e);const a=Ho(i.points[0]);if(Hr(a,n)){i=Dc(t,r,n);const s=Ho(i.points[0]);if(Hr(s,e)){const o=ua(r,a,Pm(e,Un(r,a))/2),l=ua(t,s,Pm(n,Un(t,s))/2),c=[(o[0]+l[0])/2,(o[1]+l[1])/2],u=Dc(r,c,e),h=bN(c,t,n,u.direction);i.points=[u.points[0],h.points[0]],i.direction=h.direction}}return i}function $d(r,t,e,n,i){const s=hl([e,n]),o=Ee(t,s.center)>Ee(r,s.center),[l,c]=o?[t,r]:[r,t],u=Si(s)+Ei(s);let h;if(i){const g=[l[0]+u*Math.cos(aw[i]),l[1]+u*Math.sin(aw[i])];h=ua($a(g,s),g,.01)}else h=ua($a(l,s),l,-.01);let d=Ko(h,c,s),f=[vo(h,2),vo(d,2)];if(Ge(vo(h),vo(d))){const g=P1(fe(h,l),[1,0,0])+Math.PI/2;d=[c[0]+u*Math.cos(g),c[1]+u*Math.sin(g),0],d=vo(ua($a(d,s),c,-.01),2);const v=Ko(h,d,s);f=[h,v,d]}return{points:o?f.reverse():f,direction:Un(o?h:d,t)}}function Ko(r,t,e){let n=[r[0],t[1]];return Hr(n,e)&&(n=[t[0],r[1]]),n}function xN(r,t,e,n,i){let l=typeof t=="number"?t:.5;t==="start"&&(l=0),t==="end"&&(l=.99);const c=On(r.getPoint(l)),u=On(r.getPoint(l+.01));let h=t==="start"?"left":t==="end"?"right":"center";if(XA(c,u)||!e){const[y,m]=ow(r,l,n,i);return{transform:[["translate",y,m]],textAlign:h}}let d=Math.atan2(u[1]-c[1],u[0]-c[0]);u[0]<c[0]&&(h=h==="center"?h:h==="left"?"right":"left",n*=-1,d+=Math.PI);const[g,v]=ow(r,l,n,i,d),p=[["translate",g,v],["rotate",d/Math.PI*180]];return{textAlign:h,transform:p}}function B4(r,t,e,n,i){var a,s;const o=((a=r.badge)===null||a===void 0?void 0:a.getGeometryBounds().halfExtents[0])*2||0,l=((s=r.label)===null||s===void 0?void 0:s.getGeometryBounds().halfExtents[0])*2||0;return xN(r.key,e,!0,(l?(l/2+o/2)*(t==="suffix"?1:-1):0)+n,i)}function ow(r,t,e,n,i){const[a,s]=On(r.getPoint(t));let o=e,l=n;return i&&(o=e*Math.cos(i)-n*Math.sin(i),l=e*Math.sin(i)+n*Math.cos(i)),[a+o,s+l]}function Cm(r,t,e,n){if(Ge(r,t))return r;const i=fe(t,r),a=[r[0]+e*i[0],r[1]+e*i[1]],s=Fi(Fu(i,!1));return a[0]+=n*s[0],a[1]+=n*s[1],a}function z4(r){return St(r)?[r,-r]:r}function j4(r){return St(r)?[r,1-r]:r}function q4(r,t,e){return[["M",r[0],r[1]],["Q",e[0],e[1],t[0],t[1]]]}function wN(r,t,e){return[["M",r[0],r[1]],["C",e[0][0],e[0][1],e[1][0],e[1][1],t[0],t[1]]]}function z1(r,t=0,e=!1){const n=r.length-1,i=r[0],a=r[n],s=r.slice(1,n),o=[["M",i[0],i[1]]];return s.forEach((l,c)=>{const u=s[c-1]||i,h=s[c+1]||a;if(!KA(u,l,h)&&t){const[d,f]=G4(u,l,h,t);o.push(["L",d[0],d[1]],["Q",l[0],l[1],f[0],f[1]],["L",f[0],f[1]])}else o.push(["L",l[0],l[1]])}),o.push(["L",a[0],a[1]]),e&&o.push(["Z"]),o}function G4(r,t,e,n){const i=hu(r,t),a=hu(e,t),s=Math.min(n,Math.min(i,a)/2),o=[t[0]-s/i*(t[0]-r[0]),t[1]-s/i*(t[1]-r[1])],l=[t[0]-s/a*(t[0]-e[0]),t[1]-s/a*(t[1]-e[1])];return[o,l]}const $4=r=>{const t=Math.PI/2,e=Si(r)/2,n=Ei(r)/2,i=Math.atan2(e,n)/2,a=Math.atan2(n,e)/2;return{top:[-t-a,-t+a],"top-right":[-t+a,-i],"right-top":[-t+a,-i],right:[-i,i],"bottom-right":[i,t-a],"right-bottom":[i,t-a],bottom:[t-a,t+a],"bottom-left":[t+a,Math.PI-i],"left-bottom":[t+a,Math.PI-i],left:[Math.PI-i,Math.PI+i],"top-left":[Math.PI+i,-t-a],"left-top":[Math.PI+i,-t-a]}};function EN(r,t,e,n,i){const a=ea(r),s=r.getCenter();let o=n&&ga(n),l=i&&ga(i);if(!o||!l){const c=$4(a),u=c[t][0],h=c[t][1],[d,f]=ya(a),g=Math.max(d,f),v=qt(s,[g*Math.cos(u),g*Math.sin(u),0]),p=qt(s,[g*Math.cos(h),g*Math.sin(h),0]);o=Lm(r,v),l=Lm(r,p),e||([o,l]=[l,o])}return[o,l]}function W4(r,t,e,n,i,a){const s=r.getPorts()[i||a],o=r.getPorts()[a||i];let[l,c]=EN(r,t,e,s,o);const u=V4(r,l,c,n);return s&&(l=Zo(s,u[0])),o&&(c=Zo(o,u.at(-1))),wN(l,c,u)}function V4(r,t,e,n){const i=r.getCenter();if(Ge(t,e)){const a=fe(t,i),s=[n*Math.sign(a[0])||n/2,n*Math.sign(a[1])||-n/2,0];return[qt(t,s),qt(e,Wr(s,[1,-1,1]))]}return[ua(i,t,Ee(i,t)+n),ua(i,e,Ee(i,e)+n)]}function U4(r,t,e,n,i,a,s){const o=G1(r),l=o[a||s],c=o[s||a];let[u,h]=EN(r,e,n,l,c);const d=Y4(r,u,h,i);return l&&(u=Zo(l,d[0])),c&&(h=Zo(c,d.at(-1))),z1([u,...d,h],t)}function Y4(r,t,e,n){const i=[],a=ea(r);if(Ge(t,e))switch(Do(t,a)){case"left":i.push([t[0]-n,t[1]]),i.push([t[0]-n,t[1]+n]),i.push([t[0],t[1]+n]);break;case"right":i.push([t[0]+n,t[1]]),i.push([t[0]+n,t[1]+n]),i.push([t[0],t[1]+n]);break;case"top":i.push([t[0],t[1]-n]),i.push([t[0]+n,t[1]-n]),i.push([t[0]+n,t[1]]);break;case"bottom":i.push([t[0],t[1]+n]),i.push([t[0]+n,t[1]+n]),i.push([t[0]+n,t[1]]);break}else{const s=Do(t,a),o=Do(e,a);if(s===o){const l=s;let c,u;switch(l){case"left":c=Math.min(t[0],e[0])-n,i.push([c,t[1]]),i.push([c,e[1]]);break;case"right":c=Math.max(t[0],e[0])+n,i.push([c,t[1]]),i.push([c,e[1]]);break;case"top":u=Math.min(t[1],e[1])-n,i.push([t[0],u]),i.push([e[0],u]);break;case"bottom":u=Math.max(t[1],e[1])+n,i.push([t[0],u]),i.push([e[0],u]);break}}else{const l=(d,f)=>({left:[f[0]-n,f[1]],right:[f[0]+n,f[1]],top:[f[0],f[1]-n],bottom:[f[0],f[1]+n]})[d],c=l(s,t),u=l(o,e),h=Ko(c,u,a);i.push(c,h,u)}}return i}function Rm(r,t){const e=new Set,n=new Set,i=new Set;return r.forEach(a=>{t(a).forEach(o=>{e.add(o),r.includes(o.source)&&r.includes(o.target)?n.add(o):i.add(o)})}),{edges:Array.from(e),internal:Array.from(n),external:Array.from(i)}}function lw(r,t){const e=[];let n=r;for(;n;){e.push(n);const i=t(K(n));if(i)n=i;else break}if(e.some(i=>{var a;return(a=i.style)===null||a===void 0?void 0:a.collapsed})){const i=e.reverse().findIndex(ir);return e[i]||e.at(-1)}return r}function H4(r,t){return t||(r<4?10:r===4?12:r*2.5)}const X4=(r,t)=>{const e=Math.max(r,t)/2;return[["M",-r/2,0],["A",e,e,0,1,0,2*e-r/2,0],["A",e,e,0,1,0,-r/2,0],["Z"]]},SN=(r,t)=>[["M",-r/2,0],["L",r/2,-t/2],["L",r/2,t/2],["Z"]],K4=(r,t)=>[["M",-r/2,0],["L",0,-t/2],["L",r/2,0],["L",0,t/2],["Z"]],Z4=(r,t)=>[["M",-r/2,0],["L",r/2,-t/2],["L",4*r/5-r/2,0],["L",r/2,t/2],["Z"]],J4=(r,t)=>[["M",-r/2,-t/2],["L",r/2,-t/2],["L",r/2,t/2],["L",-r/2,t/2],["Z"]],Q4=(r,t)=>{const e=r/2,n=r/7,i=r-n;return[["M",-e,0],["L",0,-t/2],["L",0,t/2],["Z"],["M",i-e,-t/2],["L",i+n-e,-t/2],["L",i+n-e,t/2],["L",i-e,t/2],["Z"]]},tz=(r,t)=>[["M",r/2,-t/2],["L",-r/2,0],["L",r/2,0],["L",-r/2,0],["L",r/2,t/2]],ez=Object.freeze(Object.defineProperty({__proto__:null,circle:X4,diamond:K4,rect:J4,simple:tz,triangle:SN,triangleRect:Q4,vee:Z4},Symbol.toStringTag,{value:"Module"}));var yc=function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(e[n[i]]=r[n[i]]);return e};class ba extends oN{constructor(t){super(wn({style:ba.defaultStyleProps},t)),this.type="edge"}get sourceNode(){const{sourceNode:t}=this.parsedAttributes;return this.context.element.getElement(t)}get targetNode(){const{targetNode:t}=this.parsedAttributes;return this.context.element.getElement(t)}getKeyStyle(t){const e=this.getGraphicStyle(t),{loop:n}=e,i=yc(e,["loop"]),{sourceNode:a,targetNode:s}=this,l={d:n&&hz(a,s)?this.getLoopPath(t):this.getKeyPath(t)};return pr.PARSED_STYLE_LIST.forEach(c=>{c in i&&(l[c]=i[c])}),l}getLoopPath(t){const{sourcePort:e,targetPort:n}=t,i=this.sourceNode,a=ea(i),s=Math.max(Ei(a),Si(a)),{placement:o,clockwise:l,dist:c=s}=Ue(this.getGraphicStyle(t),"loop");return W4(i,o,l,c,e,n)}getEndpoints(t,e=!0,n=[]){const{sourcePort:i,targetPort:a}=t,{sourceNode:s,targetNode:o}=this,[l,c]=fz(s,o,i,a);if(!e){const f=l?ga(l):s.getCenter(),g=c?ga(c):o.getCenter();return[f,g]}const u=typeof n=="function"?n():n,h=fw(l||s,u[0]||c||o),d=fw(c||o,u[u.length-1]||l||s);return[h,d]}getHaloStyle(t){if(t.halo===!1)return!1;const e=this.getKeyStyle(t),n=Ue(this.getGraphicStyle(t),"halo");return Object.assign(Object.assign({},e),n)}getLabelStyle(t){if(t.label===!1||!t.labelText)return!1;const e=Ue(this.getGraphicStyle(t),"label"),{placement:n,offsetX:i,offsetY:a,autoRotate:s,maxWidth:o}=e,l=yc(e,["placement","offsetX","offsetY","autoRotate","maxWidth"]),c=xN(this.shapeMap.key,n,s,i,a),u=this.shapeMap.key.getLocalBounds(),h=M5([u.min,u.max],o);return Object.assign({wordWrapWidth:h},c,l)}getBadgeStyle(t){if(t.badge===!1||!t.badgeText)return!1;const e=Ue(t,"badge"),{offsetX:n,offsetY:i,placement:a}=e,s=yc(e,["offsetX","offsetY","placement"]);return Object.assign(s,B4(this.shapeMap,a,t.labelPlacement,n,i))}drawArrow(t,e){var n;const i=e==="start",s=t[e==="start"?"startArrow":"endArrow"],o=this.shapeMap.key;if(s){const l=this.getArrowStyle(t,i),[c,u,h]=i?["markerStart","markerStartOffset","startArrowOffset"]:["markerEnd","markerEndOffset","endArrowOffset"],d=o.parsedStyle[c];if(d)d.attr(l);else{const f=l.src?ul:pr,g=new f({style:l});o.style[c]=g}o.style[u]=t[h]||l.width/2+ +l.lineWidth}else{const l=i?"markerStart":"markerEnd";(n=o.style[l])===null||n===void 0||n.destroy(),o.style[l]=null}}getArrowStyle(t,e){const n=this.getShape("key").attributes,i=e?"startArrow":"endArrow",a=Ue(this.getGraphicStyle(t),i),{size:s,type:o}=a,l=yc(a,["size","type"]),[c,u]=br(H4(n.lineWidth,s)),d=(Tt(o)?o:ez[o]||SN)(c,u);return Object.assign(Ya(n,["stroke","strokeOpacity","fillOpacity"]),{width:c,height:u},Object.assign({},d&&{d,fill:o==="simple"?"":n.stroke}),l)}drawLabelShape(t,e){const n=this.getLabelStyle(t);this.upsert("label",xi,n,e)}drawHaloShape(t,e){const n=this.getHaloStyle(t);this.upsert("halo",pr,n,e)}drawBadgeShape(t,e){const n=this.getBadgeStyle(t);this.upsert("badge",Hs,n,e)}drawSourceArrow(t){this.drawArrow(t,"start")}drawTargetArrow(t){this.drawArrow(t,"end")}drawKeyShape(t,e){const n=this.getKeyStyle(t);return this.upsert("key",pr,n,e)}render(t=this.parsedAttributes,e=this){this.drawKeyShape(t,e),this.getShape("key")&&(this.drawSourceArrow(t),this.drawTargetArrow(t),this.drawLabelShape(t,e),this.drawHaloShape(t,e),this.drawBadgeShape(t,e))}onframe(){this.drawKeyShape(this.parsedAttributes,this),this.drawSourceArrow(this.parsedAttributes),this.drawTargetArrow(this.parsedAttributes),this.drawHaloShape(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this),this.drawBadgeShape(this.parsedAttributes,this)}animate(t,e){const n=super.animate(t,e);return n&&new Proxy(n,{set:(i,a,s)=>(a==="currentTime"&&Promise.resolve().then(()=>this.onframe()),Reflect.set(i,a,s))})}}ba.defaultStyleProps={badge:!0,badgeOffsetX:0,badgeOffsetY:0,badgePlacement:"suffix",isBillboard:!0,label:!0,labelAutoRotate:!0,labelIsBillboard:!0,labelMaxWidth:"80%",labelOffsetX:4,labelOffsetY:0,labelPlacement:"center",labelTextBaseline:"middle",labelWordWrap:!1,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloPointerEvents:"none",haloStrokeOpacity:.25,haloZIndex:-1,loop:!0,startArrow:!1,startArrowLineDash:0,startArrowLineJoin:"round",startArrowLineWidth:1,startArrowTransformOrigin:"center",startArrowType:"vee",endArrow:!1,endArrowLineDash:0,endArrowLineJoin:"round",endArrowLineWidth:1,endArrowTransformOrigin:"center",endArrowType:"vee",loopPlacement:"top",loopClockwise:!0};class ss extends ba{constructor(t){super(wn({style:ss.defaultStyleProps},t))}getKeyPath(t){const[e,n]=this.getEndpoints(t),{controlPoints:i,curvePosition:a,curveOffset:s}=t,o=this.getControlPoints(e,n,j4(a),z4(s),i);return wN(e,n,o)}getControlPoints(t,e,n,i,a){return(a==null?void 0:a.length)===2?a:[Cm(t,e,n[0],i[0]),Cm(t,e,n[1],i[1])]}}ss.defaultStyleProps={curvePosition:.5,curveOffset:20};class Vu extends ss{constructor(t){super(wn({style:Vu.defaultStyleProps},t))}getControlPoints(t,e,n,i){const a=e[0]-t[0];return[[t[0]+a*n[0]+i[0],t[1]],[e[0]-a*n[1]+i[1],e[1]]]}}Vu.defaultStyleProps={curvePosition:[.5,.5],curveOffset:[0,0]};class Uu extends ss{constructor(t){super(wn({style:Uu.defaultStyleProps},t))}get ref(){return this.context.model.getRootsData()[0]}getEndpoints(t){if(this.sourceNode.id===this.ref.id)return super.getEndpoints(t);const e=dn(this.ref),n=this.sourceNode.getIntersectPoint(e,!0),i=this.targetNode.getIntersectPoint(e);return[n,i]}toRadialCoordinate(t){const e=dn(this.ref),n=Ee(t,e),i=VA(fe(t,e));return[n,i]}getControlPoints(t,e,n,i){const[a,s]=this.toRadialCoordinate(t),[o]=this.toRadialCoordinate(e),l=o-a;return[[t[0]+(l*n[0]+i[0])*Math.cos(s),t[1]+(l*n[0]+i[0])*Math.sin(s)],[e[0]-(l*n[1]-i[0])*Math.cos(s),e[1]-(l*n[1]-i[0])*Math.sin(s)]]}}Uu.defaultStyleProps={curvePosition:.5,curveOffset:20};class Yu extends ss{constructor(t){super(wn({style:Yu.defaultStyleProps},t))}getControlPoints(t,e,n,i){const a=e[1]-t[1];return[[t[0],t[1]+a*n[0]+i[0]],[e[0],e[1]-a*n[1]+i[1]]]}}Yu.defaultStyleProps={curvePosition:[.5,.5],curveOffset:[0,0]};let _N=class kN extends ba{constructor(t){super(wn({style:kN.defaultStyleProps},t))}getKeyPath(t){const[e,n]=this.getEndpoints(t);return[["M",e[0],e[1]],["L",n[0],n[1]]]}};_N.defaultStyleProps={};const nz={enableObstacleAvoidance:!1,offset:10,maxAllowedDirectionChange:Math.PI/2,maximumLoops:3e3,gridSize:5,startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{right:{stepX:1,stepY:0},left:{stepX:-1,stepY:0},bottom:{stepX:0,stepY:1},top:{stepX:0,stepY:-1}},penalties:{0:0,90:0},distFunc:hu},Ai=r=>`${Math.round(r[0])}|||${Math.round(r[1])}`;function ja(r,t){const e=n=>Math.round(n/t);return St(r)?e(r):r.map(e)}function rz(r,t){const e=Math.abs(r-t);return e>Math.PI?2*Math.PI-e:e}function cw(r,t){const e=t[0]-r[0],n=t[1]-r[1];return!e&&!n?0:Math.atan2(n,e)}function MN(r,t,e,n){const i=cw(r,t),a=e[Ai(r)],o=cw(a||n,r);return rz(o,i)}const iz=(r,t)=>{const{offset:e,gridSize:n}=t,i={};return r.forEach(a=>{if(!a||a.destroyed||!a.isVisible())return;const s=ma(a.getRenderBounds(),e);for(let o=ja(s.min[0],n);o<=ja(s.max[0],n);o+=1)for(let l=ja(s.min[1],n);l<=ja(s.max[1],n);l+=1)i[`${o}|||${l}`]=!0}),i};function uw(r,t,e){return Math.min(...t.map(n=>e(r,n)))}function az(r,t,e){let n=r[0],i=e(r[0],t);for(let a=0;a<r.length;a++){const s=r[a],o=e(s,t);o<i&&(n=s,i=o)}return n}const hw=(r,t,e,n)=>{if(!t)return[r];const{directionMap:i,offset:a}=n,s=ma(t.getRenderBounds(),a),o=Object.keys(i).reduce((l,c)=>{if(e.includes(c)){const u=i[c],[h,d]=ya(s),f=[r[0]+u.stepX*h,r[1]+u.stepY*d],g=BB(s);for(let v=0;v<g.length;v++){const p=C1([r,f],g[v]);p&&FA(p,s)&&l.push(p)}}return l},[]);return Hr(r,s)||o.push(r),o.map(l=>ja(l,n.gridSize))},sz=(r,t,e,n,i,a,s)=>{const o=[];let l=[a[0]===n[0]?n[0]:r[0]*s,a[1]===n[1]?n[1]:r[1]*s];o.unshift(l);let c=r,u=t[Ai(c)];for(;u;){const f=u,g=c;MN(f,g,t,e)&&(l=[f[0]===g[0]?l[0]:f[0]*s,f[1]===g[1]?l[1]:f[1]*s],o.unshift(l)),u=t[Ai(f)],c=f}const h=i.map(f=>[f[0]*s,f[1]*s]),d=az(h,l,hu);return o.unshift(d),o};function oz(r,t,e,n){const i=Ja(r.getCenter()),a=Ja(t.getCenter()),s=Object.assign(nz,n),{gridSize:o}=s,l=s.enableObstacleAvoidance?e:[r,t],c=iz(l,s),u=ja(i,o),h=ja(a,o),d=hw(i,r,s.startDirections,s),f=hw(a,t,s.endDirections,s);d.forEach(T=>delete c[Ai(T)]),f.forEach(T=>delete c[Ai(T)]);const g={},v={},p={},y={},m={},x=new lz;for(let T=0;T<d.length;T++){const N=d[T],P=Ai(N);g[P]=N,y[P]=0,m[P]=uw(N,f,s.distFunc),x.add({id:P,value:m[P]})}const E=f.map(T=>Ai(T));let _=s.maximumLoops,M,O=1/0;for(const[T,N]of Object.entries(g))m[T]<=O&&(O=m[T],M=N);for(;Object.keys(g).length>0&&_>0;){const T=x.minId(!1);if(T)M=g[T];else break;const N=Ai(M);if(E.includes(N))return sz(M,p,u,a,d,h,o);delete g[N],x.remove(N),v[N]=!0;for(const P of Object.values(s.directionMap)){const C=qt(M,[P.stepX,P.stepY]),R=Ai(C);if(v[R])continue;const I=MN(M,C,p,u);if(I>s.maxAllowedDirectionChange||c[R])continue;g[R]||(g[R]=C);const j=s.penalties[I],G=s.distFunc(M,C)+(isNaN(j)?o:j),H=y[N]+G,Z=y[R];Z&&H>=Z||(p[R]=M,y[R]=H,m[R]=H+uw(C,f,s.distFunc),x.add({id:R,value:m[R]}))}_-=1}return[]}class lz{constructor(){this.arr=[],this.map={},this.arr=[],this.map={}}_innerAdd(t,e){let n=0,i=e-1;for(;i-n>1;){const a=Math.floor((n+i)/2);if(this.arr[a].value>t.value)i=a;else if(this.arr[a].value<t.value)n=a;else{this.arr.splice(a,0,t),this.map[t.id]=!0;return}}this.arr.splice(i,0,t),this.map[t.id]=!0}add(t){delete this.map[t.id];const e=this.arr.length;if(!e||this.arr[e-1].value<t.value){this.arr.push(t),this.map[t.id]=!0;return}this._innerAdd(t,e)}remove(t){this.map[t]&&delete this.map[t]}_clearAndGetMinId(){let t;for(let e=this.arr.length-1;e>=0;e--)this.map[this.arr[e].id]?t=this.arr[e].id:this.arr.splice(e,1);return t}_findFirstId(){for(;this.arr.length;){const t=this.arr.shift();if(this.map[t.id])return t.id}}minId(t){return t?this._clearAndGetMinId():this._findFirstId()}}class Hu extends ba{constructor(t){super(wn({style:Hu.defaultStyleProps},t))}getControlPoints(t){const{router:e}=t,{sourceNode:n,targetNode:i}=this,[a,s]=this.getEndpoints(t,!1);let o=[];if(!e)o=t.controlPoints;else if(e.type==="shortest-path"){const l=this.context.element.getNodes();o=oz(n,i,l,e),o.length||(o=iw(a,s,n,i,t.controlPoints,{padding:e.offset}))}else e.type==="orth"&&(o=iw(a,s,n,i,t.controlPoints,e));return o}getPoints(t){const e=this.getControlPoints(t),[n,i]=this.getEndpoints(t,!0,e);return[n,...e,i]}getKeyPath(t){const e=this.getPoints(t);return z1(e,t.radius)}getLoopPath(t){const{sourcePort:e,targetPort:n,radius:i}=t,a=this.sourceNode,s=ea(a),o=Math.max(Ei(s),Si(s))/4,{placement:l,clockwise:c,dist:u=o}=Ue(this.getGraphicStyle(t),"loop");return U4(a,i,l,c,u,e,n)}}Hu.defaultStyleProps={radius:0,controlPoints:[],router:!1};class Xu extends ba{constructor(t){super(wn({style:Xu.defaultStyleProps},t))}getKeyPath(t){const{curvePosition:e,curveOffset:n}=t,[i,a]=this.getEndpoints(t),s=t.controlPoint||Cm(i,a,e,n);return q4(i,a,s)}}Xu.defaultStyleProps={curvePosition:.5,curveOffset:30};var cz=function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(e[n[i]]=r[n[i]]);return e};function pl(r){return r instanceof Zr&&r.type==="node"}function TN(r){return r instanceof ba}function j1(r){return r instanceof Xs}function uz(r){return pl(r)||TN(r)||j1(r)}function hz(r,t){return!r||!t?!1:r===t}const dz={top:[.5,0],right:[1,.5],bottom:[.5,1],left:[0,.5],"left-top":[0,0],"top-left":[0,0],"left-bottom":[0,1],"bottom-left":[0,1],"right-top":[1,0],"top-right":[1,0],"right-bottom":[1,1],"bottom-right":[1,1],default:[.5,.5]};function q1(r,t,e=dz,n=!0){const i=[.5,.5],a=ae(t)?Mn(e,t.toLocaleLowerCase(),i):t;if(!n&&ae(t))return a;const[s,o]=a||i;return[r.min[0]+Ei(r)*s,r.min[1]+Si(r)*o]}function G1(r){if(!r)return{};const t=r.getPorts();return(r.attributes.ports||[]).forEach((n,i)=>{var a;const{key:s,placement:o}=n;ON(n)&&(t[a=s||i]||(t[a]=Pi(r.getShape("key").getBounds(),o)))}),t}function ON(r){const{r:t}=r;return!t||Number(t)===0}function ga(r){return $s(r)?r:r.getPosition()}function fz(r,t,e,n){const i=dw(r,t,e,n),a=dw(t,r,n,e);return[i,a]}function dw(r,t,e,n){const i=G1(r);if(e)return i[e];const a=Object.values(i);if(a.length===0)return;const s=a.map(c=>ga(c)),o=gz(t,n),[l]=v5(s,o);return a.find(c=>ga(c)===l)}function gz(r,t){const e=G1(r);if(t)return[ga(e[t])];const n=Object.values(e);return n.length>0?n.map(i=>ga(i)):[r.getCenter()]}function fw(r,t){return j1(r)||pl(r)?Lm(r,t):Zo(r,t)}function Zo(r,t){if(!r||!t)return[0,0,0];if($s(r))return r;if(r.attributes.linkToCenter)return r.getPosition();const e=$s(t)?t:pl(t)?t.getCenter():t.getPosition();return Bu(e,r.getBounds())}function Lm(r,t){if(!r||!t)return[0,0,0];const e=$s(t)?t:pl(t)?t.getCenter():t.getPosition();return r.getIntersectPoint(e)||r.getCenter()}function gw(r,t="bottom",e=0,n=0,i=!1){const a=t.split("-"),[s,o]=Pi(r,t),[l,c]=i?["bottom","top"]:["top","bottom"],u=a.includes("top")?c:a.includes("bottom")?l:"middle",h=a.includes("left")?"right":a.includes("right")?"left":"center";return{transform:[["translate",s+e,o+n]],textBaseline:u,textAlign:h}}function vz(r,t){return[[0,-r],[t*Math.cos(3*Math.PI/10),-t*Math.sin(3*Math.PI/10)],[r*Math.cos(Math.PI/10),-r*Math.sin(Math.PI/10)],[t*Math.cos(Math.PI/10),t*Math.sin(Math.PI/10)],[r*Math.cos(3*Math.PI/10),r*Math.sin(3*Math.PI/10)],[0,t],[-r*Math.cos(3*Math.PI/10),r*Math.sin(3*Math.PI/10)],[-t*Math.cos(Math.PI/10),t*Math.sin(Math.PI/10)],[-r*Math.cos(Math.PI/10),-r*Math.sin(Math.PI/10)],[-t*Math.cos(3*Math.PI/10),-t*Math.sin(3*Math.PI/10)]]}function pz(r,t){const e={};return e.top=[0,-r],e.left=[-r*Math.cos(Math.PI/10),-r*Math.sin(Math.PI/10)],e["left-bottom"]=[-r*Math.cos(3*Math.PI/10),r*Math.sin(3*Math.PI/10)],e.bottom=[0,t],e["right-bottom"]=[r*Math.cos(3*Math.PI/10),r*Math.sin(3*Math.PI/10)],e.right=e.default=[r*Math.cos(Math.PI/10),-r*Math.sin(Math.PI/10)],e}function yz(r,t,e){const n=t/2,i=r/2,a={up:[[-i,n],[i,n],[0,-n]],left:[[-i,0],[i,n],[i,-n]],right:[[-i,n],[-i,-n],[i,0]],down:[[-i,-n],[i,-n],[0,n]]};return a[e]||a.up}function mz(r,t,e){const n=t/2,i=r/2,a={};return e==="down"?(a.bottom=a.default=[0,n],a.right=[i,-n],a.left=[-i,-n]):e==="left"?(a.top=[i,-n],a.bottom=[i,n],a.left=a.default=[-i,0]):e==="right"?(a.top=[-i,-n],a.bottom=[-i,n],a.right=a.default=[i,0]):(a.left=[-i,n],a.top=a.default=[0,-n],a.right=[i,n]),a}function bz(r,t){return[[0,-t/2],[r/2,0],[0,t/2],[-r/2,0]]}function AN(r){return Mn(r,["style","visibility"])!=="hidden"}function xz(r,t){const{zIndex:e,transform:n,transformOrigin:i,visibility:a,cursor:s,clipPath:o,component:l}=t,c=cz(t,["zIndex","transform","transformOrigin","visibility","cursor","clipPath","component"]);Object.assign(r.attributes,c),n&&r.setAttribute("transform",n),St(e)&&r.setAttribute("zIndex",e),i&&r.setAttribute("transformOrigin",i),a&&r.setAttribute("visibility",a),s&&r.setAttribute("cursor",s),o&&r.setAttribute("clipPath",o),l&&r.setAttribute("component",l)}function Im(r,t){"update"in r?r.update(t):r.attr(t)}function wz(r){return[[0,r],[r*Math.sqrt(3)/2,r/2],[r*Math.sqrt(3)/2,-r/2],[0,-r],[-r*Math.sqrt(3)/2,-r/2],[-r*Math.sqrt(3)/2,r/2]]}function Ez(r){Go(r,"__to_be_destroyed__",!0)}function yl(r){return Mn(r,"__to_be_destroyed__",!1)}var Sz=function(r,t,e,n){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((n=n.apply(r,t||[])).next())})};class Ku extends wr{constructor(t,e){super(t,Object.assign({},Ku.defaultOptions,e)),this.onCollapseExpand=n=>Sz(this,void 0,void 0,function*(){if(!this.validate(n))return;const{target:i}=n;if(!uz(i))return;const a=i.id,{model:s,graph:o}=this.context,l=s.getElementDataById(a);if(!l)return!1;const{onCollapse:c,onExpand:u,animation:h,align:d}=this.options;ir(l)?(yield o.expandElement(a,{animation:h,align:d}),u==null||u(a)):(yield o.collapseElement(a,{animation:h,align:d}),c==null||c(a))}),this.bindEvents()}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){const{graph:t}=this.context,{trigger:e}=this.options;t.on(`node:${e}`,this.onCollapseExpand),t.on(`combo:${e}`,this.onCollapseExpand)}unbindEvents(){const{graph:t}=this.context,{trigger:e}=this.options;t.off(`node:${e}`,this.onCollapseExpand),t.off(`combo:${e}`,this.onCollapseExpand)}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return Tt(e)?e(t):!!e}destroy(){this.unbindEvents(),super.destroy()}}Ku.defaultOptions={enable:!0,animation:!0,trigger:rt.DBLCLICK,align:!0};var mc=function(r,t,e,n){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((n=n.apply(r,t||[])).next())})};const _z="g6-create-edge-assist-edge-id",bc="g6-create-edge-assist-node-id";class Zu extends wr{constructor(t,e){super(t,Object.assign({},Zu.defaultOptions,e)),this.drop=n=>mc(this,void 0,void 0,function*(){const{targetType:i}=n;["combo","node"].includes(i)&&this.source?yield this.handleCreateEdge(n):yield this.cancelEdge()}),this.handleCreateEdge=n=>mc(this,void 0,void 0,function*(){var i,a,s;if(!this.validate(n))return;const{graph:o,canvas:l,batch:c,element:u}=this.context,{style:h}=this.options;if(this.source){this.createEdge(n),yield this.cancelEdge();return}c.startBatch(),l.setCursor("crosshair"),this.source=this.getSelectedNodeIDs([n.target.id])[0];const d=o.getElementData(this.source);o.addNodeData([{id:bc,style:{visibility:"hidden",ports:[{key:"port-1",placement:[.5,.5]}],x:(i=d.style)===null||i===void 0?void 0:i.x,y:(a=d.style)===null||a===void 0?void 0:a.y}}]),o.addEdgeData([{id:_z,source:this.source,target:bc,style:Object.assign({pointerEvents:"none"},h)}]),yield(s=u.draw({animation:!1}))===null||s===void 0?void 0:s.finished}),this.updateAssistEdge=n=>mc(this,void 0,void 0,function*(){var i;if(!this.source)return;const{model:a,element:s}=this.context;a.translateNodeTo(bc,[n.canvas.x,n.canvas.y]),yield(i=s.draw({animation:!1,silence:!0}))===null||i===void 0?void 0:i.finished}),this.createEdge=n=>{var i,a;const{graph:s}=this.context,{style:o,onFinish:l,onCreate:c}=this.options;if(((i=n.target)===null||i===void 0?void 0:i.id)===void 0||this.source===void 0)return;const h=(a=this.getSelectedNodeIDs([n.target.id]))===null||a===void 0?void 0:a[0],d=`${this.source}-${h}-${rL()}`,f=c({id:d,source:this.source,target:h,style:o});f&&(s.addEdgeData([f]),l(f))},this.cancelEdge=()=>mc(this,void 0,void 0,function*(){var n;if(!this.source)return;const{graph:i,element:a,batch:s}=this.context;i.removeNodeData([bc]),this.source=void 0,yield(n=a.draw({animation:!1}))===null||n===void 0?void 0:n.finished,s.endBatch()}),this.bindEvents()}update(t){super.update(t),this.bindEvents()}bindEvents(){const{graph:t}=this.context,{trigger:e}=this.options;this.unbindEvents(),e==="click"?(t.on(Cr.CLICK,this.handleCreateEdge),t.on(Ba.CLICK,this.handleCreateEdge),t.on(Bi.CLICK,this.cancelEdge),t.on(cu.CLICK,this.cancelEdge)):(t.on(Cr.DRAG_START,this.handleCreateEdge),t.on(Ba.DRAG_START,this.handleCreateEdge),t.on(rt.POINTER_UP,this.drop)),t.on(rt.POINTER_MOVE,this.updateAssistEdge)}getSelectedNodeIDs(t){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map(e=>e.id).concat(t)))}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return Tt(e)?e(t):!!e}unbindEvents(){const{graph:t}=this.context;t.off(Cr.CLICK,this.handleCreateEdge),t.off(Ba.CLICK,this.handleCreateEdge),t.off(Bi.CLICK,this.cancelEdge),t.off(cu.CLICK,this.cancelEdge),t.off(Cr.DRAG_START,this.handleCreateEdge),t.off(Ba.DRAG_START,this.handleCreateEdge),t.off(rt.POINTER_UP,this.drop),t.off(rt.POINTER_MOVE,this.updateAssistEdge)}destroy(){this.unbindEvents(),super.destroy()}}Zu.defaultOptions={animation:!0,enable:!0,style:{},trigger:"drag",onCreate:r=>r,onFinish:()=>{}};var vw=function(r,t,e,n){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((n=n.apply(r,t||[])).next())})};class Ju extends wr{constructor(t,e){super(t,Object.assign({},Ju.defaultOptions,e)),this.isDragging=!1,this.onDragStart=n=>{this.validate(n)&&(this.isDragging=!0,this.context.canvas.setCursor("grabbing"))},this.onDrag=n=>{var i,a,s,o;if(!this.isDragging||Ke.isPinching)return;const l=(a=(i=n.movement)===null||i===void 0?void 0:i.x)!==null&&a!==void 0?a:n.dx,c=(o=(s=n.movement)===null||s===void 0?void 0:s.y)!==null&&o!==void 0?o:n.dy;(l|c)!==0&&this.translate([l,c],!1)},this.onDragEnd=()=>{var n,i;this.isDragging=!1,this.context.canvas.setCursor(this.defaultCursor),(i=(n=this.options).onFinish)===null||i===void 0||i.call(n)},this.invokeOnFinish=al(()=>{var n,i;(i=(n=this.options).onFinish)===null||i===void 0||i.call(n)},300),this.shortcut=new Ys(t.graph),this.bindEvents(),this.defaultCursor=this.context.canvas.getConfig().cursor||"default"}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){const{trigger:t}=this.options;if(Ze(t)){const{up:e=[],down:n=[],left:i=[],right:a=[]}=t;this.shortcut.bind(e,s=>this.onTranslate([0,1],s)),this.shortcut.bind(n,s=>this.onTranslate([0,-1],s)),this.shortcut.bind(i,s=>this.onTranslate([1,0],s)),this.shortcut.bind(a,s=>this.onTranslate([-1,0],s))}else{const{graph:e}=this.context;e.on(rt.DRAG_START,this.onDragStart),e.on(rt.DRAG,this.onDrag),e.on(rt.DRAG_END,this.onDragEnd)}}onTranslate(t,e){return vw(this,void 0,void 0,function*(){if(!this.validate(e))return;const{sensitivity:n}=this.options,i=n*-1;yield this.translate(Wr(t,i),this.options.animation),this.invokeOnFinish()})}translate(t,e){return vw(this,void 0,void 0,function*(){t=this.clampByDirection(t),t=this.clampByRange(t),t=this.clampByRotation(t),yield this.context.graph.translateBy(t,e)})}clampByRotation([t,e]){const n=this.context.graph.getRotation();return UA([t,e],n)}clampByDirection([t,e]){const{direction:n}=this.options;return n==="x"?e=0:n==="y"&&(t=0),[t,e]}clampByRange([t,e]){const{viewport:n,canvas:i}=this.context,[a,s]=i.getSize(),[o,l,c,u]=Lr(this.options.range),h=[s*o,a*l,s*c,a*u],d=ma(T1(n.getCanvasCenter()),h),f=fe(n.getViewportCenter(),[t,e,0]);if(!Hr(f,d)){const{min:[g,v],max:[p,y]}=d;(f[0]<g&&t>0||f[0]>p&&t<0)&&(t=0),(f[1]<v&&e>0||f[1]>y&&e<0)&&(e=0)}return[t,e]}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return typeof e=="function"?e(t):!!e}unbindEvents(){this.shortcut.unbindAll();const{graph:t}=this.context;t.off(rt.DRAG_START,this.onDragStart),t.off(rt.DRAG,this.onDrag),t.off(rt.DRAG_END,this.onDragEnd)}destroy(){this.shortcut.destroy(),this.unbindEvents(),this.context.canvas.setCursor(this.defaultCursor),super.destroy()}}Ju.defaultOptions={enable:r=>"targetType"in r?r.targetType==="canvas":!0,sensitivity:10,direction:"both",range:1/0};var pw=function(r,t,e,n){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((n=n.apply(r,t||[])).next())})};class ml extends wr{constructor(t,e){super(t,Object.assign({},ml.defaultOptions,e)),this.enable=!1,this.enableElements=["node","combo"],this.target=[],this.shadowOrigin=[0,0],this.hiddenEdges=[],this.isDragging=!1,this.onDrop=n=>pw(this,void 0,void 0,function*(){var i;if(this.options.dropEffect!=="link")return;const{model:a,element:s}=this.context,o=n.target.id;this.target.forEach(l=>{const c=a.getParentData(l,ge);c&&K(c)===o&&a.refreshComboData(o),a.setParent(l,o,ge)}),yield(i=s==null?void 0:s.draw({animation:!0}))===null||i===void 0?void 0:i.finished}),this.setCursor=n=>{if(this.isDragging)return;const{type:i}=n,{canvas:a}=this.context,{cursor:s}=this.options;i===rt.POINTER_ENTER?a.setCursor((s==null?void 0:s.grab)||"grab"):a.setCursor((s==null?void 0:s.default)||"default")},this.onDragStart=this.onDragStart.bind(this),this.onDrag=this.onDrag.bind(this),this.onDragEnd=this.onDragEnd.bind(this),this.onDrop=this.onDrop.bind(this),this.bindEvents()}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){const{graph:t,canvas:e}=this.context,n=e.getLayer().getContextService().$canvas;n&&(n.addEventListener("blur",this.onDragEnd),n.addEventListener("contextmenu",this.onDragEnd)),this.enableElements.forEach(i=>{t.on(`${i}:${rt.DRAG_START}`,this.onDragStart),t.on(`${i}:${rt.DRAG}`,this.onDrag),t.on(`${i}:${rt.DRAG_END}`,this.onDragEnd),t.on(`${i}:${rt.POINTER_ENTER}`,this.setCursor),t.on(`${i}:${rt.POINTER_LEAVE}`,this.setCursor)}),["link"].includes(this.options.dropEffect)&&(t.on(Ba.DROP,this.onDrop),t.on(Bi.DROP,this.onDrop))}getSelectedNodeIDs(t){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map(e=>e.id).concat(t)))}getDelta(t){const e=this.context.graph.getZoom();return Xr([t.dx,t.dy],e)}onDragStart(t){var e;if(this.enable=this.validate(t),!this.enable)return;const{batch:n,canvas:i,graph:a}=this.context;i.setCursor(((e=this.options.cursor)===null||e===void 0?void 0:e.grabbing)||"grabbing"),this.isDragging=!0,n.startBatch();const s=t.target.id;a.getElementState(s).includes(this.options.state)?this.target=this.getSelectedNodeIDs([s]):this.target=[s],this.hideEdge(),this.context.graph.frontElement(this.target),this.options.shadow&&this.createShadow(this.target)}onDrag(t){if(!this.enable)return;const e=this.getDelta(t);this.options.shadow?this.moveShadow(e):this.moveElement(this.target,e)}onDragEnd(){var t,e,n;if(!this.enable)return;if(this.enable=!1,this.options.shadow){if(!this.shadow)return;this.shadow.style.visibility="hidden";const{x:s=0,y:o=0}=this.shadow.attributes,[l,c]=fe([+s,+o],this.shadowOrigin);this.moveElement(this.target,[l,c])}this.showEdges(),(e=(t=this.options).onFinish)===null||e===void 0||e.call(t,this.target);const{batch:i,canvas:a}=this.context;i.endBatch(),a.setCursor(((n=this.options.cursor)===null||n===void 0?void 0:n.grab)||"grab"),this.isDragging=!1,this.target=[]}validate(t){if(this.destroyed||yl(t.target)||this.context.graph.isCollapsingExpanding)return!1;const{enable:e}=this.options;return Tt(e)?e(t):!!e}clampByRotation([t,e]){const n=this.context.graph.getRotation();return UA([t,e],n)}moveElement(t,e){return pw(this,void 0,void 0,function*(){const{graph:n,model:i}=this.context,{dropEffect:a}=this.options;a==="move"&&t.forEach(s=>i.refreshComboData(s)),n.translateElementBy(Object.fromEntries(t.map(s=>[s,this.clampByRotation(e)])),!1)})}moveShadow(t){if(!this.shadow)return;const{x:e=0,y:n=0}=this.shadow.attributes,[i,a]=t;this.shadow.attr({x:+e+i,y:+n+a})}createShadow(t){const e=Ue(this.options,"shadow"),n=hl(t.map(c=>this.context.element.getElement(c).getBounds())),[i,a]=n.min;this.shadowOrigin=[i,a];const[s,o]=ya(n),l={width:s,height:o,x:i,y:a};this.shadow?this.shadow.attr(Object.assign(Object.assign(Object.assign({},e),l),{visibility:"visible"})):(this.shadow=new Nn({style:Object.assign(Object.assign(Object.assign({$layer:"transient"},e),l),{pointerEvents:"none"})}),this.context.canvas.appendChild(this.shadow))}showEdges(){this.options.shadow||this.hiddenEdges.length===0||(this.context.graph.showElement(this.hiddenEdges),this.hiddenEdges=[])}hideEdge(){const{hideEdge:t,shadow:e}=this.options;if(t==="none"||e)return;const{graph:n}=this.context;t==="all"?this.hiddenEdges=n.getEdgeData().map(K):this.hiddenEdges=Array.from(new Set(this.target.map(i=>n.getRelatedEdgesData(i,t).map(K)).flat())),n.hideElement(this.hiddenEdges)}unbindEvents(){const{graph:t,canvas:e}=this.context,n=e.getLayer().getContextService().$canvas;n&&(n.removeEventListener("blur",this.onDragEnd),n.removeEventListener("contextmenu",this.onDragEnd)),this.enableElements.forEach(i=>{t.off(`${i}:${rt.DRAG_START}`,this.onDragStart),t.off(`${i}:${rt.DRAG}`,this.onDrag),t.off(`${i}:${rt.DRAG_END}`,this.onDragEnd),t.off(`${i}:${rt.POINTER_ENTER}`,this.setCursor),t.off(`${i}:${rt.POINTER_LEAVE}`,this.setCursor)}),t.off(`combo:${rt.DROP}`,this.onDrop),t.off(`canvas:${rt.DROP}`,this.onDrop)}destroy(){var t;this.unbindEvents(),(t=this.shadow)===null||t===void 0||t.destroy(),super.destroy()}}ml.defaultOptions={animation:!0,enable:r=>["node","combo"].includes(r.targetType),dropEffect:"move",state:"selected",hideEdge:"none",shadow:!1,shadowZIndex:100,shadowFill:"#F3F9FF",shadowFillOpacity:.5,shadowStroke:"#1890FF",shadowStrokeOpacity:.9,shadowLineDash:[5,5],cursor:{default:"default",grab:"grab",grabbing:"grabbing"}};var kz="*",Qu=(function(){function r(){this._events={}}return r.prototype.on=function(t,e,n){return this._events[t]||(this._events[t]=[]),this._events[t].push({callback:e,once:!!n}),this},r.prototype.once=function(t,e){return this.on(t,e,!0)},r.prototype.emit=function(t){for(var e=this,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var a=this._events[t]||[],s=this._events[kz]||[],o=function(l){for(var c=l.length,u=0;u<c;u++)if(l[u]){var h=l[u],d=h.callback,f=h.once;f&&(l.splice(u,1),l.length===0&&delete e._events[t],c--,u--),d.apply(e,n)}};o(a),o(s)},r.prototype.off=function(t,e){if(!t)this._events={};else if(!e)delete this._events[t];else{for(var n=this._events[t]||[],i=n.length,a=0;a<i;a++)n[a].callback===e&&(n.splice(a,1),i--,a--);n.length===0&&delete this._events[t]}return this},r.prototype.getEvents=function(){return this._events},r})();function Dm(r,t,e,n){for(;r.length;){const i=r.shift();if(e(i))return!0;t.add(i.id),n(i.id).forEach(s=>{t.has(s.id)||(t.add(s.id),r.push(s))})}return!1}function yu(r,t,e,n){if(e(r))return!0;t.add(r.id);for(const a of n(r.id))if(!t.has(a.id)&&yu(a,t,e,n))return!0;return!1}const yw=()=>!0;class Mz{constructor(t){Me(this,"graph");Me(this,"nodeFilter");Me(this,"edgeFilter");Me(this,"cacheEnabled");Me(this,"inEdgesMap",new Map);Me(this,"outEdgesMap",new Map);Me(this,"bothEdgesMap",new Map);Me(this,"allNodesMap",new Map);Me(this,"allEdgesMap",new Map);Me(this,"clearCache",()=>{this.inEdgesMap.clear(),this.outEdgesMap.clear(),this.bothEdgesMap.clear(),this.allNodesMap.clear(),this.allEdgesMap.clear()});Me(this,"refreshCache",()=>{this.clearCache(),this.updateCache(this.graph.getAllNodes().map(t=>t.id))});Me(this,"updateCache",t=>{const e=new Set;t.forEach(n=>{const i=this.bothEdgesMap.get(n);if(i&&i.forEach(a=>e.add(a.id)),!this.hasNode(n))this.inEdgesMap.delete(n),this.outEdgesMap.delete(n),this.bothEdgesMap.delete(n),this.allNodesMap.delete(n);else{const a=this.graph.getRelatedEdges(n,"in").filter(this.edgeFilter),s=this.graph.getRelatedEdges(n,"out").filter(this.edgeFilter),o=Array.from(new Set([...a,...s]));o.forEach(l=>e.add(l.id)),this.inEdgesMap.set(n,a),this.outEdgesMap.set(n,s),this.bothEdgesMap.set(n,o),this.allNodesMap.set(n,this.graph.getNode(n))}}),e.forEach(n=>{this.hasEdge(n)?this.allEdgesMap.set(n,this.graph.getEdge(n)):this.allEdgesMap.delete(n)})});Me(this,"handleGraphChanged",t=>{const e=new Set;t.changes.forEach(n=>{switch(n.type){case"NodeAdded":e.add(n.value.id);break;case"NodeDataUpdated":e.add(n.id);break;case"EdgeAdded":e.add(n.value.source),e.add(n.value.target);break;case"EdgeUpdated":(n.propertyName==="source"||n.propertyName==="target")&&(e.add(n.oldValue),e.add(n.newValue));break;case"EdgeDataUpdated":if(t.graph.hasEdge(n.id)){const i=t.graph.getEdge(n.id);e.add(i.source),e.add(i.target)}break;case"EdgeRemoved":e.add(n.value.source),e.add(n.value.target);break;case"NodeRemoved":e.add(n.value.id);break}}),this.updateCache(e)});this.graph=t.graph;const e=t.nodeFilter||yw,n=t.edgeFilter||yw;this.nodeFilter=e,this.edgeFilter=i=>{const{source:a,target:s}=this.graph.getEdgeDetail(i.id);return!e(a)||!e(s)?!1:n(i,a,s)},t.cache==="auto"?(this.cacheEnabled=!0,this.startAutoCache()):t.cache==="manual"?this.cacheEnabled=!0:this.cacheEnabled=!1}startAutoCache(){this.refreshCache(),this.graph.on("changed",this.handleGraphChanged)}stopAutoCache(){this.graph.off("changed",this.handleGraphChanged)}checkNodeExistence(t){this.getNode(t)}hasNode(t){if(!this.graph.hasNode(t))return!1;const e=this.graph.getNode(t);return this.nodeFilter(e)}areNeighbors(t,e){return this.checkNodeExistence(t),this.getNeighbors(e).some(n=>n.id===t)}getNode(t){const e=this.graph.getNode(t);if(!this.nodeFilter(e))throw new Error("Node not found for id: "+t);return e}getRelatedEdges(t,e){return this.checkNodeExistence(t),this.cacheEnabled?e==="in"?this.inEdgesMap.get(t):e==="out"?this.outEdgesMap.get(t):this.bothEdgesMap.get(t):this.graph.getRelatedEdges(t,e).filter(this.edgeFilter)}getDegree(t,e){return this.getRelatedEdges(t,e).length}getSuccessors(t){const n=this.getRelatedEdges(t,"out").map(i=>this.getNode(i.target));return Array.from(new Set(n))}getPredecessors(t){const n=this.getRelatedEdges(t,"in").map(i=>this.getNode(i.source));return Array.from(new Set(n))}getNeighbors(t){const e=this.getPredecessors(t),n=this.getSuccessors(t);return Array.from(new Set([...e,...n]))}hasEdge(t){if(!this.graph.hasEdge(t))return!1;const e=this.graph.getEdge(t);return this.edgeFilter(e)}getEdge(t){const e=this.graph.getEdge(t);if(!this.edgeFilter(e))throw new Error("Edge not found for id: "+t);return e}getEdgeDetail(t){const e=this.getEdge(t);return{edge:e,source:this.getNode(e.source),target:this.getNode(e.target)}}hasTreeStructure(t){return this.graph.hasTreeStructure(t)}getRoots(t){return this.graph.getRoots(t).filter(this.nodeFilter)}getChildren(t,e){return this.checkNodeExistence(t),this.graph.getChildren(t,e).filter(this.nodeFilter)}getParent(t,e){this.checkNodeExistence(t);const n=this.graph.getParent(t,e);return!n||!this.nodeFilter(n)?null:n}getAllNodes(){return this.cacheEnabled?Array.from(this.allNodesMap.values()):this.graph.getAllNodes().filter(this.nodeFilter)}getAllEdges(){return this.cacheEnabled?Array.from(this.allEdgesMap.values()):this.graph.getAllEdges().filter(this.edgeFilter)}bfs(t,e,n="out"){const i={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];Dm([this.getNode(t)],new Set,e,i)}dfs(t,e,n="out"){const i={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];yu(this.getNode(t),new Set,e,i)}}let vn=class NN extends Qu{constructor(e){super();Me(this,"nodeMap",new Map);Me(this,"edgeMap",new Map);Me(this,"inEdgesMap",new Map);Me(this,"outEdgesMap",new Map);Me(this,"bothEdgesMap",new Map);Me(this,"treeIndices",new Map);Me(this,"changes",[]);Me(this,"batchCount",0);Me(this,"onChanged",()=>{});Me(this,"batch",e=>{this.batchCount+=1,e(),this.batchCount-=1,this.batchCount||this.commit()});e&&(e.nodes&&this.addNodes(e.nodes),e.edges&&this.addEdges(e.edges),e.tree&&this.addTree(e.tree),e.onChanged&&(this.onChanged=e.onChanged))}commit(){const e=this.changes;this.changes=[];const n={graph:this,changes:e};this.emit("changed",n),this.onChanged(n)}reduceChanges(e){let n=[];return e.forEach(i=>{switch(i.type){case"NodeRemoved":{let a=!1;n=n.filter(s=>{if(s.type==="NodeAdded"){const o=s.value.id===i.value.id;return o&&(a=!0),!o}else{if(s.type==="NodeDataUpdated")return s.id!==i.value.id;if(s.type==="TreeStructureChanged")return s.nodeId!==i.value.id}return!0}),a||n.push(i);break}case"EdgeRemoved":{let a=!1;n=n.filter(s=>{if(s.type==="EdgeAdded"){const o=s.value.id===i.value.id;return o&&(a=!0),!o}else if(s.type==="EdgeDataUpdated"||s.type==="EdgeUpdated")return s.id!==i.value.id;return!0}),a||n.push(i);break}case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":{const a=n.findIndex(o=>o.type===i.type&&o.id===i.id&&(i.propertyName===void 0||o.propertyName===i.propertyName)),s=n[a];s?i.propertyName!==void 0?s.newValue=i.newValue:(n.splice(a,1),n.push(i)):n.push(i);break}case"TreeStructureDetached":{n=n.filter(a=>a.type==="TreeStructureAttached"||a.type==="TreeStructureChanged"?a.treeKey!==i.treeKey:!0),n.push(i);break}case"TreeStructureChanged":{const a=n.find(s=>s.type==="TreeStructureChanged"&&s.treeKey===i.treeKey&&s.nodeId===i.nodeId);a?a.newParentId=i.newParentId:n.push(i);break}default:n.push(i);break}}),n}checkNodeExistence(e){this.getNode(e)}hasNode(e){return this.nodeMap.has(e)}areNeighbors(e,n){return this.getNeighbors(n).some(i=>i.id===e)}getNode(e){const n=this.nodeMap.get(e);if(!n)throw new Error("Node not found for id: "+e);return n}getRelatedEdges(e,n){if(this.checkNodeExistence(e),n==="in"){const i=this.inEdgesMap.get(e);return Array.from(i)}else if(n==="out"){const i=this.outEdgesMap.get(e);return Array.from(i)}else{const i=this.bothEdgesMap.get(e);return Array.from(i)}}getDegree(e,n){return this.getRelatedEdges(e,n).length}getSuccessors(e){const i=this.getRelatedEdges(e,"out").map(a=>this.getNode(a.target));return Array.from(new Set(i))}getPredecessors(e){const i=this.getRelatedEdges(e,"in").map(a=>this.getNode(a.source));return Array.from(new Set(i))}getNeighbors(e){const n=this.getPredecessors(e),i=this.getSuccessors(e);return Array.from(new Set([...n,...i]))}doAddNode(e){if(this.hasNode(e.id))throw new Error("Node already exists: "+e.id);this.nodeMap.set(e.id,e),this.inEdgesMap.set(e.id,new Set),this.outEdgesMap.set(e.id,new Set),this.bothEdgesMap.set(e.id,new Set),this.treeIndices.forEach(n=>{n.childrenMap.set(e.id,new Set)}),this.changes.push({type:"NodeAdded",value:e})}addNodes(e){this.batch(()=>{for(const n of e)this.doAddNode(n)})}addNode(e){this.addNodes([e])}doRemoveNode(e){const n=this.getNode(e),i=this.bothEdgesMap.get(e);i==null||i.forEach(a=>this.doRemoveEdge(a.id)),this.nodeMap.delete(e),this.treeIndices.forEach(a=>{var o,l;(o=a.childrenMap.get(e))==null||o.forEach(c=>{a.parentMap.delete(c.id)});const s=a.parentMap.get(e);s&&((l=a.childrenMap.get(s.id))==null||l.delete(n)),a.parentMap.delete(e),a.childrenMap.delete(e)}),this.bothEdgesMap.delete(e),this.inEdgesMap.delete(e),this.outEdgesMap.delete(e),this.changes.push({type:"NodeRemoved",value:n})}removeNodes(e){this.batch(()=>{e.forEach(n=>this.doRemoveNode(n))})}removeNode(e){this.removeNodes([e])}updateNodeDataProperty(e,n,i){const a=this.getNode(e);this.batch(()=>{const s=a.data[n],o=i;a.data[n]=o,this.changes.push({type:"NodeDataUpdated",id:e,propertyName:n,oldValue:s,newValue:o})})}mergeNodeData(e,n){this.batch(()=>{Object.entries(n).forEach(([i,a])=>{this.updateNodeDataProperty(e,i,a)})})}updateNodeData(...e){const n=e[0],i=this.getNode(n);if(typeof e[1]=="string"){this.updateNodeDataProperty(n,e[1],e[2]);return}let a;if(typeof e[1]=="function"){const s=e[1];a=s(i.data)}else typeof e[1]=="object"&&(a=e[1]);this.batch(()=>{const s=i.data,o=a;i.data=a,this.changes.push({type:"NodeDataUpdated",id:n,oldValue:s,newValue:o})})}checkEdgeExistence(e){if(!this.hasEdge(e))throw new Error("Edge not found for id: "+e)}hasEdge(e){return this.edgeMap.has(e)}getEdge(e){return this.checkEdgeExistence(e),this.edgeMap.get(e)}getEdgeDetail(e){const n=this.getEdge(e);return{edge:n,source:this.getNode(n.source),target:this.getNode(n.target)}}doAddEdge(e){if(this.hasEdge(e.id))throw new Error("Edge already exists: "+e.id);this.checkNodeExistence(e.source),this.checkNodeExistence(e.target),this.edgeMap.set(e.id,e);const n=this.inEdgesMap.get(e.target),i=this.outEdgesMap.get(e.source),a=this.bothEdgesMap.get(e.source),s=this.bothEdgesMap.get(e.target);n.add(e),i.add(e),a.add(e),s.add(e),this.changes.push({type:"EdgeAdded",value:e})}addEdges(e){this.batch(()=>{for(const n of e)this.doAddEdge(n)})}addEdge(e){this.addEdges([e])}doRemoveEdge(e){const n=this.getEdge(e),i=this.outEdgesMap.get(n.source),a=this.inEdgesMap.get(n.target),s=this.bothEdgesMap.get(n.source),o=this.bothEdgesMap.get(n.target);i.delete(n),a.delete(n),s.delete(n),o.delete(n),this.edgeMap.delete(e),this.changes.push({type:"EdgeRemoved",value:n})}removeEdges(e){this.batch(()=>{e.forEach(n=>this.doRemoveEdge(n))})}removeEdge(e){this.removeEdges([e])}updateEdgeSource(e,n){const i=this.getEdge(e);this.checkNodeExistence(n);const a=i.source,s=n;this.outEdgesMap.get(a).delete(i),this.bothEdgesMap.get(a).delete(i),this.outEdgesMap.get(s).add(i),this.bothEdgesMap.get(s).add(i),i.source=n,this.batch(()=>{this.changes.push({type:"EdgeUpdated",id:e,propertyName:"source",oldValue:a,newValue:s})})}updateEdgeTarget(e,n){const i=this.getEdge(e);this.checkNodeExistence(n);const a=i.target,s=n;this.inEdgesMap.get(a).delete(i),this.bothEdgesMap.get(a).delete(i),this.inEdgesMap.get(s).add(i),this.bothEdgesMap.get(s).add(i),i.target=n,this.batch(()=>{this.changes.push({type:"EdgeUpdated",id:e,propertyName:"target",oldValue:a,newValue:s})})}updateEdgeDataProperty(e,n,i){const a=this.getEdge(e);this.batch(()=>{const s=a.data[n],o=i;a.data[n]=o,this.changes.push({type:"EdgeDataUpdated",id:e,propertyName:n,oldValue:s,newValue:o})})}updateEdgeData(...e){const n=e[0],i=this.getEdge(n);if(typeof e[1]=="string"){this.updateEdgeDataProperty(n,e[1],e[2]);return}let a;if(typeof e[1]=="function"){const s=e[1];a=s(i.data)}else typeof e[1]=="object"&&(a=e[1]);this.batch(()=>{const s=i.data,o=a;i.data=a,this.changes.push({type:"EdgeDataUpdated",id:n,oldValue:s,newValue:o})})}mergeEdgeData(e,n){this.batch(()=>{Object.entries(n).forEach(([i,a])=>{this.updateEdgeDataProperty(e,i,a)})})}checkTreeExistence(e){if(!this.hasTreeStructure(e))throw new Error("Tree structure not found for treeKey: "+e)}hasTreeStructure(e){return this.treeIndices.has(e)}attachTreeStructure(e){this.treeIndices.has(e)||(this.treeIndices.set(e,{parentMap:new Map,childrenMap:new Map}),this.batch(()=>{this.changes.push({type:"TreeStructureAttached",treeKey:e})}))}detachTreeStructure(e){this.checkTreeExistence(e),this.treeIndices.delete(e),this.batch(()=>{this.changes.push({type:"TreeStructureDetached",treeKey:e})})}addTree(e,n){this.batch(()=>{this.attachTreeStructure(n);const i=[],a=Array.isArray(e)?e:[e];for(;a.length;){const s=a.shift();i.push(s),s.children&&a.push(...s.children)}this.addNodes(i),i.forEach(s=>{var o;(o=s.children)==null||o.forEach(l=>{this.setParent(l.id,s.id,n)})})})}getRoots(e){return this.checkTreeExistence(e),this.getAllNodes().filter(n=>!this.getParent(n.id,e))}getChildren(e,n){this.checkNodeExistence(e),this.checkTreeExistence(n);const a=this.treeIndices.get(n).childrenMap.get(e);return Array.from(a||[])}getParent(e,n){return this.checkNodeExistence(e),this.checkTreeExistence(n),this.treeIndices.get(n).parentMap.get(e)||null}getAncestors(e,n){const i=[];let a=this.getNode(e),s;for(;s=this.getParent(a.id,n);)i.push(s),a=s;return i}setParent(e,n,i){var u,h;this.checkTreeExistence(i);const a=this.treeIndices.get(i);if(!a)return;const s=this.getNode(e),o=a.parentMap.get(e);if((o==null?void 0:o.id)===n)return;if(n==null){o&&((u=a.childrenMap.get(o.id))==null||u.delete(s)),a.parentMap.delete(e);return}const l=this.getNode(n);a.parentMap.set(e,l),o&&((h=a.childrenMap.get(o.id))==null||h.delete(s));let c=a.childrenMap.get(l.id);c||(c=new Set,a.childrenMap.set(l.id,c)),c.add(s),this.batch(()=>{this.changes.push({type:"TreeStructureChanged",treeKey:i,nodeId:e,oldParentId:o==null?void 0:o.id,newParentId:l.id})})}dfsTree(e,n,i){const a=s=>this.getChildren(s,i);return yu(this.getNode(e),new Set,n,a)}bfsTree(e,n,i){const a=s=>this.getChildren(s,i);return Dm([this.getNode(e)],new Set,n,a)}getAllNodes(){return Array.from(this.nodeMap.values())}getAllEdges(){return Array.from(this.edgeMap.values())}bfs(e,n,i="out"){const a={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[i];return Dm([this.getNode(e)],new Set,n,a)}dfs(e,n,i="out"){const a={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[i];return yu(this.getNode(e),new Set,n,a)}clone(){const e=this.getAllNodes().map(a=>({...a,data:{...a.data}})),n=this.getAllEdges().map(a=>({...a,data:{...a.data}})),i=new NN({nodes:e,edges:n});return this.treeIndices.forEach(({parentMap:a,childrenMap:s},o)=>{const l=new Map;a.forEach((u,h)=>{l.set(h,i.getNode(u.id))});const c=new Map;s.forEach((u,h)=>{c.set(h,new Set(Array.from(u).map(d=>i.getNode(d.id))))}),i.treeIndices.set(o,{parentMap:l,childrenMap:c})}),i}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}createView(e){return new Mz({graph:this,...e})}};class th{constructor(t,e){this.context=t,this.options=e||{}}}var Tz=function(r,t,e,n){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((n=n.apply(r,t||[])).next())})},Oz=function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(e[n[i]]=r[n[i]]);return e};function Az(r){const{type:t}=r;return["compact-box","mindmap","dendrogram","indented"].includes(t)}function Nz(r){return!Array.isArray(r)&&(r==null?void 0:r.preLayout)}function Fc(r){const{nodes:t,edges:e}=r,n={nodes:[],edges:[],combos:[]};return t.forEach(i=>{const a=i.data._isCombo?n.combos:n.nodes,{x:s,y:o,z:l=0}=i.data;a==null||a.push({id:i.id,style:{x:s,y:o,z:l}})}),e.forEach(i=>{const{id:a,source:s,target:o,data:{points:l=[],controlPoints:c=l.slice(1,l.length-1)}}=i;n.edges.push({id:a,source:s,target:o,style:Object.assign({},c!=null&&c.length?{controlPoints:c.map(On)}:{})})}),n}function Pz(r,t){class e extends th{constructor(i,a){if(super(i,a),this.instance=new r({}),this.id=this.instance.id,"stop"in this.instance&&"tick"in this.instance){const s=this.instance;this.stop=s.stop.bind(s),this.tick=o=>{const l=s.tick(o);return Fc(l)}}}execute(i,a){return Tz(this,void 0,void 0,function*(){return Fc(yield this.instance.execute(this.graphData2LayoutModel(i),this.transformOptions(An({},this.options,a))))})}transformOptions(i){if(!("onTick"in i))return i;const a=i.onTick;return i.onTick=s=>a(Fc(s)),i}graphData2LayoutModel(i){const{nodes:a=[],edges:s=[],combos:o=[]}=i,l=a.map(f=>{const g=K(f),{data:v,style:p,combo:y}=f,m=Oz(f,["data","style","combo"]),x={id:g,data:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},v),{data:v}),y?{parentId:y}:{}),{style:p}),m)};return p!=null&&p.x&&Object.assign(x.data,{x:p.x}),p!=null&&p.y&&Object.assign(x.data,{y:p.y}),p!=null&&p.z&&Object.assign(x.data,{z:p.z}),x}),c=new Map(l.map(f=>[f.id,f])),u=s.filter(f=>{const{source:g,target:v}=f;return c.has(g)&&c.has(v)}).map(f=>{const{source:g,target:v,data:p,style:y}=f;return{id:K(f),source:g,target:v,data:Object.assign({},p),style:Object.assign({},y)}}),h=o.map(f=>({id:K(f),data:Object.assign({_isCombo:!0},f.data),style:Object.assign({},f.style)})),d=new vn({nodes:[...l,...h],edges:u});return t.model.model.hasTreeStructure(ge)&&(d.attachTreeStructure(ge),l.forEach(f=>{const g=t.model.model.getParent(f.id,ge);g&&d.hasNode(g.id)&&d.setParent(f.id,g.id,ge)})),d}}return e}function Wd(r,t,...e){if(t in r)return r[t](...e);if("instance"in r){const n=r.instance;if(t in n)return n[t](...e)}return null}function mw(r,t){if(t in r)return r[t];if("instance"in r){const e=r.instance;if(t in e)return e[t]}return null}var Cz=function(r,t,e,n){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((n=n.apply(r,t||[])).next())})};class Rz extends ml{get forceLayoutInstance(){return this.context.layout.getLayoutInstance().find(t=>["d3-force","d3-force-3d"].includes(t==null?void 0:t.id))}validate(t){return this.context.layout?this.forceLayoutInstance?super.validate(t):(wi.warn("DragElementForce only works with d3-force or d3-force-3d layout"),!1):!1}moveElement(t,e){return Cz(this,void 0,void 0,function*(){const n=this.forceLayoutInstance;this.context.graph.getNodeData(t).forEach((i,a)=>{const{x:s=0,y:o=0}=i.style||{};n&&Wd(n,"setFixedPosition",t[a],[...qt([+s,+o],this.clampByRotation(e))])})})}onDragStart(t){if(this.enable=this.validate(t),!this.enable)return;this.target=this.getSelectedNodeIDs([t.target.id]),this.hideEdge(),this.context.graph.frontElement(this.target);const e=this.forceLayoutInstance;e&&mw(e,"simulation").alphaTarget(.3).restart(),this.context.graph.getNodeData(this.target).forEach(n=>{const{x:i=0,y:a=0}=n.style||{};e&&Wd(e,"setFixedPosition",K(n),[+i,+a])})}onDrag(t){if(!this.enable)return;const e=this.getDelta(t);this.moveElement(this.target,e)}onDragEnd(){const t=this.forceLayoutInstance;t&&mw(t,"simulation").alphaTarget(0),!this.options.fixed&&this.context.graph.getNodeData(this.target).forEach(e=>{t&&Wd(t,"setFixedPosition",K(e),[null,null,null])})}}var bw=function(r,t,e,n){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((n=n.apply(r,t||[])).next())})};class eh extends wr{constructor(t,e){super(t,Object.assign({},eh.defaultOptions,e)),this.isZoomEvent=n=>!!(n.data&&"scale"in n.data),this.relatedEdgeToUpdate=new Set,this.zoom=this.context.graph.getZoom(),this.fixElementSize=n=>bw(this,void 0,void 0,function*(){if(!this.validate(n))return;const{graph:i}=this.context,{state:a,nodeFilter:s,edgeFilter:o,comboFilter:l}=this.options,c=(a?i.getElementDataByState("node",a):i.getNodeData()).filter(s),u=(a?i.getElementDataByState("edge",a):i.getEdgeData()).filter(o),h=(a?i.getElementDataByState("combo",a):i.getComboData()).filter(l),d=this.isZoomEvent(n)?this.zoom=Math.max(.01,Math.min(n.data.scale,10)):this.zoom,f=[...c,...h];f.length>0&&f.forEach(g=>this.fixNodeLike(g,d)),this.updateRelatedEdges(),u.length>0&&u.forEach(g=>this.fixEdge(g,d))}),this.cachedStyles=new Map,this.getOriginalFieldValue=(n,i,a)=>{var s;const o=this.cachedStyles.get(n)||[],l=((s=o.find(c=>c.shape===i))===null||s===void 0?void 0:s.style)||{};return a in l||(l[a]=i.attributes[a],this.cachedStyles.set(n,[...o.filter(c=>c.shape!==i),{shape:i,style:l}])),l[a]},this.scaleEntireElement=(n,i,a)=>{i.setLocalScale(1/a);const s=this.cachedStyles.get(n)||[];s.push({shape:i}),this.cachedStyles.set(n,s)},this.scaleSpecificShapes=(n,i,a)=>{const s=R5(n);(Array.isArray(a)?a:[a]).forEach(l=>{const{shape:c,fields:u}=l,h=typeof c=="function"?c(s):n.getShape(c);if(h){if(!u){this.scaleEntireElement(n.id,h,i);return}u.forEach(d=>{const f=this.getOriginalFieldValue(n.id,h,d);St(f)&&(h.style[d]=f/i)})}})},this.skipIfExceedViewport=n=>{const{viewport:i}=this.context;return!(i!=null&&i.isInViewport(n.getRenderBounds(),!1,30))},this.fixNodeLike=(n,i)=>{const a=K(n),{element:s,model:o}=this.context,l=s.getElement(a);if(!l||this.skipIfExceedViewport(l))return;o.getRelatedEdgesData(a).forEach(h=>this.relatedEdgeToUpdate.add(K(h)));const u=this.options[l.type];if(!u){this.scaleEntireElement(a,l,i);return}this.scaleSpecificShapes(l,i,u)},this.fixEdge=(n,i)=>{const a=K(n),s=this.context.element.getElement(a);if(!s||this.skipIfExceedViewport(s))return;const o=this.options.edge;if(!o){s.style.transformOrigin="center",this.scaleEntireElement(a,s,i);return}this.scaleSpecificShapes(s,i,o)},this.updateRelatedEdges=()=>{const{element:n}=this.context;this.relatedEdgeToUpdate.size>0&&this.relatedEdgeToUpdate.forEach(i=>{const a=n.getElement(i);a==null||a.update({})}),this.relatedEdgeToUpdate.clear()},this.resetTransform=n=>bw(this,void 0,void 0,function*(){var i;!((i=n.data)===null||i===void 0)&&i.firstRender||(this.options.reset?this.restoreCachedStyles():this.fixElementSize({data:{scale:this.zoom}}))}),this.bindEvents()}restoreCachedStyles(){if(this.cachedStyles.size>0){this.cachedStyles.forEach(i=>{i.forEach(({shape:a,style:s})=>{if(ui(s))a.setLocalScale(1);else{if(this.options.state)return;Object.entries(s).forEach(([o,l])=>a.style[o]=l)}})});const{graph:t,element:e}=this.context,n=Object.keys(Object.fromEntries(this.cachedStyles)).filter(i=>i&&t.getElementType(i)==="node");if(n.length>0){const i=new Set;n.forEach(a=>{t.getRelatedEdgesData(a).forEach(s=>i.add(K(s)))}),i.forEach(a=>{const s=e==null?void 0:e.getElement(a);s==null||s.update({})})}}}bindEvents(){const{graph:t}=this.context;t.on(ft.AFTER_DRAW,this.resetTransform),t.on(ft.AFTER_TRANSFORM,this.fixElementSize)}unbindEvents(){const{graph:t}=this.context;t.off(ft.AFTER_DRAW,this.resetTransform),t.off(ft.AFTER_TRANSFORM,this.fixElementSize)}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return Tt(e)?e(t):!!e}destroy(){this.unbindEvents(),super.destroy()}}eh.defaultOptions={enable:r=>r.data.scale<1,nodeFilter:()=>!0,edgeFilter:()=>!0,comboFilter:()=>!0,edge:[{shape:"key",fields:["lineWidth"]},{shape:"halo",fields:["lineWidth"]},{shape:"label"}],reset:!1};var Lz=function(r,t,e,n){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((n=n.apply(r,t||[])).next())})};class nh extends wr{constructor(t,e){super(t,Object.assign({},nh.defaultOptions,e)),this.focus=n=>Lz(this,void 0,void 0,function*(){if(!this.validate(n))return;const{graph:i}=this.context;yield i.focusElement(n.target.id,this.options.animation)}),this.bindEvents()}bindEvents(){const{graph:t}=this.context;this.unbindEvents(),Qa.forEach(e=>{t.on(`${e}:${rt.CLICK}`,this.focus)})}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return Tt(e)?e(t):!!e}unbindEvents(){const{graph:t}=this.context;Qa.forEach(e=>{t.off(`${e}:${rt.CLICK}`,this.focus)})}destroy(){this.unbindEvents(),super.destroy()}}nh.defaultOptions={animation:{easing:"ease-in",duration:500},enable:!0};class rh extends wr{constructor(t,e){super(t,Object.assign({},rh.defaultOptions,e)),this.isFrozen=!1,this.toggleFrozen=n=>{this.isFrozen=n.type==="dragstart"},this.hoverElement=n=>{if(!this.validate(n))return;const i=n.type===rt.POINTER_ENTER;this.updateElementsState(n,i);const{onHover:a,onHoverEnd:s}=this.options;i?a==null||a(n):s==null||s(n)},this.updateElementsState=(n,i)=>{if(!this.options.state&&!this.options.inactiveState)return;const{graph:a}=this.context,{state:s,animation:o,inactiveState:l}=this.options,c=this.getActiveIds(n),u={};if(s&&Object.assign(u,this.getElementsState(c,s,i)),l){const h=GA(a.getData(),!0).filter(d=>!c.includes(d));Object.assign(u,this.getElementsState(h,l,i))}a.setElementState(u,o)},this.getElementsState=(n,i,a)=>{const{graph:s}=this.context,o={};return n.forEach(l=>{const c=s.getElementState(l);a?o[l]=c.includes(i)?c:[...c,i]:o[l]=c.filter(u=>u!==i)}),o},this.bindEvents()}bindEvents(){const{graph:t}=this.context;this.unbindEvents(),Qa.forEach(n=>{t.on(`${n}:${rt.POINTER_ENTER}`,this.hoverElement),t.on(`${n}:${rt.POINTER_LEAVE}`,this.hoverElement)});const e=this.context.canvas.document;e.addEventListener(`${rt.DRAG_START}`,this.toggleFrozen),e.addEventListener(`${rt.DRAG_END}`,this.toggleFrozen)}getActiveIds(t){const{graph:e}=this.context,{degree:n,direction:i}=this.options,a=t.target.id;return n?tN(e,t.targetType,a,typeof n=="function"?n(t):n,i):[a]}validate(t){if(this.destroyed||this.isFrozen||yl(t.target)||this.context.graph.isCollapsingExpanding)return!1;const{enable:e}=this.options;return Tt(e)?e(t):!!e}unbindEvents(){const{graph:t}=this.context;Qa.forEach(n=>{t.off(`${n}:${rt.POINTER_ENTER}`,this.hoverElement),t.off(`${n}:${rt.POINTER_LEAVE}`,this.hoverElement)});const e=this.context.canvas.document;e.removeEventListener(`${rt.DRAG_START}`,this.toggleFrozen),e.removeEventListener(`${rt.DRAG_END}`,this.toggleFrozen)}destroy(){this.unbindEvents(),super.destroy()}}rh.defaultOptions={animation:!1,enable:!0,degree:0,direction:"both",state:"active",inactiveState:void 0};class Iz extends dl{onPointerDown(t){if(!super.validate(t)||!super.isKeydown()||this.points)return;const{canvas:e,graph:n}=this.context;this.pathShape=new pr({id:"g6-lasso-select",style:this.options.style}),e.appendChild(this.pathShape),this.points=[du(t,n)]}onPointerMove(t){var e;if(!this.points)return;const{immediately:n,mode:i}=this.options;this.points.push(du(t,this.context.graph)),(e=this.pathShape)===null||e===void 0||e.setAttribute("d",O5(this.points)),n&&i==="default"&&this.points.length>2&&super.updateElementsStates(this.points)}onPointerUp(){if(this.points){if(this.points.length<2){this.clearLasso();return}super.updateElementsStates(this.points),this.clearLasso()}}clearLasso(){var t;(t=this.pathShape)===null||t===void 0||t.remove(),this.pathShape=void 0,this.points=void 0}}class ih extends wr{constructor(t,e){super(t,Object.assign({},ih.defaultOptions,e)),this.hiddenShapes=[],this.isVisible=!0,this.setElementsVisibility=(n,i,a)=>{n.filter(Boolean).forEach(s=>{i==="hidden"&&!s.isVisible()?this.hiddenShapes.push(s):i==="visible"&&this.hiddenShapes.includes(s)?this.hiddenShapes.splice(this.hiddenShapes.indexOf(s),1):Za(s,i,a)})},this.filterShapes=(n,i)=>{if(Tt(i))return s=>!i(n,s);const a=i==null?void 0:i[n];return s=>s.className?!(a!=null&&a.includes(s.className)):!0},this.hideShapes=n=>{if(!this.validate(n)||!this.isVisible)return;const{element:i}=this.context,{shapes:a={}}=this.options;this.setElementsVisibility(i.getNodes(),"hidden",this.filterShapes("node",a)),this.setElementsVisibility(i.getEdges(),"hidden",this.filterShapes("edge",a)),this.setElementsVisibility(i.getCombos(),"hidden",this.filterShapes("combo",a)),this.isVisible=!1},this.showShapes=al(n=>{if(!this.validate(n)||this.isVisible)return;const{element:i}=this.context;this.setElementsVisibility(i.getNodes(),"visible"),this.setElementsVisibility(i.getEdges(),"visible"),this.setElementsVisibility(i.getCombos(),"visible"),this.isVisible=!0},this.options.debounce),this.bindEvents()}bindEvents(){const{graph:t}=this.context;t.on(ft.BEFORE_TRANSFORM,this.hideShapes),t.on(ft.AFTER_TRANSFORM,this.showShapes)}unbindEvents(){const{graph:t}=this.context;t.off(ft.BEFORE_TRANSFORM,this.hideShapes),t.off(ft.AFTER_TRANSFORM,this.showShapes)}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return Tt(e)?e(t):!!e}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy()}}ih.defaultOptions={enable:!0,debounce:200,shapes:r=>r==="node"};var xw=function(r,t,e,n){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((n=n.apply(r,t||[])).next())})};class ah extends wr{constructor(t,e){super(t,Object.assign({},ah.defaultOptions,e)),this.onWheel=n=>xw(this,void 0,void 0,function*(){this.options.preventDefault&&n.preventDefault();const i=n.deltaX,a=n.deltaY;yield this.scroll([-i,-a],n)}),this.shortcut=new Ys(t.graph),this.bindEvents()}update(t){super.update(t),this.bindEvents()}bindEvents(){var t,e;const{trigger:n}=this.options;if(this.shortcut.unbindAll(),Ze(n)){(t=this.graphDom)===null||t===void 0||t.removeEventListener(rt.WHEEL,this.onWheel);const{up:i=[],down:a=[],left:s=[],right:o=[]}=n;this.shortcut.bind(i,l=>this.scroll([0,-10],l)),this.shortcut.bind(a,l=>this.scroll([0,10],l)),this.shortcut.bind(s,l=>this.scroll([-10,0],l)),this.shortcut.bind(o,l=>this.scroll([10,0],l))}else(e=this.graphDom)===null||e===void 0||e.addEventListener(rt.WHEEL,this.onWheel,{passive:!1})}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}formatDisplacement(t){const{sensitivity:e}=this.options;return t=Wr(t,e),t=this.clampByDirection(t),t=this.clampByRange(t),t}clampByDirection([t,e]){const{direction:n}=this.options;return n==="x"?e=0:n==="y"&&(t=0),[t,e]}clampByRange([t,e]){const{viewport:n,canvas:i}=this.context,[a,s]=i.getSize(),[o,l,c,u]=Lr(this.options.range),h=[s*o,a*l,s*c,a*u],d=ma(T1(n.getCanvasCenter()),h),f=fe(n.getViewportCenter(),[t,e,0]);if(!Hr(f,d)){const{min:[g,v],max:[p,y]}=d;(f[0]<g&&t>0||f[0]>p&&t<0)&&(t=0),(f[1]<v&&e>0||f[1]>y&&e<0)&&(e=0)}return[t,e]}scroll(t,e){return xw(this,void 0,void 0,function*(){if(!this.validate(e))return;const{onFinish:n}=this.options,i=this.context.graph,a=this.formatDisplacement(t);yield i.translateBy(a,!1),n==null||n()})}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return Tt(e)?e(t):!!e}destroy(){var t;this.shortcut.destroy(),(t=this.graphDom)===null||t===void 0||t.removeEventListener(rt.WHEEL,this.onWheel),super.destroy()}}ah.defaultOptions={enable:!0,sensitivity:1,preventDefault:!0,range:1/0};var ww=function(r,t,e,n){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((n=n.apply(r,t||[])).next())})};class sh extends wr{constructor(t,e){super(t,Object.assign({},sh.defaultOptions,e)),this.zoom=(n,i,a)=>ww(this,void 0,void 0,function*(){if(!this.validate(i))return;const{graph:s}=this.context;let o=this.options.origin;!o&&"viewport"in i&&(o=On(i.viewport));const{sensitivity:l,onFinish:c}=this.options,u=1+qe(n,-50,50)*l/100,h=s.getZoom();yield s.zoomTo(h*u,a,o),c==null||c()}),this.onReset=()=>ww(this,void 0,void 0,function*(){yield this.context.graph.zoomTo(1,this.options.animation)}),this.preventDefault=n=>{this.options.preventDefault&&n.preventDefault()},this.shortcut=new Ys(t.graph),this.bindEvents()}update(t){super.update(t),this.bindEvents()}bindEvents(){const{trigger:t}=this.options;if(this.shortcut.unbindAll(),Array.isArray(t))if(t.includes(rt.PINCH))this.shortcut.bind([rt.PINCH],e=>{this.zoom(e.scale,e,!1)});else{const e=this.context.canvas.getContainer();e==null||e.addEventListener(rt.WHEEL,this.preventDefault),this.shortcut.bind([...t,rt.WHEEL],n=>{const{deltaX:i,deltaY:a}=n;this.zoom(-(a??i),n,!1)})}if(typeof t=="object"){const{zoomIn:e=[],zoomOut:n=[],reset:i=[]}=t;this.shortcut.bind(e,a=>this.zoom(10,a,this.options.animation)),this.shortcut.bind(n,a=>this.zoom(-10,a,this.options.animation)),this.shortcut.bind(i,this.onReset)}}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return Tt(e)?e(t):!!e}destroy(){var t;this.shortcut.destroy(),(t=this.context.canvas.getContainer())===null||t===void 0||t.removeEventListener(rt.WHEEL,this.preventDefault),super.destroy()}}sh.defaultOptions={animation:{duration:200},enable:!0,sensitivity:1,trigger:[],preventDefault:!0};var Vd,Ew;function xa(){if(Ew)return Vd;Ew=1;function r(t,e,n,i){return i===void 0&&(i="height"),n==="center"?(t[i]+e[i])/2:t.height}return Vd={assign:Object.assign,getHeight:r},Vd}var Ud,Sw;function PN(){if(Sw)return Ud;Sw=1;var r=xa(),t=18,e=t*2,n=t,i={getId:function(l){return l.id||l.name},getPreH:function(l){return l.preH||0},getPreV:function(l){return l.preV||0},getHGap:function(l){return l.hgap||n},getVGap:function(l){return l.vgap||n},getChildren:function(l){return l.children},getHeight:function(l){return l.height||e},getWidth:function(l){var c=l.label||" ";return l.width||c.split("").length*t}};function a(o,l){var c=this;if(c.vgap=c.hgap=0,o instanceof a)return o;c.data=o;var u=l.getHGap(o),h=l.getVGap(o);return c.preH=l.getPreH(o),c.preV=l.getPreV(o),c.width=l.getWidth(o),c.height=l.getHeight(o),c.width+=c.preH,c.height+=c.preV,c.id=l.getId(o),c.x=c.y=0,c.depth=0,c.children||(c.children=[]),c.addGap(u,h),c}r.assign(a.prototype,{isRoot:function(){return this.depth===0},isLeaf:function(){return this.children.length===0},addGap:function(l,c){var u=this;u.hgap+=l,u.vgap+=c,u.width+=2*l,u.height+=2*c},eachNode:function(l){for(var c=this,u=[c],h;h=u.shift();)l(h),u=h.children.concat(u)},DFTraverse:function(l){this.eachNode(l)},BFTraverse:function(l){for(var c=this,u=[c],h;h=u.shift();)l(h),u=u.concat(h.children)},getBoundingBox:function(){var l={left:Number.MAX_VALUE,top:Number.MAX_VALUE,width:0,height:0};return this.eachNode(function(c){l.left=Math.min(l.left,c.x),l.top=Math.min(l.top,c.y),l.width=Math.max(l.width,c.x+c.width),l.height=Math.max(l.height,c.y+c.height)}),l},translate:function(l,c){l===void 0&&(l=0),c===void 0&&(c=0),this.eachNode(function(u){u.x+=l,u.y+=c,u.x+=u.preH,u.y+=u.preV})},right2left:function(){var l=this,c=l.getBoundingBox();l.eachNode(function(u){u.x=u.x-(u.x-c.left)*2-u.width}),l.translate(c.width,0)},bottom2top:function(){var l=this,c=l.getBoundingBox();l.eachNode(function(u){u.y=u.y-(u.y-c.top)*2-u.height}),l.translate(0,c.height)}});function s(o,l,c){l===void 0&&(l={}),l=r.assign({},i,l);var u=new a(o,l),h=[u],d;if(!c&&!o.collapsed){for(;d=h.shift();)if(!d.data.collapsed){var f=l.getChildren(d.data),g=f?f.length:0;if(d.children=new Array(g),f&&g)for(var v=0;v<g;v++){var p=new a(f[v],l);d.children[v]=p,h.push(p),p.parent=d,p.depth=d.depth+1}}}return u}return Ud=s,Ud}var Yd,_w;function oh(){if(_w)return Yd;_w=1;var r=PN(),t=(function(){function e(i,a){a===void 0&&(a={});var s=this;s.options=a,s.rootNode=r(i,a)}var n=e.prototype;return n.execute=function(){throw new Error("please override this method")},e})();return Yd=t,Yd}var Hd,kw;function Dz(){if(kw)return Hd;kw=1;function r(s,o,l,c){c===void 0&&(c=[]);var u=this;u.w=s||0,u.h=o||0,u.y=l||0,u.x=0,u.c=c||[],u.cs=c.length,u.prelim=0,u.mod=0,u.shift=0,u.change=0,u.tl=null,u.tr=null,u.el=null,u.er=null,u.msel=0,u.mser=0}r.fromNode=function(s,o){if(!s)return null;var l=[];return s.children.forEach(function(c){l.push(r.fromNode(c,o))}),o?new r(s.height,s.width,s.x,l):new r(s.width,s.height,s.y,l)};function t(s,o,l){l?s.y+=o:s.x+=o,s.children.forEach(function(c){t(c,o,l)})}function e(s,o){var l=o?s.y:s.x;return s.children.forEach(function(c){l=Math.min(e(c,o),l)}),l}function n(s,o){var l=e(s,o);t(s,-l,o)}function i(s,o,l){l?o.y=s.x:o.x=s.x,s.c.forEach(function(c,u){i(c,o.children[u],l)})}function a(s,o,l){l===void 0&&(l=0),o?(s.x=l,l+=s.width):(s.y=l,l+=s.height),s.children.forEach(function(c){a(c,o,l)})}return Hd=function(s,o){o===void 0&&(o={});var l=o.isHorizontal;function c(T){if(T.cs===0){u(T);return}c(T.c[0]);for(var N=M(v(T.c[0].el),0,null),P=1;P<T.cs;++P){c(T.c[P]);var C=v(T.c[P].er);h(T,P,N),N=M(C,P,N)}m(T),u(T)}function u(T){T.cs===0?(T.el=T,T.er=T,T.msel=T.mser=0):(T.el=T.c[0].el,T.msel=T.c[0].msel,T.er=T.c[T.cs-1].er,T.mser=T.c[T.cs-1].mser)}function h(T,N,P){for(var C=T.c[N-1],R=C.mod,I=T.c[N],j=I.mod;C!==null&&I!==null;){v(C)>P.low&&(P=P.nxt);var G=R+C.prelim+C.w-(j+I.prelim);G>0&&(j+=G,d(T,N,P.index,G));var H=v(C),Z=v(I);H<=Z&&(C=g(C),C!==null&&(R+=C.mod)),H>=Z&&(I=f(I),I!==null&&(j+=I.mod))}!C&&I?p(T,N,I,j):C&&!I&&y(T,N,C,R)}function d(T,N,P,C){T.c[N].mod+=C,T.c[N].msel+=C,T.c[N].mser+=C,E(T,N,P,C)}function f(T){return T.cs===0?T.tl:T.c[0]}function g(T){return T.cs===0?T.tr:T.c[T.cs-1]}function v(T){return T.y+T.h}function p(T,N,P,C){var R=T.c[0].el;R.tl=P;var I=C-P.mod-T.c[0].msel;R.mod+=I,R.prelim-=I,T.c[0].el=T.c[N].el,T.c[0].msel=T.c[N].msel}function y(T,N,P,C){var R=T.c[N].er;R.tr=P;var I=C-P.mod-T.c[N].mser;R.mod+=I,R.prelim-=I,T.c[N].er=T.c[N-1].er,T.c[N].mser=T.c[N-1].mser}function m(T){T.prelim=(T.c[0].prelim+T.c[0].mod+T.c[T.cs-1].mod+T.c[T.cs-1].prelim+T.c[T.cs-1].w)/2-T.w/2}function x(T,N){N+=T.mod,T.x=T.prelim+N,_(T);for(var P=0;P<T.cs;P++)x(T.c[P],N)}function E(T,N,P,C){if(P!==N-1){var R=N-P;T.c[P+1].shift+=C/R,T.c[N].shift-=C/R,T.c[N].change-=C-C/R}}function _(T){for(var N=0,P=0,C=0;C<T.cs;C++)N+=T.c[C].shift,P+=N+T.c[C].change,T.c[C].mod+=P}function M(T,N,P){for(;P!==null&&T>=P.low;)P=P.nxt;return{low:T,index:N,nxt:P}}a(s,l);var O=r.fromNode(s,l);return c(O),x(O,0),i(O,s,l),n(s,l),s},Hd}var Xd,Mw;function CN(){if(Mw)return Xd;Mw=1;var r=PN();return Xd=function(t,e){for(var n=r(t.data,e,!0),i=r(t.data,e,!0),a=t.children.length,s=Math.round(a/2),o=e.getSide||function(h,d){return d<s?"right":"left"},l=0;l<a;l++){var c=t.children[l],u=o(c,l);u==="right"?i.children.push(c):n.children.push(c)}return n.eachNode(function(h){h.isRoot()||(h.side="left")}),i.eachNode(function(h){h.isRoot()||(h.side="right")}),{left:n,right:i}},Xd}var Kd,Tw;function $1(){if(Tw)return Kd;Tw=1;var r=CN(),t=["LR","RL","TB","BT","H","V"],e=["LR","RL","H"],n=function(o){return e.indexOf(o)>-1},i=t[0];Kd=function(s,o,l){var c=o.direction||i;if(o.isHorizontal=n(c),t.indexOf(c)===-1)throw new TypeError("Invalid direction: "+c);if(c===t[0])l(s,o);else if(c===t[1])l(s,o),s.right2left();else if(c===t[2])l(s,o);else if(c===t[3])l(s,o),s.bottom2top();else if(c===t[4]||c===t[5]){var u=r(s,o),h=u.left,d=u.right;l(h,o),l(d,o),o.isHorizontal?h.right2left():h.bottom2top(),d.translate(h.x-d.x,h.y-d.y),s.x=h.x,s.y=d.y;var f=s.getBoundingBox();o.isHorizontal?f.top<0&&s.translate(0,-f.top):f.left<0&&s.translate(-f.left,0)}var g=o.fixedRoot;return g===void 0&&(g=!0),g&&s.translate(-(s.x+s.width/2+s.hgap),-(s.y+s.height/2+s.vgap)),a(s,o),s};function a(s,o){if(o.radial){var l=o.isHorizontal?["x","y"]:["y","x"],c=l[0],u=l[1],h={x:1/0,y:1/0},d={x:-1/0,y:-1/0},f=0;s.DFTraverse(function(p){f++;var y=p.x,m=p.y;h.x=Math.min(h.x,y),h.y=Math.min(h.y,m),d.x=Math.max(d.x,y),d.y=Math.max(d.y,m)});var g=d[u]-h[u];if(g===0)return;var v=Math.PI*2/f;s.DFTraverse(function(p){var y=(p[u]-h[u])/g*(Math.PI*2-v)+v,m=p[c]-s[c];p.x=Math.cos(y)*m,p.y=Math.sin(y)*m})}}return Kd}var Zd,Ow;function Fz(){if(Ow)return Zd;Ow=1;function r(c,u){c.prototype=Object.create(u.prototype),c.prototype.constructor=c,t(c,u)}function t(c,u){return t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(h,d){return h.__proto__=d,h},t(c,u)}var e=oh(),n=Dz(),i=$1(),a=xa(),s=(function(c){function u(){return c.apply(this,arguments)||this}r(u,c);var h=u.prototype;return h.execute=function(){var f=this;return i(f.rootNode,f.options,n)},u})(e),o={};function l(c,u){return u=a.assign({},o,u),new s(c,u).execute()}return Zd=l,Zd}var Jd,Aw;function Bz(){if(Aw)return Jd;Aw=1;var r=xa();function t(i,a){a===void 0&&(a=[]);var s=this;s.x=s.y=0,s.leftChild=s.rightChild=null,s.height=0,s.children=a}var e={isHorizontal:!0,nodeSep:20,nodeSize:20,rankSep:200,subTreeSep:10};function n(i,a,s){s?(a.x=i.x,a.y=i.y):(a.x=i.y,a.y=i.x),i.children.forEach(function(o,l){n(o,a.children[l],s)})}return Jd=function(i,a){a===void 0&&(a={}),a=r.assign({},e,a);var s=0;function o(d){if(!d)return null;d.width=0,d.depth&&d.depth>s&&(s=d.depth);var f=d.children,g=f.length,v=new t(d.height,[]);return f.forEach(function(p,y){var m=o(p);v.children.push(m),y===0&&(v.leftChild=m),y===g-1&&(v.rightChild=m)}),v.originNode=d,v.isLeaf=d.isLeaf(),v}function l(d){if(d.isLeaf||d.children.length===0)d.drawingDepth=s;else{var f=d.children.map(function(v){return l(v)}),g=Math.min.apply(null,f);d.drawingDepth=g-1}return d.drawingDepth}var c;function u(d){d.x=d.drawingDepth*a.rankSep,d.isLeaf?(d.y=0,c&&(d.y=c.y+c.height+a.nodeSep,d.originNode.parent!==c.originNode.parent&&(d.y+=a.subTreeSep)),c=d):(d.children.forEach(function(f){u(f)}),d.y=(d.leftChild.y+d.rightChild.y)/2)}var h=o(i);return l(h),u(h),n(h,i,a.isHorizontal),i},Jd}var Qd,Nw;function zz(){if(Nw)return Qd;Nw=1;function r(c,u){c.prototype=Object.create(u.prototype),c.prototype.constructor=c,t(c,u)}function t(c,u){return t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(h,d){return h.__proto__=d,h},t(c,u)}var e=oh(),n=Bz(),i=$1(),a=xa(),s=(function(c){function u(){return c.apply(this,arguments)||this}r(u,c);var h=u.prototype;return h.execute=function(){var f=this;return f.rootNode.width=0,i(f.rootNode,f.options,n)},u})(e),o={};function l(c,u){return u=a.assign({},o,u),new s(c,u).execute()}return Qd=l,Qd}var tf,Pw;function jz(){if(Pw)return tf;Pw=1;var r=xa();function t(e,n,i,a,s){var o=(typeof i=="function"?i(e):i)*e.depth;if(!a)try{if(e.id===e.parent.children[0].id){e.x+=o,e.y=n?n.y:0;return}}catch{}if(e.x+=o,n){if(e.y=n.y+r.getHeight(n,e,s),n.parent&&e.parent.id!==n.parent.id){var l=n.parent,c=l.y+r.getHeight(l,e,s);e.y=c>e.y?c:e.y}}else e.y=0}return tf=function(e,n,i,a){var s=null;e.eachNode(function(o){t(o,s,n,i,a),s=o})},tf}var ef,Cw;function qz(){if(Cw)return ef;Cw=1;function r(h,d){h.prototype=Object.create(d.prototype),h.prototype.constructor=h,t(h,d)}function t(h,d){return t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(f,g){return f.__proto__=g,f},t(h,d)}var e=oh(),n=jz(),i=CN(),a=xa(),s=["LR","RL","H"],o=s[0],l=(function(h){function d(){return h.apply(this,arguments)||this}r(d,h);var f=d.prototype;return f.execute=function(){var v=this,p=v.options,y=v.rootNode;p.isHorizontal=!0;var m=p.indent,x=m===void 0?20:m,E=p.dropCap,_=E===void 0?!0:E,M=p.direction,O=M===void 0?o:M,T=p.align;if(O&&s.indexOf(O)===-1)throw new TypeError("Invalid direction: "+O);if(O===s[0])n(y,x,_,T);else if(O===s[1])n(y,x,_,T),y.right2left();else if(O===s[2]){var N=i(y,p),P=N.left,C=N.right;n(P,x,_,T),P.right2left(),n(C,x,_,T);var R=P.getBoundingBox();C.translate(R.width,0),y.x=C.x-y.width/2}return y},d})(e),c={};function u(h,d){return d=a.assign({},c,d),new l(h,d).execute()}return ef=u,ef}var nf,Rw;function Gz(){if(Rw)return nf;Rw=1;var r=xa();function t(i,a){var s=0;return i.children.length?i.children.forEach(function(o){s+=t(o,a)}):s=i.height,i._subTreeSep=a.getSubTreeSep(i.data),i.totalHeight=Math.max(i.height,s)+2*i._subTreeSep,i.totalHeight}function e(i){var a=i.children,s=a.length;if(s){a.forEach(function(d){e(d)});var o=a[0],l=a[s-1],c=l.y-o.y+l.height,u=0;if(a.forEach(function(d){u+=d.totalHeight}),c>i.height)i.y=o.y+c/2-i.height/2;else if(a.length!==1||i.height>u){var h=i.y+(i.height-c)/2-o.y;a.forEach(function(d){d.translate(0,h)})}else i.y=(o.y+o.height/2+l.y+l.height/2)/2-i.height/2}}var n={getSubTreeSep:function(){return 0}};return nf=function(i,a){a===void 0&&(a={}),a=r.assign({},n,a),i.parent={x:0,width:0,height:0,y:0},i.BFTraverse(function(s){s.x=s.parent.x+s.parent.width}),i.parent=null,t(i,a),i.startY=0,i.y=i.totalHeight/2-i.height/2,i.eachNode(function(s){var o=s.children,l=o.length;if(l){var c=o[0];if(c.startY=s.startY+s._subTreeSep,l===1)c.y=s.y+s.height/2-c.height/2;else{c.y=c.startY+c.totalHeight/2-c.height/2;for(var u=1;u<l;u++){var h=o[u];h.startY=o[u-1].startY+o[u-1].totalHeight,h.y=h.startY+h.totalHeight/2-h.height/2}}}}),e(i)},nf}var rf,Lw;function $z(){if(Lw)return rf;Lw=1;function r(c,u){c.prototype=Object.create(u.prototype),c.prototype.constructor=c,t(c,u)}function t(c,u){return t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(h,d){return h.__proto__=d,h},t(c,u)}var e=oh(),n=Gz(),i=$1(),a=xa(),s=(function(c){function u(){return c.apply(this,arguments)||this}r(u,c);var h=u.prototype;return h.execute=function(){var f=this;return i(f.rootNode,f.options,n)},u})(e),o={};function l(c,u){return u=a.assign({},o,u),new s(c,u).execute()}return rf=l,rf}var af,Iw;function Wz(){if(Iw)return af;Iw=1;var r={compactBox:Fz(),dendrogram:zz(),indented:qz(),mindmap:$z()};return af=r,af}var xc=Wz();const Vz=(r,t)=>{if(r!=="next"&&r!=="prev")return t},Dw=r=>{r.prev.next=r.next,r.next.prev=r.prev,delete r.next,delete r.prev};let Uz=class{constructor(){const t={};t.prev=t,t.next=t.prev,this.shortcut=t}dequeue(){const t=this.shortcut,e=t.prev;if(e&&e!==t)return Dw(e),e}enqueue(t){const e=this.shortcut;t.prev&&t.next&&Dw(t),t.next=e.next,e.next.prev=t,e.next=t,t.prev=e}toString(){const t=[],e=this.shortcut;let n=e.prev;for(;n!==e;)t.push(JSON.stringify(n,Vz)),n=n==null?void 0:n.prev;return`[${t.join(", ")}]`}};class Yz extends Uz{}const Hz=()=>1,Xz=(r,t)=>{var e;if(r.getAllNodes().length<=1)return[];const n=Zz(r,t||Hz);return(e=Kz(n.graph,n.buckets,n.zeroIdx).map(a=>r.getRelatedEdges(a.v,"out").filter(({target:s})=>s===a.w)))===null||e===void 0?void 0:e.flat()},Kz=(r,t,e)=>{let n=[];const i=t[t.length-1],a=t[0];let s;for(;r.getAllNodes().length;){for(;s=a.dequeue();)sf(r,t,e,s);for(;s=i.dequeue();)sf(r,t,e,s);if(r.getAllNodes().length){for(let o=t.length-2;o>0;--o)if(s=t[o].dequeue(),s){n=n.concat(sf(r,t,e,s,!0));break}}}return n},sf=(r,t,e,n,i)=>{var a,s;const o=[];return r.hasNode(n.v)&&((a=r.getRelatedEdges(n.v,"in"))===null||a===void 0||a.forEach(l=>{const c=l.data.weight,u=r.getNode(l.source);i&&o.push({v:l.source,w:l.target,in:0,out:0}),u.data.out===void 0&&(u.data.out=0),u.data.out-=c,Fm(t,e,Object.assign({v:u.id},u.data))}),(s=r.getRelatedEdges(n.v,"out"))===null||s===void 0||s.forEach(l=>{const c=l.data.weight,u=l.target,h=r.getNode(u);h.data.in===void 0&&(h.data.in=0),h.data.in-=c,Fm(t,e,Object.assign({v:h.id},h.data))}),r.removeNode(n.v)),i?o:void 0},Zz=(r,t)=>{const e=new vn;let n=0,i=0;r.getAllNodes().forEach(l=>{e.addNode({id:l.id,data:{v:l.id,in:0,out:0}})}),r.getAllEdges().forEach(l=>{const c=e.getRelatedEdges(l.source,"out").find(h=>h.target===l.target),u=(t==null?void 0:t(l))||1;c?e.updateEdgeData(c==null?void 0:c.id,Object.assign(Object.assign({},c.data),{weight:c.data.weight+u})):e.addEdge({id:l.id,source:l.source,target:l.target,data:{weight:u}}),i=Math.max(i,e.getNode(l.source).data.out+=u),n=Math.max(n,e.getNode(l.target).data.in+=u)});const a=[],s=i+n+3;for(let l=0;l<s;l++)a.push(new Yz);const o=n+1;return e.getAllNodes().forEach(l=>{Fm(a,o,Object.assign({v:l.id},e.getNode(l.id).data))}),{buckets:a,zeroIdx:o,graph:e}},Fm=(r,t,e)=>{e.out?e.in?r[e.out-e.in+t].enqueue(e):r[r.length-1].enqueue(e):r[0].enqueue(e)},Jz=(r,t)=>{const n=Xz(r,(i=>a=>a.data.weight||1)());n==null||n.forEach(i=>{const a=i.data;r.removeEdge(i.id),a.forwardName=i.data.name,a.reversed=!0,r.addEdge({id:i.id,source:i.target,target:i.source,data:Object.assign({},a)})})},Qz=r=>{r.getAllEdges().forEach(t=>{const e=t.data;if(e.reversed){r.removeEdge(t.id);const n=e.forwardName;delete e.reversed,delete e.forwardName,r.addEdge({id:t.id,source:t.target,target:t.source,data:Object.assign(Object.assign({},e),{forwardName:n})})}})},tj=(r,t)=>Number(r)-Number(t),Ks=(r,t,e,n)=>{let i;do i=`${n}${Math.random()}`;while(r.hasNode(i));return e.dummy=t,r.addNode({id:i,data:e}),i},ej=r=>{const t=new vn;return r.getAllNodes().forEach(e=>{t.addNode(Object.assign({},e))}),r.getAllEdges().forEach(e=>{const n=t.getRelatedEdges(e.source,"out").find(i=>i.target===e.target);n?t.updateEdgeData(n==null?void 0:n.id,Object.assign(Object.assign({},n.data),{weight:n.data.weight+e.data.weight||0,minlen:Math.max(n.data.minlen,e.data.minlen||1)})):t.addEdge({id:e.id,source:e.source,target:e.target,data:{weight:e.data.weight||0,minlen:e.data.minlen||1}})}),t},RN=r=>{const t=new vn;return r.getAllNodes().forEach(e=>{r.getChildren(e.id).length||t.addNode(Object.assign({},e))}),r.getAllEdges().forEach(e=>{t.addEdge(e)}),t},nj=(r,t)=>r==null?void 0:r.reduce((e,n,i)=>(e[n]=t[i],e),{}),Fw=(r,t)=>{const e=Number(r.x),n=Number(r.y),i=Number(t.x)-e,a=Number(t.y)-n;let s=Number(r.width)/2,o=Number(r.height)/2;if(!i&&!a)return{x:0,y:0};let l,c;return Math.abs(a)*s>Math.abs(i)*o?(a<0&&(o=-o),l=o*i/a,c=o):(i<0&&(s=-s),l=s,c=s*a/i),{x:e+l,y:n+c}},Jo=r=>{const t=[],e=LN(r)+1;for(let n=0;n<e;n++)t.push([]);r.getAllNodes().forEach(n=>{const i=n.data.rank;i!==void 0&&t[i]&&t[i].push(n.id)});for(let n=0;n<e;n++)t[n]=t[n].sort((i,a)=>tj(r.getNode(i).data.order,r.getNode(a).data.order));return t},rj=r=>{const t=r.getAllNodes().filter(n=>n.data.rank!==void 0).map(n=>n.data.rank),e=Math.min(...t);r.getAllNodes().forEach(n=>{n.data.hasOwnProperty("rank")&&e!==1/0&&(n.data.rank-=e)})},ij=(r,t=0)=>{const e=r.getAllNodes(),n=e.filter(o=>o.data.rank!==void 0).map(o=>o.data.rank),i=Math.min(...n),a=[];e.forEach(o=>{const l=(o.data.rank||0)-i;a[l]||(a[l]=[]),a[l].push(o.id)});let s=0;for(let o=0;o<a.length;o++){const l=a[o];l===void 0?o%t!==0&&(s-=1):s&&(l==null||l.forEach(c=>{const u=r.getNode(c);u&&(u.data.rank=u.data.rank||0,u.data.rank+=s)}))}},Bw=(r,t,e,n)=>{const i={width:0,height:0};return St(e)&&St(n)&&(i.rank=e,i.order=n),Ks(r,"border",i,t)},LN=r=>{let t;return r.getAllNodes().forEach(e=>{const n=e.data.rank;n!==void 0&&(t===void 0||n>t)&&(t=n)}),t||(t=0),t},aj=(r,t)=>{const e={lhs:[],rhs:[]};return r==null||r.forEach(n=>{t(n)?e.lhs.push(n):e.rhs.push(n)}),e},W1=(r,t)=>r.reduce((e,n)=>{const i=t(e),a=t(n);return i>a?n:e}),IN=(r,t,e,n,i,a)=>{n.includes(t.id)||(n.push(t.id),e||a.push(t.id),i(t.id).forEach(s=>IN(r,s,e,n,i,a)),e&&a.push(t.id))},DN=(r,t,e,n)=>{const i=Array.isArray(t)?t:[t],a=l=>r.getNeighbors(l),s=[],o=[];return i.forEach(l=>{if(r.hasNode(l.id))IN(r,l,e==="post",o,a,s);else throw new Error(`Graph does not have node: ${l}`)}),s},sj=r=>{const t=e=>{const n=r.getChildren(e),i=r.getNode(e);if(n!=null&&n.length&&n.forEach(a=>t(a.id)),i.data.hasOwnProperty("minRank")){i.data.borderLeft=[],i.data.borderRight=[];for(let a=i.data.minRank,s=i.data.maxRank+1;a<s;a+=1)zw(r,"borderLeft","_bl",e,i,a),zw(r,"borderRight","_br",e,i,a)}};r.getRoots().forEach(e=>t(e.id))},zw=(r,t,e,n,i,a)=>{const s={rank:a,borderType:t,width:0,height:0},o=i.data[t][a-1],l=Ks(r,"border",s,e);i.data[t][a]=l,r.setParent(l,n),o&&r.addEdge({id:`e${Math.random()}`,source:o,target:l,data:{weight:1}})},oj=(r,t)=>{const e=t.toLowerCase();(e==="lr"||e==="rl")&&FN(r)},lj=(r,t)=>{const e=t.toLowerCase();(e==="bt"||e==="rl")&&cj(r),(e==="lr"||e==="rl")&&(uj(r),FN(r))},FN=r=>{r.getAllNodes().forEach(t=>{jw(t)}),r.getAllEdges().forEach(t=>{jw(t)})},jw=r=>{const t=r.data.width;r.data.width=r.data.height,r.data.height=t},cj=r=>{r.getAllNodes().forEach(t=>{of(t.data)}),r.getAllEdges().forEach(t=>{var e;(e=t.data.points)===null||e===void 0||e.forEach(n=>of(n)),t.data.hasOwnProperty("y")&&of(t.data)})},of=r=>{r!=null&&r.y&&(r.y=-r.y)},uj=r=>{r.getAllNodes().forEach(t=>{lf(t.data)}),r.getAllEdges().forEach(t=>{var e;(e=t.data.points)===null||e===void 0||e.forEach(n=>lf(n)),t.data.hasOwnProperty("x")&&lf(t.data)})},lf=r=>{const t=r.x;r.x=r.y,r.y=t},hj=r=>{const t=Ks(r,"root",{},"_root"),e=dj(r);let n=Math.max(...Object.values(e));Math.abs(n)===1/0&&(n=1);const i=n-1,a=2*i+1;r.getAllEdges().forEach(o=>{o.data.minlen*=a});const s=fj(r)+1;return r.getRoots().forEach(o=>{BN(r,t,a,s,i,e,o.id)}),{nestingRoot:t,nodeRankFactor:a}},BN=(r,t,e,n,i,a,s)=>{const o=r.getChildren(s);if(!(o!=null&&o.length)){s!==t&&r.addEdge({id:`e${Math.random()}`,source:t,target:s,data:{weight:0,minlen:e}});return}const l=Bw(r,"_bt"),c=Bw(r,"_bb"),u=r.getNode(s);r.setParent(l,s),u.data.borderTop=l,r.setParent(c,s),u.data.borderBottom=c,o==null||o.forEach(h=>{BN(r,t,e,n,i,a,h.id);const d=h.data.borderTop?h.data.borderTop:h.id,f=h.data.borderBottom?h.data.borderBottom:h.id,g=h.data.borderTop?n:2*n,v=d!==f?1:i-a[s]+1;r.addEdge({id:`e${Math.random()}`,source:l,target:d,data:{minlen:v,weight:g,nestingEdge:!0}}),r.addEdge({id:`e${Math.random()}`,source:f,target:c,data:{minlen:v,weight:g,nestingEdge:!0}})}),r.getParent(s)||r.addEdge({id:`e${Math.random()}`,source:t,target:l,data:{weight:0,minlen:i+a[s]}})},dj=r=>{const t={},e=(n,i)=>{const a=r.getChildren(n);a==null||a.forEach(s=>e(s.id,i+1)),t[n]=i};return r.getRoots().forEach(n=>e(n.id,1)),t},fj=r=>{let t=0;return r.getAllEdges().forEach(e=>{t+=e.data.weight}),t},gj=(r,t)=>{t&&r.removeNode(t),r.getAllEdges().forEach(e=>{e.data.nestingEdge&&r.removeEdge(e.id)})},vj="edge",zN="edge-label",pj=(r,t)=>{r.getAllEdges().forEach(e=>yj(r,e,t))},yj=(r,t,e)=>{let n=t.source,i=r.getNode(n).data.rank;const a=t.target,s=r.getNode(a).data.rank,o=t.data.labelRank;if(s===i+1)return;r.removeEdge(t.id);let l,c,u;for(u=0,++i;i<s;++u,++i)t.data.points=[],c={originalEdge:t,width:0,height:0,rank:i},l=Ks(r,vj,c,"_d"),i===o&&(c.width=t.data.width,c.height=t.data.height,c.dummy=zN,c.labelpos=t.data.labelpos),r.addEdge({id:`e${Math.random()}`,source:n,target:l,data:{weight:t.data.weight}}),u===0&&e.push(l),n=l;r.addEdge({id:`e${Math.random()}`,source:n,target:a,data:{weight:t.data.weight}})},mj=(r,t)=>{t.forEach(e=>{let n=r.getNode(e);const{data:i}=n,a=i.originalEdge;let s;a&&r.addEdge(a);let o=e;for(;n.data.dummy;)s=r.getSuccessors(o)[0],r.removeNode(o),a.data.points.push({x:n.data.x,y:n.data.y}),n.data.dummy===zN&&(a.data.x=n.data.x,a.data.y=n.data.y,a.data.width=n.data.width,a.data.height=n.data.height),o=s.id,n=r.getNode(o)})},bj=(r,t,e)=>{const n={};let i;e==null||e.forEach(a=>{let s=r.getParent(a),o,l;for(;s;){if(o=r.getParent(s.id),o?(l=n[o.id],n[o.id]=s.id):(l=i,i=s.id),l&&l!==s.id){t.hasNode(l)||t.addNode({id:l,data:{}}),t.hasNode(s.id)||t.addNode({id:s.id,data:{}}),t.hasEdge(`e${l}-${s.id}`)||t.addEdge({id:`e${l}-${s.id}`,source:l,target:s.id,data:{}});return}s=o}})},xj=(r,t,e)=>{const n=wj(r),i=new vn({tree:[{id:n,children:[],data:{}}]});return r.getAllNodes().forEach(a=>{const s=r.getParent(a.id);(a.data.rank===t||a.data.minRank<=t&&t<=a.data.maxRank)&&(i.hasNode(a.id)||i.addNode(Object.assign({},a)),s!=null&&s.id&&!i.hasNode(s==null?void 0:s.id)&&i.addNode(Object.assign({},s)),i.setParent(a.id,(s==null?void 0:s.id)||n),r.getRelatedEdges(a.id,e).forEach(o=>{const l=o.source===a.id?o.target:o.source;i.hasNode(l)||i.addNode(Object.assign({},r.getNode(l)));const c=i.getRelatedEdges(l,"out").find(({target:h})=>h===a.id),u=c!==void 0?c.data.weight:0;c?i.updateEdgeData(c.id,Object.assign(Object.assign({},c.data),{weight:o.data.weight+u})):i.addEdge({id:o.id,source:l,target:a.id,data:{weight:o.data.weight+u}})}),a.data.hasOwnProperty("minRank")&&i.updateNodeData(a.id,Object.assign(Object.assign({},a.data),{borderLeft:a.data.borderLeft[t],borderRight:a.data.borderRight[t]})))}),i},wj=r=>{let t;for(;r.hasNode(t=`_root${Math.random()}`););return t},Ej=(r,t,e)=>{const n=nj(e,e.map((u,h)=>h)),a=t.map(u=>{const h=r.getRelatedEdges(u,"out").map(d=>({pos:n[d.target]||0,weight:d.data.weight}));return h==null?void 0:h.sort((d,f)=>d.pos-f.pos)}).flat().filter(u=>u!==void 0);let s=1;for(;s<e.length;)s<<=1;const o=2*s-1;s-=1;const l=Array(o).fill(0,0,o);let c=0;return a==null||a.forEach(u=>{if(u){let h=u.pos+s;l[h]+=u.weight;let d=0;for(;h>0;)h%2&&(d+=l[h+1]),h=h-1>>1,l[h]+=u.weight;c+=u.weight*d}}),c},qw=(r,t)=>{let e=0;for(let n=1;n<(t==null?void 0:t.length);n+=1)e+=Ej(r,t[n-1],t[n]);return e},Gw=r=>{const t={},e=r.getAllNodes(),n=e.map(c=>{var u;return(u=c.data.rank)!==null&&u!==void 0?u:-1/0}),i=Math.max(...n),a=[];for(let c=0;c<i+1;c++)a.push([]);const s=e.sort((c,u)=>r.getNode(c.id).data.rank-r.getNode(u.id).data.rank),l=s.filter(c=>r.getNode(c.id).data.fixorder!==void 0).sort((c,u)=>r.getNode(c.id).data.fixorder-r.getNode(u.id).data.fixorder);return l==null||l.forEach(c=>{isNaN(r.getNode(c.id).data.rank)||a[r.getNode(c.id).data.rank].push(c.id),t[c.id]=!0}),s==null||s.forEach(c=>r.dfsTree(c.id,u=>{if(t.hasOwnProperty(u.id))return!0;t[u.id]=!0,isNaN(u.data.rank)||a[u.data.rank].push(u.id)})),a},Sj=(r,t)=>t.map(e=>{const n=r.getRelatedEdges(e,"in");if(!(n!=null&&n.length))return{v:e};const i={sum:0,weight:0};return n==null||n.forEach(a=>{const s=r.getNode(a.source);i.sum+=a.data.weight*s.data.order,i.weight+=a.data.weight}),{v:e,barycenter:i.sum/i.weight,weight:i.weight}}),_j=(r,t)=>{var e,n,i;const a={};r==null||r.forEach((o,l)=>{a[o.v]={i:l,indegree:0,in:[],out:[],vs:[o.v]};const c=a[o.v];o.barycenter!==void 0&&(c.barycenter=o.barycenter,c.weight=o.weight)}),(e=t.getAllEdges())===null||e===void 0||e.forEach(o=>{const l=a[o.source],c=a[o.target];l!==void 0&&c!==void 0&&(c.indegree++,l.out.push(a[o.target]))});const s=(i=(n=Object.values(a)).filter)===null||i===void 0?void 0:i.call(n,o=>!o.indegree);return kj(s)},kj=r=>{var t,e;const n=[],i=l=>c=>{c.merged||(c.barycenter===void 0||l.barycenter===void 0||c.barycenter>=l.barycenter)&&Mj(l,c)},a=l=>c=>{c.in.push(l),--c.indegree===0&&r.push(c)};for(;r!=null&&r.length;){const l=r.pop();n.push(l),(t=l.in.reverse())===null||t===void 0||t.forEach(c=>i(l)(c)),(e=l.out)===null||e===void 0||e.forEach(c=>a(l)(c))}const s=n.filter(l=>!l.merged),o=["vs","i","barycenter","weight"];return s.map(l=>{const c={};return o==null||o.forEach(u=>{l[u]!==void 0&&(c[u]=l[u])}),c})},Mj=(r,t)=>{var e;let n=0,i=0;r.weight&&(n+=r.barycenter*r.weight,i+=r.weight),t.weight&&(n+=t.barycenter*t.weight,i+=t.weight),r.vs=(e=t.vs)===null||e===void 0?void 0:e.concat(r.vs),r.barycenter=n/i,r.weight=i,r.i=Math.min(t.i,r.i),t.merged=!0},Tj=(r,t,e,n)=>{const i=aj(r,d=>{const f=d.hasOwnProperty("fixorder")&&!isNaN(d.fixorder);return n?!f&&d.hasOwnProperty("barycenter"):f||d.hasOwnProperty("barycenter")}),a=i.lhs,s=i.rhs.sort((d,f)=>-d.i- -f.i),o=[];let l=0,c=0,u=0;a==null||a.sort(Oj(!!t,!!e)),u=$w(o,s,u),a==null||a.forEach(d=>{var f;u+=(f=d.vs)===null||f===void 0?void 0:f.length,o.push(d.vs),l+=d.barycenter*d.weight,c+=d.weight,u=$w(o,s,u)});const h={vs:o.flat()};return c&&(h.barycenter=l/c,h.weight=c),h},$w=(r,t,e)=>{let n=e,i;for(;t.length&&(i=t[t.length-1]).i<=n;)t.pop(),r==null||r.push(i.vs),n++;return n},Oj=(r,t)=>(e,n)=>{if(e.fixorder!==void 0&&n.fixorder!==void 0)return e.fixorder-n.fixorder;if(e.barycenter<n.barycenter)return-1;if(e.barycenter>n.barycenter)return 1;if(t&&e.order!==void 0&&n.order!==void 0){if(e.order<n.order)return-1;if(e.order>n.order)return 1}return r?n.i-e.i:e.i-n.i},jN=(r,t,e,n,i,a)=>{var s,o,l,c;let u=r.getChildren(t).map(m=>m.id);const h=r.getNode(t),d=h?h.data.borderLeft:void 0,f=h?h.data.borderRight:void 0,g={};d&&(u=u==null?void 0:u.filter(m=>m!==d&&m!==f));const v=Sj(r,u||[]);v==null||v.forEach(m=>{var x;if(!((x=r.getChildren(m.v))===null||x===void 0)&&x.length){const E=jN(r,m.v,e,n,a);g[m.v]=E,E.hasOwnProperty("barycenter")&&Nj(m,E)}});const p=_j(v,e);Aj(p,g),(s=p.filter(m=>m.vs.length>0))===null||s===void 0||s.forEach(m=>{const x=r.getNode(m.vs[0]);x&&(m.fixorder=x.data.fixorder,m.order=x.data.order)});const y=Tj(p,n,i,a);if(d&&(y.vs=[d,y.vs,f].flat(),!((o=r.getPredecessors(d))===null||o===void 0)&&o.length)){const m=r.getNode(((l=r.getPredecessors(d))===null||l===void 0?void 0:l[0].id)||""),x=r.getNode(((c=r.getPredecessors(f))===null||c===void 0?void 0:c[0].id)||"");y.hasOwnProperty("barycenter")||(y.barycenter=0,y.weight=0),y.barycenter=(y.barycenter*y.weight+m.data.order+x.data.order)/(y.weight+2),y.weight+=2}return y},Aj=(r,t)=>{r==null||r.forEach(e=>{var n;const i=(n=e.vs)===null||n===void 0?void 0:n.map(a=>t[a]?t[a].vs:a);e.vs=i.flat()})},Nj=(r,t)=>{r.barycenter!==void 0?(r.barycenter=(r.barycenter*r.weight+t.barycenter*t.weight)/(r.weight+t.weight),r.weight+=t.weight):(r.barycenter=t.barycenter,r.weight=t.weight)},Pj=(r,t)=>{const e=LN(r),n=[],i=[];for(let u=1;u<e+1;u++)n.push(u);for(let u=e-1;u>-1;u--)i.push(u);const a=Ww(r,n,"in"),s=Ww(r,i,"out");let o=Gw(r);cf(r,o);let l=Number.POSITIVE_INFINITY,c;for(let u=0,h=0;h<4;++u,++h){Vw(u%2?a:s,u%4>=2,!1,t),o=Jo(r);const d=qw(r,o);d<l&&(h=0,c=da(o),l=d)}o=Gw(r),cf(r,o);for(let u=0,h=0;h<4;++u,++h){Vw(u%2?a:s,u%4>=2,!0,t),o=Jo(r);const d=qw(r,o);d<l&&(h=0,c=da(o),l=d)}cf(r,c)},Ww=(r,t,e)=>t.map(n=>xj(r,n,e)),Vw=(r,t,e,n)=>{const i=new vn;r==null||r.forEach(a=>{var s;const o=a.getRoots()[0].id,l=jN(a,o,i,t,e,n);for(let c=0;c<((s=l.vs)===null||s===void 0?void 0:s.length);c++){const u=a.getNode(l.vs[c]);u&&(u.data.order=c)}bj(a,i,l.vs)})},cf=(r,t)=>{t==null||t.forEach(e=>{e==null||e.forEach((n,i)=>{r.getNode(n).data.order=i})})},Cj=(r,t)=>{const n=r.getAllNodes().filter(s=>{var o;return!(!((o=r.getChildren(s.id))===null||o===void 0)&&o.length)}).map(s=>s.data.rank),i=Math.max(...n),a=[];for(let s=0;s<i+1;s++)a[s]=[];t==null||t.forEach(s=>{const o=r.getNode(s);!o||o.data.dummy||isNaN(o.data.rank)||(o.data.fixorder=a[o.data.rank].length,a[o.data.rank].push(s))})},Rj=r=>{const t={};let e=0;const n=i=>{const a=e;r.getChildren(i).forEach(s=>n(s.id)),t[i]={low:a,lim:e++}};return r.getRoots().forEach(i=>n(i.id)),t},Lj=(r,t,e,n)=>{var i,a;const s=[],o=[],l=Math.min(t[e].low,t[n].low),c=Math.max(t[e].lim,t[n].lim);let u,h;u=e;do u=(i=r.getParent(u))===null||i===void 0?void 0:i.id,s.push(u);while(u&&(t[u].low>l||c>t[u].lim));for(h=u,u=n;u&&u!==h;)o.push(u),u=(a=r.getParent(u))===null||a===void 0?void 0:a.id;return{lca:h,path:s.concat(o.reverse())}},Ij=(r,t)=>{const e=Rj(r);t.forEach(n=>{var i,a;let s=n,o=r.getNode(s);const l=o.data.originalEdge;if(!l)return;const c=Lj(r,e,l.source,l.target),u=c.path,h=c.lca;let d=0,f=u[d],g=!0;for(;s!==l.target;){if(o=r.getNode(s),g){for(;f!==h&&((i=r.getNode(f))===null||i===void 0?void 0:i.data.maxRank)<o.data.rank;)d++,f=u[d];f===h&&(g=!1)}if(!g){for(;d<u.length-1&&((a=r.getNode(u[d+1]))===null||a===void 0?void 0:a.data.minRank)<=o.data.rank;)d++;f=u[d]}r.hasNode(f)&&r.setParent(s,f),s=r.getSuccessors(s)[0].id}})},Dj=(r,t)=>{const e={},n=(i,a)=>{let s=0,o=0;const l=i.length,c=a==null?void 0:a[(a==null?void 0:a.length)-1];return a==null||a.forEach((u,h)=>{var d;const f=Bj(r,u),g=f?r.getNode(f.id).data.order:l;(f||u===c)&&((d=a.slice(o,h+1))===null||d===void 0||d.forEach(v=>{var p;(p=r.getPredecessors(v))===null||p===void 0||p.forEach(y=>{var m;const x=r.getNode(y.id),E=x.data.order;(E<s||g<E)&&!(x.data.dummy&&(!((m=r.getNode(v))===null||m===void 0)&&m.data.dummy))&&qN(e,y.id,v)})}),o=h+1,s=g)}),a};return t!=null&&t.length&&t.reduce(n),e},Fj=(r,t)=>{const e={};function n(o,l,c,u,h){var d,f;let g;for(let v=l;v<c;v++)g=o[v],!((d=r.getNode(g))===null||d===void 0)&&d.data.dummy&&((f=r.getPredecessors(g))===null||f===void 0||f.forEach(p=>{const y=r.getNode(p.id);y.data.dummy&&(y.data.order<u||y.data.order>h)&&qN(e,p.id,g)}))}function i(o){return JSON.stringify(o.slice(1))}function a(o,l){const c=i(o);l.get(c)||(n(...o),l.set(c,!0))}const s=(o,l)=>{let c=-1,u,h=0;const d=new Map;return l==null||l.forEach((f,g)=>{var v;if(((v=r.getNode(f))===null||v===void 0?void 0:v.data.dummy)==="border"){const p=r.getPredecessors(f)||[];p.length&&(u=r.getNode(p[0].id).data.order,a([l,h,g,c,u],d),h=g,c=u)}a([l,h,l.length,u,o.length],d)}),l};return t!=null&&t.length&&t.reduce(s),e},Bj=(r,t)=>{var e,n;if(!((e=r.getNode(t))===null||e===void 0)&&e.data.dummy)return(n=r.getPredecessors(t))===null||n===void 0?void 0:n.find(i=>r.getNode(i.id).data.dummy)},qN=(r,t,e)=>{let n=t,i=e;if(n>i){const s=n;n=i,i=s}let a=r[n];a||(r[n]=a={}),a[i]=!0},zj=(r,t,e)=>{let n=t,i=e;if(n>i){const a=t;n=i,i=a}return!!r[n]},jj=(r,t,e,n)=>{const i={},a={},s={};return t==null||t.forEach(o=>{o==null||o.forEach((l,c)=>{i[l]=l,a[l]=l,s[l]=c})}),t==null||t.forEach(o=>{let l=-1;o==null||o.forEach(c=>{let u=n(c).map(h=>h.id);if(u.length){u=u.sort((d,f)=>s[d]-s[f]);const h=(u.length-1)/2;for(let d=Math.floor(h),f=Math.ceil(h);d<=f;++d){const g=u[d];a[c]===c&&l<s[g]&&!zj(e,c,g)&&(a[g]=c,a[c]=i[c]=i[g],l=s[g])}}})}),{root:i,align:a}},qj=(r,t,e,n,i,a,s)=>{var o;const l={},c=Gj(r,t,e,i,a,s),u=s?"borderLeft":"borderRight",h=(g,v)=>{let p=c.getAllNodes(),y=p.pop();const m={};for(;y;)m[y.id]?g(y.id):(m[y.id]=!0,p.push(y),p=p.concat(v(y.id))),y=p.pop()},d=g=>{l[g]=(c.getRelatedEdges(g,"in")||[]).reduce((v,p)=>Math.max(v,(l[p.source]||0)+p.data.weight),0)},f=g=>{const v=(c.getRelatedEdges(g,"out")||[]).reduce((y,m)=>Math.min(y,(l[m.target]||0)-m.data.weight),Number.POSITIVE_INFINITY),p=r.getNode(g);v!==Number.POSITIVE_INFINITY&&p.data.borderType!==u&&(l[g]=Math.max(l[g],v))};return h(d,c.getPredecessors.bind(c)),h(f,c.getSuccessors.bind(c)),(o=Object.values(n))===null||o===void 0||o.forEach(g=>{l[g]=l[e[g]]}),l},Gj=(r,t,e,n,i,a)=>{const s=new vn,o=Uj(n,i,a);return t==null||t.forEach(l=>{let c;l==null||l.forEach(u=>{const h=e[u];if(s.hasNode(h)||s.addNode({id:h,data:{}}),c){const d=e[c],f=s.getRelatedEdges(d,"out").find(g=>g.target===h);f?s.updateEdgeData(f.id,Object.assign(Object.assign({},f.data),{weight:Math.max(o(r,u,c),f.data.weight||0)})):s.addEdge({id:`e${Math.random()}`,source:d,target:h,data:{weight:Math.max(o(r,u,c),0)}})}c=u})}),s},$j=(r,t)=>W1(Object.values(t),e=>{var n;let i=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY;return(n=Object.keys(e))===null||n===void 0||n.forEach(s=>{const o=e[s],l=Yj(r,s)/2;i=Math.max(o+l,i),a=Math.min(o-l,a)}),i-a});function Wj(r,t){const e=Object.values(t),n=Math.min(...e),i=Math.max(...e);["u","d"].forEach(a=>{["l","r"].forEach(s=>{const o=a+s,l=r[o];let c;if(l===t)return;const u=Object.values(l);c=s==="l"?n-Math.min(...u):i-Math.max(...u),c&&(r[o]={},Object.keys(l).forEach(h=>{r[o][h]=l[h]+c}))})})}const Vj=(r,t)=>{const e={};return Object.keys(r.ul).forEach(n=>{if(t)e[n]=r[t.toLowerCase()][n];else{const i=Object.values(r).map(a=>a[n]);e[n]=(i[0]+i[1])/2}}),e},Uj=(r,t,e)=>(n,i,a)=>{const s=n.getNode(i),o=n.getNode(a);let l=0,c=0;if(l+=s.data.width/2,s.data.hasOwnProperty("labelpos"))switch((s.data.labelpos||"").toLowerCase()){case"l":c=-s.data.width/2;break;case"r":c=s.data.width/2;break}if(c&&(l+=e?c:-c),c=0,l+=(s.data.dummy?t:r)/2,l+=(o.data.dummy?t:r)/2,l+=o.data.width/2,o.data.labelpos)switch((o.data.labelpos||"").toLowerCase()){case"l":c=o.data.width/2;break;case"r":c=-o.data.width/2;break}return c&&(l+=e?c:-c),c=0,l},Yj=(r,t)=>r.getNode(t).data.width||0,Hj=(r,t)=>{const{ranksep:e=0}=t||{},n=Jo(r);let i=0;n==null||n.forEach(a=>{const s=a.map(l=>r.getNode(l).data.height),o=Math.max(...s,0);a==null||a.forEach(l=>{r.getNode(l).data.y=i+o/2}),i+=o+e})},Xj=(r,t)=>{const{align:e,nodesep:n=0,edgesep:i=0}=t||{},a=Jo(r),s=Object.assign(Dj(r,a),Fj(r,a)),o={};let l=[];["u","d"].forEach(u=>{l=u==="u"?a:Object.values(a).reverse(),["l","r"].forEach(h=>{h==="r"&&(l=l.map(v=>Object.values(v).reverse()));const d=(u==="u"?r.getPredecessors:r.getSuccessors).bind(r),f=jj(r,l,s,d),g=qj(r,l,f.root,f.align,n,i,h==="r");h==="r"&&Object.keys(g).forEach(v=>g[v]=-g[v]),o[u+h]=g})});const c=$j(r,o);return c&&Wj(o,c),Vj(o,e)},Kj=(r,t)=>{var e;const n=RN(r);Hj(n,t);const i=Xj(n,t);(e=Object.keys(i))===null||e===void 0||e.forEach(a=>{n.getNode(a).data.x=i[a]})},GN=r=>{const t={},e=n=>{var i;const a=r.getNode(n);if(!a)return 0;if(t[n])return a.data.rank;t[n]=!0;let s;return(i=r.getRelatedEdges(n,"out"))===null||i===void 0||i.forEach(o=>{const l=e(o.target),c=o.data.minlen,u=l-c;u&&(s===void 0||u<s)&&(s=u)}),s||(s=0),a.data.rank=s,s};r.getAllNodes().filter(n=>r.getRelatedEdges(n.id,"in").length===0).forEach(n=>e(n.id))},Zj=r=>{const t={};let e;const n=s=>{var o;const l=r.getNode(s);if(!l)return 0;if(t[s])return l.data.rank;t[s]=!0;let c;return(o=r.getRelatedEdges(s,"out"))===null||o===void 0||o.forEach(u=>{const h=n(u.target),d=u.data.minlen,f=h-d;f&&(c===void 0||f<c)&&(c=f)}),c||(c=0),(e===void 0||c<e)&&(e=c),l.data.rank=c,c};r.getAllNodes().filter(s=>r.getRelatedEdges(s.id,"in").length===0).forEach(s=>{s&&n(s.id)}),e===void 0&&(e=0);const i={},a=(s,o)=>{var l;const c=r.getNode(s),u=isNaN(c.data.layer)?o:c.data.layer;(c.data.rank===void 0||c.data.rank<u)&&(c.data.rank=u),!i[s]&&(i[s]=!0,(l=r.getRelatedEdges(s,"out"))===null||l===void 0||l.forEach(h=>{a(h.target,u+h.data.minlen)}))};r.getAllNodes().forEach(s=>{const o=s.data;o&&(isNaN(o.layer)?o.rank-=e:a(s.id,o.layer))})},va=(r,t)=>r.getNode(t.target).data.rank-r.getNode(t.source).data.rank-t.data.minlen,Jj=r=>{const t=new vn({tree:[]}),e=r.getAllNodes()[0],n=r.getAllNodes().length;t.addNode(e);let i,a;for(;Qj(t,r)<n;)i=$N(t,r),a=t.hasNode(i.source)?va(r,i):-va(r,i),WN(t,r,a);return t},Qj=(r,t)=>{const e=n=>{t.getRelatedEdges(n,"both").forEach(i=>{const a=i.source,s=n===a?i.target:a;!r.hasNode(s)&&!va(t,i)&&(r.addNode({id:s,data:{}}),r.addEdge({id:i.id,source:n,target:s,data:{}}),e(s))})};return r.getAllNodes().forEach(n=>e(n.id)),r.getAllNodes().length},t8=r=>{const t=new vn({tree:[]}),e=r.getAllNodes()[0],n=r.getAllNodes().length;t.addNode(e);let i,a;for(;e8(t,r)<n;)i=$N(t,r),a=t.hasNode(i.source)?va(r,i):-va(r,i),WN(t,r,a);return t},e8=(r,t)=>{const e=n=>{var i;(i=t.getRelatedEdges(n,"both"))===null||i===void 0||i.forEach(a=>{const s=a.source,o=n===s?a.target:s;!r.hasNode(o)&&(t.getNode(o).data.layer!==void 0||!va(t,a))&&(r.addNode({id:o,data:{}}),r.addEdge({id:a.id,source:n,target:o,data:{}}),e(o))})};return r.getAllNodes().forEach(n=>e(n.id)),r.getAllNodes().length},$N=(r,t)=>W1(t.getAllEdges(),e=>r.hasNode(e.source)!==r.hasNode(e.target)?va(t,e):1/0),WN=(r,t,e)=>{r.getAllNodes().forEach(n=>{const i=t.getNode(n.id);i.data.rank||(i.data.rank=0),i.data.rank+=e})},n8=r=>{const t=ej(r);GN(t);const e=Jj(t);UN(e),VN(e,t);let n,i;for(;n=a8(e);)i=s8(e,t,n),o8(e,t,n,i)},VN=(r,t)=>{let e=DN(r,r.getAllNodes(),"post");e=e.slice(0,(e==null?void 0:e.length)-1),e.forEach(n=>{r8(r,t,n)})},r8=(r,t,e)=>{const i=r.getNode(e).data.parent,a=r.getRelatedEdges(e,"both").find(s=>s.target===i||s.source===i);a.data.cutvalue=i8(r,t,e)},i8=(r,t,e)=>{const i=r.getNode(e).data.parent;let a=!0,s=t.getRelatedEdges(e,"out").find(l=>l.target===i),o=0;return s||(a=!1,s=t.getRelatedEdges(i,"out").find(l=>l.target===e)),o=s.data.weight,t.getRelatedEdges(e,"both").forEach(l=>{const c=l.source===e,u=c?l.target:l.source;if(u!==i){const h=c===a,d=l.data.weight;if(o+=h?d:-d,c8(r,e,u)){const f=r.getRelatedEdges(e,"both").find(g=>g.source===u||g.target===u).data.cutvalue;o+=h?-f:f}}}),o},UN=(r,t=r.getAllNodes()[0].id)=>{YN(r,{},1,t)},YN=(r,t,e,n,i)=>{var a;const s=e;let o=e;const l=r.getNode(n);return t[n]=!0,(a=r.getNeighbors(n))===null||a===void 0||a.forEach(c=>{t[c.id]||(o=YN(r,t,o,c.id,n))}),l.data.low=s,l.data.lim=o++,i?l.data.parent=i:delete l.data.parent,o},a8=r=>r.getAllEdges().find(t=>t.data.cutvalue<0),s8=(r,t,e)=>{let n=e.source,i=e.target;t.getRelatedEdges(n,"out").find(u=>u.target===i)||(n=e.target,i=e.source);const a=r.getNode(n),s=r.getNode(i);let o=a,l=!1;a.data.lim>s.data.lim&&(o=s,l=!0);const c=t.getAllEdges().filter(u=>l===Uw(r.getNode(u.source),o)&&l!==Uw(r.getNode(u.target),o));return W1(c,u=>va(t,u))},o8=(r,t,e,n)=>{const i=r.getRelatedEdges(e.source,"both").find(a=>a.source===e.target||a.target===e.target);i&&r.removeEdge(i.id),r.addEdge({id:`e${Math.random()}`,source:n.source,target:n.target,data:{}}),UN(r),VN(r,t),l8(r,t)},l8=(r,t)=>{const e=r.getAllNodes().find(i=>!i.data.parent);let n=DN(r,e,"pre");n=n.slice(1),n.forEach(i=>{const a=r.getNode(i).data.parent;let s=t.getRelatedEdges(i,"out").find(l=>l.target===a),o=!1;!s&&t.hasNode(a)&&(s=t.getRelatedEdges(a,"out").find(l=>l.target===i),o=!0),t.getNode(i).data.rank=(t.hasNode(a)&&t.getNode(a).data.rank||0)+(o?s==null?void 0:s.data.minlen:-(s==null?void 0:s.data.minlen))})},c8=(r,t,e)=>r.getRelatedEdges(t,"both").find(n=>n.source===e||n.target===e),Uw=(r,t)=>t.data.low<=r.data.lim&&r.data.lim<=t.data.lim,u8=(r,t)=>{switch(t){case"network-simplex":d8(r);break;case"tight-tree":Yw(r);break;case"longest-path":h8(r);break;default:Yw(r)}},h8=GN,Yw=r=>{Zj(r),t8(r)},d8=r=>{n8(r)},f8=(r,t)=>{const{edgeLabelSpace:e,keepNodeOrder:n,prevGraph:i,rankdir:a,ranksep:s}=t;!n&&i&&v8(r,i);const o=w8(r);e&&(t.ranksep=E8(o,{rankdir:a,ranksep:s}));let l;try{l=g8(o,t)}catch(c){if(c.message==="Not possible to find intersection inside of the rectangle"){console.error(`The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph's structure:
`,c);return}throw c}return p8(r,o),l},g8=(r,t)=>{const{ranker:e,rankdir:n="tb",nodeOrder:i,keepNodeOrder:a,align:s,nodesep:o=50,edgesep:l=20,ranksep:c=50}=t;P8(r),Jz(r);const{nestingRoot:u,nodeRankFactor:h}=hj(r);u8(RN(r),e),S8(r),ij(r,h),gj(r,u),rj(r),_8(r),k8(r);const d=[];pj(r,d),Ij(r,d),sj(r),a&&Cj(r,i),Pj(r,a),C8(r),oj(r,n),Kj(r,{align:s,nodesep:o,edgesep:l,ranksep:c}),R8(r),N8(r),mj(r,d),O8(r),lj(r,n);const{width:f,height:g}=M8(r);return T8(r),A8(r),Qz(r),{width:f,height:g}},v8=(r,t)=>{r.getAllNodes().forEach(e=>{const n=r.getNode(e.id);if(t.hasNode(e.id)){const i=t.getNode(e.id);n.data.fixorder=i.data._order,delete i.data._order}else delete n.data.fixorder})},p8=(r,t)=>{r.getAllNodes().forEach(e=>{var n;const i=r.getNode(e.id);if(i){const a=t.getNode(e.id);i.data.x=a.data.x,i.data.y=a.data.y,i.data._order=a.data.order,i.data._rank=a.data.rank,!((n=t.getChildren(e.id))===null||n===void 0)&&n.length&&(i.data.width=a.data.width,i.data.height=a.data.height)}}),r.getAllEdges().forEach(e=>{const n=r.getEdge(e.id),i=t.getEdge(e.id);n.data.points=i?i.data.points:[],i&&i.data.hasOwnProperty("x")&&(n.data.x=i.data.x,n.data.y=i.data.y)})},y8=["width","height","layer","fixorder"],m8={width:0,height:0},b8=["minlen","weight","width","height","labeloffset"],x8={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},uf=["labelpos"],w8=r=>{const t=new vn({tree:[]});return r.getAllNodes().forEach(e=>{const n=Xw(r.getNode(e.id).data),i=Object.assign(Object.assign({},m8),n),a=Hw(i,y8);t.hasNode(e.id)||t.addNode({id:e.id,data:Object.assign({},a)});const s=r.hasTreeStructure("combo")?r.getParent(e.id,"combo"):r.getParent(e.id);Rt(s)||(t.hasNode(s.id)||t.addNode(Object.assign({},s)),t.setParent(e.id,s.id))}),r.getAllEdges().forEach(e=>{const n=Xw(r.getEdge(e.id).data),i={};uf==null||uf.forEach(a=>{n[a]!==void 0&&(i[a]=n[a])}),t.addEdge({id:e.id,source:e.source,target:e.target,data:Object.assign({},x8,Hw(n,b8),i)})}),t},E8=(r,t)=>{const{ranksep:e=0,rankdir:n}=t;return r.getAllNodes().forEach(i=>{isNaN(i.data.layer)||i.data.layer||(i.data.layer=0)}),r.getAllEdges().forEach(i=>{var a;i.data.minlen*=2,((a=i.data.labelpos)===null||a===void 0?void 0:a.toLowerCase())!=="c"&&(n==="TB"||n==="BT"?i.data.width+=i.data.labeloffset:i.data.height+=i.data.labeloffset)}),e/2},S8=r=>{r.getAllEdges().forEach(t=>{if(t.data.width&&t.data.height){const e=r.getNode(t.source),n=r.getNode(t.target),i={e:t,rank:(n.data.rank-e.data.rank)/2+e.data.rank};Ks(r,"edge-proxy",i,"_ep")}})},_8=r=>{let t=0;return r.getAllNodes().forEach(e=>{var n,i;e.data.borderTop&&(e.data.minRank=(n=r.getNode(e.data.borderTop))===null||n===void 0?void 0:n.data.rank,e.data.maxRank=(i=r.getNode(e.data.borderBottom))===null||i===void 0?void 0:i.data.rank,t=Math.max(t,e.data.maxRank||-1/0))}),t},k8=r=>{r.getAllNodes().forEach(t=>{t.data.dummy==="edge-proxy"&&(r.getEdge(t.data.e.id).data.labelRank=t.data.rank,r.removeNode(t.id))})},M8=(r,t)=>{let e,n=0,i,a=0;const{marginx:s=0,marginy:o=0}={},l=c=>{if(!c.data)return;const u=c.data.x,h=c.data.y,d=c.data.width,f=c.data.height;!isNaN(u)&&!isNaN(d)&&(e===void 0&&(e=u-d/2),e=Math.min(e,u-d/2),n=Math.max(n,u+d/2)),!isNaN(h)&&!isNaN(f)&&(i===void 0&&(i=h-f/2),i=Math.min(i,h-f/2),a=Math.max(a,h+f/2))};return r.getAllNodes().forEach(c=>{l(c)}),r.getAllEdges().forEach(c=>{c!=null&&c.data.hasOwnProperty("x")&&l(c)}),e-=s,i-=o,r.getAllNodes().forEach(c=>{c.data.x-=e,c.data.y-=i}),r.getAllEdges().forEach(c=>{var u;(u=c.data.points)===null||u===void 0||u.forEach(h=>{h.x-=e,h.y-=i}),c.data.hasOwnProperty("x")&&(c.data.x-=e),c.data.hasOwnProperty("y")&&(c.data.y-=i)}),{width:n-e+s,height:a-i+o}},T8=r=>{r.getAllEdges().forEach(t=>{const e=r.getNode(t.source),n=r.getNode(t.target);let i,a;t.data.points?(i=t.data.points[0],a=t.data.points[t.data.points.length-1]):(t.data.points=[],i={x:n.data.x,y:n.data.y},a={x:e.data.x,y:e.data.y}),t.data.points.unshift(Fw(e.data,i)),t.data.points.push(Fw(n.data,a))})},O8=r=>{r.getAllEdges().forEach(t=>{if(t.data.hasOwnProperty("x"))switch((t.data.labelpos==="l"||t.data.labelpos==="r")&&(t.data.width-=t.data.labeloffset),t.data.labelpos){case"l":t.data.x-=t.data.width/2+t.data.labeloffset;break;case"r":t.data.x+=t.data.width/2+t.data.labeloffset;break}})},A8=r=>{r.getAllEdges().forEach(t=>{var e;t.data.reversed&&((e=t.data.points)===null||e===void 0||e.reverse())})},N8=r=>{r.getAllNodes().forEach(t=>{var e,n,i;if(!((e=r.getChildren(t.id))===null||e===void 0)&&e.length){const a=r.getNode(t.id),s=r.getNode(a.data.borderTop),o=r.getNode(a.data.borderBottom),l=r.getNode(a.data.borderLeft[((n=a.data.borderLeft)===null||n===void 0?void 0:n.length)-1]),c=r.getNode(a.data.borderRight[((i=a.data.borderRight)===null||i===void 0?void 0:i.length)-1]);a.data.width=Math.abs((c==null?void 0:c.data.x)-(l==null?void 0:l.data.x))||10,a.data.height=Math.abs((o==null?void 0:o.data.y)-(s==null?void 0:s.data.y))||10,a.data.x=((l==null?void 0:l.data.x)||0)+a.data.width/2,a.data.y=((s==null?void 0:s.data.y)||0)+a.data.height/2}}),r.getAllNodes().forEach(t=>{t.data.dummy==="border"&&r.removeNode(t.id)})},P8=r=>{r.getAllEdges().forEach(t=>{if(t.source===t.target){const e=r.getNode(t.source);e.data.selfEdges||(e.data.selfEdges=[]),e.data.selfEdges.push(t),r.removeEdge(t.id)}})},C8=r=>{const t=Jo(r);t==null||t.forEach(e=>{let n=0;e==null||e.forEach((i,a)=>{var s;const o=r.getNode(i);o.data.order=a+n,(s=o.data.selfEdges)===null||s===void 0||s.forEach(l=>{Ks(r,"selfedge",{width:l.data.width,height:l.data.height,rank:o.data.rank,order:a+ ++n,e:l},"_se")}),delete o.data.selfEdges})})},R8=r=>{r.getAllNodes().forEach(t=>{const e=r.getNode(t.id);if(e.data.dummy==="selfedge"){const n=r.getNode(e.data.e.source),i=n.data.x+n.data.width/2,a=n.data.y,s=e.data.x-i,o=n.data.height/2;r.hasEdge(e.data.e.id)?r.updateEdgeData(e.data.e.id,e.data.e.data):r.addEdge({id:e.data.e.id,source:e.data.e.source,target:e.data.e.target,data:e.data.e.data}),r.removeNode(t.id),e.data.e.data.points=[{x:i+2*s/3,y:a-o},{x:i+5*s/6,y:a-o},{y:a,x:i+s},{x:i+5*s/6,y:a+o},{x:i+2*s/3,y:a+o}],e.data.e.data.x=e.data.x,e.data.e.data.y=e.data.y}})},Hw=(r,t)=>{const e={};return t==null||t.forEach(n=>{r[n]!==void 0&&(e[n]=+r[n])}),e},Xw=(r={})=>{const t={};return Object.keys(r).forEach(e=>{t[e.toLowerCase()]=r[e]}),t},Ci=Array.isArray,HN=r=>{const t=[],e=r.length;for(let n=0;n<e;n+=1){t[n]=[];for(let i=0;i<e;i+=1)n===i?t[n][i]=0:r[n][i]===0||!r[n][i]?t[n][i]=1/0:t[n][i]=r[n][i]}for(let n=0;n<e;n+=1)for(let i=0;i<e;i+=1)for(let a=0;a<e;a+=1)t[i][a]>t[i][n]+t[n][a]&&(t[i][a]=t[i][n]+t[n][a]);return t},XN=(r,t)=>{const{nodes:e,edges:n}=r,i=[],a={};if(!e)throw new Error("invalid nodes data!");return e&&e.forEach((s,o)=>{a[s.id]=o;const l=[];i.push(l)}),n==null||n.forEach(s=>{const{source:o,target:l}=s,c=a[o],u=a[l];c===void 0||u===void 0||(i[c][u]=1,i[u][c]=1)}),i},L8=(r,t)=>{const e=[];return r.forEach(n=>{const i=[];n.forEach(a=>{i.push(a*t)}),e.push(i)}),e},I8=r=>{let t=1/0,e=1/0,n=-1/0,i=-1/0;return r.forEach(a=>{let s=a.data.size;Ci(s)?s.length===1&&(s=[s[0],s[0]]):St(s)?s=[s,s]:(s===void 0||isNaN(s))&&(s=[30,30]);const o=[s[0]/2,s[1]/2],l=a.data.x-o[0],c=a.data.x+o[0],u=a.data.y-o[1],h=a.data.y+o[1];t>l&&(t=l),e>u&&(e=u),n<c&&(n=c),i<h&&(i=h)}),{minX:t,minY:e,maxX:n,maxY:i}},Kw=(r,t)=>Math.sqrt((r.x-t.x)*(r.x-t.x)+(r.y-t.y)*(r.y-t.y)),Bm=(r,t,e,n="TB",i,a={})=>{if(!(t!=null&&t.length))return;const{stopBranchFn:s,stopAllFn:o}=a;for(let l=0;l<t.length;l++){const c=t[l];if(r.hasNode(c.id)&&!(s!=null&&s(c))){if(o!=null&&o(c))return;n==="TB"&&e(c),Bm(r,r.getChildren(c.id,i),e,n,i,a),n!=="TB"&&e(c)}}},zm=r=>{if(r===null)return r;if(r instanceof Date)return new Date(r.getTime());if(r instanceof Array){const t=[];return r.forEach(e=>{t.push(e)}),t.map(e=>zm(e))}if(typeof r=="object"){const t={};return Object.keys(r).forEach(e=>{t[e]=zm(r[e])}),t}return r},yr=(r,t)=>{const e=zm(r);return e.data=e.data||{},t&&(St(e.data.x)||(e.data.x=Math.random()*t[0]),St(e.data.y)||(e.data.y=Math.random()*t[1])),e};function bl(r){if(!r)return[0,0,0];if(St(r))return[r,r,r];if(r.length===0)return[0,0,0];const[t,e=t,n=t]=r;return[t,e,n]}function Wa(r,t){let e;return Tt(t)?e=t:St(t)?e=()=>t:e=()=>r,e}function V1(r,t,e=!0){return!t&&t!==0?n=>{const{size:i}=n.data||{};return i?Array.isArray(i)?e?Math.max(...i)||r:i:Ze(i)&&i.width&&i.height?e?Math.max(i.width,i.height)||r:[i.width,i.height]:i:r}:Tt(t)?t:St(t)?()=>t:Array.isArray(t)?()=>e?Math.max(...t)||r:t:Ze(t)&&t.width&&t.height?()=>e?Math.max(t.width,t.height)||r:[t.width,t.height]:()=>r}const U1=(r,t,e=10)=>{let n;const i=typeof t=="function"?t:()=>t||0;return r?Array.isArray(r)?n=s=>r:Tt(r)?n=r:n=s=>r:n=s=>{var o,l,c;if(!((o=s.data)===null||o===void 0)&&o.bboxSize)return(l=s.data)===null||l===void 0?void 0:l.bboxSize;if(!((c=s.data)===null||c===void 0)&&c.size){const u=s.data.size;return Array.isArray(u)?u:Ze(u)?[u.width,u.height]:u}return e},s=>{const o=n(s),l=i(s);return Math.max(...bl(o))+l}},D8={rankdir:"TB",nodesep:50,ranksep:50,edgeLabelSpace:!0,ranker:"tight-tree",controlPoints:!1,radial:!1,focusNode:null};class F8{constructor(t={}){this.options=t,this.id="antv-dagre",this.options=Object.assign(Object.assign({},D8),t)}execute(t,e){return Xt(this,void 0,void 0,function*(){return this.genericDagreLayout(!1,t,e)})}assign(t,e){return Xt(this,void 0,void 0,function*(){yield this.genericDagreLayout(!0,t,e)})}genericDagreLayout(t,e,n){return Xt(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),n),{nodeSize:a,align:s,rankdir:o="TB",ranksep:l,nodesep:c,ranksepFunc:u,nodesepFunc:h,edgeLabelSpace:d,ranker:f,nodeOrder:g,begin:v,controlPoints:p,radial:y,sortByCombo:m,preset:x}=i,E=new vn({tree:[]}),_=Wa(l||50,u),M=Wa(c||50,h);let O=M,T=_;(o==="LR"||o==="RL")&&(O=_,T=M);const N=V1(10,a,!1),P=e.getAllNodes(),C=e.getAllEdges();P.forEach(U=>{const tt=bl(N(U)),gt=T(U),xt=O(U),ut=tt[0]+2*xt,zt=tt[1]+2*gt,J=U.data.layer;St(J)?E.addNode({id:U.id,data:{width:ut,height:zt,layer:J}}):E.addNode({id:U.id,data:{width:ut,height:zt}})}),m&&(E.attachTreeStructure("combo"),P.forEach(U=>{const{parentId:tt}=U.data;tt!==void 0&&E.hasNode(tt)&&E.setParent(U.id,tt,"combo")})),C.forEach(U=>{E.addEdge({id:U.id,source:U.source,target:U.target,data:{weight:U.data.weight||1}})});let R;x!=null&&x.length&&(R=new vn({nodes:x})),f8(E,{prevGraph:R,edgeLabelSpace:d,keepNodeOrder:!!g,nodeOrder:g||[],acyclicer:"greedy",ranker:f,rankdir:o,nodesep:c,align:s});const I=[0,0];if(v){let U=1/0,tt=1/0;E.getAllNodes().forEach(gt=>{U>gt.data.x&&(U=gt.data.x),tt>gt.data.y&&(tt=gt.data.y)}),E.getAllEdges().forEach(gt=>{var xt;(xt=gt.data.points)===null||xt===void 0||xt.forEach(ut=>{U>ut.x&&(U=ut.x),tt>ut.y&&(tt=ut.y)})}),I[0]=v[0]-U,I[1]=v[1]-tt}const j=o==="LR"||o==="RL";if(!y){const U=new Set,gt=o==="BT"||o==="RL"?(J,W)=>W-J:(J,W)=>J-W;E.getAllNodes().forEach(J=>{J.data.x=J.data.x+I[0],J.data.y=J.data.y+I[1],U.add(j?J.data.x:J.data.y)});const xt=Array.from(U).sort(gt),ut=j?(J,W)=>J.x!==W.x:(J,W)=>J.y!==W.y,zt=j?(J,W,Q)=>{const ht=Math.max(W.y,Q.y),Et=Math.min(W.y,Q.y);return J.filter(Pt=>Pt.y<=ht&&Pt.y>=Et)}:(J,W,Q)=>{const ht=Math.max(W.x,Q.x),Et=Math.min(W.x,Q.x);return J.filter(Pt=>Pt.x<=ht&&Pt.x>=Et)};E.getAllEdges().forEach((J,W)=>{var Q;d&&p&&J.data.type!=="loop"&&(J.data.controlPoints=B8((Q=J.data.points)===null||Q===void 0?void 0:Q.map(({x:ht,y:Et})=>({x:ht+I[0],y:Et+I[1]})),E.getNode(J.source),E.getNode(J.target),xt,j,ut,zt))})}let G=[];G=E.getAllNodes().map(U=>yr(U));const H=E.getAllEdges();return t&&(G.forEach(U=>{e.mergeNodeData(U.id,{x:U.data.x,y:U.data.y})}),H.forEach(U=>{e.mergeEdgeData(U.id,{controlPoints:U.data.controlPoints})})),{nodes:G,edges:H}})}}const B8=(r,t,e,n,i,a,s)=>{let o=(r==null?void 0:r.slice(1,r.length-1))||[];if(t&&e){let{x:l,y:c}=t.data,{x:u,y:h}=e.data;if(i&&(l=t.data.y,c=t.data.x,u=e.data.y,h=e.data.x),h!==c&&l!==u){const d=n.indexOf(c),f=n[d+1];if(f){const p=o[0],y=i?{x:(c+f)/2,y:(p==null?void 0:p.y)||u}:{x:(p==null?void 0:p.x)||u,y:(c+f)/2};(!p||a(p,y))&&o.unshift(y)}const g=n.indexOf(h),v=Math.abs(g-d);if(v===1)o=s(o,t.data,e.data),o.length||o.push(i?{x:(c+h)/2,y:l}:{x:l,y:(c+h)/2});else if(v>1){const p=n[g-1];if(p){const y=o[o.length-1],m=i?{x:(h+p)/2,y:(y==null?void 0:y.y)||u}:{x:(y==null?void 0:y.x)||l,y:(h+p)/2};(!y||a(y,m))&&o.push(m)}}}}return o},os=(r,t,e)=>{const n=r.getAllNodes(),i=r.getAllEdges();if(!(n!=null&&n.length))return{nodes:[],edges:i};if(n.length===1)return t&&r.mergeNodeData(n[0].id,{x:e[0],y:e[1]}),{nodes:[Object.assign(Object.assign({},n[0]),{data:Object.assign(Object.assign({},n[0].data),{x:e[0],y:e[1]})})],edges:i}},z8={radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1};class j8{constructor(t={}){this.options=t,this.id="circular",this.options=Object.assign(Object.assign({},z8),t)}execute(t,e){return Xt(this,void 0,void 0,function*(){return this.genericCircularLayout(!1,t,e)})}assign(t,e){return Xt(this,void 0,void 0,function*(){yield this.genericCircularLayout(!0,t,e)})}genericCircularLayout(t,e,n){return Xt(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),n),{width:a,height:s,center:o,divisions:l,startAngle:c=0,endAngle:u=2*Math.PI,angleRatio:h,ordering:d,clockwise:f,nodeSpacing:g,nodeSize:v}=i,p=e.getAllNodes(),y=e.getAllEdges(),[m,x,E]=G8(a,s,o),_=p==null?void 0:p.length;if(!_||_===1)return os(e,t,E);const M=(u-c)/_;let{radius:O,startRadius:T,endRadius:N}=i;if(g){const j=Wa(10,g),G=V1(10,v);let H=-1/0;p.forEach(U=>{const tt=G(U);H<tt&&(H=tt)});let Z=0;p.forEach((U,tt)=>{tt===0?Z+=H||10:Z+=(j(U)||0)+(H||10)}),O=Z/(2*Math.PI)}else!O&&!T&&!N?O=Math.min(x,m)/2:!T&&N?T=N:T&&!N&&(N=T);const P=M*h;let C=[];d==="topology"?C=Zw(e,p):d==="topology-directed"?C=Zw(e,p,!0):d==="degree"?C=q8(e,p):C=p.map(j=>yr(j));const R=Math.ceil(_/l);for(let j=0;j<_;++j){let G=O;!G&&T!==null&&N!==null&&(G=T+j*(N-T)/(_-1)),G||(G=10+j*100/(_-1));let H=c+j%R*P+2*Math.PI/l*Math.floor(j/R);f||(H=u-j%R*P-2*Math.PI/l*Math.floor(j/R)),C[j].data.x=E[0]+Math.cos(H)*G,C[j].data.y=E[1]+Math.sin(H)*G}return t&&C.forEach(j=>{e.mergeNodeData(j.id,{x:j.data.x,y:j.data.y})}),{nodes:C,edges:y}})}}const Zw=(r,t,e=!1)=>{const n=[yr(t[0])],i={},a=t.length;i[t[0].id]=!0;let s=0;return t.forEach((o,l)=>{if(l!==0)if((l===a-1||r.getDegree(o.id,"both")!==r.getDegree(t[l+1].id,"both")||r.areNeighbors(n[s].id,o.id))&&!i[o.id])n.push(yr(o)),i[o.id]=!0,s++;else{const c=e?r.getSuccessors(n[s].id):r.getNeighbors(n[s].id);let u=!1;for(let d=0;d<c.length;d++){const f=c[d];if(r.getDegree(f.id)===r.getDegree(o.id)&&!i[f.id]){n.push(yr(f)),i[f.id]=!0,u=!0;break}}let h=0;for(;!u&&(i[t[h].id]||(n.push(yr(t[h])),i[t[h].id]=!0,u=!0),h++,h!==a););}}),n};function q8(r,t){const e=[];return t.forEach((n,i)=>{e.push(yr(n))}),e.sort((n,i)=>r.getDegree(n.id,"both")-r.getDegree(i.id,"both")),e}const G8=(r,t,e)=>{let n=r,i=t,a=e;return!n&&typeof window<"u"&&(n=window.innerWidth),!i&&typeof window<"u"&&(i=window.innerHeight),a||(a=[n/2,i/2]),[n,i,a]},$8={nodeSize:30,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:3/2*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"};class jm{constructor(t={}){this.options=t,this.id="concentric",this.options=Object.assign(Object.assign({},$8),t)}execute(t,e){return Xt(this,void 0,void 0,function*(){return this.genericConcentricLayout(!1,t,e)})}assign(t,e){return Xt(this,void 0,void 0,function*(){yield this.genericConcentricLayout(!0,t,e)})}genericConcentricLayout(t,e,n){return Xt(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),n),{center:a,width:s,height:o,sortBy:l,maxLevelDiff:c,sweep:u,clockwise:h,equidistant:d,preventOverlap:f,startAngle:g=3/2*Math.PI,nodeSize:v,nodeSpacing:p}=i,y=e.getAllNodes(),m=e.getAllEdges(),x=!s&&typeof window<"u"?window.innerWidth:s,E=!o&&typeof window<"u"?window.innerHeight:o,_=a||[x/2,E/2];if(!(y!=null&&y.length)||y.length===1)return os(e,t,_);const M=[];let O,T=0;Ci(v)?O=Math.max(v[0],v[1]):Tt(v)?(O=-1/0,y.forEach(U=>{const tt=Math.max(...bl(v(U)));tt>O&&(O=tt)})):O=v,Ci(p)?T=Math.max(p[0],p[1]):St(p)&&(T=p),y.forEach(U=>{const tt=yr(U);M.push(tt);let gt=O;const{data:xt}=tt;Ci(xt.size)?gt=Math.max(xt.size[0],xt.size[1]):St(xt.size)?gt=xt.size:Ze(xt.size)&&(gt=Math.max(xt.size.width,xt.size.height)),O=Math.max(O,gt),Tt(p)&&(T=Math.max(p(U),T))});const N={};M.forEach((U,tt)=>{N[U.id]=tt});let P=l;(!ae(P)||M[0].data[P]===void 0)&&(P="degree"),P==="degree"?M.sort((U,tt)=>e.getDegree(tt.id,"both")-e.getDegree(U.id,"both")):M.sort((U,tt)=>tt.data[P]-U.data[P]);const C=M[0],R=(c||(P==="degree"?e.getDegree(C.id,"both"):C.data[P]))/4,I=[{nodes:[]}];let j=I[0];M.forEach(U=>{if(j.nodes.length>0){const tt=Math.abs(P==="degree"?e.getDegree(j.nodes[0].id,"both")-e.getDegree(U.id,"both"):j.nodes[0].data[P]-U.data[P]);R&&tt>=R&&(j={nodes:[]},I.push(j))}j.nodes.push(U)});let G=O+T;if(!f){const U=I.length>0&&I[0].nodes.length>1,gt=(Math.min(x,E)/2-G)/(I.length+(U?1:0));G=Math.min(G,gt)}let H=0;if(I.forEach(U=>{const tt=u===void 0?2*Math.PI-2*Math.PI/U.nodes.length:u;if(U.dTheta=tt/Math.max(1,U.nodes.length-1),U.nodes.length>1&&f){const gt=Math.cos(U.dTheta)-Math.cos(0),xt=Math.sin(U.dTheta)-Math.sin(0),ut=Math.sqrt(G*G/(gt*gt+xt*xt));H=Math.max(ut,H)}U.r=H,H+=G}),d){let U=0,tt=0;for(let gt=0;gt<I.length;gt++){const ut=(I[gt].r||0)-tt;U=Math.max(U,ut)}tt=0,I.forEach((gt,xt)=>{xt===0&&(tt=gt.r||0),gt.r=tt,tt+=U})}return I.forEach(U=>{const tt=U.dTheta||0,gt=U.r||0;U.nodes.forEach((xt,ut)=>{const zt=g+(h?1:-1)*tt*ut;xt.data.x=_[0]+gt*Math.cos(zt),xt.data.y=_[1]+gt*Math.sin(zt)})}),t&&M.forEach(U=>e.mergeNodeData(U.id,{x:U.data.x,y:U.data.y})),{nodes:M,edges:m}})}}function W8(r){const t=+this._x.call(null,r),e=+this._y.call(null,r);return KN(this.cover(t,e),t,e,r)}function KN(r,t,e,n){if(isNaN(t)||isNaN(e))return r;var i,a=r._root,s={data:n},o=r._x0,l=r._y0,c=r._x1,u=r._y1,h,d,f,g,v,p,y,m;if(!a)return r._root=s,r;for(;a.length;)if((v=t>=(h=(o+c)/2))?o=h:c=h,(p=e>=(d=(l+u)/2))?l=d:u=d,i=a,!(a=a[y=p<<1|v]))return i[y]=s,r;if(f=+r._x.call(null,a.data),g=+r._y.call(null,a.data),t===f&&e===g)return s.next=a,i?i[y]=s:r._root=s,r;do i=i?i[y]=new Array(4):r._root=new Array(4),(v=t>=(h=(o+c)/2))?o=h:c=h,(p=e>=(d=(l+u)/2))?l=d:u=d;while((y=p<<1|v)===(m=(g>=d)<<1|f>=h));return i[m]=a,i[y]=s,r}function V8(r){var t,e,n=r.length,i,a,s=new Array(n),o=new Array(n),l=1/0,c=1/0,u=-1/0,h=-1/0;for(e=0;e<n;++e)isNaN(i=+this._x.call(null,t=r[e]))||isNaN(a=+this._y.call(null,t))||(s[e]=i,o[e]=a,i<l&&(l=i),i>u&&(u=i),a<c&&(c=a),a>h&&(h=a));if(l>u||c>h)return this;for(this.cover(l,c).cover(u,h),e=0;e<n;++e)KN(this,s[e],o[e],r[e]);return this}function U8(r,t){if(isNaN(r=+r)||isNaN(t=+t))return this;var e=this._x0,n=this._y0,i=this._x1,a=this._y1;if(isNaN(e))i=(e=Math.floor(r))+1,a=(n=Math.floor(t))+1;else{for(var s=i-e||1,o=this._root,l,c;e>r||r>=i||n>t||t>=a;)switch(c=(t<n)<<1|r<e,l=new Array(4),l[c]=o,o=l,s*=2,c){case 0:i=e+s,a=n+s;break;case 1:e=i-s,a=n+s;break;case 2:i=e+s,n=a-s;break;case 3:e=i-s,n=a-s;break}this._root&&this._root.length&&(this._root=o)}return this._x0=e,this._y0=n,this._x1=i,this._y1=a,this}function Y8(){var r=[];return this.visit(function(t){if(!t.length)do r.push(t.data);while(t=t.next)}),r}function H8(r){return arguments.length?this.cover(+r[0][0],+r[0][1]).cover(+r[1][0],+r[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Vn(r,t,e,n,i){this.node=r,this.x0=t,this.y0=e,this.x1=n,this.y1=i}function X8(r,t,e){var n,i=this._x0,a=this._y0,s,o,l,c,u=this._x1,h=this._y1,d=[],f=this._root,g,v;for(f&&d.push(new Vn(f,i,a,u,h)),e==null?e=1/0:(i=r-e,a=t-e,u=r+e,h=t+e,e*=e);g=d.pop();)if(!(!(f=g.node)||(s=g.x0)>u||(o=g.y0)>h||(l=g.x1)<i||(c=g.y1)<a))if(f.length){var p=(s+l)/2,y=(o+c)/2;d.push(new Vn(f[3],p,y,l,c),new Vn(f[2],s,y,p,c),new Vn(f[1],p,o,l,y),new Vn(f[0],s,o,p,y)),(v=(t>=y)<<1|r>=p)&&(g=d[d.length-1],d[d.length-1]=d[d.length-1-v],d[d.length-1-v]=g)}else{var m=r-+this._x.call(null,f.data),x=t-+this._y.call(null,f.data),E=m*m+x*x;if(E<e){var _=Math.sqrt(e=E);i=r-_,a=t-_,u=r+_,h=t+_,n=f.data}}return n}function K8(r){if(isNaN(u=+this._x.call(null,r))||isNaN(h=+this._y.call(null,r)))return this;var t,e=this._root,n,i,a,s=this._x0,o=this._y0,l=this._x1,c=this._y1,u,h,d,f,g,v,p,y;if(!e)return this;if(e.length)for(;;){if((g=u>=(d=(s+l)/2))?s=d:l=d,(v=h>=(f=(o+c)/2))?o=f:c=f,t=e,!(e=e[p=v<<1|g]))return this;if(!e.length)break;(t[p+1&3]||t[p+2&3]||t[p+3&3])&&(n=t,y=p)}for(;e.data!==r;)if(i=e,!(e=e.next))return this;return(a=e.next)&&delete e.next,i?(a?i.next=a:delete i.next,this):t?(a?t[p]=a:delete t[p],(e=t[0]||t[1]||t[2]||t[3])&&e===(t[3]||t[2]||t[1]||t[0])&&!e.length&&(n?n[y]=e:this._root=e),this):(this._root=a,this)}function Z8(r){for(var t=0,e=r.length;t<e;++t)this.remove(r[t]);return this}function J8(){return this._root}function Q8(){var r=0;return this.visit(function(t){if(!t.length)do++r;while(t=t.next)}),r}function t9(r){var t=[],e,n=this._root,i,a,s,o,l;for(n&&t.push(new Vn(n,this._x0,this._y0,this._x1,this._y1));e=t.pop();)if(!r(n=e.node,a=e.x0,s=e.y0,o=e.x1,l=e.y1)&&n.length){var c=(a+o)/2,u=(s+l)/2;(i=n[3])&&t.push(new Vn(i,c,u,o,l)),(i=n[2])&&t.push(new Vn(i,a,u,c,l)),(i=n[1])&&t.push(new Vn(i,c,s,o,u)),(i=n[0])&&t.push(new Vn(i,a,s,c,u))}return this}function e9(r){var t=[],e=[],n;for(this._root&&t.push(new Vn(this._root,this._x0,this._y0,this._x1,this._y1));n=t.pop();){var i=n.node;if(i.length){var a,s=n.x0,o=n.y0,l=n.x1,c=n.y1,u=(s+l)/2,h=(o+c)/2;(a=i[0])&&t.push(new Vn(a,s,o,u,h)),(a=i[1])&&t.push(new Vn(a,u,o,l,h)),(a=i[2])&&t.push(new Vn(a,s,h,u,c)),(a=i[3])&&t.push(new Vn(a,u,h,l,c))}e.push(n)}for(;n=e.pop();)r(n.node,n.x0,n.y0,n.x1,n.y1);return this}function n9(r){return r[0]}function r9(r){return arguments.length?(this._x=r,this):this._x}function i9(r){return r[1]}function a9(r){return arguments.length?(this._y=r,this):this._y}function lh(r,t,e){var n=new Y1(t??n9,e??i9,NaN,NaN,NaN,NaN);return r==null?n:n.addAll(r)}function Y1(r,t,e,n,i,a){this._x=r,this._y=t,this._x0=e,this._y0=n,this._x1=i,this._y1=a,this._root=void 0}function Jw(r){for(var t={data:r.data},e=t;r=r.next;)e=e.next={data:r.data};return t}var Hn=lh.prototype=Y1.prototype;Hn.copy=function(){var r=new Y1(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,e,n;if(!t)return r;if(!t.length)return r._root=Jw(t),r;for(e=[{source:t,target:r._root=new Array(4)}];t=e.pop();)for(var i=0;i<4;++i)(n=t.source[i])&&(n.length?e.push({source:n,target:t.target[i]=new Array(4)}):t.target[i]=Jw(n));return r};Hn.add=W8;Hn.addAll=V8;Hn.cover=U8;Hn.data=Y8;Hn.extent=H8;Hn.find=X8;Hn.remove=K8;Hn.removeAll=Z8;Hn.root=J8;Hn.size=Q8;Hn.visit=t9;Hn.visitAfter=e9;Hn.x=r9;Hn.y=a9;function s9(r){const t=+this._x.call(null,r),e=+this._y.call(null,r),n=+this._z.call(null,r);return ZN(this.cover(t,e,n),t,e,n,r)}function ZN(r,t,e,n,i){if(isNaN(t)||isNaN(e)||isNaN(n))return r;var a,s=r._root,o={data:i},l=r._x0,c=r._y0,u=r._z0,h=r._x1,d=r._y1,f=r._z1,g,v,p,y,m,x,E,_,M,O,T;if(!s)return r._root=o,r;for(;s.length;)if((E=t>=(g=(l+h)/2))?l=g:h=g,(_=e>=(v=(c+d)/2))?c=v:d=v,(M=n>=(p=(u+f)/2))?u=p:f=p,a=s,!(s=s[O=M<<2|_<<1|E]))return a[O]=o,r;if(y=+r._x.call(null,s.data),m=+r._y.call(null,s.data),x=+r._z.call(null,s.data),t===y&&e===m&&n===x)return o.next=s,a?a[O]=o:r._root=o,r;do a=a?a[O]=new Array(8):r._root=new Array(8),(E=t>=(g=(l+h)/2))?l=g:h=g,(_=e>=(v=(c+d)/2))?c=v:d=v,(M=n>=(p=(u+f)/2))?u=p:f=p;while((O=M<<2|_<<1|E)===(T=(x>=p)<<2|(m>=v)<<1|y>=g));return a[T]=s,a[O]=o,r}function o9(r){Array.isArray(r)||(r=Array.from(r));const t=r.length,e=new Float64Array(t),n=new Float64Array(t),i=new Float64Array(t);let a=1/0,s=1/0,o=1/0,l=-1/0,c=-1/0,u=-1/0;for(let h=0,d,f,g,v;h<t;++h)isNaN(f=+this._x.call(null,d=r[h]))||isNaN(g=+this._y.call(null,d))||isNaN(v=+this._z.call(null,d))||(e[h]=f,n[h]=g,i[h]=v,f<a&&(a=f),f>l&&(l=f),g<s&&(s=g),g>c&&(c=g),v<o&&(o=v),v>u&&(u=v));if(a>l||s>c||o>u)return this;this.cover(a,s,o).cover(l,c,u);for(let h=0;h<t;++h)ZN(this,e[h],n[h],i[h],r[h]);return this}function l9(r,t,e){if(isNaN(r=+r)||isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,i=this._y0,a=this._z0,s=this._x1,o=this._y1,l=this._z1;if(isNaN(n))s=(n=Math.floor(r))+1,o=(i=Math.floor(t))+1,l=(a=Math.floor(e))+1;else{for(var c=s-n||1,u=this._root,h,d;n>r||r>=s||i>t||t>=o||a>e||e>=l;)switch(d=(e<a)<<2|(t<i)<<1|r<n,h=new Array(8),h[d]=u,u=h,c*=2,d){case 0:s=n+c,o=i+c,l=a+c;break;case 1:n=s-c,o=i+c,l=a+c;break;case 2:s=n+c,i=o-c,l=a+c;break;case 3:n=s-c,i=o-c,l=a+c;break;case 4:s=n+c,o=i+c,a=l-c;break;case 5:n=s-c,o=i+c,a=l-c;break;case 6:s=n+c,i=o-c,a=l-c;break;case 7:n=s-c,i=o-c,a=l-c;break}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=i,this._z0=a,this._x1=s,this._y1=o,this._z1=l,this}function c9(){var r=[];return this.visit(function(t){if(!t.length)do r.push(t.data);while(t=t.next)}),r}function u9(r){return arguments.length?this.cover(+r[0][0],+r[0][1],+r[0][2]).cover(+r[1][0],+r[1][1],+r[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]}function xe(r,t,e,n,i,a,s){this.node=r,this.x0=t,this.y0=e,this.z0=n,this.x1=i,this.y1=a,this.z1=s}function h9(r,t,e,n){var i,a=this._x0,s=this._y0,o=this._z0,l,c,u,h,d,f,g=this._x1,v=this._y1,p=this._z1,y=[],m=this._root,x,E;for(m&&y.push(new xe(m,a,s,o,g,v,p)),n==null?n=1/0:(a=r-n,s=t-n,o=e-n,g=r+n,v=t+n,p=e+n,n*=n);x=y.pop();)if(!(!(m=x.node)||(l=x.x0)>g||(c=x.y0)>v||(u=x.z0)>p||(h=x.x1)<a||(d=x.y1)<s||(f=x.z1)<o))if(m.length){var _=(l+h)/2,M=(c+d)/2,O=(u+f)/2;y.push(new xe(m[7],_,M,O,h,d,f),new xe(m[6],l,M,O,_,d,f),new xe(m[5],_,c,O,h,M,f),new xe(m[4],l,c,O,_,M,f),new xe(m[3],_,M,u,h,d,O),new xe(m[2],l,M,u,_,d,O),new xe(m[1],_,c,u,h,M,O),new xe(m[0],l,c,u,_,M,O)),(E=(e>=O)<<2|(t>=M)<<1|r>=_)&&(x=y[y.length-1],y[y.length-1]=y[y.length-1-E],y[y.length-1-E]=x)}else{var T=r-+this._x.call(null,m.data),N=t-+this._y.call(null,m.data),P=e-+this._z.call(null,m.data),C=T*T+N*N+P*P;if(C<n){var R=Math.sqrt(n=C);a=r-R,s=t-R,o=e-R,g=r+R,v=t+R,p=e+R,i=m.data}}return i}const d9=(r,t,e,n,i,a)=>Math.sqrt((r-n)**2+(t-i)**2+(e-a)**2);function f9(r,t,e,n){const i=[],a=r-n,s=t-n,o=e-n,l=r+n,c=t+n,u=e+n;return this.visit((h,d,f,g,v,p,y)=>{if(!h.length)do{const m=h.data;d9(r,t,e,this._x(m),this._y(m),this._z(m))<=n&&i.push(m)}while(h=h.next);return d>l||f>c||g>u||v<a||p<s||y<o}),i}function g9(r){if(isNaN(d=+this._x.call(null,r))||isNaN(f=+this._y.call(null,r))||isNaN(g=+this._z.call(null,r)))return this;var t,e=this._root,n,i,a,s=this._x0,o=this._y0,l=this._z0,c=this._x1,u=this._y1,h=this._z1,d,f,g,v,p,y,m,x,E,_,M;if(!e)return this;if(e.length)for(;;){if((m=d>=(v=(s+c)/2))?s=v:c=v,(x=f>=(p=(o+u)/2))?o=p:u=p,(E=g>=(y=(l+h)/2))?l=y:h=y,t=e,!(e=e[_=E<<2|x<<1|m]))return this;if(!e.length)break;(t[_+1&7]||t[_+2&7]||t[_+3&7]||t[_+4&7]||t[_+5&7]||t[_+6&7]||t[_+7&7])&&(n=t,M=_)}for(;e.data!==r;)if(i=e,!(e=e.next))return this;return(a=e.next)&&delete e.next,i?(a?i.next=a:delete i.next,this):t?(a?t[_]=a:delete t[_],(e=t[0]||t[1]||t[2]||t[3]||t[4]||t[5]||t[6]||t[7])&&e===(t[7]||t[6]||t[5]||t[4]||t[3]||t[2]||t[1]||t[0])&&!e.length&&(n?n[M]=e:this._root=e),this):(this._root=a,this)}function v9(r){for(var t=0,e=r.length;t<e;++t)this.remove(r[t]);return this}function p9(){return this._root}function y9(){var r=0;return this.visit(function(t){if(!t.length)do++r;while(t=t.next)}),r}function m9(r){var t=[],e,n=this._root,i,a,s,o,l,c,u;for(n&&t.push(new xe(n,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));e=t.pop();)if(!r(n=e.node,a=e.x0,s=e.y0,o=e.z0,l=e.x1,c=e.y1,u=e.z1)&&n.length){var h=(a+l)/2,d=(s+c)/2,f=(o+u)/2;(i=n[7])&&t.push(new xe(i,h,d,f,l,c,u)),(i=n[6])&&t.push(new xe(i,a,d,f,h,c,u)),(i=n[5])&&t.push(new xe(i,h,s,f,l,d,u)),(i=n[4])&&t.push(new xe(i,a,s,f,h,d,u)),(i=n[3])&&t.push(new xe(i,h,d,o,l,c,f)),(i=n[2])&&t.push(new xe(i,a,d,o,h,c,f)),(i=n[1])&&t.push(new xe(i,h,s,o,l,d,f)),(i=n[0])&&t.push(new xe(i,a,s,o,h,d,f))}return this}function b9(r){var t=[],e=[],n;for(this._root&&t.push(new xe(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));n=t.pop();){var i=n.node;if(i.length){var a,s=n.x0,o=n.y0,l=n.z0,c=n.x1,u=n.y1,h=n.z1,d=(s+c)/2,f=(o+u)/2,g=(l+h)/2;(a=i[0])&&t.push(new xe(a,s,o,l,d,f,g)),(a=i[1])&&t.push(new xe(a,d,o,l,c,f,g)),(a=i[2])&&t.push(new xe(a,s,f,l,d,u,g)),(a=i[3])&&t.push(new xe(a,d,f,l,c,u,g)),(a=i[4])&&t.push(new xe(a,s,o,g,d,f,h)),(a=i[5])&&t.push(new xe(a,d,o,g,c,f,h)),(a=i[6])&&t.push(new xe(a,s,f,g,d,u,h)),(a=i[7])&&t.push(new xe(a,d,f,g,c,u,h))}e.push(n)}for(;n=e.pop();)r(n.node,n.x0,n.y0,n.z0,n.x1,n.y1,n.z1);return this}function x9(r){return r[0]}function w9(r){return arguments.length?(this._x=r,this):this._x}function E9(r){return r[1]}function S9(r){return arguments.length?(this._y=r,this):this._y}function _9(r){return r[2]}function k9(r){return arguments.length?(this._z=r,this):this._z}function JN(r,t,e,n){var i=new H1(t??x9,e??E9,n??_9,NaN,NaN,NaN,NaN,NaN,NaN);return r==null?i:i.addAll(r)}function H1(r,t,e,n,i,a,s,o,l){this._x=r,this._y=t,this._z=e,this._x0=n,this._y0=i,this._z0=a,this._x1=s,this._y1=o,this._z1=l,this._root=void 0}function Qw(r){for(var t={data:r.data},e=t;r=r.next;)e=e.next={data:r.data};return t}var Cn=JN.prototype=H1.prototype;Cn.copy=function(){var r=new H1(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),t=this._root,e,n;if(!t)return r;if(!t.length)return r._root=Qw(t),r;for(e=[{source:t,target:r._root=new Array(8)}];t=e.pop();)for(var i=0;i<8;++i)(n=t.source[i])&&(n.length?e.push({source:n,target:t.target[i]=new Array(8)}):t.target[i]=Qw(n));return r};Cn.add=s9;Cn.addAll=o9;Cn.cover=l9;Cn.data=c9;Cn.extent=u9;Cn.find=h9;Cn.findAllWithinRadius=f9;Cn.remove=g9;Cn.removeAll=v9;Cn.root=p9;Cn.size=y9;Cn.visit=m9;Cn.visitAfter=b9;Cn.x=w9;Cn.y=S9;Cn.z=k9;const M9=.81,hf=.1;function T9(r,t,e,n,i=2){const a=t/e,s=r.getAllNodes(),o=s.map((u,h)=>{const{nodeStrength:d,x:f,y:g,z:v,size:p}=u.data;return{x:f,y:g,z:v,size:p,index:h,id:u.id,vx:0,vy:0,vz:0,weight:a*d}}),l=(i===2?lh(o,u=>u.x,u=>u.y):JN(o,u=>u.x,u=>u.y,u=>u.z)).visitAfter(O9),c=new Map;return o.forEach(u=>{c.set(u.id,u),N9(u,l,i)}),o.map((u,h)=>{const{id:d,data:f}=s[h],{mass:g=1}=f;n[d]={x:u.vx/g,y:u.vy/g,z:u.vz/g}}),n}function O9(r){let t=0,e=0,n=0,i=0,a=0;const s=r.length;if(s){for(let o=0;o<s;o++){const l=r[o];l&&l.weight&&(t+=l.weight,e+=l.x*l.weight,n+=l.y*l.weight,i+=l.z*l.weight,a+=l.size*l.weight)}r.x=e/t,r.y=n/t,r.z=i/t,r.size=a/t,r.weight=t}else{const o=r;r.x=o.data.x,r.y=o.data.y,r.z=o.data.z,r.size=o.data.size,r.weight=o.data.weight}}const A9=(r,t,e,n,i,a,s)=>{var o;if(((o=r.data)===null||o===void 0?void 0:o.id)===a.id)return;const l=[e,n,i][s-1],c=a.x-r.x||hf,u=a.y-r.y||hf,h=a.z-r.z||hf,d=[c,u,h],f=l-t;let g=0;for(let y=0;y<s;y++)g+=d[y]*d[y];const p=Math.sqrt(g)*g;if(f*f*M9<g){const y=r.weight/p;return a.vx+=c*y,a.vy+=u*y,a.vz+=h*y,!0}if(r.length)return!1;if(r.data!==a){const y=r.data.weight/p;a.vx+=c*y,a.vy+=u*y,a.vz+=h*y}};function N9(r,t,e){t.visit((n,i,a,s,o)=>A9(n,i,a,s,o,r,e))}const P9={dimensions:2,maxIteration:500,gravity:10,factor:1,edgeStrength:50,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:200,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean"};class QN{constructor(t={}){this.options=t,this.id="force",this.timeInterval=0,this.judgingDistance=0,this.running=!1,this.options=Object.assign(Object.assign({},P9),t)}execute(t,e){return Xt(this,void 0,void 0,function*(){return this.genericForceLayout(!1,t,e)})}assign(t,e){return Xt(this,void 0,void 0,function*(){yield this.genericForceLayout(!0,t,e)})}stop(){this.timeInterval&&typeof window<"u"&&window.clearInterval(this.timeInterval),this.running=!1}tick(t=this.options.maxIteration||1){if(this.lastResult)return this.lastResult;for(let n=0;(this.judgingDistance>this.lastOptions.minMovement||n<1)&&n<t;n++)this.runOneStep(this.lastCalcGraph,this.lastGraph,n,this.lastVelMap,this.lastOptions),this.updatePosition(this.lastGraph,this.lastCalcGraph,this.lastVelMap,this.lastOptions);const e={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&e.nodes.forEach(n=>this.lastGraph.mergeNodeData(n.id,{x:n.data.x,y:n.data.y,z:this.options.dimensions===3?n.data.z:void 0})),e}genericForceLayout(t,e,n){return Xt(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),n),a=e.getAllNodes(),s=e.getAllEdges(),o=this.formatOptions(i,e),{dimensions:l,width:c,height:u,nodeSize:h,getMass:d,nodeStrength:f,edgeStrength:g,linkDistance:v}=o,p=a.map((T,N)=>Object.assign(Object.assign({},T),{data:Object.assign(Object.assign({},T.data),{x:St(T.data.x)?T.data.x:Math.random()*c,y:St(T.data.y)?T.data.y:Math.random()*u,z:St(T.data.z)?T.data.z:Math.random()*Math.sqrt(c*u),size:h(T)||30,mass:d(T),nodeStrength:f(T)})})),y=s.map(T=>Object.assign(Object.assign({},T),{data:Object.assign(Object.assign({},T.data),{edgeStrength:g(T),linkDistance:v(T,e.getNode(T.source),e.getNode(T.target))})}));if(!(a!=null&&a.length))return this.lastResult={nodes:[],edges:s},{nodes:[],edges:s};const m={};a.forEach((T,N)=>{m[T.id]={x:0,y:0,z:0}});const x=new vn({nodes:p,edges:y});this.formatCentripetal(o,x);const{maxIteration:E,minMovement:_,onTick:M}=o;if(this.lastLayoutNodes=p,this.lastLayoutEdges=y,this.lastAssign=t,this.lastGraph=e,this.lastCalcGraph=x,this.lastOptions=o,this.lastVelMap=m,typeof window>"u")return;let O=0;return new Promise(T=>{this.timeInterval=window.setInterval(()=>{(!a||!this.running)&&T({nodes:df(e,p),edges:s}),this.runOneStep(x,e,O,m,o),this.updatePosition(e,x,m,o),t&&p.forEach(N=>e.mergeNodeData(N.id,{x:N.data.x,y:N.data.y,z:l===3?N.data.z:void 0})),M==null||M({nodes:df(e,p),edges:s}),O++,(O>=E||this.judgingDistance<_)&&(window.clearInterval(this.timeInterval),T({nodes:df(e,p),edges:s}))},0),this.running=!0})})}formatOptions(t,e){const n=Object.assign({},t),{width:i,height:a,getMass:s}=t;n.width=!i&&typeof window<"u"?window.innerWidth:i,n.height=!a&&typeof window<"u"?window.innerHeight:a,t.center||(n.center=[n.width/2,n.height/2]),s||(n.getMass=l=>{let c=1;St(l==null?void 0:l.data.mass)&&(c=l==null?void 0:l.data.mass);const u=e.getDegree(l.id,"both");return!u||u<5?c:u*5*c}),n.nodeSize=U1(t.nodeSize,t.nodeSpacing);const o=t.linkDistance?Wa(1,t.linkDistance):l=>1+n.nodeSize(e.getNode(l.source))+n.nodeSize(e.getNode(l.target));return n.linkDistance=o,n.nodeStrength=Wa(1,t.nodeStrength),n.edgeStrength=Wa(1,t.edgeStrength),n}formatCentripetal(t,e){const{dimensions:n,centripetalOptions:i,center:a,clusterNodeStrength:s,leafCluster:o,clustering:l,nodeClusterBy:c}=t,u=e.getAllNodes(),h=i||{leaf:2,single:2,others:1,center:y=>({x:a[0],y:a[1],z:n===3?a[2]:void 0})};typeof s!="function"&&(t.clusterNodeStrength=y=>s);let d,f;if(o&&c&&(d=tE(e,c),f=Array.from(new Set(u==null?void 0:u.map(y=>y.data[c])))||[],t.centripetalOptions=Object.assign(h,{single:100,leaf:y=>{const{siblingLeaves:m,sameTypeLeaves:x}=d[y.id]||{};return(x==null?void 0:x.length)===(m==null?void 0:m.length)||(f==null?void 0:f.length)===1?1:t.clusterNodeStrength(y)},others:1,center:y=>{const m=e.getDegree(y.id,"both");if(!m)return{x:100,y:100,z:0};let x;if(m===1){const{sameTypeLeaves:E=[]}=d[y.id]||{};E.length===1?x=void 0:E.length>1&&(x=eE(E))}else x=void 0;return{x:x==null?void 0:x.x,y:x==null?void 0:x.y,z:x==null?void 0:x.z}}})),l&&c){d||(d=tE(e,c)),f||(f=Array.from(new Set(u.map(m=>m.data[c])))),f=f.filter(m=>m!==void 0);const y={};f.forEach(m=>{const x=u.filter(E=>E.data[c]===m).map(E=>e.getNode(E.id));y[m]=eE(x)}),t.centripetalOptions=Object.assign(h,{single:m=>t.clusterNodeStrength(m),leaf:m=>t.clusterNodeStrength(m),others:m=>t.clusterNodeStrength(m),center:m=>{const x=y[m.data[c]];return{x:x==null?void 0:x.x,y:x==null?void 0:x.y,z:x==null?void 0:x.z}}})}const{leaf:g,single:v,others:p}=t.centripetalOptions||{};g&&typeof g!="function"&&(t.centripetalOptions.leaf=()=>g),v&&typeof v!="function"&&(t.centripetalOptions.single=()=>v),p&&typeof p!="function"&&(t.centripetalOptions.others=()=>p)}runOneStep(t,e,n,i,a){const s={},o=t.getAllNodes(),l=t.getAllEdges();if(!(o!=null&&o.length))return;const{monitor:c}=a;if(this.calRepulsive(t,s,a),l&&this.calAttractive(t,s,a),this.calGravity(t,e,s,a),this.updateVelocity(t,s,i,a),c){const u=this.calTotalEnergy(s,o);c({energy:u,nodes:e.getAllNodes(),edges:e.getAllEdges(),iterations:n})}}calTotalEnergy(t,e){if(!(e!=null&&e.length))return 0;let n=0;return e.forEach((i,a)=>{const s=t[i.id].x,o=t[i.id].y,l=this.options.dimensions===3?t[i.id].z:0,c=s*s+o*o+l*l,{mass:u=1}=i.data;n+=u*c*.5}),n}calRepulsive(t,e,n){const{dimensions:i,factor:a,coulombDisScale:s}=n;T9(t,a,s*s,e,i)}calAttractive(t,e,n){const{dimensions:i,nodeSize:a}=n;t.getAllEdges().forEach((s,o)=>{const{source:l,target:c}=s,u=t.getNode(l),h=t.getNode(c);if(!u||!h)return;let d=h.data.x-u.data.x,f=h.data.y-u.data.y,g=i===3?h.data.z-u.data.z:0;!d&&!f&&(d=Math.random()*.01,f=Math.random()*.01,i===3&&!g&&(g=Math.random()*.01));const v=Math.sqrt(d*d+f*f+g*g);if(v<a(u)+a(h))return;const p=d/v,y=f/v,m=g/v,{linkDistance:x=200,edgeStrength:E=200}=s.data||{},M=(x-v)*E,O=u.data.mass||1,T=h.data.mass||1,N=1/O,P=1/T,C=p*M,R=y*M,I=m*M;e[l].x-=C*N,e[l].y-=R*N,e[l].z-=I*N,e[c].x+=C*P,e[c].y+=R*P,e[c].z+=I*P})}calGravity(t,e,n,i){const{getCenter:a}=i,s=t.getAllNodes(),o=e.getAllNodes(),l=e.getAllEdges(),{width:c,height:u,center:h,gravity:d,centripetalOptions:f}=i;s&&s.forEach(g=>{const{id:v,data:p}=g,{mass:y,x:m,y:x,z:E}=p,_=e.getNode(v);let M=0,O=0,T=0,N=d;const P=t.getDegree(v,"in"),C=t.getDegree(v,"out"),R=t.getDegree(v,"both"),I=a==null?void 0:a(_,R);if(I){const[j,G,H]=I;M=m-j,O=x-G,N=H}else M=m-h[0],O=x-h[1],T=E-h[2];if(N&&(n[v].x-=N*M/y,n[v].y-=N*O/y,n[v].z-=N*T/y),f){const{leaf:j,single:G,others:H,center:Z}=f,{x:U,y:tt,z:gt,centerStrength:xt}=(Z==null?void 0:Z(_,o,l,c,u))||{x:0,y:0,z:0,centerStrength:0};if(!St(U)||!St(tt))return;const ut=(m-U)/y,zt=(x-tt)/y,J=(E-gt)/y;if(xt&&(n[v].x-=xt*ut,n[v].y-=xt*zt,n[v].z-=xt*J),R===0){const Q=G(_);if(!Q)return;n[v].x-=Q*ut,n[v].y-=Q*zt,n[v].z-=Q*J;return}if(P===0||C===0){const Q=j(_,o,l);if(!Q)return;n[v].x-=Q*ut,n[v].y-=Q*zt,n[v].z-=Q*J;return}const W=H(_);if(!W)return;n[v].x-=W*ut,n[v].y-=W*zt,n[v].z-=W*J}})}updateVelocity(t,e,n,i){const{damping:a,maxSpeed:s,interval:o,dimensions:l}=i,c=t.getAllNodes();c!=null&&c.length&&c.forEach(u=>{const{id:h}=u;let d=(n[h].x+e[h].x*o)*a||.01,f=(n[h].y+e[h].y*o)*a||.01,g=l===3?(n[h].z+e[h].z*o)*a||.01:0;const v=Math.sqrt(d*d+f*f+g*g);if(v>s){const p=s/v;d=p*d,f=p*f,g=p*g}n[h]={x:d,y:f,z:g}})}updatePosition(t,e,n,i){const{distanceThresholdMode:a,interval:s,dimensions:o}=i,l=e.getAllNodes();if(!(l!=null&&l.length)){this.judgingDistance=0;return}let c=0;a==="max"?this.judgingDistance=-1/0:a==="min"&&(this.judgingDistance=1/0),l.forEach(u=>{const{id:h}=u,d=t.getNode(h);if(St(d.data.fx)&&St(d.data.fy)){e.mergeNodeData(h,{x:d.data.fx,y:d.data.fy,z:o===3?d.data.fz:void 0});return}const f=n[h].x*s,g=n[h].y*s,v=o===3?n[h].z*s:0;e.mergeNodeData(h,{x:u.data.x+f,y:u.data.y+g,z:u.data.z+v});const p=Math.sqrt(f*f+g*g+v*v);switch(a){case"max":this.judgingDistance<p&&(this.judgingDistance=p);break;case"min":this.judgingDistance>p&&(this.judgingDistance=p);break;default:c=c+p;break}}),(!a||a==="mean")&&(this.judgingDistance=c/l.length)}}const tE=(r,t)=>{const e=r.getAllNodes();if(!(e!=null&&e.length))return{};const n={};return e.forEach((i,a)=>{r.getDegree(i.id,"both")===1&&(n[i.id]=C9(r,"leaf",i,t))}),n},C9=(r,t,e,n)=>{const i=r.getDegree(e.id,"in"),a=r.getDegree(e.id,"out");let s=e,o=[];i===0?(s=r.getSuccessors(e.id)[0],o=r.getNeighbors(s.id)):a===0&&(s=r.getPredecessors(e.id)[0],o=r.getNeighbors(s.id)),o=o.filter(c=>r.getDegree(c.id,"in")===0||r.getDegree(c.id,"out")===0);const l=R9(r,t,n,e,o);return{coreNode:s,siblingLeaves:o,sameTypeLeaves:l}},R9=(r,t,e,n,i)=>{const a=n.data[e]||"";let s=(i==null?void 0:i.filter(o=>o.data[e]===a))||[];return s=s.filter(o=>r.getDegree(o.id,"in")===0||r.getDegree(o.id,"out")===0),s},eE=r=>{const t={x:0,y:0};r.forEach(n=>{const{x:i,y:a}=n.data;t.x+=i||0,t.y+=a||0});const e=r.length||1;return{x:t.x/e,y:t.y/e}},df=(r,t)=>t.map(e=>{const{id:n,data:i}=e,a=r.getNode(n);return Object.assign(Object.assign({},a),{data:Object.assign(Object.assign({},a.data),{x:i.x,y:i.y,z:i.z})})});var ee={};const L9=Object.prototype.toString;function Qo(r){const t=L9.call(r);return t.endsWith("Array]")&&!t.includes("Big")}const I9=Object.freeze(Object.defineProperty({__proto__:null,isAnyArray:Qo},Symbol.toStringTag,{value:"Module"})),D9=tO(I9);function F9(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Qo(r))throw new TypeError("input must be an array");if(r.length===0)throw new TypeError("input must not be empty");var e=t.fromIndex,n=e===void 0?0:e,i=t.toIndex,a=i===void 0?r.length:i;if(n<0||n>=r.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(a<=n||a>r.length||!Number.isInteger(a))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=r[n],o=n+1;o<a;o++)r[o]>s&&(s=r[o]);return s}function B9(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Qo(r))throw new TypeError("input must be an array");if(r.length===0)throw new TypeError("input must not be empty");var e=t.fromIndex,n=e===void 0?0:e,i=t.toIndex,a=i===void 0?r.length:i;if(n<0||n>=r.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(a<=n||a>r.length||!Number.isInteger(a))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=r[n],o=n+1;o<a;o++)r[o]<s&&(s=r[o]);return s}function z9(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Qo(r)){if(r.length===0)throw new TypeError("input must not be empty")}else throw new TypeError("input must be an array");var e;if(t.output!==void 0){if(!Qo(t.output))throw new TypeError("output option must be an array if specified");e=t.output}else e=new Array(r.length);var n=B9(r),i=F9(r);if(n===i)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var a=t.min,s=a===void 0?t.autoMinMax?n:0:a,o=t.max,l=o===void 0?t.autoMinMax?i:1:o;if(s>=l)throw new RangeError("min option must be smaller than max option");for(var c=(l-s)/(i-n),u=0;u<r.length;u++)e[u]=(r[u]-n)*c+s;return e}const j9=Object.freeze(Object.defineProperty({__proto__:null,default:z9},Symbol.toStringTag,{value:"Module"})),q9=tO(j9);var nE;function G9(){var so,qm,Rn;if(nE)return ee;nE=1,Object.defineProperty(ee,"__esModule",{value:!0});var r=D9,t=q9;const e=" ".repeat(2),n=" ".repeat(4);function i(){return a(this)}function a(L,k={}){const{maxRows:w=15,maxColumns:b=10,maxNumSize:S=8,padMinus:A="auto"}=k;return`${L.constructor.name} {
${e}[
${n}${s(L,w,b,S,A)}
${e}]
${e}rows: ${L.rows}
${e}columns: ${L.columns}
}`}function s(L,k,w,b,S){const{rows:A,columns:D}=L,F=Math.min(A,k),B=Math.min(D,w),z=[];if(S==="auto"){S=!1;t:for(let X=0;X<F;X++)for(let $=0;$<B;$++)if(L.get(X,$)<0){S=!0;break t}}for(let X=0;X<F;X++){let $=[];for(let it=0;it<B;it++)$.push(o(L.get(X,it),b,S));z.push(`${$.join(" ")}`)}return B!==D&&(z[z.length-1]+=` ... ${D-w} more columns`),F!==A&&z.push(`... ${A-k} more rows`),z.join(`
${n}`)}function o(L,k,w){return(L>=0&&w?` ${l(L,k-1)}`:l(L,k)).padEnd(k)}function l(L,k){let w=L.toString();if(w.length<=k)return w;let b=L.toFixed(k);if(b.length>k&&(b=L.toFixed(Math.max(0,k-(b.length-k)))),b.length<=k&&!b.startsWith("0.000")&&!b.startsWith("-0.000"))return b;let S=L.toExponential(k);return S.length>k&&(S=L.toExponential(Math.max(0,k-(S.length-k)))),S.slice(0)}function c(L,k){L.prototype.add=function(b){return typeof b=="number"?this.addS(b):this.addM(b)},L.prototype.addS=function(b){for(let S=0;S<this.rows;S++)for(let A=0;A<this.columns;A++)this.set(S,A,this.get(S,A)+b);return this},L.prototype.addM=function(b){if(b=k.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let S=0;S<this.rows;S++)for(let A=0;A<this.columns;A++)this.set(S,A,this.get(S,A)+b.get(S,A));return this},L.add=function(b,S){return new k(b).add(S)},L.prototype.sub=function(b){return typeof b=="number"?this.subS(b):this.subM(b)},L.prototype.subS=function(b){for(let S=0;S<this.rows;S++)for(let A=0;A<this.columns;A++)this.set(S,A,this.get(S,A)-b);return this},L.prototype.subM=function(b){if(b=k.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let S=0;S<this.rows;S++)for(let A=0;A<this.columns;A++)this.set(S,A,this.get(S,A)-b.get(S,A));return this},L.sub=function(b,S){return new k(b).sub(S)},L.prototype.subtract=L.prototype.sub,L.prototype.subtractS=L.prototype.subS,L.prototype.subtractM=L.prototype.subM,L.subtract=L.sub,L.prototype.mul=function(b){return typeof b=="number"?this.mulS(b):this.mulM(b)},L.prototype.mulS=function(b){for(let S=0;S<this.rows;S++)for(let A=0;A<this.columns;A++)this.set(S,A,this.get(S,A)*b);return this},L.prototype.mulM=function(b){if(b=k.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let S=0;S<this.rows;S++)for(let A=0;A<this.columns;A++)this.set(S,A,this.get(S,A)*b.get(S,A));return this},L.mul=function(b,S){return new k(b).mul(S)},L.prototype.multiply=L.prototype.mul,L.prototype.multiplyS=L.prototype.mulS,L.prototype.multiplyM=L.prototype.mulM,L.multiply=L.mul,L.prototype.div=function(b){return typeof b=="number"?this.divS(b):this.divM(b)},L.prototype.divS=function(b){for(let S=0;S<this.rows;S++)for(let A=0;A<this.columns;A++)this.set(S,A,this.get(S,A)/b);return this},L.prototype.divM=function(b){if(b=k.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let S=0;S<this.rows;S++)for(let A=0;A<this.columns;A++)this.set(S,A,this.get(S,A)/b.get(S,A));return this},L.div=function(b,S){return new k(b).div(S)},L.prototype.divide=L.prototype.div,L.prototype.divideS=L.prototype.divS,L.prototype.divideM=L.prototype.divM,L.divide=L.div,L.prototype.mod=function(b){return typeof b=="number"?this.modS(b):this.modM(b)},L.prototype.modS=function(b){for(let S=0;S<this.rows;S++)for(let A=0;A<this.columns;A++)this.set(S,A,this.get(S,A)%b);return this},L.prototype.modM=function(b){if(b=k.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let S=0;S<this.rows;S++)for(let A=0;A<this.columns;A++)this.set(S,A,this.get(S,A)%b.get(S,A));return this},L.mod=function(b,S){return new k(b).mod(S)},L.prototype.modulus=L.prototype.mod,L.prototype.modulusS=L.prototype.modS,L.prototype.modulusM=L.prototype.modM,L.modulus=L.mod,L.prototype.and=function(b){return typeof b=="number"?this.andS(b):this.andM(b)},L.prototype.andS=function(b){for(let S=0;S<this.rows;S++)for(let A=0;A<this.columns;A++)this.set(S,A,this.get(S,A)&b);return this},L.prototype.andM=function(b){if(b=k.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let S=0;S<this.rows;S++)for(let A=0;A<this.columns;A++)this.set(S,A,this.get(S,A)&b.get(S,A));return this},L.and=function(b,S){return new k(b).and(S)},L.prototype.or=function(b){return typeof b=="number"?this.orS(b):this.orM(b)},L.prototype.orS=function(b){for(let S=0;S<this.rows;S++)for(let A=0;A<this.columns;A++)this.set(S,A,this.get(S,A)|b);return this},L.prototype.orM=function(b){if(b=k.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let S=0;S<this.rows;S++)for(let A=0;A<this.columns;A++)this.set(S,A,this.get(S,A)|b.get(S,A));return this},L.or=function(b,S){return new k(b).or(S)},L.prototype.xor=function(b){return typeof b=="number"?this.xorS(b):this.xorM(b)},L.prototype.xorS=function(b){for(let S=0;S<this.rows;S++)for(let A=0;A<this.columns;A++)this.set(S,A,this.get(S,A)^b);return this},L.prototype.xorM=function(b){if(b=k.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let S=0;S<this.rows;S++)for(let A=0;A<this.columns;A++)this.set(S,A,this.get(S,A)^b.get(S,A));return this},L.xor=function(b,S){return new k(b).xor(S)},L.prototype.leftShift=function(b){return typeof b=="number"?this.leftShiftS(b):this.leftShiftM(b)},L.prototype.leftShiftS=function(b){for(let S=0;S<this.rows;S++)for(let A=0;A<this.columns;A++)this.set(S,A,this.get(S,A)<<b);return this},L.prototype.leftShiftM=function(b){if(b=k.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let S=0;S<this.rows;S++)for(let A=0;A<this.columns;A++)this.set(S,A,this.get(S,A)<<b.get(S,A));return this},L.leftShift=function(b,S){return new k(b).leftShift(S)},L.prototype.signPropagatingRightShift=function(b){return typeof b=="number"?this.signPropagatingRightShiftS(b):this.signPropagatingRightShiftM(b)},L.prototype.signPropagatingRightShiftS=function(b){for(let S=0;S<this.rows;S++)for(let A=0;A<this.columns;A++)this.set(S,A,this.get(S,A)>>b);return this},L.prototype.signPropagatingRightShiftM=function(b){if(b=k.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let S=0;S<this.rows;S++)for(let A=0;A<this.columns;A++)this.set(S,A,this.get(S,A)>>b.get(S,A));return this},L.signPropagatingRightShift=function(b,S){return new k(b).signPropagatingRightShift(S)},L.prototype.rightShift=function(b){return typeof b=="number"?this.rightShiftS(b):this.rightShiftM(b)},L.prototype.rightShiftS=function(b){for(let S=0;S<this.rows;S++)for(let A=0;A<this.columns;A++)this.set(S,A,this.get(S,A)>>>b);return this},L.prototype.rightShiftM=function(b){if(b=k.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let S=0;S<this.rows;S++)for(let A=0;A<this.columns;A++)this.set(S,A,this.get(S,A)>>>b.get(S,A));return this},L.rightShift=function(b,S){return new k(b).rightShift(S)},L.prototype.zeroFillRightShift=L.prototype.rightShift,L.prototype.zeroFillRightShiftS=L.prototype.rightShiftS,L.prototype.zeroFillRightShiftM=L.prototype.rightShiftM,L.zeroFillRightShift=L.rightShift,L.prototype.not=function(){for(let b=0;b<this.rows;b++)for(let S=0;S<this.columns;S++)this.set(b,S,~this.get(b,S));return this},L.not=function(b){return new k(b).not()},L.prototype.abs=function(){for(let b=0;b<this.rows;b++)for(let S=0;S<this.columns;S++)this.set(b,S,Math.abs(this.get(b,S)));return this},L.abs=function(b){return new k(b).abs()},L.prototype.acos=function(){for(let b=0;b<this.rows;b++)for(let S=0;S<this.columns;S++)this.set(b,S,Math.acos(this.get(b,S)));return this},L.acos=function(b){return new k(b).acos()},L.prototype.acosh=function(){for(let b=0;b<this.rows;b++)for(let S=0;S<this.columns;S++)this.set(b,S,Math.acosh(this.get(b,S)));return this},L.acosh=function(b){return new k(b).acosh()},L.prototype.asin=function(){for(let b=0;b<this.rows;b++)for(let S=0;S<this.columns;S++)this.set(b,S,Math.asin(this.get(b,S)));return this},L.asin=function(b){return new k(b).asin()},L.prototype.asinh=function(){for(let b=0;b<this.rows;b++)for(let S=0;S<this.columns;S++)this.set(b,S,Math.asinh(this.get(b,S)));return this},L.asinh=function(b){return new k(b).asinh()},L.prototype.atan=function(){for(let b=0;b<this.rows;b++)for(let S=0;S<this.columns;S++)this.set(b,S,Math.atan(this.get(b,S)));return this},L.atan=function(b){return new k(b).atan()},L.prototype.atanh=function(){for(let b=0;b<this.rows;b++)for(let S=0;S<this.columns;S++)this.set(b,S,Math.atanh(this.get(b,S)));return this},L.atanh=function(b){return new k(b).atanh()},L.prototype.cbrt=function(){for(let b=0;b<this.rows;b++)for(let S=0;S<this.columns;S++)this.set(b,S,Math.cbrt(this.get(b,S)));return this},L.cbrt=function(b){return new k(b).cbrt()},L.prototype.ceil=function(){for(let b=0;b<this.rows;b++)for(let S=0;S<this.columns;S++)this.set(b,S,Math.ceil(this.get(b,S)));return this},L.ceil=function(b){return new k(b).ceil()},L.prototype.clz32=function(){for(let b=0;b<this.rows;b++)for(let S=0;S<this.columns;S++)this.set(b,S,Math.clz32(this.get(b,S)));return this},L.clz32=function(b){return new k(b).clz32()},L.prototype.cos=function(){for(let b=0;b<this.rows;b++)for(let S=0;S<this.columns;S++)this.set(b,S,Math.cos(this.get(b,S)));return this},L.cos=function(b){return new k(b).cos()},L.prototype.cosh=function(){for(let b=0;b<this.rows;b++)for(let S=0;S<this.columns;S++)this.set(b,S,Math.cosh(this.get(b,S)));return this},L.cosh=function(b){return new k(b).cosh()},L.prototype.exp=function(){for(let b=0;b<this.rows;b++)for(let S=0;S<this.columns;S++)this.set(b,S,Math.exp(this.get(b,S)));return this},L.exp=function(b){return new k(b).exp()},L.prototype.expm1=function(){for(let b=0;b<this.rows;b++)for(let S=0;S<this.columns;S++)this.set(b,S,Math.expm1(this.get(b,S)));return this},L.expm1=function(b){return new k(b).expm1()},L.prototype.floor=function(){for(let b=0;b<this.rows;b++)for(let S=0;S<this.columns;S++)this.set(b,S,Math.floor(this.get(b,S)));return this},L.floor=function(b){return new k(b).floor()},L.prototype.fround=function(){for(let b=0;b<this.rows;b++)for(let S=0;S<this.columns;S++)this.set(b,S,Math.fround(this.get(b,S)));return this},L.fround=function(b){return new k(b).fround()},L.prototype.log=function(){for(let b=0;b<this.rows;b++)for(let S=0;S<this.columns;S++)this.set(b,S,Math.log(this.get(b,S)));return this},L.log=function(b){return new k(b).log()},L.prototype.log1p=function(){for(let b=0;b<this.rows;b++)for(let S=0;S<this.columns;S++)this.set(b,S,Math.log1p(this.get(b,S)));return this},L.log1p=function(b){return new k(b).log1p()},L.prototype.log10=function(){for(let b=0;b<this.rows;b++)for(let S=0;S<this.columns;S++)this.set(b,S,Math.log10(this.get(b,S)));return this},L.log10=function(b){return new k(b).log10()},L.prototype.log2=function(){for(let b=0;b<this.rows;b++)for(let S=0;S<this.columns;S++)this.set(b,S,Math.log2(this.get(b,S)));return this},L.log2=function(b){return new k(b).log2()},L.prototype.round=function(){for(let b=0;b<this.rows;b++)for(let S=0;S<this.columns;S++)this.set(b,S,Math.round(this.get(b,S)));return this},L.round=function(b){return new k(b).round()},L.prototype.sign=function(){for(let b=0;b<this.rows;b++)for(let S=0;S<this.columns;S++)this.set(b,S,Math.sign(this.get(b,S)));return this},L.sign=function(b){return new k(b).sign()},L.prototype.sin=function(){for(let b=0;b<this.rows;b++)for(let S=0;S<this.columns;S++)this.set(b,S,Math.sin(this.get(b,S)));return this},L.sin=function(b){return new k(b).sin()},L.prototype.sinh=function(){for(let b=0;b<this.rows;b++)for(let S=0;S<this.columns;S++)this.set(b,S,Math.sinh(this.get(b,S)));return this},L.sinh=function(b){return new k(b).sinh()},L.prototype.sqrt=function(){for(let b=0;b<this.rows;b++)for(let S=0;S<this.columns;S++)this.set(b,S,Math.sqrt(this.get(b,S)));return this},L.sqrt=function(b){return new k(b).sqrt()},L.prototype.tan=function(){for(let b=0;b<this.rows;b++)for(let S=0;S<this.columns;S++)this.set(b,S,Math.tan(this.get(b,S)));return this},L.tan=function(b){return new k(b).tan()},L.prototype.tanh=function(){for(let b=0;b<this.rows;b++)for(let S=0;S<this.columns;S++)this.set(b,S,Math.tanh(this.get(b,S)));return this},L.tanh=function(b){return new k(b).tanh()},L.prototype.trunc=function(){for(let b=0;b<this.rows;b++)for(let S=0;S<this.columns;S++)this.set(b,S,Math.trunc(this.get(b,S)));return this},L.trunc=function(b){return new k(b).trunc()},L.pow=function(b,S){return new k(b).pow(S)},L.prototype.pow=function(b){return typeof b=="number"?this.powS(b):this.powM(b)},L.prototype.powS=function(b){for(let S=0;S<this.rows;S++)for(let A=0;A<this.columns;A++)this.set(S,A,this.get(S,A)**b);return this},L.prototype.powM=function(b){if(b=k.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let S=0;S<this.rows;S++)for(let A=0;A<this.columns;A++)this.set(S,A,this.get(S,A)**b.get(S,A));return this}}function u(L,k,w){let b=w?L.rows:L.rows-1;if(k<0||k>b)throw new RangeError("Row index out of range")}function h(L,k,w){let b=w?L.columns:L.columns-1;if(k<0||k>b)throw new RangeError("Column index out of range")}function d(L,k){if(k.to1DArray&&(k=k.to1DArray()),k.length!==L.columns)throw new RangeError("vector size must be the same as the number of columns");return k}function f(L,k){if(k.to1DArray&&(k=k.to1DArray()),k.length!==L.rows)throw new RangeError("vector size must be the same as the number of rows");return k}function g(L,k){if(!r.isAnyArray(k))throw new TypeError("row indices must be an array");for(let w=0;w<k.length;w++)if(k[w]<0||k[w]>=L.rows)throw new RangeError("row indices are out of range")}function v(L,k){if(!r.isAnyArray(k))throw new TypeError("column indices must be an array");for(let w=0;w<k.length;w++)if(k[w]<0||k[w]>=L.columns)throw new RangeError("column indices are out of range")}function p(L,k,w,b,S){if(arguments.length!==5)throw new RangeError("expected 4 arguments");if(m("startRow",k),m("endRow",w),m("startColumn",b),m("endColumn",S),k>w||b>S||k<0||k>=L.rows||w<0||w>=L.rows||b<0||b>=L.columns||S<0||S>=L.columns)throw new RangeError("Submatrix indices are out of range")}function y(L,k=0){let w=[];for(let b=0;b<L;b++)w.push(k);return w}function m(L,k){if(typeof k!="number")throw new TypeError(`${L} must be a number`)}function x(L){if(L.isEmpty())throw new Error("Empty matrix has no elements to index")}function E(L){let k=y(L.rows);for(let w=0;w<L.rows;++w)for(let b=0;b<L.columns;++b)k[w]+=L.get(w,b);return k}function _(L){let k=y(L.columns);for(let w=0;w<L.rows;++w)for(let b=0;b<L.columns;++b)k[b]+=L.get(w,b);return k}function M(L){let k=0;for(let w=0;w<L.rows;w++)for(let b=0;b<L.columns;b++)k+=L.get(w,b);return k}function O(L){let k=y(L.rows,1);for(let w=0;w<L.rows;++w)for(let b=0;b<L.columns;++b)k[w]*=L.get(w,b);return k}function T(L){let k=y(L.columns,1);for(let w=0;w<L.rows;++w)for(let b=0;b<L.columns;++b)k[b]*=L.get(w,b);return k}function N(L){let k=1;for(let w=0;w<L.rows;w++)for(let b=0;b<L.columns;b++)k*=L.get(w,b);return k}function P(L,k,w){const b=L.rows,S=L.columns,A=[];for(let D=0;D<b;D++){let F=0,B=0,z=0;for(let X=0;X<S;X++)z=L.get(D,X)-w[D],F+=z,B+=z*z;k?A.push((B-F*F/S)/(S-1)):A.push((B-F*F/S)/S)}return A}function C(L,k,w){const b=L.rows,S=L.columns,A=[];for(let D=0;D<S;D++){let F=0,B=0,z=0;for(let X=0;X<b;X++)z=L.get(X,D)-w[D],F+=z,B+=z*z;k?A.push((B-F*F/b)/(b-1)):A.push((B-F*F/b)/b)}return A}function R(L,k,w){const b=L.rows,S=L.columns,A=b*S;let D=0,F=0,B=0;for(let z=0;z<b;z++)for(let X=0;X<S;X++)B=L.get(z,X)-w,D+=B,F+=B*B;return k?(F-D*D/A)/(A-1):(F-D*D/A)/A}function I(L,k){for(let w=0;w<L.rows;w++)for(let b=0;b<L.columns;b++)L.set(w,b,L.get(w,b)-k[w])}function j(L,k){for(let w=0;w<L.rows;w++)for(let b=0;b<L.columns;b++)L.set(w,b,L.get(w,b)-k[b])}function G(L,k){for(let w=0;w<L.rows;w++)for(let b=0;b<L.columns;b++)L.set(w,b,L.get(w,b)-k)}function H(L){const k=[];for(let w=0;w<L.rows;w++){let b=0;for(let S=0;S<L.columns;S++)b+=L.get(w,S)**2/(L.columns-1);k.push(Math.sqrt(b))}return k}function Z(L,k){for(let w=0;w<L.rows;w++)for(let b=0;b<L.columns;b++)L.set(w,b,L.get(w,b)/k[w])}function U(L){const k=[];for(let w=0;w<L.columns;w++){let b=0;for(let S=0;S<L.rows;S++)b+=L.get(S,w)**2/(L.rows-1);k.push(Math.sqrt(b))}return k}function tt(L,k){for(let w=0;w<L.rows;w++)for(let b=0;b<L.columns;b++)L.set(w,b,L.get(w,b)/k[b])}function gt(L){const k=L.size-1;let w=0;for(let b=0;b<L.columns;b++)for(let S=0;S<L.rows;S++)w+=L.get(S,b)**2/k;return Math.sqrt(w)}function xt(L,k){for(let w=0;w<L.rows;w++)for(let b=0;b<L.columns;b++)L.set(w,b,L.get(w,b)/k)}class ut{static from1DArray(k,w,b){if(k*w!==b.length)throw new RangeError("data length does not match given dimensions");let A=new W(k,w);for(let D=0;D<k;D++)for(let F=0;F<w;F++)A.set(D,F,b[D*w+F]);return A}static rowVector(k){let w=new W(1,k.length);for(let b=0;b<k.length;b++)w.set(0,b,k[b]);return w}static columnVector(k){let w=new W(k.length,1);for(let b=0;b<k.length;b++)w.set(b,0,k[b]);return w}static zeros(k,w){return new W(k,w)}static ones(k,w){return new W(k,w).fill(1)}static rand(k,w,b={}){if(typeof b!="object")throw new TypeError("options must be an object");const{random:S=Math.random}=b;let A=new W(k,w);for(let D=0;D<k;D++)for(let F=0;F<w;F++)A.set(D,F,S());return A}static randInt(k,w,b={}){if(typeof b!="object")throw new TypeError("options must be an object");const{min:S=0,max:A=1e3,random:D=Math.random}=b;if(!Number.isInteger(S))throw new TypeError("min must be an integer");if(!Number.isInteger(A))throw new TypeError("max must be an integer");if(S>=A)throw new RangeError("min must be smaller than max");let F=A-S,B=new W(k,w);for(let z=0;z<k;z++)for(let X=0;X<w;X++){let $=S+Math.round(D()*F);B.set(z,X,$)}return B}static eye(k,w,b){w===void 0&&(w=k),b===void 0&&(b=1);let S=Math.min(k,w),A=this.zeros(k,w);for(let D=0;D<S;D++)A.set(D,D,b);return A}static diag(k,w,b){let S=k.length;w===void 0&&(w=S),b===void 0&&(b=w);let A=Math.min(S,w,b),D=this.zeros(w,b);for(let F=0;F<A;F++)D.set(F,F,k[F]);return D}static min(k,w){k=this.checkMatrix(k),w=this.checkMatrix(w);let b=k.rows,S=k.columns,A=new W(b,S);for(let D=0;D<b;D++)for(let F=0;F<S;F++)A.set(D,F,Math.min(k.get(D,F),w.get(D,F)));return A}static max(k,w){k=this.checkMatrix(k),w=this.checkMatrix(w);let b=k.rows,S=k.columns,A=new this(b,S);for(let D=0;D<b;D++)for(let F=0;F<S;F++)A.set(D,F,Math.max(k.get(D,F),w.get(D,F)));return A}static checkMatrix(k){return ut.isMatrix(k)?k:new W(k)}static isMatrix(k){return k!=null&&k.klass==="Matrix"}get size(){return this.rows*this.columns}apply(k){if(typeof k!="function")throw new TypeError("callback must be a function");for(let w=0;w<this.rows;w++)for(let b=0;b<this.columns;b++)k.call(this,w,b);return this}to1DArray(){let k=[];for(let w=0;w<this.rows;w++)for(let b=0;b<this.columns;b++)k.push(this.get(w,b));return k}to2DArray(){let k=[];for(let w=0;w<this.rows;w++){k.push([]);for(let b=0;b<this.columns;b++)k[w].push(this.get(w,b))}return k}toJSON(){return this.to2DArray()}isRowVector(){return this.rows===1}isColumnVector(){return this.columns===1}isVector(){return this.rows===1||this.columns===1}isSquare(){return this.rows===this.columns}isEmpty(){return this.rows===0||this.columns===0}isSymmetric(){if(this.isSquare()){for(let k=0;k<this.rows;k++)for(let w=0;w<=k;w++)if(this.get(k,w)!==this.get(w,k))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let k=0;k<this.rows;k++)if(this.get(k,k)!==0)return!1;return!0}isEchelonForm(){let k=0,w=0,b=-1,S=!0,A=!1;for(;k<this.rows&&S;){for(w=0,A=!1;w<this.columns&&A===!1;)this.get(k,w)===0?w++:this.get(k,w)===1&&w>b?(A=!0,b=w):(S=!1,A=!0);k++}return S}isReducedEchelonForm(){let k=0,w=0,b=-1,S=!0,A=!1;for(;k<this.rows&&S;){for(w=0,A=!1;w<this.columns&&A===!1;)this.get(k,w)===0?w++:this.get(k,w)===1&&w>b?(A=!0,b=w):(S=!1,A=!0);for(let D=w+1;D<this.rows;D++)this.get(k,D)!==0&&(S=!1);k++}return S}echelonForm(){let k=this.clone(),w=0,b=0;for(;w<k.rows&&b<k.columns;){let S=w;for(let A=w;A<k.rows;A++)k.get(A,b)>k.get(S,b)&&(S=A);if(k.get(S,b)===0)b++;else{k.swapRows(w,S);let A=k.get(w,b);for(let D=b;D<k.columns;D++)k.set(w,D,k.get(w,D)/A);for(let D=w+1;D<k.rows;D++){let F=k.get(D,b)/k.get(w,b);k.set(D,b,0);for(let B=b+1;B<k.columns;B++)k.set(D,B,k.get(D,B)-k.get(w,B)*F)}w++,b++}}return k}reducedEchelonForm(){let k=this.echelonForm(),w=k.columns,b=k.rows,S=b-1;for(;S>=0;)if(k.maxRow(S)===0)S--;else{let A=0,D=!1;for(;A<b&&D===!1;)k.get(S,A)===1?D=!0:A++;for(let F=0;F<S;F++){let B=k.get(F,A);for(let z=A;z<w;z++){let X=k.get(F,z)-B*k.get(S,z);k.set(F,z,X)}}S--}return k}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(k={}){if(typeof k!="object")throw new TypeError("options must be an object");const{rows:w=1,columns:b=1}=k;if(!Number.isInteger(w)||w<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(b)||b<=0)throw new TypeError("columns must be a positive integer");let S=new W(this.rows*w,this.columns*b);for(let A=0;A<w;A++)for(let D=0;D<b;D++)S.setSubMatrix(this,this.rows*A,this.columns*D);return S}fill(k){for(let w=0;w<this.rows;w++)for(let b=0;b<this.columns;b++)this.set(w,b,k);return this}neg(){return this.mulS(-1)}getRow(k){u(this,k);let w=[];for(let b=0;b<this.columns;b++)w.push(this.get(k,b));return w}getRowVector(k){return W.rowVector(this.getRow(k))}setRow(k,w){u(this,k),w=d(this,w);for(let b=0;b<this.columns;b++)this.set(k,b,w[b]);return this}swapRows(k,w){u(this,k),u(this,w);for(let b=0;b<this.columns;b++){let S=this.get(k,b);this.set(k,b,this.get(w,b)),this.set(w,b,S)}return this}getColumn(k){h(this,k);let w=[];for(let b=0;b<this.rows;b++)w.push(this.get(b,k));return w}getColumnVector(k){return W.columnVector(this.getColumn(k))}setColumn(k,w){h(this,k),w=f(this,w);for(let b=0;b<this.rows;b++)this.set(b,k,w[b]);return this}swapColumns(k,w){h(this,k),h(this,w);for(let b=0;b<this.rows;b++){let S=this.get(b,k);this.set(b,k,this.get(b,w)),this.set(b,w,S)}return this}addRowVector(k){k=d(this,k);for(let w=0;w<this.rows;w++)for(let b=0;b<this.columns;b++)this.set(w,b,this.get(w,b)+k[b]);return this}subRowVector(k){k=d(this,k);for(let w=0;w<this.rows;w++)for(let b=0;b<this.columns;b++)this.set(w,b,this.get(w,b)-k[b]);return this}mulRowVector(k){k=d(this,k);for(let w=0;w<this.rows;w++)for(let b=0;b<this.columns;b++)this.set(w,b,this.get(w,b)*k[b]);return this}divRowVector(k){k=d(this,k);for(let w=0;w<this.rows;w++)for(let b=0;b<this.columns;b++)this.set(w,b,this.get(w,b)/k[b]);return this}addColumnVector(k){k=f(this,k);for(let w=0;w<this.rows;w++)for(let b=0;b<this.columns;b++)this.set(w,b,this.get(w,b)+k[w]);return this}subColumnVector(k){k=f(this,k);for(let w=0;w<this.rows;w++)for(let b=0;b<this.columns;b++)this.set(w,b,this.get(w,b)-k[w]);return this}mulColumnVector(k){k=f(this,k);for(let w=0;w<this.rows;w++)for(let b=0;b<this.columns;b++)this.set(w,b,this.get(w,b)*k[w]);return this}divColumnVector(k){k=f(this,k);for(let w=0;w<this.rows;w++)for(let b=0;b<this.columns;b++)this.set(w,b,this.get(w,b)/k[w]);return this}mulRow(k,w){u(this,k);for(let b=0;b<this.columns;b++)this.set(k,b,this.get(k,b)*w);return this}mulColumn(k,w){h(this,k);for(let b=0;b<this.rows;b++)this.set(b,k,this.get(b,k)*w);return this}max(k){if(this.isEmpty())return NaN;switch(k){case"row":{const w=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let b=0;b<this.rows;b++)for(let S=0;S<this.columns;S++)this.get(b,S)>w[b]&&(w[b]=this.get(b,S));return w}case"column":{const w=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let b=0;b<this.rows;b++)for(let S=0;S<this.columns;S++)this.get(b,S)>w[S]&&(w[S]=this.get(b,S));return w}case void 0:{let w=this.get(0,0);for(let b=0;b<this.rows;b++)for(let S=0;S<this.columns;S++)this.get(b,S)>w&&(w=this.get(b,S));return w}default:throw new Error(`invalid option: ${k}`)}}maxIndex(){x(this);let k=this.get(0,0),w=[0,0];for(let b=0;b<this.rows;b++)for(let S=0;S<this.columns;S++)this.get(b,S)>k&&(k=this.get(b,S),w[0]=b,w[1]=S);return w}min(k){if(this.isEmpty())return NaN;switch(k){case"row":{const w=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let b=0;b<this.rows;b++)for(let S=0;S<this.columns;S++)this.get(b,S)<w[b]&&(w[b]=this.get(b,S));return w}case"column":{const w=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let b=0;b<this.rows;b++)for(let S=0;S<this.columns;S++)this.get(b,S)<w[S]&&(w[S]=this.get(b,S));return w}case void 0:{let w=this.get(0,0);for(let b=0;b<this.rows;b++)for(let S=0;S<this.columns;S++)this.get(b,S)<w&&(w=this.get(b,S));return w}default:throw new Error(`invalid option: ${k}`)}}minIndex(){x(this);let k=this.get(0,0),w=[0,0];for(let b=0;b<this.rows;b++)for(let S=0;S<this.columns;S++)this.get(b,S)<k&&(k=this.get(b,S),w[0]=b,w[1]=S);return w}maxRow(k){if(u(this,k),this.isEmpty())return NaN;let w=this.get(k,0);for(let b=1;b<this.columns;b++)this.get(k,b)>w&&(w=this.get(k,b));return w}maxRowIndex(k){u(this,k),x(this);let w=this.get(k,0),b=[k,0];for(let S=1;S<this.columns;S++)this.get(k,S)>w&&(w=this.get(k,S),b[1]=S);return b}minRow(k){if(u(this,k),this.isEmpty())return NaN;let w=this.get(k,0);for(let b=1;b<this.columns;b++)this.get(k,b)<w&&(w=this.get(k,b));return w}minRowIndex(k){u(this,k),x(this);let w=this.get(k,0),b=[k,0];for(let S=1;S<this.columns;S++)this.get(k,S)<w&&(w=this.get(k,S),b[1]=S);return b}maxColumn(k){if(h(this,k),this.isEmpty())return NaN;let w=this.get(0,k);for(let b=1;b<this.rows;b++)this.get(b,k)>w&&(w=this.get(b,k));return w}maxColumnIndex(k){h(this,k),x(this);let w=this.get(0,k),b=[0,k];for(let S=1;S<this.rows;S++)this.get(S,k)>w&&(w=this.get(S,k),b[0]=S);return b}minColumn(k){if(h(this,k),this.isEmpty())return NaN;let w=this.get(0,k);for(let b=1;b<this.rows;b++)this.get(b,k)<w&&(w=this.get(b,k));return w}minColumnIndex(k){h(this,k),x(this);let w=this.get(0,k),b=[0,k];for(let S=1;S<this.rows;S++)this.get(S,k)<w&&(w=this.get(S,k),b[0]=S);return b}diag(){let k=Math.min(this.rows,this.columns),w=[];for(let b=0;b<k;b++)w.push(this.get(b,b));return w}norm(k="frobenius"){switch(k){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw new RangeError(`unknown norm type: ${k}`)}}cumulativeSum(){let k=0;for(let w=0;w<this.rows;w++)for(let b=0;b<this.columns;b++)k+=this.get(w,b),this.set(w,b,k);return this}dot(k){ut.isMatrix(k)&&(k=k.to1DArray());let w=this.to1DArray();if(w.length!==k.length)throw new RangeError("vectors do not have the same size");let b=0;for(let S=0;S<w.length;S++)b+=w[S]*k[S];return b}mmul(k){k=W.checkMatrix(k);let w=this.rows,b=this.columns,S=k.columns,A=new W(w,S),D=new Float64Array(b);for(let F=0;F<S;F++){for(let B=0;B<b;B++)D[B]=k.get(B,F);for(let B=0;B<w;B++){let z=0;for(let X=0;X<b;X++)z+=this.get(B,X)*D[X];A.set(B,F,z)}}return A}mpow(k){if(!this.isSquare())throw new RangeError("Matrix must be square");if(!Number.isInteger(k)||k<0)throw new RangeError("Exponent must be a non-negative integer");let w=W.eye(this.rows),b=this;for(let S=k;S>=1;S/=2)(S&1)!==0&&(w=w.mmul(b)),b=b.mmul(b);return w}strassen2x2(k){k=W.checkMatrix(k);let w=new W(2,2);const b=this.get(0,0),S=k.get(0,0),A=this.get(0,1),D=k.get(0,1),F=this.get(1,0),B=k.get(1,0),z=this.get(1,1),X=k.get(1,1),$=(b+z)*(S+X),it=(F+z)*S,yt=b*(D-X),et=z*(B-S),st=(b+A)*X,kt=(F-b)*(S+D),V=(A-z)*(B+X),pt=$+et-st+V,At=yt+st,Bt=it+et,Gt=$-it+yt+kt;return w.set(0,0,pt),w.set(0,1,At),w.set(1,0,Bt),w.set(1,1,Gt),w}strassen3x3(k){k=W.checkMatrix(k);let w=new W(3,3);const b=this.get(0,0),S=this.get(0,1),A=this.get(0,2),D=this.get(1,0),F=this.get(1,1),B=this.get(1,2),z=this.get(2,0),X=this.get(2,1),$=this.get(2,2),it=k.get(0,0),yt=k.get(0,1),et=k.get(0,2),st=k.get(1,0),kt=k.get(1,1),V=k.get(1,2),pt=k.get(2,0),At=k.get(2,1),Bt=k.get(2,2),Gt=(b+S+A-D-F-X-$)*kt,Re=(b-D)*(-yt+kt),Ct=F*(-it+yt+st-kt-V-pt+Bt),Lt=(-b+D+F)*(it-yt+kt),ye=(D+F)*(-it+yt),Y=b*it,dt=(-b+z+X)*(it-et+V),Mt=(-b+z)*(et-V),vt=(z+X)*(-it+et),Le=(b+S+A-F-B-z-X)*V,ce=X*(-it+et+st-kt-V-pt+At),ke=(-A+X+$)*(kt+pt-At),Ie=(A-$)*(kt-At),Sn=A*pt,Fr=(X+$)*(-pt+At),cn=(-A+F+B)*(V+pt-Bt),ii=(A-B)*(V-Bt),Mi=(F+B)*(-pt+Bt),ie=S*st,_n=B*At,ur=D*et,hr=z*yt,un=$*Bt,vR=Y+Sn+ie,pR=Gt+Lt+ye+Y+ke+Sn+Fr,yR=Y+dt+vt+Le+Sn+cn+Mi,mR=Re+Ct+Lt+Y+Sn+cn+ii,bR=Re+Lt+ye+Y+_n,xR=Sn+cn+ii+Mi+ur,wR=Y+dt+Mt+ce+ke+Ie+Sn,ER=ke+Ie+Sn+Fr+hr,SR=Y+dt+Mt+vt+un;return w.set(0,0,vR),w.set(0,1,pR),w.set(0,2,yR),w.set(1,0,mR),w.set(1,1,bR),w.set(1,2,xR),w.set(2,0,wR),w.set(2,1,ER),w.set(2,2,SR),w}mmulStrassen(k){k=W.checkMatrix(k);let w=this.clone(),b=w.rows,S=w.columns,A=k.rows,D=k.columns;S!==A&&console.warn(`Multiplying ${b} x ${S} and ${A} x ${D} matrix: dimensions do not match.`);function F($,it,yt){let et=$.rows,st=$.columns;if(et===it&&st===yt)return $;{let kt=ut.zeros(it,yt);return kt=kt.setSubMatrix($,0,0),kt}}let B=Math.max(b,A),z=Math.max(S,D);w=F(w,B,z),k=F(k,B,z);function X($,it,yt,et){if(yt<=512||et<=512)return $.mmul(it);yt%2===1&&et%2===1?($=F($,yt+1,et+1),it=F(it,yt+1,et+1)):yt%2===1?($=F($,yt+1,et),it=F(it,yt+1,et)):et%2===1&&($=F($,yt,et+1),it=F(it,yt,et+1));let st=parseInt($.rows/2,10),kt=parseInt($.columns/2,10),V=$.subMatrix(0,st-1,0,kt-1),pt=it.subMatrix(0,st-1,0,kt-1),At=$.subMatrix(0,st-1,kt,$.columns-1),Bt=it.subMatrix(0,st-1,kt,it.columns-1),Gt=$.subMatrix(st,$.rows-1,0,kt-1),Re=it.subMatrix(st,it.rows-1,0,kt-1),Ct=$.subMatrix(st,$.rows-1,kt,$.columns-1),Lt=it.subMatrix(st,it.rows-1,kt,it.columns-1),ye=X(ut.add(V,Ct),ut.add(pt,Lt),st,kt),Y=X(ut.add(Gt,Ct),pt,st,kt),dt=X(V,ut.sub(Bt,Lt),st,kt),Mt=X(Ct,ut.sub(Re,pt),st,kt),vt=X(ut.add(V,At),Lt,st,kt),Le=X(ut.sub(Gt,V),ut.add(pt,Bt),st,kt),ce=X(ut.sub(At,Ct),ut.add(Re,Lt),st,kt),ke=ut.add(ye,Mt);ke.sub(vt),ke.add(ce);let Ie=ut.add(dt,vt),Sn=ut.add(Y,Mt),Fr=ut.sub(ye,Y);Fr.add(dt),Fr.add(Le);let cn=ut.zeros(2*ke.rows,2*ke.columns);return cn=cn.setSubMatrix(ke,0,0),cn=cn.setSubMatrix(Ie,ke.rows,0),cn=cn.setSubMatrix(Sn,0,ke.columns),cn=cn.setSubMatrix(Fr,ke.rows,ke.columns),cn.subMatrix(0,yt-1,0,et-1)}return X(w,k,B,z)}scaleRows(k={}){if(typeof k!="object")throw new TypeError("options must be an object");const{min:w=0,max:b=1}=k;if(!Number.isFinite(w))throw new TypeError("min must be a number");if(!Number.isFinite(b))throw new TypeError("max must be a number");if(w>=b)throw new RangeError("min must be smaller than max");let S=new W(this.rows,this.columns);for(let A=0;A<this.rows;A++){const D=this.getRow(A);D.length>0&&t(D,{min:w,max:b,output:D}),S.setRow(A,D)}return S}scaleColumns(k={}){if(typeof k!="object")throw new TypeError("options must be an object");const{min:w=0,max:b=1}=k;if(!Number.isFinite(w))throw new TypeError("min must be a number");if(!Number.isFinite(b))throw new TypeError("max must be a number");if(w>=b)throw new RangeError("min must be smaller than max");let S=new W(this.rows,this.columns);for(let A=0;A<this.columns;A++){const D=this.getColumn(A);D.length&&t(D,{min:w,max:b,output:D}),S.setColumn(A,D)}return S}flipRows(){const k=Math.ceil(this.columns/2);for(let w=0;w<this.rows;w++)for(let b=0;b<k;b++){let S=this.get(w,b),A=this.get(w,this.columns-1-b);this.set(w,b,A),this.set(w,this.columns-1-b,S)}return this}flipColumns(){const k=Math.ceil(this.rows/2);for(let w=0;w<this.columns;w++)for(let b=0;b<k;b++){let S=this.get(b,w),A=this.get(this.rows-1-b,w);this.set(b,w,A),this.set(this.rows-1-b,w,S)}return this}kroneckerProduct(k){k=W.checkMatrix(k);let w=this.rows,b=this.columns,S=k.rows,A=k.columns,D=new W(w*S,b*A);for(let F=0;F<w;F++)for(let B=0;B<b;B++)for(let z=0;z<S;z++)for(let X=0;X<A;X++)D.set(S*F+z,A*B+X,this.get(F,B)*k.get(z,X));return D}kroneckerSum(k){if(k=W.checkMatrix(k),!this.isSquare()||!k.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let w=this.rows,b=k.rows,S=this.kroneckerProduct(W.eye(b,b)),A=W.eye(w,w).kroneckerProduct(k);return S.add(A)}transpose(){let k=new W(this.columns,this.rows);for(let w=0;w<this.rows;w++)for(let b=0;b<this.columns;b++)k.set(b,w,this.get(w,b));return k}sortRows(k=zt){for(let w=0;w<this.rows;w++)this.setRow(w,this.getRow(w).sort(k));return this}sortColumns(k=zt){for(let w=0;w<this.columns;w++)this.setColumn(w,this.getColumn(w).sort(k));return this}subMatrix(k,w,b,S){p(this,k,w,b,S);let A=new W(w-k+1,S-b+1);for(let D=k;D<=w;D++)for(let F=b;F<=S;F++)A.set(D-k,F-b,this.get(D,F));return A}subMatrixRow(k,w,b){if(w===void 0&&(w=0),b===void 0&&(b=this.columns-1),w>b||w<0||w>=this.columns||b<0||b>=this.columns)throw new RangeError("Argument out of range");let S=new W(k.length,b-w+1);for(let A=0;A<k.length;A++)for(let D=w;D<=b;D++){if(k[A]<0||k[A]>=this.rows)throw new RangeError(`Row index out of range: ${k[A]}`);S.set(A,D-w,this.get(k[A],D))}return S}subMatrixColumn(k,w,b){if(w===void 0&&(w=0),b===void 0&&(b=this.rows-1),w>b||w<0||w>=this.rows||b<0||b>=this.rows)throw new RangeError("Argument out of range");let S=new W(b-w+1,k.length);for(let A=0;A<k.length;A++)for(let D=w;D<=b;D++){if(k[A]<0||k[A]>=this.columns)throw new RangeError(`Column index out of range: ${k[A]}`);S.set(D-w,A,this.get(D,k[A]))}return S}setSubMatrix(k,w,b){if(k=W.checkMatrix(k),k.isEmpty())return this;let S=w+k.rows-1,A=b+k.columns-1;p(this,w,S,b,A);for(let D=0;D<k.rows;D++)for(let F=0;F<k.columns;F++)this.set(w+D,b+F,k.get(D,F));return this}selection(k,w){g(this,k),v(this,w);let b=new W(k.length,w.length);for(let S=0;S<k.length;S++){let A=k[S];for(let D=0;D<w.length;D++){let F=w[D];b.set(S,D,this.get(A,F))}}return b}trace(){let k=Math.min(this.rows,this.columns),w=0;for(let b=0;b<k;b++)w+=this.get(b,b);return w}clone(){return this.constructor.copy(this,new W(this.rows,this.columns))}static copy(k,w){for(const[b,S,A]of k.entries())w.set(b,S,A);return w}sum(k){switch(k){case"row":return E(this);case"column":return _(this);case void 0:return M(this);default:throw new Error(`invalid option: ${k}`)}}product(k){switch(k){case"row":return O(this);case"column":return T(this);case void 0:return N(this);default:throw new Error(`invalid option: ${k}`)}}mean(k){const w=this.sum(k);switch(k){case"row":{for(let b=0;b<this.rows;b++)w[b]/=this.columns;return w}case"column":{for(let b=0;b<this.columns;b++)w[b]/=this.rows;return w}case void 0:return w/this.size;default:throw new Error(`invalid option: ${k}`)}}variance(k,w={}){if(typeof k=="object"&&(w=k,k=void 0),typeof w!="object")throw new TypeError("options must be an object");const{unbiased:b=!0,mean:S=this.mean(k)}=w;if(typeof b!="boolean")throw new TypeError("unbiased must be a boolean");switch(k){case"row":{if(!r.isAnyArray(S))throw new TypeError("mean must be an array");return P(this,b,S)}case"column":{if(!r.isAnyArray(S))throw new TypeError("mean must be an array");return C(this,b,S)}case void 0:{if(typeof S!="number")throw new TypeError("mean must be a number");return R(this,b,S)}default:throw new Error(`invalid option: ${k}`)}}standardDeviation(k,w){typeof k=="object"&&(w=k,k=void 0);const b=this.variance(k,w);if(k===void 0)return Math.sqrt(b);for(let S=0;S<b.length;S++)b[S]=Math.sqrt(b[S]);return b}center(k,w={}){if(typeof k=="object"&&(w=k,k=void 0),typeof w!="object")throw new TypeError("options must be an object");const{center:b=this.mean(k)}=w;switch(k){case"row":{if(!r.isAnyArray(b))throw new TypeError("center must be an array");return I(this,b),this}case"column":{if(!r.isAnyArray(b))throw new TypeError("center must be an array");return j(this,b),this}case void 0:{if(typeof b!="number")throw new TypeError("center must be a number");return G(this,b),this}default:throw new Error(`invalid option: ${k}`)}}scale(k,w={}){if(typeof k=="object"&&(w=k,k=void 0),typeof w!="object")throw new TypeError("options must be an object");let b=w.scale;switch(k){case"row":{if(b===void 0)b=H(this);else if(!r.isAnyArray(b))throw new TypeError("scale must be an array");return Z(this,b),this}case"column":{if(b===void 0)b=U(this);else if(!r.isAnyArray(b))throw new TypeError("scale must be an array");return tt(this,b),this}case void 0:{if(b===void 0)b=gt(this);else if(typeof b!="number")throw new TypeError("scale must be a number");return xt(this,b),this}default:throw new Error(`invalid option: ${k}`)}}toString(k){return a(this,k)}[Symbol.iterator](){return this.entries()}*entries(){for(let k=0;k<this.rows;k++)for(let w=0;w<this.columns;w++)yield[k,w,this.get(k,w)]}*values(){for(let k=0;k<this.rows;k++)for(let w=0;w<this.columns;w++)yield this.get(k,w)}}ut.prototype.klass="Matrix",typeof Symbol<"u"&&(ut.prototype[Symbol.for("nodejs.util.inspect.custom")]=i);function zt(L,k){return L-k}function J(L){return L.every(k=>typeof k=="number")}ut.random=ut.rand,ut.randomInt=ut.randInt,ut.diagonal=ut.diag,ut.prototype.diagonal=ut.prototype.diag,ut.identity=ut.eye,ut.prototype.negate=ut.prototype.neg,ut.prototype.tensorProduct=ut.prototype.kroneckerProduct;const Ol=class Ol extends ut{constructor(w,b){super();ud(this,so);Me(this,"data");if(Ol.isMatrix(w))hd(this,so,qm).call(this,w.rows,w.columns),Ol.copy(w,this);else if(Number.isInteger(w)&&w>=0)hd(this,so,qm).call(this,w,b);else if(r.isAnyArray(w)){const S=w;if(w=S.length,b=w?S[0].length:0,typeof b!="number")throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let A=0;A<w;A++){if(S[A].length!==b)throw new RangeError("Inconsistent array dimensions");if(!J(S[A]))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(S[A]))}this.rows=w,this.columns=b}else throw new TypeError("First argument must be a positive number or an array")}set(w,b,S){return this.data[w][b]=S,this}get(w,b){return this.data[w][b]}removeRow(w){return u(this,w),this.data.splice(w,1),this.rows-=1,this}addRow(w,b){return b===void 0&&(b=w,w=this.rows),u(this,w,!0),b=Float64Array.from(d(this,b)),this.data.splice(w,0,b),this.rows+=1,this}removeColumn(w){h(this,w);for(let b=0;b<this.rows;b++){const S=new Float64Array(this.columns-1);for(let A=0;A<w;A++)S[A]=this.data[b][A];for(let A=w+1;A<this.columns;A++)S[A-1]=this.data[b][A];this.data[b]=S}return this.columns-=1,this}addColumn(w,b){typeof b>"u"&&(b=w,w=this.columns),h(this,w,!0),b=f(this,b);for(let S=0;S<this.rows;S++){const A=new Float64Array(this.columns+1);let D=0;for(;D<w;D++)A[D]=this.data[S][D];for(A[D++]=b[S];D<this.columns+1;D++)A[D]=this.data[S][D-1];this.data[S]=A}return this.columns+=1,this}};so=new WeakSet,qm=function(w,b){if(this.data=[],Number.isInteger(b)&&b>=0)for(let S=0;S<w;S++)this.data.push(new Float64Array(b));else throw new TypeError("nColumns must be a positive integer");this.rows=w,this.columns=b};let W=Ol;c(ut,W);const Al=class Al extends ut{constructor(w){super();ud(this,Rn);if(W.isMatrix(w)){if(!w.isSymmetric())throw new TypeError("not symmetric data");Nl(this,Rn,W.copy(w,new W(w.rows,w.rows)))}else if(Number.isInteger(w)&&w>=0)Nl(this,Rn,new W(w,w));else if(Nl(this,Rn,new W(w)),!this.isSymmetric())throw new TypeError("not symmetric data")}get size(){return Br(this,Rn).size}get rows(){return Br(this,Rn).rows}get columns(){return Br(this,Rn).columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(w){return W.isMatrix(w)&&w.klassType==="SymmetricMatrix"}static zeros(w){return new this(w)}static ones(w){return new this(w).fill(1)}clone(){const w=new Al(this.diagonalSize);for(const[b,S,A]of this.upperRightEntries())w.set(b,S,A);return w}toMatrix(){return new W(this)}get(w,b){return Br(this,Rn).get(w,b)}set(w,b,S){return Br(this,Rn).set(w,b,S),Br(this,Rn).set(b,w,S),this}removeCross(w){return Br(this,Rn).removeRow(w),Br(this,Rn).removeColumn(w),this}addCross(w,b){b===void 0&&(b=w,w=this.diagonalSize);const S=b.slice();return S.splice(w,1),Br(this,Rn).addRow(w,S),Br(this,Rn).addColumn(w,b),this}applyMask(w){if(w.length!==this.diagonalSize)throw new RangeError("Mask size do not match with matrix size");const b=[];for(const[S,A]of w.entries())A||b.push(S);b.reverse();for(const S of b)this.removeCross(S);return this}toCompact(){const{diagonalSize:w}=this,b=new Array(w*(w+1)/2);for(let S=0,A=0,D=0;D<b.length;D++)b[D]=this.get(A,S),++S>=w&&(S=++A);return b}static fromCompact(w){const b=w.length,S=(Math.sqrt(8*b+1)-1)/2;if(!Number.isInteger(S))throw new TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(w)}`);const A=new Al(S);for(let D=0,F=0,B=0;B<b;B++)A.set(D,F,w[B]),++D>=S&&(D=++F);return A}*upperRightEntries(){for(let w=0,b=0;w<this.diagonalSize;void 0){const S=this.get(w,b);yield[w,b,S],++b>=this.diagonalSize&&(b=++w)}}*upperRightValues(){for(let w=0,b=0;w<this.diagonalSize;void 0)yield this.get(w,b),++b>=this.diagonalSize&&(b=++w)}};Rn=new WeakMap;let Q=Al;Q.prototype.klassType="SymmetricMatrix";class ht extends Q{static isDistanceMatrix(k){return Q.isSymmetricMatrix(k)&&k.klassSubType==="DistanceMatrix"}constructor(k){if(super(k),!this.isDistance())throw new TypeError("Provided arguments do no produce a distance matrix")}set(k,w,b){return k===w&&(b=0),super.set(k,w,b)}addCross(k,w){return w===void 0&&(w=k,k=this.diagonalSize),w=w.slice(),w[k]=0,super.addCross(k,w)}toSymmetricMatrix(){return new Q(this)}clone(){const k=new ht(this.diagonalSize);for(const[w,b,S]of this.upperRightEntries())w!==b&&k.set(w,b,S);return k}toCompact(){const{diagonalSize:k}=this,w=(k-1)*k/2,b=new Array(w);for(let S=1,A=0,D=0;D<b.length;D++)b[D]=this.get(A,S),++S>=k&&(S=++A+1);return b}static fromCompact(k){const w=k.length;if(w===0)return new this(0);const b=(Math.sqrt(8*w+1)+1)/2;if(!Number.isInteger(b))throw new TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(k)}`);const S=new this(b);for(let A=1,D=0,F=0;F<w;F++)S.set(A,D,k[F]),++A>=b&&(A=++D+1);return S}}ht.prototype.klassSubType="DistanceMatrix";class Et extends ut{constructor(k,w,b){super(),this.matrix=k,this.rows=w,this.columns=b}}class Pt extends Et{constructor(k,w){h(k,w),super(k,k.rows,1),this.column=w}set(k,w,b){return this.matrix.set(k,this.column,b),this}get(k){return this.matrix.get(k,this.column)}}class Kt extends Et{constructor(k,w){v(k,w),super(k,k.rows,w.length),this.columnIndices=w}set(k,w,b){return this.matrix.set(k,this.columnIndices[w],b),this}get(k,w){return this.matrix.get(k,this.columnIndices[w])}}class pe extends Et{constructor(k){super(k,k.rows,k.columns)}set(k,w,b){return this.matrix.set(k,this.columns-w-1,b),this}get(k,w){return this.matrix.get(k,this.columns-w-1)}}class pn extends Et{constructor(k){super(k,k.rows,k.columns)}set(k,w,b){return this.matrix.set(this.rows-k-1,w,b),this}get(k,w){return this.matrix.get(this.rows-k-1,w)}}class Ce extends Et{constructor(k,w){u(k,w),super(k,1,k.columns),this.row=w}set(k,w,b){return this.matrix.set(this.row,w,b),this}get(k,w){return this.matrix.get(this.row,w)}}class Qe extends Et{constructor(k,w){g(k,w),super(k,w.length,k.columns),this.rowIndices=w}set(k,w,b){return this.matrix.set(this.rowIndices[k],w,b),this}get(k,w){return this.matrix.get(this.rowIndices[k],w)}}class Qt extends Et{constructor(k,w,b){g(k,w),v(k,b),super(k,w.length,b.length),this.rowIndices=w,this.columnIndices=b}set(k,w,b){return this.matrix.set(this.rowIndices[k],this.columnIndices[w],b),this}get(k,w){return this.matrix.get(this.rowIndices[k],this.columnIndices[w])}}class Er extends Et{constructor(k,w,b,S,A){p(k,w,b,S,A),super(k,b-w+1,A-S+1),this.startRow=w,this.startColumn=S}set(k,w,b){return this.matrix.set(this.startRow+k,this.startColumn+w,b),this}get(k,w){return this.matrix.get(this.startRow+k,this.startColumn+w)}}class re extends Et{constructor(k){super(k,k.columns,k.rows)}set(k,w,b){return this.matrix.set(w,k,b),this}get(k,w){return this.matrix.get(w,k)}}class Sr extends ut{constructor(k,w={}){const{rows:b=1}=w;if(k.length%b!==0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=b,this.columns=k.length/b,this.data=k}set(k,w,b){let S=this._calculateIndex(k,w);return this.data[S]=b,this}get(k,w){let b=this._calculateIndex(k,w);return this.data[b]}_calculateIndex(k,w){return k*this.columns+w}}class _e extends ut{constructor(k){super(),this.data=k,this.rows=k.length,this.columns=k[0].length}set(k,w,b){return this.data[k][w]=b,this}get(k,w){return this.data[k][w]}}function ds(L,k){if(r.isAnyArray(L))return L[0]&&r.isAnyArray(L[0])?new _e(L):new Sr(L,k);throw new Error("the argument is not an array")}class _r{constructor(k){k=_e.checkMatrix(k);let w=k.clone(),b=w.rows,S=w.columns,A=new Float64Array(b),D=1,F,B,z,X,$,it,yt,et,st;for(F=0;F<b;F++)A[F]=F;for(et=new Float64Array(b),B=0;B<S;B++){for(F=0;F<b;F++)et[F]=w.get(F,B);for(F=0;F<b;F++){for(st=Math.min(F,B),$=0,z=0;z<st;z++)$+=w.get(F,z)*et[z];et[F]-=$,w.set(F,B,et[F])}for(X=B,F=B+1;F<b;F++)Math.abs(et[F])>Math.abs(et[X])&&(X=F);if(X!==B){for(z=0;z<S;z++)it=w.get(X,z),w.set(X,z,w.get(B,z)),w.set(B,z,it);yt=A[X],A[X]=A[B],A[B]=yt,D=-D}if(B<b&&w.get(B,B)!==0)for(F=B+1;F<b;F++)w.set(F,B,w.get(F,B)/w.get(B,B))}this.LU=w,this.pivotVector=A,this.pivotSign=D}isSingular(){let k=this.LU,w=k.columns;for(let b=0;b<w;b++)if(k.get(b,b)===0)return!0;return!1}solve(k){k=W.checkMatrix(k);let w=this.LU;if(w.rows!==k.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let S=k.columns,A=k.subMatrixRow(this.pivotVector,0,S-1),D=w.columns,F,B,z;for(z=0;z<D;z++)for(F=z+1;F<D;F++)for(B=0;B<S;B++)A.set(F,B,A.get(F,B)-A.get(z,B)*w.get(F,z));for(z=D-1;z>=0;z--){for(B=0;B<S;B++)A.set(z,B,A.get(z,B)/w.get(z,z));for(F=0;F<z;F++)for(B=0;B<S;B++)A.set(F,B,A.get(F,B)-A.get(z,B)*w.get(F,z))}return A}get determinant(){let k=this.LU;if(!k.isSquare())throw new Error("Matrix must be square");let w=this.pivotSign,b=k.columns;for(let S=0;S<b;S++)w*=k.get(S,S);return w}get lowerTriangularMatrix(){let k=this.LU,w=k.rows,b=k.columns,S=new W(w,b);for(let A=0;A<w;A++)for(let D=0;D<b;D++)A>D?S.set(A,D,k.get(A,D)):A===D?S.set(A,D,1):S.set(A,D,0);return S}get upperTriangularMatrix(){let k=this.LU,w=k.rows,b=k.columns,S=new W(w,b);for(let A=0;A<w;A++)for(let D=0;D<b;D++)A<=D?S.set(A,D,k.get(A,D)):S.set(A,D,0);return S}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function Ye(L,k){let w=0;return Math.abs(L)>Math.abs(k)?(w=k/L,Math.abs(L)*Math.sqrt(1+w*w)):k!==0?(w=L/k,Math.abs(k)*Math.sqrt(1+w*w)):0}class Be{constructor(k){k=_e.checkMatrix(k);let w=k.clone(),b=k.rows,S=k.columns,A=new Float64Array(S),D,F,B,z;for(B=0;B<S;B++){let X=0;for(D=B;D<b;D++)X=Ye(X,w.get(D,B));if(X!==0){for(w.get(B,B)<0&&(X=-X),D=B;D<b;D++)w.set(D,B,w.get(D,B)/X);for(w.set(B,B,w.get(B,B)+1),F=B+1;F<S;F++){for(z=0,D=B;D<b;D++)z+=w.get(D,B)*w.get(D,F);for(z=-z/w.get(B,B),D=B;D<b;D++)w.set(D,F,w.get(D,F)+z*w.get(D,B))}}A[B]=-X}this.QR=w,this.Rdiag=A}solve(k){k=W.checkMatrix(k);let w=this.QR,b=w.rows;if(k.rows!==b)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let S=k.columns,A=k.clone(),D=w.columns,F,B,z,X;for(z=0;z<D;z++)for(B=0;B<S;B++){for(X=0,F=z;F<b;F++)X+=w.get(F,z)*A.get(F,B);for(X=-X/w.get(z,z),F=z;F<b;F++)A.set(F,B,A.get(F,B)+X*w.get(F,z))}for(z=D-1;z>=0;z--){for(B=0;B<S;B++)A.set(z,B,A.get(z,B)/this.Rdiag[z]);for(F=0;F<z;F++)for(B=0;B<S;B++)A.set(F,B,A.get(F,B)-A.get(z,B)*w.get(F,z))}return A.subMatrix(0,D-1,0,S-1)}isFullRank(){let k=this.QR.columns;for(let w=0;w<k;w++)if(this.Rdiag[w]===0)return!1;return!0}get upperTriangularMatrix(){let k=this.QR,w=k.columns,b=new W(w,w),S,A;for(S=0;S<w;S++)for(A=0;A<w;A++)S<A?b.set(S,A,k.get(S,A)):S===A?b.set(S,A,this.Rdiag[S]):b.set(S,A,0);return b}get orthogonalMatrix(){let k=this.QR,w=k.rows,b=k.columns,S=new W(w,b),A,D,F,B;for(F=b-1;F>=0;F--){for(A=0;A<w;A++)S.set(A,F,0);for(S.set(F,F,1),D=F;D<b;D++)if(k.get(F,F)!==0){for(B=0,A=F;A<w;A++)B+=k.get(A,F)*S.get(A,D);for(B=-B/k.get(F,F),A=F;A<w;A++)S.set(A,D,S.get(A,D)+B*k.get(A,F))}}return S}}class Xn{constructor(k,w={}){if(k=_e.checkMatrix(k),k.isEmpty())throw new Error("Matrix must be non-empty");let b=k.rows,S=k.columns;const{computeLeftSingularVectors:A=!0,computeRightSingularVectors:D=!0,autoTranspose:F=!1}=w;let B=!!A,z=!!D,X=!1,$;if(b<S)if(!F)$=k.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else{$=k.transpose(),b=$.rows,S=$.columns,X=!0;let Y=B;B=z,z=Y}else $=k.clone();let it=Math.min(b,S),yt=Math.min(b+1,S),et=new Float64Array(yt),st=new W(b,it),kt=new W(S,S),V=new Float64Array(S),pt=new Float64Array(b),At=new Float64Array(yt);for(let Y=0;Y<yt;Y++)At[Y]=Y;let Bt=Math.min(b-1,S),Gt=Math.max(0,Math.min(S-2,b)),Re=Math.max(Bt,Gt);for(let Y=0;Y<Re;Y++){if(Y<Bt){et[Y]=0;for(let dt=Y;dt<b;dt++)et[Y]=Ye(et[Y],$.get(dt,Y));if(et[Y]!==0){$.get(Y,Y)<0&&(et[Y]=-et[Y]);for(let dt=Y;dt<b;dt++)$.set(dt,Y,$.get(dt,Y)/et[Y]);$.set(Y,Y,$.get(Y,Y)+1)}et[Y]=-et[Y]}for(let dt=Y+1;dt<S;dt++){if(Y<Bt&&et[Y]!==0){let Mt=0;for(let vt=Y;vt<b;vt++)Mt+=$.get(vt,Y)*$.get(vt,dt);Mt=-Mt/$.get(Y,Y);for(let vt=Y;vt<b;vt++)$.set(vt,dt,$.get(vt,dt)+Mt*$.get(vt,Y))}V[dt]=$.get(Y,dt)}if(B&&Y<Bt)for(let dt=Y;dt<b;dt++)st.set(dt,Y,$.get(dt,Y));if(Y<Gt){V[Y]=0;for(let dt=Y+1;dt<S;dt++)V[Y]=Ye(V[Y],V[dt]);if(V[Y]!==0){V[Y+1]<0&&(V[Y]=0-V[Y]);for(let dt=Y+1;dt<S;dt++)V[dt]/=V[Y];V[Y+1]+=1}if(V[Y]=-V[Y],Y+1<b&&V[Y]!==0){for(let dt=Y+1;dt<b;dt++)pt[dt]=0;for(let dt=Y+1;dt<b;dt++)for(let Mt=Y+1;Mt<S;Mt++)pt[dt]+=V[Mt]*$.get(dt,Mt);for(let dt=Y+1;dt<S;dt++){let Mt=-V[dt]/V[Y+1];for(let vt=Y+1;vt<b;vt++)$.set(vt,dt,$.get(vt,dt)+Mt*pt[vt])}}if(z)for(let dt=Y+1;dt<S;dt++)kt.set(dt,Y,V[dt])}}let Ct=Math.min(S,b+1);if(Bt<S&&(et[Bt]=$.get(Bt,Bt)),b<Ct&&(et[Ct-1]=0),Gt+1<Ct&&(V[Gt]=$.get(Gt,Ct-1)),V[Ct-1]=0,B){for(let Y=Bt;Y<it;Y++){for(let dt=0;dt<b;dt++)st.set(dt,Y,0);st.set(Y,Y,1)}for(let Y=Bt-1;Y>=0;Y--)if(et[Y]!==0){for(let dt=Y+1;dt<it;dt++){let Mt=0;for(let vt=Y;vt<b;vt++)Mt+=st.get(vt,Y)*st.get(vt,dt);Mt=-Mt/st.get(Y,Y);for(let vt=Y;vt<b;vt++)st.set(vt,dt,st.get(vt,dt)+Mt*st.get(vt,Y))}for(let dt=Y;dt<b;dt++)st.set(dt,Y,-st.get(dt,Y));st.set(Y,Y,1+st.get(Y,Y));for(let dt=0;dt<Y-1;dt++)st.set(dt,Y,0)}else{for(let dt=0;dt<b;dt++)st.set(dt,Y,0);st.set(Y,Y,1)}}if(z)for(let Y=S-1;Y>=0;Y--){if(Y<Gt&&V[Y]!==0)for(let dt=Y+1;dt<S;dt++){let Mt=0;for(let vt=Y+1;vt<S;vt++)Mt+=kt.get(vt,Y)*kt.get(vt,dt);Mt=-Mt/kt.get(Y+1,Y);for(let vt=Y+1;vt<S;vt++)kt.set(vt,dt,kt.get(vt,dt)+Mt*kt.get(vt,Y))}for(let dt=0;dt<S;dt++)kt.set(dt,Y,0);kt.set(Y,Y,1)}let Lt=Ct-1,ye=Number.EPSILON;for(;Ct>0;){let Y,dt;for(Y=Ct-2;Y>=-1&&Y!==-1;Y--){const Mt=Number.MIN_VALUE+ye*Math.abs(et[Y]+Math.abs(et[Y+1]));if(Math.abs(V[Y])<=Mt||Number.isNaN(V[Y])){V[Y]=0;break}}if(Y===Ct-2)dt=4;else{let Mt;for(Mt=Ct-1;Mt>=Y&&Mt!==Y;Mt--){let vt=(Mt!==Ct?Math.abs(V[Mt]):0)+(Mt!==Y+1?Math.abs(V[Mt-1]):0);if(Math.abs(et[Mt])<=ye*vt){et[Mt]=0;break}}Mt===Y?dt=3:Mt===Ct-1?dt=1:(dt=2,Y=Mt)}switch(Y++,dt){case 1:{let Mt=V[Ct-2];V[Ct-2]=0;for(let vt=Ct-2;vt>=Y;vt--){let Le=Ye(et[vt],Mt),ce=et[vt]/Le,ke=Mt/Le;if(et[vt]=Le,vt!==Y&&(Mt=-ke*V[vt-1],V[vt-1]=ce*V[vt-1]),z)for(let Ie=0;Ie<S;Ie++)Le=ce*kt.get(Ie,vt)+ke*kt.get(Ie,Ct-1),kt.set(Ie,Ct-1,-ke*kt.get(Ie,vt)+ce*kt.get(Ie,Ct-1)),kt.set(Ie,vt,Le)}break}case 2:{let Mt=V[Y-1];V[Y-1]=0;for(let vt=Y;vt<Ct;vt++){let Le=Ye(et[vt],Mt),ce=et[vt]/Le,ke=Mt/Le;if(et[vt]=Le,Mt=-ke*V[vt],V[vt]=ce*V[vt],B)for(let Ie=0;Ie<b;Ie++)Le=ce*st.get(Ie,vt)+ke*st.get(Ie,Y-1),st.set(Ie,Y-1,-ke*st.get(Ie,vt)+ce*st.get(Ie,Y-1)),st.set(Ie,vt,Le)}break}case 3:{const Mt=Math.max(Math.abs(et[Ct-1]),Math.abs(et[Ct-2]),Math.abs(V[Ct-2]),Math.abs(et[Y]),Math.abs(V[Y])),vt=et[Ct-1]/Mt,Le=et[Ct-2]/Mt,ce=V[Ct-2]/Mt,ke=et[Y]/Mt,Ie=V[Y]/Mt,Sn=((Le+vt)*(Le-vt)+ce*ce)/2,Fr=vt*ce*(vt*ce);let cn=0;(Sn!==0||Fr!==0)&&(Sn<0?cn=0-Math.sqrt(Sn*Sn+Fr):cn=Math.sqrt(Sn*Sn+Fr),cn=Fr/(Sn+cn));let ii=(ke+vt)*(ke-vt)+cn,Mi=ke*Ie;for(let ie=Y;ie<Ct-1;ie++){let _n=Ye(ii,Mi);_n===0&&(_n=Number.MIN_VALUE);let ur=ii/_n,hr=Mi/_n;if(ie!==Y&&(V[ie-1]=_n),ii=ur*et[ie]+hr*V[ie],V[ie]=ur*V[ie]-hr*et[ie],Mi=hr*et[ie+1],et[ie+1]=ur*et[ie+1],z)for(let un=0;un<S;un++)_n=ur*kt.get(un,ie)+hr*kt.get(un,ie+1),kt.set(un,ie+1,-hr*kt.get(un,ie)+ur*kt.get(un,ie+1)),kt.set(un,ie,_n);if(_n=Ye(ii,Mi),_n===0&&(_n=Number.MIN_VALUE),ur=ii/_n,hr=Mi/_n,et[ie]=_n,ii=ur*V[ie]+hr*et[ie+1],et[ie+1]=-hr*V[ie]+ur*et[ie+1],Mi=hr*V[ie+1],V[ie+1]=ur*V[ie+1],B&&ie<b-1)for(let un=0;un<b;un++)_n=ur*st.get(un,ie)+hr*st.get(un,ie+1),st.set(un,ie+1,-hr*st.get(un,ie)+ur*st.get(un,ie+1)),st.set(un,ie,_n)}V[Ct-2]=ii;break}case 4:{if(et[Y]<=0&&(et[Y]=et[Y]<0?-et[Y]:0,z))for(let Mt=0;Mt<=Lt;Mt++)kt.set(Mt,Y,-kt.get(Mt,Y));for(;Y<Lt&&!(et[Y]>=et[Y+1]);){let Mt=et[Y];if(et[Y]=et[Y+1],et[Y+1]=Mt,z&&Y<S-1)for(let vt=0;vt<S;vt++)Mt=kt.get(vt,Y+1),kt.set(vt,Y+1,kt.get(vt,Y)),kt.set(vt,Y,Mt);if(B&&Y<b-1)for(let vt=0;vt<b;vt++)Mt=st.get(vt,Y+1),st.set(vt,Y+1,st.get(vt,Y)),st.set(vt,Y,Mt);Y++}Ct--;break}}}if(X){let Y=kt;kt=st,st=Y}this.m=b,this.n=S,this.s=et,this.U=st,this.V=kt}solve(k){let w=k,b=this.threshold,S=this.s.length,A=W.zeros(S,S);for(let it=0;it<S;it++)Math.abs(this.s[it])<=b?A.set(it,it,0):A.set(it,it,1/this.s[it]);let D=this.U,F=this.rightSingularVectors,B=F.mmul(A),z=F.rows,X=D.rows,$=W.zeros(z,X);for(let it=0;it<z;it++)for(let yt=0;yt<X;yt++){let et=0;for(let st=0;st<S;st++)et+=B.get(it,st)*D.get(yt,st);$.set(it,yt,et)}return $.mmul(w)}solveForDiagonal(k){return this.solve(W.diag(k))}inverse(){let k=this.V,w=this.threshold,b=k.rows,S=k.columns,A=new W(b,this.s.length);for(let X=0;X<b;X++)for(let $=0;$<S;$++)Math.abs(this.s[$])>w&&A.set(X,$,k.get(X,$)/this.s[$]);let D=this.U,F=D.rows,B=D.columns,z=new W(b,F);for(let X=0;X<b;X++)for(let $=0;$<F;$++){let it=0;for(let yt=0;yt<B;yt++)it+=A.get(X,yt)*D.get($,yt);z.set(X,$,it)}return z}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let k=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,w=0,b=this.s;for(let S=0,A=b.length;S<A;S++)b[S]>k&&w++;return w}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return W.diag(this.s)}}function Kn(L,k=!1){return L=_e.checkMatrix(L),k?new Xn(L).inverse():kr(L,W.eye(L.rows))}function kr(L,k,w=!1){return L=_e.checkMatrix(L),k=_e.checkMatrix(k),w?new Xn(L).solve(k):L.isSquare()?new _r(L).solve(k):new Be(L).solve(k)}function ki(L){if(L=W.checkMatrix(L),L.isSquare()){if(L.columns===0)return 1;let k,w,b,S;if(L.columns===2)return k=L.get(0,0),w=L.get(0,1),b=L.get(1,0),S=L.get(1,1),k*S-w*b;if(L.columns===3){let A,D,F;return A=new Qt(L,[1,2],[1,2]),D=new Qt(L,[1,2],[0,2]),F=new Qt(L,[1,2],[0,1]),k=L.get(0,0),w=L.get(0,1),b=L.get(0,2),k*ki(A)-w*ki(D)+b*ki(F)}else return new _r(L).determinant}else throw Error("determinant can only be calculated for a square matrix")}function ei(L,k){let w=[];for(let b=0;b<L;b++)b!==k&&w.push(b);return w}function fs(L,k,w,b=1e-9,S=1e-9){if(L>S)return new Array(k.rows+1).fill(0);{let A=k.addRow(w,[0]);for(let D=0;D<A.rows;D++)Math.abs(A.get(D,0))<b&&A.set(D,0,0);return A.to1DArray()}}function gs(L,k={}){const{thresholdValue:w=1e-9,thresholdError:b=1e-9}=k;L=W.checkMatrix(L);let S=L.rows,A=new W(S,S);for(let D=0;D<S;D++){let F=W.columnVector(L.getRow(D)),B=L.subMatrixRow(ei(S,D)).transpose(),X=new Xn(B).solve(F),$=W.sub(F,B.mmul(X)).abs().max();A.setRow(D,fs($,X,D,w,b))}return A}function ld(L,k=Number.EPSILON){if(L=W.checkMatrix(L),L.isEmpty())return L.transpose();let w=new Xn(L,{autoTranspose:!0}),b=w.leftSingularVectors,S=w.rightSingularVectors,A=w.diagonal;for(let D=0;D<A.length;D++)Math.abs(A[D])>k?A[D]=1/A[D]:A[D]=0;return S.mmul(W.diag(A).mmul(b.transpose()))}function Ml(L,k=L,w={}){L=new W(L);let b=!1;if(typeof k=="object"&&!W.isMatrix(k)&&!r.isAnyArray(k)?(w=k,k=L,b=!0):k=new W(k),L.rows!==k.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:S=!0}=w;S&&(L=L.center("column"),b||(k=k.center("column")));const A=L.transpose().mmul(k);for(let D=0;D<A.rows;D++)for(let F=0;F<A.columns;F++)A.set(D,F,A.get(D,F)*(1/(L.rows-1)));return A}function ni(L,k=L,w={}){L=new W(L);let b=!1;if(typeof k=="object"&&!W.isMatrix(k)&&!r.isAnyArray(k)?(w=k,k=L,b=!0):k=new W(k),L.rows!==k.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:S=!0,scale:A=!0}=w;S&&(L.center("column"),b||k.center("column")),A&&(L.scale("column"),b||k.scale("column"));const D=L.standardDeviation("column",{unbiased:!0}),F=b?D:k.standardDeviation("column",{unbiased:!0}),B=L.transpose().mmul(k);for(let z=0;z<B.rows;z++)for(let X=0;X<B.columns;X++)B.set(z,X,B.get(z,X)*(1/(D[z]*F[X]))*(1/(L.rows-1)));return B}class ri{constructor(k,w={}){const{assumeSymmetric:b=!1}=w;if(k=_e.checkMatrix(k),!k.isSquare())throw new Error("Matrix is not a square matrix");if(k.isEmpty())throw new Error("Matrix must be non-empty");let S=k.columns,A=new W(S,S),D=new Float64Array(S),F=new Float64Array(S),B=k,z,X,$=!1;if(b?$=!0:$=k.isSymmetric(),$){for(z=0;z<S;z++)for(X=0;X<S;X++)A.set(z,X,B.get(z,X));hR(S,F,D,A),dR(S,F,D,A)}else{let it=new W(S,S),yt=new Float64Array(S);for(X=0;X<S;X++)for(z=0;z<S;z++)it.set(z,X,B.get(z,X));fR(S,it,yt,A),gR(S,F,D,A,it)}this.n=S,this.e=F,this.d=D,this.V=A}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let k=this.n,w=this.e,b=this.d,S=new W(k,k),A,D;for(A=0;A<k;A++){for(D=0;D<k;D++)S.set(A,D,0);S.set(A,A,b[A]),w[A]>0?S.set(A,A+1,w[A]):w[A]<0&&S.set(A,A-1,w[A])}return S}}function hR(L,k,w,b){let S,A,D,F,B,z,X,$;for(B=0;B<L;B++)w[B]=b.get(L-1,B);for(F=L-1;F>0;F--){for($=0,D=0,z=0;z<F;z++)$=$+Math.abs(w[z]);if($===0)for(k[F]=w[F-1],B=0;B<F;B++)w[B]=b.get(F-1,B),b.set(F,B,0),b.set(B,F,0);else{for(z=0;z<F;z++)w[z]/=$,D+=w[z]*w[z];for(S=w[F-1],A=Math.sqrt(D),S>0&&(A=-A),k[F]=$*A,D=D-S*A,w[F-1]=S-A,B=0;B<F;B++)k[B]=0;for(B=0;B<F;B++){for(S=w[B],b.set(B,F,S),A=k[B]+b.get(B,B)*S,z=B+1;z<=F-1;z++)A+=b.get(z,B)*w[z],k[z]+=b.get(z,B)*S;k[B]=A}for(S=0,B=0;B<F;B++)k[B]/=D,S+=k[B]*w[B];for(X=S/(D+D),B=0;B<F;B++)k[B]-=X*w[B];for(B=0;B<F;B++){for(S=w[B],A=k[B],z=B;z<=F-1;z++)b.set(z,B,b.get(z,B)-(S*k[z]+A*w[z]));w[B]=b.get(F-1,B),b.set(F,B,0)}}w[F]=D}for(F=0;F<L-1;F++){if(b.set(L-1,F,b.get(F,F)),b.set(F,F,1),D=w[F+1],D!==0){for(z=0;z<=F;z++)w[z]=b.get(z,F+1)/D;for(B=0;B<=F;B++){for(A=0,z=0;z<=F;z++)A+=b.get(z,F+1)*b.get(z,B);for(z=0;z<=F;z++)b.set(z,B,b.get(z,B)-A*w[z])}}for(z=0;z<=F;z++)b.set(z,F+1,0)}for(B=0;B<L;B++)w[B]=b.get(L-1,B),b.set(L-1,B,0);b.set(L-1,L-1,1),k[0]=0}function dR(L,k,w,b){let S,A,D,F,B,z,X,$,it,yt,et,st,kt,V,pt,At;for(D=1;D<L;D++)k[D-1]=k[D];k[L-1]=0;let Bt=0,Gt=0,Re=Number.EPSILON;for(z=0;z<L;z++){for(Gt=Math.max(Gt,Math.abs(w[z])+Math.abs(k[z])),X=z;X<L&&!(Math.abs(k[X])<=Re*Gt);)X++;if(X>z)do{for(S=w[z],$=(w[z+1]-S)/(2*k[z]),it=Ye($,1),$<0&&(it=-it),w[z]=k[z]/($+it),w[z+1]=k[z]*($+it),yt=w[z+1],A=S-w[z],D=z+2;D<L;D++)w[D]-=A;for(Bt=Bt+A,$=w[X],et=1,st=et,kt=et,V=k[z+1],pt=0,At=0,D=X-1;D>=z;D--)for(kt=st,st=et,At=pt,S=et*k[D],A=et*$,it=Ye($,k[D]),k[D+1]=pt*it,pt=k[D]/it,et=$/it,$=et*w[D]-pt*S,w[D+1]=A+pt*(et*S+pt*w[D]),B=0;B<L;B++)A=b.get(B,D+1),b.set(B,D+1,pt*b.get(B,D)+et*A),b.set(B,D,et*b.get(B,D)-pt*A);$=-pt*At*kt*V*k[z]/yt,k[z]=pt*$,w[z]=et*$}while(Math.abs(k[z])>Re*Gt);w[z]=w[z]+Bt,k[z]=0}for(D=0;D<L-1;D++){for(B=D,$=w[D],F=D+1;F<L;F++)w[F]<$&&(B=F,$=w[F]);if(B!==D)for(w[B]=w[D],w[D]=$,F=0;F<L;F++)$=b.get(F,D),b.set(F,D,b.get(F,B)),b.set(F,B,$)}}function fR(L,k,w,b){let S=0,A=L-1,D,F,B,z,X,$,it;for($=S+1;$<=A-1;$++){for(it=0,z=$;z<=A;z++)it=it+Math.abs(k.get(z,$-1));if(it!==0){for(B=0,z=A;z>=$;z--)w[z]=k.get(z,$-1)/it,B+=w[z]*w[z];for(F=Math.sqrt(B),w[$]>0&&(F=-F),B=B-w[$]*F,w[$]=w[$]-F,X=$;X<L;X++){for(D=0,z=A;z>=$;z--)D+=w[z]*k.get(z,X);for(D=D/B,z=$;z<=A;z++)k.set(z,X,k.get(z,X)-D*w[z])}for(z=0;z<=A;z++){for(D=0,X=A;X>=$;X--)D+=w[X]*k.get(z,X);for(D=D/B,X=$;X<=A;X++)k.set(z,X,k.get(z,X)-D*w[X])}w[$]=it*w[$],k.set($,$-1,it*F)}}for(z=0;z<L;z++)for(X=0;X<L;X++)b.set(z,X,z===X?1:0);for($=A-1;$>=S+1;$--)if(k.get($,$-1)!==0){for(z=$+1;z<=A;z++)w[z]=k.get(z,$-1);for(X=$;X<=A;X++){for(F=0,z=$;z<=A;z++)F+=w[z]*b.get(z,X);for(F=F/w[$]/k.get($,$-1),z=$;z<=A;z++)b.set(z,X,b.get(z,X)+F*w[z])}}}function gR(L,k,w,b,S){let A=L-1,D=0,F=L-1,B=Number.EPSILON,z=0,X=0,$=0,it=0,yt=0,et=0,st=0,kt=0,V,pt,At,Bt,Gt,Re,Ct,Lt,ye,Y,dt,Mt,vt,Le,ce;for(V=0;V<L;V++)for((V<D||V>F)&&(w[V]=S.get(V,V),k[V]=0),pt=Math.max(V-1,0);pt<L;pt++)X=X+Math.abs(S.get(V,pt));for(;A>=D;){for(Bt=A;Bt>D&&(et=Math.abs(S.get(Bt-1,Bt-1))+Math.abs(S.get(Bt,Bt)),et===0&&(et=X),!(Math.abs(S.get(Bt,Bt-1))<B*et));)Bt--;if(Bt===A)S.set(A,A,S.get(A,A)+z),w[A]=S.get(A,A),k[A]=0,A--,kt=0;else if(Bt===A-1){if(Ct=S.get(A,A-1)*S.get(A-1,A),$=(S.get(A-1,A-1)-S.get(A,A))/2,it=$*$+Ct,st=Math.sqrt(Math.abs(it)),S.set(A,A,S.get(A,A)+z),S.set(A-1,A-1,S.get(A-1,A-1)+z),Lt=S.get(A,A),it>=0){for(st=$>=0?$+st:$-st,w[A-1]=Lt+st,w[A]=w[A-1],st!==0&&(w[A]=Lt-Ct/st),k[A-1]=0,k[A]=0,Lt=S.get(A,A-1),et=Math.abs(Lt)+Math.abs(st),$=Lt/et,it=st/et,yt=Math.sqrt($*$+it*it),$=$/yt,it=it/yt,pt=A-1;pt<L;pt++)st=S.get(A-1,pt),S.set(A-1,pt,it*st+$*S.get(A,pt)),S.set(A,pt,it*S.get(A,pt)-$*st);for(V=0;V<=A;V++)st=S.get(V,A-1),S.set(V,A-1,it*st+$*S.get(V,A)),S.set(V,A,it*S.get(V,A)-$*st);for(V=D;V<=F;V++)st=b.get(V,A-1),b.set(V,A-1,it*st+$*b.get(V,A)),b.set(V,A,it*b.get(V,A)-$*st)}else w[A-1]=Lt+$,w[A]=Lt+$,k[A-1]=st,k[A]=-st;A=A-2,kt=0}else{if(Lt=S.get(A,A),ye=0,Ct=0,Bt<A&&(ye=S.get(A-1,A-1),Ct=S.get(A,A-1)*S.get(A-1,A)),kt===10){for(z+=Lt,V=D;V<=A;V++)S.set(V,V,S.get(V,V)-Lt);et=Math.abs(S.get(A,A-1))+Math.abs(S.get(A-1,A-2)),Lt=ye=.75*et,Ct=-.4375*et*et}if(kt===30&&(et=(ye-Lt)/2,et=et*et+Ct,et>0)){for(et=Math.sqrt(et),ye<Lt&&(et=-et),et=Lt-Ct/((ye-Lt)/2+et),V=D;V<=A;V++)S.set(V,V,S.get(V,V)-et);z+=et,Lt=ye=Ct=.964}for(kt=kt+1,Gt=A-2;Gt>=Bt&&(st=S.get(Gt,Gt),yt=Lt-st,et=ye-st,$=(yt*et-Ct)/S.get(Gt+1,Gt)+S.get(Gt,Gt+1),it=S.get(Gt+1,Gt+1)-st-yt-et,yt=S.get(Gt+2,Gt+1),et=Math.abs($)+Math.abs(it)+Math.abs(yt),$=$/et,it=it/et,yt=yt/et,!(Gt===Bt||Math.abs(S.get(Gt,Gt-1))*(Math.abs(it)+Math.abs(yt))<B*(Math.abs($)*(Math.abs(S.get(Gt-1,Gt-1))+Math.abs(st)+Math.abs(S.get(Gt+1,Gt+1))))));)Gt--;for(V=Gt+2;V<=A;V++)S.set(V,V-2,0),V>Gt+2&&S.set(V,V-3,0);for(At=Gt;At<=A-1&&(Le=At!==A-1,At!==Gt&&($=S.get(At,At-1),it=S.get(At+1,At-1),yt=Le?S.get(At+2,At-1):0,Lt=Math.abs($)+Math.abs(it)+Math.abs(yt),Lt!==0&&($=$/Lt,it=it/Lt,yt=yt/Lt)),Lt!==0);At++)if(et=Math.sqrt($*$+it*it+yt*yt),$<0&&(et=-et),et!==0){for(At!==Gt?S.set(At,At-1,-et*Lt):Bt!==Gt&&S.set(At,At-1,-S.get(At,At-1)),$=$+et,Lt=$/et,ye=it/et,st=yt/et,it=it/$,yt=yt/$,pt=At;pt<L;pt++)$=S.get(At,pt)+it*S.get(At+1,pt),Le&&($=$+yt*S.get(At+2,pt),S.set(At+2,pt,S.get(At+2,pt)-$*st)),S.set(At,pt,S.get(At,pt)-$*Lt),S.set(At+1,pt,S.get(At+1,pt)-$*ye);for(V=0;V<=Math.min(A,At+3);V++)$=Lt*S.get(V,At)+ye*S.get(V,At+1),Le&&($=$+st*S.get(V,At+2),S.set(V,At+2,S.get(V,At+2)-$*yt)),S.set(V,At,S.get(V,At)-$),S.set(V,At+1,S.get(V,At+1)-$*it);for(V=D;V<=F;V++)$=Lt*b.get(V,At)+ye*b.get(V,At+1),Le&&($=$+st*b.get(V,At+2),b.set(V,At+2,b.get(V,At+2)-$*yt)),b.set(V,At,b.get(V,At)-$),b.set(V,At+1,b.get(V,At+1)-$*it)}}}if(X!==0){for(A=L-1;A>=0;A--)if($=w[A],it=k[A],it===0)for(Bt=A,S.set(A,A,1),V=A-1;V>=0;V--){for(Ct=S.get(V,V)-$,yt=0,pt=Bt;pt<=A;pt++)yt=yt+S.get(V,pt)*S.get(pt,A);if(k[V]<0)st=Ct,et=yt;else if(Bt=V,k[V]===0?S.set(V,A,Ct!==0?-yt/Ct:-yt/(B*X)):(Lt=S.get(V,V+1),ye=S.get(V+1,V),it=(w[V]-$)*(w[V]-$)+k[V]*k[V],Re=(Lt*et-st*yt)/it,S.set(V,A,Re),S.set(V+1,A,Math.abs(Lt)>Math.abs(st)?(-yt-Ct*Re)/Lt:(-et-ye*Re)/st)),Re=Math.abs(S.get(V,A)),B*Re*Re>1)for(pt=V;pt<=A;pt++)S.set(pt,A,S.get(pt,A)/Re)}else if(it<0)for(Bt=A-1,Math.abs(S.get(A,A-1))>Math.abs(S.get(A-1,A))?(S.set(A-1,A-1,it/S.get(A,A-1)),S.set(A-1,A,-(S.get(A,A)-$)/S.get(A,A-1))):(ce=Tl(0,-S.get(A-1,A),S.get(A-1,A-1)-$,it),S.set(A-1,A-1,ce[0]),S.set(A-1,A,ce[1])),S.set(A,A-1,0),S.set(A,A,1),V=A-2;V>=0;V--){for(Y=0,dt=0,pt=Bt;pt<=A;pt++)Y=Y+S.get(V,pt)*S.get(pt,A-1),dt=dt+S.get(V,pt)*S.get(pt,A);if(Ct=S.get(V,V)-$,k[V]<0)st=Ct,yt=Y,et=dt;else if(Bt=V,k[V]===0?(ce=Tl(-Y,-dt,Ct,it),S.set(V,A-1,ce[0]),S.set(V,A,ce[1])):(Lt=S.get(V,V+1),ye=S.get(V+1,V),Mt=(w[V]-$)*(w[V]-$)+k[V]*k[V]-it*it,vt=(w[V]-$)*2*it,Mt===0&&vt===0&&(Mt=B*X*(Math.abs(Ct)+Math.abs(it)+Math.abs(Lt)+Math.abs(ye)+Math.abs(st))),ce=Tl(Lt*yt-st*Y+it*dt,Lt*et-st*dt-it*Y,Mt,vt),S.set(V,A-1,ce[0]),S.set(V,A,ce[1]),Math.abs(Lt)>Math.abs(st)+Math.abs(it)?(S.set(V+1,A-1,(-Y-Ct*S.get(V,A-1)+it*S.get(V,A))/Lt),S.set(V+1,A,(-dt-Ct*S.get(V,A)-it*S.get(V,A-1))/Lt)):(ce=Tl(-yt-ye*S.get(V,A-1),-et-ye*S.get(V,A),st,it),S.set(V+1,A-1,ce[0]),S.set(V+1,A,ce[1]))),Re=Math.max(Math.abs(S.get(V,A-1)),Math.abs(S.get(V,A))),B*Re*Re>1)for(pt=V;pt<=A;pt++)S.set(pt,A-1,S.get(pt,A-1)/Re),S.set(pt,A,S.get(pt,A)/Re)}for(V=0;V<L;V++)if(V<D||V>F)for(pt=V;pt<L;pt++)b.set(V,pt,S.get(V,pt));for(pt=L-1;pt>=D;pt--)for(V=D;V<=F;V++){for(st=0,At=D;At<=Math.min(pt,F);At++)st=st+b.get(V,At)*S.get(At,pt);b.set(V,pt,st)}}}function Tl(L,k,w,b){let S,A;return Math.abs(w)>Math.abs(b)?(S=b/w,A=w+S*b,[(L+S*k)/A,(k-S*L)/A]):(S=w/b,A=b+S*w,[(S*L+k)/A,(S*k-L)/A])}class Pb{constructor(k){if(k=_e.checkMatrix(k),!k.isSymmetric())throw new Error("Matrix is not symmetric");let w=k,b=w.rows,S=new W(b,b),A=!0,D,F,B;for(F=0;F<b;F++){let z=0;for(B=0;B<F;B++){let X=0;for(D=0;D<B;D++)X+=S.get(B,D)*S.get(F,D);X=(w.get(F,B)-X)/S.get(B,B),S.set(F,B,X),z=z+X*X}for(z=w.get(F,F)-z,A&&(A=z>0),S.set(F,F,Math.sqrt(Math.max(z,0))),B=F+1;B<b;B++)S.set(F,B,0)}this.L=S,this.positiveDefinite=A}isPositiveDefinite(){return this.positiveDefinite}solve(k){k=_e.checkMatrix(k);let w=this.L,b=w.rows;if(k.rows!==b)throw new Error("Matrix dimensions do not match");if(this.isPositiveDefinite()===!1)throw new Error("Matrix is not positive definite");let S=k.columns,A=k.clone(),D,F,B;for(B=0;B<b;B++)for(F=0;F<S;F++){for(D=0;D<B;D++)A.set(B,F,A.get(B,F)-A.get(D,F)*w.get(B,D));A.set(B,F,A.get(B,F)/w.get(B,B))}for(B=b-1;B>=0;B--)for(F=0;F<S;F++){for(D=B+1;D<b;D++)A.set(B,F,A.get(B,F)-A.get(D,F)*w.get(D,B));A.set(B,F,A.get(B,F)/w.get(B,B))}return A}get lowerTriangularMatrix(){return this.L}}class Cb{constructor(k,w={}){k=_e.checkMatrix(k);let{Y:b}=w;const{scaleScores:S=!1,maxIterations:A=1e3,terminationCriteria:D=1e-10}=w;let F;if(b){if(r.isAnyArray(b)&&typeof b[0]=="number"?b=W.columnVector(b):b=_e.checkMatrix(b),b.rows!==k.rows)throw new Error("Y should have the same number of rows as X");F=b.getColumnVector(0)}else F=k.getColumnVector(0);let B=1,z,X,$,it;for(let yt=0;yt<A&&B>D;yt++)$=k.transpose().mmul(F).div(F.transpose().mmul(F).get(0,0)),$=$.div($.norm()),z=k.mmul($).div($.transpose().mmul($).get(0,0)),yt>0&&(B=z.clone().sub(it).pow(2).sum()),it=z.clone(),b?(X=b.transpose().mmul(z).div(z.transpose().mmul(z).get(0,0)),X=X.div(X.norm()),F=b.mmul(X).div(X.transpose().mmul(X).get(0,0))):F=z;if(b){let yt=k.transpose().mmul(z).div(z.transpose().mmul(z).get(0,0));yt=yt.div(yt.norm());let et=k.clone().sub(z.clone().mmul(yt.transpose())),st=F.transpose().mmul(z).div(z.transpose().mmul(z).get(0,0)),kt=b.clone().sub(z.clone().mulS(st.get(0,0)).mmul(X.transpose()));this.t=z,this.p=yt.transpose(),this.w=$.transpose(),this.q=X,this.u=F,this.s=z.transpose().mmul(z),this.xResidual=et,this.yResidual=kt,this.betas=st}else this.w=$.transpose(),this.s=z.transpose().mmul(z).sqrt(),S?this.t=z.clone().div(this.s.get(0,0)):this.t=z,this.xResidual=k.sub(z.mmul($.transpose()))}}return ee.AbstractMatrix=ut,ee.CHO=Pb,ee.CholeskyDecomposition=Pb,ee.DistanceMatrix=ht,ee.EVD=ri,ee.EigenvalueDecomposition=ri,ee.LU=_r,ee.LuDecomposition=_r,ee.Matrix=W,ee.MatrixColumnSelectionView=Kt,ee.MatrixColumnView=Pt,ee.MatrixFlipColumnView=pe,ee.MatrixFlipRowView=pn,ee.MatrixRowSelectionView=Qe,ee.MatrixRowView=Ce,ee.MatrixSelectionView=Qt,ee.MatrixSubView=Er,ee.MatrixTransposeView=re,ee.NIPALS=Cb,ee.Nipals=Cb,ee.QR=Be,ee.QrDecomposition=Be,ee.SVD=Xn,ee.SingularValueDecomposition=Xn,ee.SymmetricMatrix=Q,ee.WrapperMatrix1D=Sr,ee.WrapperMatrix2D=_e,ee.correlation=ni,ee.covariance=Ml,ee.default=W,ee.determinant=ki,ee.inverse=Kn,ee.linearDependencies=gs,ee.pseudoInverse=ld,ee.solve=kr,ee.wrap=ds,ee}var ch=G9();const rE=Au(ch),ia=ch.Matrix,tP=ch.SingularValueDecomposition;rE.Matrix?rE.Matrix:ch.Matrix;const $9={center:[0,0],linkDistance:50};class eP{constructor(t={}){this.options=t,this.id="mds",this.options=Object.assign(Object.assign({},$9),t)}execute(t,e){return Xt(this,void 0,void 0,function*(){return this.genericMDSLayout(!1,t,e)})}assign(t,e){return Xt(this,void 0,void 0,function*(){yield this.genericMDSLayout(!0,t,e)})}genericMDSLayout(t,e,n){return Xt(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),n),{center:a=[0,0],linkDistance:s=50}=i,o=e.getAllNodes(),l=e.getAllEdges();if(!(o!=null&&o.length)||o.length===1)return os(e,t,a);const c=XN({nodes:o,edges:l}),u=HN(c);W9(u);const h=L8(u,s),d=V9(h),f=[];return d.forEach((v,p)=>{const y=yr(o[p]);y.data.x=v[0]+a[0],y.data.y=v[1]+a[1],f.push(y)}),t&&f.forEach(v=>e.mergeNodeData(v.id,{x:v.data.x,y:v.data.y})),{nodes:f,edges:l}})}}const W9=r=>{let t=-999999;r.forEach(e=>{e.forEach(n=>{n!==1/0&&t<n&&(t=n)})}),r.forEach((e,n)=>{e.forEach((i,a)=>{i===1/0&&(r[n][a]=t)})})},V9=r=>{const e=ia.mul(ia.pow(r,2),-.5),n=e.mean("row"),i=e.mean("column"),a=e.mean();e.add(a).subRowVector(n).subColumnVector(i);const s=new tP(e),o=ia.sqrt(s.diagonalMatrix).diagonal();return s.leftSingularVectors.toJSON().map(l=>ia.mul([l],[o]).toJSON()[0].splice(0,2))};function Gm(r){return!!r.tick&&!!r.stop}const U9={gForce:!0,force2:!0,d3force:!0,fruchterman:!0,forceAtlas2:!0,force:!0,"graphin-force":!0},Y9={center:[0,0],comboPadding:10,treeKey:"combo"};class H9{constructor(t={}){this.options=t,this.id="comboCombined",this.options=Object.assign(Object.assign({},Y9),t)}execute(t,e){return Xt(this,void 0,void 0,function*(){return this.genericComboCombinedLayout(!1,t,e)})}assign(t,e){return Xt(this,void 0,void 0,function*(){yield this.genericComboCombinedLayout(!0,t,e)})}genericComboCombinedLayout(t,e,n){return Xt(this,void 0,void 0,function*(){const i=this.initVals(Object.assign(Object.assign({},this.options),n)),{center:a,treeKey:s,outerLayout:o}=i,l=e.getAllNodes().filter(T=>!T.data._isCombo),c=e.getAllNodes().filter(T=>T.data._isCombo),u=e.getAllEdges(),h=l==null?void 0:l.length;if(!h||h===1)return os(e,t,a);const d=[],f=new Map;l.forEach(T=>{f.set(T.id,T)});const g=new Map;c.forEach(T=>{g.set(T.id,T)});const v=new Map,p=this.getInnerGraphs(e,s,f,g,u,i,v);yield Promise.all(p);const y=new Map,m=[],x=new Map;let E=!0;e.getRoots(s).forEach(T=>{const N=v.get(T.id),P=g.get(T.id)||f.get(T.id),C={id:T.id,data:Object.assign(Object.assign({},T.data),{x:N.data.x||P.data.x,y:N.data.y||P.data.y,fx:N.data.fx||P.data.fx,fy:N.data.fy||P.data.fy,mass:N.data.mass||P.data.mass,size:N.data.size})};m.push(C),y.set(T.id,!0),!isNaN(C.data.x)&&C.data.x!==0&&!isNaN(C.data.y)&&C.data.y!==0?E=!1:(C.data.x=Math.random()*100,C.data.y=Math.random()*100),Bm(e,[T],R=>{R.id!==T.id&&x.set(R.id,T.id)},"TB",s)});const _=[];u.forEach(T=>{const N=x.get(T.source)||T.source,P=x.get(T.target)||T.target;N!==P&&y.has(N)&&y.has(P)&&_.push({id:T.id,source:N,target:P,data:{}})});let M;if(m!=null&&m.length){if(m.length===1)m[0].data.x=a[0],m[0].data.y=a[1];else{const T=new vn({nodes:m,edges:_}),N=o||new QN;E&&U9[N.id]&&(yield(m.length<100?new eP:new jm).assign(T));const P=Object.assign({center:a,kg:5,preventOverlap:!0,animate:!1},N.id==="force"?{gravity:1,factor:4,linkDistance:(C,R,I)=>{const j=Math.max(...R.data.size)||32,G=Math.max(...I.data.size)||32;return j/2+G/2+200}}:{});M=yield iE(N,T,P)}v.forEach(T=>{var N;const P=M.nodes.find(I=>I.id===T.id);if(P){const{x:I,y:j}=P.data;T.data.visited=!0,T.data.x=I,T.data.y=j,d.push({id:T.id,data:{x:I,y:j}})}const{x:C,y:R}=T.data;(N=T.data.nodes)===null||N===void 0||N.forEach(I=>{d.push({id:I.id,data:{x:I.data.x+C,y:I.data.y+R}})})}),v.forEach(({data:T})=>{const{x:N,y:P,visited:C,nodes:R}=T;R==null||R.forEach(I=>{if(!C){const j=d.find(G=>G.id===I.id);j.data.x+=N||0,j.data.y+=P||0}})})}return t&&d.forEach(T=>{e.mergeNodeData(T.id,{x:T.data.x,y:T.data.y})}),{nodes:d,edges:u}})}initVals(t){const e=Object.assign({},t),{nodeSize:n,spacing:i,comboPadding:a}=t;let s,o;if(St(i)?o=()=>i:Tt(i)?o=i:o=()=>0,e.spacing=o,!n)s=c=>{const u=o(c);return c.size?Ci(c.size)?((c.size[0]>c.size[1]?c.size[0]:c.size[1])+u)/2:Ze(c.size)?((c.size.width>c.size.height?c.size.width:c.size.height)+u)/2:(c.size+u)/2:32+u/2};else if(Tt(n))s=c=>{const u=n(c),h=o(c);return Ci(c.size)?((c.size[0]>c.size[1]?c.size[0]:c.size[1])+h)/2:((u||32)+h)/2};else if(Ci(n)){const u=(n[0]>n[1]?n[0]:n[1])/2;s=h=>u+o(h)/2}else{const c=n/2;s=u=>c+o(u)/2}e.nodeSize=s;let l;return St(a)?l=()=>a:Ci(a)?l=()=>Math.max.apply(null,a):Tt(a)?l=a:l=()=>0,e.comboPadding=l,e}getInnerGraphs(t,e,n,i,a,s,o){const{nodeSize:l,comboPadding:c,spacing:u,innerLayout:h}=s,d=h||new jm({}),f={center:[0,0],preventOverlap:!0,nodeSpacing:u},g=[],v=p=>{let y=(c==null?void 0:c(p))||10;return Ci(y)&&(y=Math.max(...y)),{size:y?[y*2,y*2]:[30,30],padding:y}};return t.getRoots(e).forEach(p=>{o.set(p.id,{id:p.id,data:{nodes:[],size:v(p).size}});let y=Promise.resolve();Bm(t,[p],m=>{var x;if(!m.data._isCombo)return;const{size:E,padding:_}=v(m);if(!(!((x=t.getChildren(m.id,e))===null||x===void 0)&&x.length))o.set(m.id,{id:m.id,data:Object.assign(Object.assign({},m.data),{size:E})});else{const M=o.get(m.id);o.set(m.id,{id:m.id,data:Object.assign({nodes:[]},M==null?void 0:M.data)});const O=new Map,T=t.getChildren(m.id,e).map(C=>{if(C.data._isCombo)return o.has(C.id)||o.set(C.id,{id:C.id,data:Object.assign({},C.data)}),O.set(C.id,!0),o.get(C.id);const R=n.get(C.id)||i.get(C.id);return O.set(C.id,!0),{id:C.id,data:Object.assign(Object.assign({},R.data),C.data)}}),N={nodes:T,edges:a.filter(C=>O.has(C.source)&&O.has(C.target))};let P=1/0;T.forEach(C=>{var R;let{size:I}=C.data;I||(I=((R=o.get(C.id))===null||R===void 0?void 0:R.data.size)||(l==null?void 0:l(C))||[30,30]),St(I)&&(I=[I,I]);const[j,G]=I;P>j&&(P=j),P>G&&(P=G),C.data.size=I}),y=y.then(()=>Xt(this,void 0,void 0,function*(){const C=new vn(N);yield iE(d,C,f,!0);const{minX:R,minY:I,maxX:j,maxY:G}=I8(T),H={x:(j+R)/2,y:(G+I)/2};N.nodes.forEach(U=>{U.data.x-=H.x,U.data.y-=H.y});const Z=[Math.max(j-R,P)+_*2,Math.max(G-I,P)+_*2];o.get(m.id).data.size=Z,o.get(m.id).data.nodes=T}))}return!0},"BT",e),g.push(y)}),g}}function iE(r,t,e,n){var i;return Xt(this,void 0,void 0,function*(){return Gm(r)?(r.execute(t,e),r.stop(),r.tick((i=e.iterations)!==null&&i!==void 0?i:300)):n?yield r.assign(t,e):yield r.execute(t,e)})}function X9(r,t){var e,n=1;r==null&&(r=0),t==null&&(t=0);function i(){var a,s=e.length,o,l=0,c=0;for(a=0;a<s;++a)o=e[a],l+=o.x,c+=o.y;for(l=(l/s-r)*n,c=(c/s-t)*n,a=0;a<s;++a)o=e[a],o.x-=l,o.y-=c}return i.initialize=function(a){e=a},i.x=function(a){return arguments.length?(r=+a,i):r},i.y=function(a){return arguments.length?(t=+a,i):t},i.strength=function(a){return arguments.length?(n=+a,i):n},i}function fn(r){return function(){return r}}function aa(r){return(r()-.5)*1e-6}function K9(r){return r.x+r.vx}function Z9(r){return r.y+r.vy}function J9(r){var t,e,n,i=1,a=1;typeof r!="function"&&(r=fn(r==null?1:+r));function s(){for(var c,u=t.length,h,d,f,g,v,p,y=0;y<a;++y)for(h=lh(t,K9,Z9).visitAfter(o),c=0;c<u;++c)d=t[c],v=e[d.index],p=v*v,f=d.x+d.vx,g=d.y+d.vy,h.visit(m);function m(x,E,_,M,O){var T=x.data,N=x.r,P=v+N;if(T){if(T.index>d.index){var C=f-T.x-T.vx,R=g-T.y-T.vy,I=C*C+R*R;I<P*P&&(C===0&&(C=aa(n),I+=C*C),R===0&&(R=aa(n),I+=R*R),I=(P-(I=Math.sqrt(I)))/I*i,d.vx+=(C*=I)*(P=(N*=N)/(p+N)),d.vy+=(R*=I)*P,T.vx-=C*(P=1-P),T.vy-=R*P)}return}return E>f+P||M<f-P||_>g+P||O<g-P}}function o(c){if(c.data)return c.r=e[c.data.index];for(var u=c.r=0;u<4;++u)c[u]&&c[u].r>c.r&&(c.r=c[u].r)}function l(){if(t){var c,u=t.length,h;for(e=new Array(u),c=0;c<u;++c)h=t[c],e[h.index]=+r(h,c,t)}}return s.initialize=function(c,u){t=c,n=u,l()},s.iterations=function(c){return arguments.length?(a=+c,s):a},s.strength=function(c){return arguments.length?(i=+c,s):i},s.radius=function(c){return arguments.length?(r=typeof c=="function"?c:fn(+c),l(),s):r},s}function Q9(r){return r.index}function aE(r,t){var e=r.get(t);if(!e)throw new Error("node not found: "+t);return e}function tq(r){var t=Q9,e=h,n,i=fn(30),a,s,o,l,c,u=1;r==null&&(r=[]);function h(p){return 1/Math.min(o[p.source.index],o[p.target.index])}function d(p){for(var y=0,m=r.length;y<u;++y)for(var x=0,E,_,M,O,T,N,P;x<m;++x)E=r[x],_=E.source,M=E.target,O=M.x+M.vx-_.x-_.vx||aa(c),T=M.y+M.vy-_.y-_.vy||aa(c),N=Math.sqrt(O*O+T*T),N=(N-a[x])/N*p*n[x],O*=N,T*=N,M.vx-=O*(P=l[x]),M.vy-=T*P,_.vx+=O*(P=1-P),_.vy+=T*P}function f(){if(s){var p,y=s.length,m=r.length,x=new Map(s.map((_,M)=>[t(_,M,s),_])),E;for(p=0,o=new Array(y);p<m;++p)E=r[p],E.index=p,typeof E.source!="object"&&(E.source=aE(x,E.source)),typeof E.target!="object"&&(E.target=aE(x,E.target)),o[E.source.index]=(o[E.source.index]||0)+1,o[E.target.index]=(o[E.target.index]||0)+1;for(p=0,l=new Array(m);p<m;++p)E=r[p],l[p]=o[E.source.index]/(o[E.source.index]+o[E.target.index]);n=new Array(m),g(),a=new Array(m),v()}}function g(){if(s)for(var p=0,y=r.length;p<y;++p)n[p]=+e(r[p],p,r)}function v(){if(s)for(var p=0,y=r.length;p<y;++p)a[p]=+i(r[p],p,r)}return d.initialize=function(p,y){s=p,c=y,f()},d.links=function(p){return arguments.length?(r=p,f(),d):r},d.id=function(p){return arguments.length?(t=p,d):t},d.iterations=function(p){return arguments.length?(u=+p,d):u},d.strength=function(p){return arguments.length?(e=typeof p=="function"?p:fn(+p),g(),d):e},d.distance=function(p){return arguments.length?(i=typeof p=="function"?p:fn(+p),v(),d):i},d}var eq={value:()=>{}};function nP(){for(var r=0,t=arguments.length,e={},n;r<t;++r){if(!(n=arguments[r]+"")||n in e||/[\s.]/.test(n))throw new Error("illegal type: "+n);e[n]=[]}return new Bc(e)}function Bc(r){this._=r}function nq(r,t){return r.trim().split(/^|\s+/).map(function(e){var n="",i=e.indexOf(".");if(i>=0&&(n=e.slice(i+1),e=e.slice(0,i)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}})}Bc.prototype=nP.prototype={constructor:Bc,on:function(r,t){var e=this._,n=nq(r+"",e),i,a=-1,s=n.length;if(arguments.length<2){for(;++a<s;)if((i=(r=n[a]).type)&&(i=rq(e[i],r.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++a<s;)if(i=(r=n[a]).type)e[i]=sE(e[i],r.name,t);else if(t==null)for(i in e)e[i]=sE(e[i],r.name,null);return this},copy:function(){var r={},t=this._;for(var e in t)r[e]=t[e].slice();return new Bc(r)},call:function(r,t){if((i=arguments.length-2)>0)for(var e=new Array(i),n=0,i,a;n<i;++n)e[n]=arguments[n+2];if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(a=this._[r],n=0,i=a.length;n<i;++n)a[n].value.apply(t,e)},apply:function(r,t,e){if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(var n=this._[r],i=0,a=n.length;i<a;++i)n[i].value.apply(t,e)}};function rq(r,t){for(var e=0,n=r.length,i;e<n;++e)if((i=r[e]).name===t)return i.value}function sE(r,t,e){for(var n=0,i=r.length;n<i;++n)if(r[n].name===t){r[n]=eq,r=r.slice(0,n).concat(r.slice(n+1));break}return e!=null&&r.push({name:t,value:e}),r}var Ws=0,So=0,po=0,rP=1e3,mu,_o,bu=0,ts=0,uh=0,tl=typeof performance=="object"&&performance.now?performance:Date,iP=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(r){setTimeout(r,17)};function aP(){return ts||(iP(iq),ts=tl.now()+uh)}function iq(){ts=0}function $m(){this._call=this._time=this._next=null}$m.prototype=sP.prototype={constructor:$m,restart:function(r,t,e){if(typeof r!="function")throw new TypeError("callback is not a function");e=(e==null?aP():+e)+(t==null?0:+t),!this._next&&_o!==this&&(_o?_o._next=this:mu=this,_o=this),this._call=r,this._time=e,Wm()},stop:function(){this._call&&(this._call=null,this._time=1/0,Wm())}};function sP(r,t,e){var n=new $m;return n.restart(r,t,e),n}function aq(){aP(),++Ws;for(var r=mu,t;r;)(t=ts-r._time)>=0&&r._call.call(void 0,t),r=r._next;--Ws}function oE(){ts=(bu=tl.now())+uh,Ws=So=0;try{aq()}finally{Ws=0,oq(),ts=0}}function sq(){var r=tl.now(),t=r-bu;t>rP&&(uh-=t,bu=r)}function oq(){for(var r,t=mu,e,n=1/0;t;)t._call?(n>t._time&&(n=t._time),r=t,t=t._next):(e=t._next,t._next=null,t=r?r._next=e:mu=e);_o=r,Wm(n)}function Wm(r){if(!Ws){So&&(So=clearTimeout(So));var t=r-ts;t>24?(r<1/0&&(So=setTimeout(oE,r-tl.now()-uh)),po&&(po=clearInterval(po))):(po||(bu=tl.now(),po=setInterval(sq,rP)),Ws=1,iP(oE))}}const lq=1664525,cq=1013904223,lE=4294967296;function uq(){let r=1;return()=>(r=(lq*r+cq)%lE)/lE}function hq(r){return r.x}function dq(r){return r.y}var fq=10,gq=Math.PI*(3-Math.sqrt(5));function vq(r){var t,e=1,n=.001,i=1-Math.pow(n,1/300),a=0,s=.6,o=new Map,l=sP(h),c=nP("tick","end"),u=uq();r==null&&(r=[]);function h(){d(),c.call("tick",t),e<n&&(l.stop(),c.call("end",t))}function d(v){var p,y=r.length,m;v===void 0&&(v=1);for(var x=0;x<v;++x)for(e+=(a-e)*i,o.forEach(function(E){E(e)}),p=0;p<y;++p)m=r[p],m.fx==null?m.x+=m.vx*=s:(m.x=m.fx,m.vx=0),m.fy==null?m.y+=m.vy*=s:(m.y=m.fy,m.vy=0);return t}function f(){for(var v=0,p=r.length,y;v<p;++v){if(y=r[v],y.index=v,y.fx!=null&&(y.x=y.fx),y.fy!=null&&(y.y=y.fy),isNaN(y.x)||isNaN(y.y)){var m=fq*Math.sqrt(.5+v),x=v*gq;y.x=m*Math.cos(x),y.y=m*Math.sin(x)}(isNaN(y.vx)||isNaN(y.vy))&&(y.vx=y.vy=0)}}function g(v){return v.initialize&&v.initialize(r,u),v}return f(),t={tick:d,restart:function(){return l.restart(h),t},stop:function(){return l.stop(),t},nodes:function(v){return arguments.length?(r=v,f(),o.forEach(g),t):r},alpha:function(v){return arguments.length?(e=+v,t):e},alphaMin:function(v){return arguments.length?(n=+v,t):n},alphaDecay:function(v){return arguments.length?(i=+v,t):+i},alphaTarget:function(v){return arguments.length?(a=+v,t):a},velocityDecay:function(v){return arguments.length?(s=1-v,t):1-s},randomSource:function(v){return arguments.length?(u=v,o.forEach(g),t):u},force:function(v,p){return arguments.length>1?(p==null?o.delete(v):o.set(v,g(p)),t):o.get(v)},find:function(v,p,y){var m=0,x=r.length,E,_,M,O,T;for(y==null?y=1/0:y*=y,m=0;m<x;++m)O=r[m],E=v-O.x,_=p-O.y,M=E*E+_*_,M<y&&(T=O,y=M);return T},on:function(v,p){return arguments.length>1?(c.on(v,p),t):c.on(v)}}}function pq(){var r,t,e,n,i=fn(-30),a,s=1,o=1/0,l=.81;function c(f){var g,v=r.length,p=lh(r,hq,dq).visitAfter(h);for(n=f,g=0;g<v;++g)t=r[g],p.visit(d)}function u(){if(r){var f,g=r.length,v;for(a=new Array(g),f=0;f<g;++f)v=r[f],a[v.index]=+i(v,f,r)}}function h(f){var g=0,v,p,y=0,m,x,E;if(f.length){for(m=x=E=0;E<4;++E)(v=f[E])&&(p=Math.abs(v.value))&&(g+=v.value,y+=p,m+=p*v.x,x+=p*v.y);f.x=m/y,f.y=x/y}else{v=f,v.x=v.data.x,v.y=v.data.y;do g+=a[v.data.index];while(v=v.next)}f.value=g}function d(f,g,v,p){if(!f.value)return!0;var y=f.x-t.x,m=f.y-t.y,x=p-g,E=y*y+m*m;if(x*x/l<E)return E<o&&(y===0&&(y=aa(e),E+=y*y),m===0&&(m=aa(e),E+=m*m),E<s&&(E=Math.sqrt(s*E)),t.vx+=y*f.value*n/E,t.vy+=m*f.value*n/E),!0;if(f.length||E>=o)return;(f.data!==t||f.next)&&(y===0&&(y=aa(e),E+=y*y),m===0&&(m=aa(e),E+=m*m),E<s&&(E=Math.sqrt(s*E)));do f.data!==t&&(x=a[f.data.index]*n/E,t.vx+=y*x,t.vy+=m*x);while(f=f.next)}return c.initialize=function(f,g){r=f,e=g,u()},c.strength=function(f){return arguments.length?(i=typeof f=="function"?f:fn(+f),u(),c):i},c.distanceMin=function(f){return arguments.length?(s=f*f,c):Math.sqrt(s)},c.distanceMax=function(f){return arguments.length?(o=f*f,c):Math.sqrt(o)},c.theta=function(f){return arguments.length?(l=f*f,c):Math.sqrt(l)},c}function yq(r,t,e){var n,i=fn(.1),a,s;typeof r!="function"&&(r=fn(+r)),t==null&&(t=0),e==null&&(e=0);function o(c){for(var u=0,h=n.length;u<h;++u){var d=n[u],f=d.x-t||1e-6,g=d.y-e||1e-6,v=Math.sqrt(f*f+g*g),p=(s[u]-v)*a[u]*c/v;d.vx+=f*p,d.vy+=g*p}}function l(){if(n){var c,u=n.length;for(a=new Array(u),s=new Array(u),c=0;c<u;++c)s[c]=+r(n[c],c,n),a[c]=isNaN(s[c])?0:+i(n[c],c,n)}}return o.initialize=function(c){n=c,l()},o.strength=function(c){return arguments.length?(i=typeof c=="function"?c:fn(+c),l(),o):i},o.radius=function(c){return arguments.length?(r=typeof c=="function"?c:fn(+c),l(),o):r},o.x=function(c){return arguments.length?(t=+c,o):t},o.y=function(c){return arguments.length?(e=+c,o):e},o}function mq(r){var t=fn(.1),e,n,i;typeof r!="function"&&(r=fn(r==null?0:+r));function a(o){for(var l=0,c=e.length,u;l<c;++l)u=e[l],u.vx+=(i[l]-u.x)*n[l]*o}function s(){if(e){var o,l=e.length;for(n=new Array(l),i=new Array(l),o=0;o<l;++o)n[o]=isNaN(i[o]=+r(e[o],o,e))?0:+t(e[o],o,e)}}return a.initialize=function(o){e=o,s()},a.strength=function(o){return arguments.length?(t=typeof o=="function"?o:fn(+o),s(),a):t},a.x=function(o){return arguments.length?(r=typeof o=="function"?o:fn(+o),s(),a):r},a}function bq(r){var t=fn(.1),e,n,i;typeof r!="function"&&(r=fn(r==null?0:+r));function a(o){for(var l=0,c=e.length,u;l<c;++l)u=e[l],u.vy+=(i[l]-u.y)*n[l]*o}function s(){if(e){var o,l=e.length;for(n=new Array(l),i=new Array(l),o=0;o<l;++o)n[o]=isNaN(i[o]=+r(e[o],o,e))?0:+t(e[o],o,e)}}return a.initialize=function(o){e=o,s()},a.strength=function(o){return arguments.length?(t=typeof o=="function"?o:fn(+o),s(),a):t},a.y=function(o){return arguments.length?(r=typeof o=="function"?o:fn(+o),s(),a):r},a}class xq{constructor(t){this.id="d3-force",this.config={inputNodeAttrs:["x","y","vx","vy","fx","fy"],outputNodeAttrs:["x","y","vx","vy"],simulationAttrs:["alpha","alphaMin","alphaDecay","alphaTarget","velocityDecay","randomSource"]},this.forceMap={link:tq,manyBody:pq,center:X9,collide:J9,radial:yq,x:mq,y:bq},this.options={link:{id:e=>e.id},manyBody:{},center:{x:0,y:0}},this.context={options:{},assign:!1,nodes:[],edges:[]},An(this.options,t),this.options.forceSimulation&&(this.simulation=this.options.forceSimulation)}execute(t,e){return Xt(this,void 0,void 0,function*(){return this.genericLayout(!1,t,e)})}assign(t,e){return Xt(this,void 0,void 0,function*(){yield this.genericLayout(!0,t,e)})}stop(){this.simulation.stop()}tick(t){return this.simulation.tick(t),this.getResult()}restart(){this.simulation.restart()}setFixedPosition(t,e){const n=this.context.nodes.find(i=>i.id===t);n&&e.forEach((i,a)=>{if(typeof i=="number"||i===null){const s=["fx","fy","fz"][a];n[s]=i}})}getOptions(t){var e,n;const i=An({},this.options,t);return i.collide&&((e=i.collide)===null||e===void 0?void 0:e.radius)===void 0&&(i.collide=i.collide||{},i.collide.radius=(n=i.nodeSize)!==null&&n!==void 0?n:10),i.iterations===void 0&&(i.link&&i.link.iterations===void 0&&(i.iterations=i.link.iterations),i.collide&&i.collide.iterations===void 0&&(i.iterations=i.collide.iterations)),this.context.options=i,i}genericLayout(t,e,n){var i;return Xt(this,void 0,void 0,function*(){const a=this.getOptions(n),s=e.getAllNodes().map(({id:u,data:h})=>Object.assign(Object.assign({id:u},h),Ya(h.data,this.config.inputNodeAttrs))),o=e.getAllEdges().map(u=>Object.assign({},u));Object.assign(this.context,{assign:t,nodes:s,edges:o,graph:e});const l=new Promise(u=>{this.resolver=u}),c=this.setSimulation(a);return c.nodes(s),(i=c.force("link"))===null||i===void 0||i.links(o),l})}getResult(){const{assign:t,nodes:e,edges:n,graph:i}=this.context,a=e.map(o=>({id:o.id,data:Object.assign(Object.assign({},o.data),Ya(o,this.config.outputNodeAttrs))})),s=n.map(({id:o,source:l,target:c,data:u})=>({id:o,source:typeof l=="object"?l.id:l,target:typeof c=="object"?c.id:c,data:u}));return t&&a.forEach(o=>i.mergeNodeData(o.id,o.data)),{nodes:a,edges:s}}initSimulation(){return vq()}setSimulation(t){const e=this.simulation||this.options.forceSimulation||this.initSimulation();return this.simulation||(this.simulation=e.on("tick",()=>{var n;return(n=t.onTick)===null||n===void 0?void 0:n.call(t,this.getResult())}).on("end",()=>{var n;return(n=this.resolver)===null||n===void 0?void 0:n.call(this,this.getResult())})),cE(e,this.config.simulationAttrs.map(n=>[n,t[n]])),Object.entries(this.forceMap).forEach(([n,i])=>{const a=n;if(t[n]){let s=e.force(a);s||(s=i(),e.force(a,s)),cE(s,Object.entries(t[a]))}else e.force(a,null)}),e}}const cE=(r,t)=>t.reduce((e,[n,i])=>!e[n]||i===void 0?e:e[n].call(r,i),r);function X1(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ff,uE;function wq(){if(uE)return ff;uE=1;function r(){this.__data__=[],this.size=0}return ff=r,ff}var gf,hE;function Zs(){if(hE)return gf;hE=1;function r(t,e){return t===e||t!==t&&e!==e}return gf=r,gf}var vf,dE;function hh(){if(dE)return vf;dE=1;var r=Zs();function t(e,n){for(var i=e.length;i--;)if(r(e[i][0],n))return i;return-1}return vf=t,vf}var pf,fE;function Eq(){if(fE)return pf;fE=1;var r=hh(),t=Array.prototype,e=t.splice;function n(i){var a=this.__data__,s=r(a,i);if(s<0)return!1;var o=a.length-1;return s==o?a.pop():e.call(a,s,1),--this.size,!0}return pf=n,pf}var yf,gE;function Sq(){if(gE)return yf;gE=1;var r=hh();function t(e){var n=this.__data__,i=r(n,e);return i<0?void 0:n[i][1]}return yf=t,yf}var mf,vE;function _q(){if(vE)return mf;vE=1;var r=hh();function t(e){return r(this.__data__,e)>-1}return mf=t,mf}var bf,pE;function kq(){if(pE)return bf;pE=1;var r=hh();function t(e,n){var i=this.__data__,a=r(i,e);return a<0?(++this.size,i.push([e,n])):i[a][1]=n,this}return bf=t,bf}var xf,yE;function dh(){if(yE)return xf;yE=1;var r=wq(),t=Eq(),e=Sq(),n=_q(),i=kq();function a(s){var o=-1,l=s==null?0:s.length;for(this.clear();++o<l;){var c=s[o];this.set(c[0],c[1])}}return a.prototype.clear=r,a.prototype.delete=t,a.prototype.get=e,a.prototype.has=n,a.prototype.set=i,xf=a,xf}var wf,mE;function Mq(){if(mE)return wf;mE=1;var r=dh();function t(){this.__data__=new r,this.size=0}return wf=t,wf}var Ef,bE;function Tq(){if(bE)return Ef;bE=1;function r(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}return Ef=r,Ef}var Sf,xE;function Oq(){if(xE)return Sf;xE=1;function r(t){return this.__data__.get(t)}return Sf=r,Sf}var _f,wE;function Aq(){if(wE)return _f;wE=1;function r(t){return this.__data__.has(t)}return _f=r,_f}var kf,EE;function oP(){if(EE)return kf;EE=1;var r=typeof Rl=="object"&&Rl&&Rl.Object===Object&&Rl;return kf=r,kf}var Mf,SE;function Jr(){if(SE)return Mf;SE=1;var r=oP(),t=typeof self=="object"&&self&&self.Object===Object&&self,e=r||t||Function("return this")();return Mf=e,Mf}var Tf,_E;function Js(){if(_E)return Tf;_E=1;var r=Jr(),t=r.Symbol;return Tf=t,Tf}var Of,kE;function Nq(){if(kE)return Of;kE=1;var r=Js(),t=Object.prototype,e=t.hasOwnProperty,n=t.toString,i=r?r.toStringTag:void 0;function a(s){var o=e.call(s,i),l=s[i];try{s[i]=void 0;var c=!0}catch{}var u=n.call(s);return c&&(o?s[i]=l:delete s[i]),u}return Of=a,Of}var Af,ME;function Pq(){if(ME)return Af;ME=1;var r=Object.prototype,t=r.toString;function e(n){return t.call(n)}return Af=e,Af}var Nf,TE;function ls(){if(TE)return Nf;TE=1;var r=Js(),t=Nq(),e=Pq(),n="[object Null]",i="[object Undefined]",a=r?r.toStringTag:void 0;function s(o){return o==null?o===void 0?i:n:a&&a in Object(o)?t(o):e(o)}return Nf=s,Nf}var Pf,OE;function Ir(){if(OE)return Pf;OE=1;function r(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}return Pf=r,Pf}var Cf,AE;function xl(){if(AE)return Cf;AE=1;var r=ls(),t=Ir(),e="[object AsyncFunction]",n="[object Function]",i="[object GeneratorFunction]",a="[object Proxy]";function s(o){if(!t(o))return!1;var l=r(o);return l==n||l==i||l==e||l==a}return Cf=s,Cf}var Rf,NE;function Cq(){if(NE)return Rf;NE=1;var r=Jr(),t=r["__core-js_shared__"];return Rf=t,Rf}var Lf,PE;function Rq(){if(PE)return Lf;PE=1;var r=Cq(),t=(function(){var n=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""})();function e(n){return!!t&&t in n}return Lf=e,Lf}var If,CE;function lP(){if(CE)return If;CE=1;var r=Function.prototype,t=r.toString;function e(n){if(n!=null){try{return t.call(n)}catch{}try{return n+""}catch{}}return""}return If=e,If}var Df,RE;function Lq(){if(RE)return Df;RE=1;var r=xl(),t=Rq(),e=Ir(),n=lP(),i=/[\\^$.*+?()[\]{}|]/g,a=/^\[object .+?Constructor\]$/,s=Function.prototype,o=Object.prototype,l=s.toString,c=o.hasOwnProperty,u=RegExp("^"+l.call(c).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function h(d){if(!e(d)||t(d))return!1;var f=r(d)?u:a;return f.test(n(d))}return Df=h,Df}var Ff,LE;function Iq(){if(LE)return Ff;LE=1;function r(t,e){return t==null?void 0:t[e]}return Ff=r,Ff}var Bf,IE;function cs(){if(IE)return Bf;IE=1;var r=Lq(),t=Iq();function e(n,i){var a=t(n,i);return r(a)?a:void 0}return Bf=e,Bf}var zf,DE;function K1(){if(DE)return zf;DE=1;var r=cs(),t=Jr(),e=r(t,"Map");return zf=e,zf}var jf,FE;function fh(){if(FE)return jf;FE=1;var r=cs(),t=r(Object,"create");return jf=t,jf}var qf,BE;function Dq(){if(BE)return qf;BE=1;var r=fh();function t(){this.__data__=r?r(null):{},this.size=0}return qf=t,qf}var Gf,zE;function Fq(){if(zE)return Gf;zE=1;function r(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}return Gf=r,Gf}var $f,jE;function Bq(){if(jE)return $f;jE=1;var r=fh(),t="__lodash_hash_undefined__",e=Object.prototype,n=e.hasOwnProperty;function i(a){var s=this.__data__;if(r){var o=s[a];return o===t?void 0:o}return n.call(s,a)?s[a]:void 0}return $f=i,$f}var Wf,qE;function zq(){if(qE)return Wf;qE=1;var r=fh(),t=Object.prototype,e=t.hasOwnProperty;function n(i){var a=this.__data__;return r?a[i]!==void 0:e.call(a,i)}return Wf=n,Wf}var Vf,GE;function jq(){if(GE)return Vf;GE=1;var r=fh(),t="__lodash_hash_undefined__";function e(n,i){var a=this.__data__;return this.size+=this.has(n)?0:1,a[n]=r&&i===void 0?t:i,this}return Vf=e,Vf}var Uf,$E;function qq(){if($E)return Uf;$E=1;var r=Dq(),t=Fq(),e=Bq(),n=zq(),i=jq();function a(s){var o=-1,l=s==null?0:s.length;for(this.clear();++o<l;){var c=s[o];this.set(c[0],c[1])}}return a.prototype.clear=r,a.prototype.delete=t,a.prototype.get=e,a.prototype.has=n,a.prototype.set=i,Uf=a,Uf}var Yf,WE;function Gq(){if(WE)return Yf;WE=1;var r=qq(),t=dh(),e=K1();function n(){this.size=0,this.__data__={hash:new r,map:new(e||t),string:new r}}return Yf=n,Yf}var Hf,VE;function $q(){if(VE)return Hf;VE=1;function r(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}return Hf=r,Hf}var Xf,UE;function gh(){if(UE)return Xf;UE=1;var r=$q();function t(e,n){var i=e.__data__;return r(n)?i[typeof n=="string"?"string":"hash"]:i.map}return Xf=t,Xf}var Kf,YE;function Wq(){if(YE)return Kf;YE=1;var r=gh();function t(e){var n=r(this,e).delete(e);return this.size-=n?1:0,n}return Kf=t,Kf}var Zf,HE;function Vq(){if(HE)return Zf;HE=1;var r=gh();function t(e){return r(this,e).get(e)}return Zf=t,Zf}var Jf,XE;function Uq(){if(XE)return Jf;XE=1;var r=gh();function t(e){return r(this,e).has(e)}return Jf=t,Jf}var Qf,KE;function Yq(){if(KE)return Qf;KE=1;var r=gh();function t(e,n){var i=r(this,e),a=i.size;return i.set(e,n),this.size+=i.size==a?0:1,this}return Qf=t,Qf}var tg,ZE;function Z1(){if(ZE)return tg;ZE=1;var r=Gq(),t=Wq(),e=Vq(),n=Uq(),i=Yq();function a(s){var o=-1,l=s==null?0:s.length;for(this.clear();++o<l;){var c=s[o];this.set(c[0],c[1])}}return a.prototype.clear=r,a.prototype.delete=t,a.prototype.get=e,a.prototype.has=n,a.prototype.set=i,tg=a,tg}var eg,JE;function Hq(){if(JE)return eg;JE=1;var r=dh(),t=K1(),e=Z1(),n=200;function i(a,s){var o=this.__data__;if(o instanceof r){var l=o.__data__;if(!t||l.length<n-1)return l.push([a,s]),this.size=++o.size,this;o=this.__data__=new e(l)}return o.set(a,s),this.size=o.size,this}return eg=i,eg}var ng,QE;function vh(){if(QE)return ng;QE=1;var r=dh(),t=Mq(),e=Tq(),n=Oq(),i=Aq(),a=Hq();function s(o){var l=this.__data__=new r(o);this.size=l.size}return s.prototype.clear=t,s.prototype.delete=e,s.prototype.get=n,s.prototype.has=i,s.prototype.set=a,ng=s,ng}var rg,t2;function J1(){if(t2)return rg;t2=1;function r(t,e){for(var n=-1,i=t==null?0:t.length;++n<i&&e(t[n],n,t)!==!1;);return t}return rg=r,rg}var ig,e2;function cP(){if(e2)return ig;e2=1;var r=cs(),t=(function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch{}})();return ig=t,ig}var ag,n2;function ph(){if(n2)return ag;n2=1;var r=cP();function t(e,n,i){n=="__proto__"&&r?r(e,n,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[n]=i}return ag=t,ag}var sg,r2;function yh(){if(r2)return sg;r2=1;var r=ph(),t=Zs(),e=Object.prototype,n=e.hasOwnProperty;function i(a,s,o){var l=a[s];(!(n.call(a,s)&&t(l,o))||o===void 0&&!(s in a))&&r(a,s,o)}return sg=i,sg}var og,i2;function wl(){if(i2)return og;i2=1;var r=yh(),t=ph();function e(n,i,a,s){var o=!a;a||(a={});for(var l=-1,c=i.length;++l<c;){var u=i[l],h=s?s(a[u],n[u],u,a,n):void 0;h===void 0&&(h=n[u]),o?t(a,u,h):r(a,u,h)}return a}return og=e,og}var lg,a2;function Xq(){if(a2)return lg;a2=1;function r(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}return lg=r,lg}var cg,s2;function _i(){if(s2)return cg;s2=1;function r(t){return t!=null&&typeof t=="object"}return cg=r,cg}var ug,o2;function Kq(){if(o2)return ug;o2=1;var r=ls(),t=_i(),e="[object Arguments]";function n(i){return t(i)&&r(i)==e}return ug=n,ug}var hg,l2;function El(){if(l2)return hg;l2=1;var r=Kq(),t=_i(),e=Object.prototype,n=e.hasOwnProperty,i=e.propertyIsEnumerable,a=r((function(){return arguments})())?r:function(s){return t(s)&&n.call(s,"callee")&&!i.call(s,"callee")};return hg=a,hg}var dg,c2;function ln(){if(c2)return dg;c2=1;var r=Array.isArray;return dg=r,dg}var ko={exports:{}},fg,u2;function Zq(){if(u2)return fg;u2=1;function r(){return!1}return fg=r,fg}ko.exports;var h2;function Qs(){return h2||(h2=1,(function(r,t){var e=Jr(),n=Zq(),i=t&&!t.nodeType&&t,a=i&&!0&&r&&!r.nodeType&&r,s=a&&a.exports===i,o=s?e.Buffer:void 0,l=o?o.isBuffer:void 0,c=l||n;r.exports=c})(ko,ko.exports)),ko.exports}var gg,d2;function mh(){if(d2)return gg;d2=1;var r=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function e(n,i){var a=typeof n;return i=i??r,!!i&&(a=="number"||a!="symbol"&&t.test(n))&&n>-1&&n%1==0&&n<i}return gg=e,gg}var vg,f2;function Q1(){if(f2)return vg;f2=1;var r=9007199254740991;function t(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=r}return vg=t,vg}var pg,g2;function Jq(){if(g2)return pg;g2=1;var r=ls(),t=Q1(),e=_i(),n="[object Arguments]",i="[object Array]",a="[object Boolean]",s="[object Date]",o="[object Error]",l="[object Function]",c="[object Map]",u="[object Number]",h="[object Object]",d="[object RegExp]",f="[object Set]",g="[object String]",v="[object WeakMap]",p="[object ArrayBuffer]",y="[object DataView]",m="[object Float32Array]",x="[object Float64Array]",E="[object Int8Array]",_="[object Int16Array]",M="[object Int32Array]",O="[object Uint8Array]",T="[object Uint8ClampedArray]",N="[object Uint16Array]",P="[object Uint32Array]",C={};C[m]=C[x]=C[E]=C[_]=C[M]=C[O]=C[T]=C[N]=C[P]=!0,C[n]=C[i]=C[p]=C[a]=C[y]=C[s]=C[o]=C[l]=C[c]=C[u]=C[h]=C[d]=C[f]=C[g]=C[v]=!1;function R(I){return e(I)&&t(I.length)&&!!C[r(I)]}return pg=R,pg}var yg,v2;function bh(){if(v2)return yg;v2=1;function r(t){return function(e){return t(e)}}return yg=r,yg}var Mo={exports:{}};Mo.exports;var p2;function tb(){return p2||(p2=1,(function(r,t){var e=oP(),n=t&&!t.nodeType&&t,i=n&&!0&&r&&!r.nodeType&&r,a=i&&i.exports===n,s=a&&e.process,o=(function(){try{var l=i&&i.require&&i.require("util").types;return l||s&&s.binding&&s.binding("util")}catch{}})();r.exports=o})(Mo,Mo.exports)),Mo.exports}var mg,y2;function Sl(){if(y2)return mg;y2=1;var r=Jq(),t=bh(),e=tb(),n=e&&e.isTypedArray,i=n?t(n):r;return mg=i,mg}var bg,m2;function uP(){if(m2)return bg;m2=1;var r=Xq(),t=El(),e=ln(),n=Qs(),i=mh(),a=Sl(),s=Object.prototype,o=s.hasOwnProperty;function l(c,u){var h=e(c),d=!h&&t(c),f=!h&&!d&&n(c),g=!h&&!d&&!f&&a(c),v=h||d||f||g,p=v?r(c.length,String):[],y=p.length;for(var m in c)(u||o.call(c,m))&&!(v&&(m=="length"||f&&(m=="offset"||m=="parent")||g&&(m=="buffer"||m=="byteLength"||m=="byteOffset")||i(m,y)))&&p.push(m);return p}return bg=l,bg}var xg,b2;function xh(){if(b2)return xg;b2=1;var r=Object.prototype;function t(e){var n=e&&e.constructor,i=typeof n=="function"&&n.prototype||r;return e===i}return xg=t,xg}var wg,x2;function hP(){if(x2)return wg;x2=1;function r(t,e){return function(n){return t(e(n))}}return wg=r,wg}var Eg,w2;function Qq(){if(w2)return Eg;w2=1;var r=hP(),t=r(Object.keys,Object);return Eg=t,Eg}var Sg,E2;function eb(){if(E2)return Sg;E2=1;var r=xh(),t=Qq(),e=Object.prototype,n=e.hasOwnProperty;function i(a){if(!r(a))return t(a);var s=[];for(var o in Object(a))n.call(a,o)&&o!="constructor"&&s.push(o);return s}return Sg=i,Sg}var _g,S2;function $i(){if(S2)return _g;S2=1;var r=xl(),t=Q1();function e(n){return n!=null&&t(n.length)&&!r(n)}return _g=e,_g}var kg,_2;function wa(){if(_2)return kg;_2=1;var r=uP(),t=eb(),e=$i();function n(i){return e(i)?r(i):t(i)}return kg=n,kg}var Mg,k2;function tG(){if(k2)return Mg;k2=1;var r=wl(),t=wa();function e(n,i){return n&&r(i,t(i),n)}return Mg=e,Mg}var Tg,M2;function eG(){if(M2)return Tg;M2=1;function r(t){var e=[];if(t!=null)for(var n in Object(t))e.push(n);return e}return Tg=r,Tg}var Og,T2;function nG(){if(T2)return Og;T2=1;var r=Ir(),t=xh(),e=eG(),n=Object.prototype,i=n.hasOwnProperty;function a(s){if(!r(s))return e(s);var o=t(s),l=[];for(var c in s)c=="constructor"&&(o||!i.call(s,c))||l.push(c);return l}return Og=a,Og}var Ag,O2;function us(){if(O2)return Ag;O2=1;var r=uP(),t=nG(),e=$i();function n(i){return e(i)?r(i,!0):t(i)}return Ag=n,Ag}var Ng,A2;function rG(){if(A2)return Ng;A2=1;var r=wl(),t=us();function e(n,i){return n&&r(i,t(i),n)}return Ng=e,Ng}var To={exports:{}};To.exports;var N2;function dP(){return N2||(N2=1,(function(r,t){var e=Jr(),n=t&&!t.nodeType&&t,i=n&&!0&&r&&!r.nodeType&&r,a=i&&i.exports===n,s=a?e.Buffer:void 0,o=s?s.allocUnsafe:void 0;function l(c,u){if(u)return c.slice();var h=c.length,d=o?o(h):new c.constructor(h);return c.copy(d),d}r.exports=l})(To,To.exports)),To.exports}var Pg,P2;function fP(){if(P2)return Pg;P2=1;function r(t,e){var n=-1,i=t.length;for(e||(e=Array(i));++n<i;)e[n]=t[n];return e}return Pg=r,Pg}var Cg,C2;function gP(){if(C2)return Cg;C2=1;function r(t,e){for(var n=-1,i=t==null?0:t.length,a=0,s=[];++n<i;){var o=t[n];e(o,n,t)&&(s[a++]=o)}return s}return Cg=r,Cg}var Rg,R2;function vP(){if(R2)return Rg;R2=1;function r(){return[]}return Rg=r,Rg}var Lg,L2;function nb(){if(L2)return Lg;L2=1;var r=gP(),t=vP(),e=Object.prototype,n=e.propertyIsEnumerable,i=Object.getOwnPropertySymbols,a=i?function(s){return s==null?[]:(s=Object(s),r(i(s),function(o){return n.call(s,o)}))}:t;return Lg=a,Lg}var Ig,I2;function iG(){if(I2)return Ig;I2=1;var r=wl(),t=nb();function e(n,i){return r(n,t(n),i)}return Ig=e,Ig}var Dg,D2;function rb(){if(D2)return Dg;D2=1;function r(t,e){for(var n=-1,i=e.length,a=t.length;++n<i;)t[a+n]=e[n];return t}return Dg=r,Dg}var Fg,F2;function wh(){if(F2)return Fg;F2=1;var r=hP(),t=r(Object.getPrototypeOf,Object);return Fg=t,Fg}var Bg,B2;function pP(){if(B2)return Bg;B2=1;var r=rb(),t=wh(),e=nb(),n=vP(),i=Object.getOwnPropertySymbols,a=i?function(s){for(var o=[];s;)r(o,e(s)),s=t(s);return o}:n;return Bg=a,Bg}var zg,z2;function aG(){if(z2)return zg;z2=1;var r=wl(),t=pP();function e(n,i){return r(n,t(n),i)}return zg=e,zg}var jg,j2;function yP(){if(j2)return jg;j2=1;var r=rb(),t=ln();function e(n,i,a){var s=i(n);return t(n)?s:r(s,a(n))}return jg=e,jg}var qg,q2;function mP(){if(q2)return qg;q2=1;var r=yP(),t=nb(),e=wa();function n(i){return r(i,e,t)}return qg=n,qg}var Gg,G2;function sG(){if(G2)return Gg;G2=1;var r=yP(),t=pP(),e=us();function n(i){return r(i,e,t)}return Gg=n,Gg}var $g,$2;function oG(){if($2)return $g;$2=1;var r=cs(),t=Jr(),e=r(t,"DataView");return $g=e,$g}var Wg,W2;function lG(){if(W2)return Wg;W2=1;var r=cs(),t=Jr(),e=r(t,"Promise");return Wg=e,Wg}var Vg,V2;function bP(){if(V2)return Vg;V2=1;var r=cs(),t=Jr(),e=r(t,"Set");return Vg=e,Vg}var Ug,U2;function cG(){if(U2)return Ug;U2=1;var r=cs(),t=Jr(),e=r(t,"WeakMap");return Ug=e,Ug}var Yg,Y2;function to(){if(Y2)return Yg;Y2=1;var r=oG(),t=K1(),e=lG(),n=bP(),i=cG(),a=ls(),s=lP(),o="[object Map]",l="[object Object]",c="[object Promise]",u="[object Set]",h="[object WeakMap]",d="[object DataView]",f=s(r),g=s(t),v=s(e),p=s(n),y=s(i),m=a;return(r&&m(new r(new ArrayBuffer(1)))!=d||t&&m(new t)!=o||e&&m(e.resolve())!=c||n&&m(new n)!=u||i&&m(new i)!=h)&&(m=function(x){var E=a(x),_=E==l?x.constructor:void 0,M=_?s(_):"";if(M)switch(M){case f:return d;case g:return o;case v:return c;case p:return u;case y:return h}return E}),Yg=m,Yg}var Hg,H2;function uG(){if(H2)return Hg;H2=1;var r=Object.prototype,t=r.hasOwnProperty;function e(n){var i=n.length,a=new n.constructor(i);return i&&typeof n[0]=="string"&&t.call(n,"index")&&(a.index=n.index,a.input=n.input),a}return Hg=e,Hg}var Xg,X2;function xP(){if(X2)return Xg;X2=1;var r=Jr(),t=r.Uint8Array;return Xg=t,Xg}var Kg,K2;function ib(){if(K2)return Kg;K2=1;var r=xP();function t(e){var n=new e.constructor(e.byteLength);return new r(n).set(new r(e)),n}return Kg=t,Kg}var Zg,Z2;function hG(){if(Z2)return Zg;Z2=1;var r=ib();function t(e,n){var i=n?r(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.byteLength)}return Zg=t,Zg}var Jg,J2;function dG(){if(J2)return Jg;J2=1;var r=/\w*$/;function t(e){var n=new e.constructor(e.source,r.exec(e));return n.lastIndex=e.lastIndex,n}return Jg=t,Jg}var Qg,Q2;function fG(){if(Q2)return Qg;Q2=1;var r=Js(),t=r?r.prototype:void 0,e=t?t.valueOf:void 0;function n(i){return e?Object(e.call(i)):{}}return Qg=n,Qg}var tv,tS;function wP(){if(tS)return tv;tS=1;var r=ib();function t(e,n){var i=n?r(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.length)}return tv=t,tv}var ev,eS;function gG(){if(eS)return ev;eS=1;var r=ib(),t=hG(),e=dG(),n=fG(),i=wP(),a="[object Boolean]",s="[object Date]",o="[object Map]",l="[object Number]",c="[object RegExp]",u="[object Set]",h="[object String]",d="[object Symbol]",f="[object ArrayBuffer]",g="[object DataView]",v="[object Float32Array]",p="[object Float64Array]",y="[object Int8Array]",m="[object Int16Array]",x="[object Int32Array]",E="[object Uint8Array]",_="[object Uint8ClampedArray]",M="[object Uint16Array]",O="[object Uint32Array]";function T(N,P,C){var R=N.constructor;switch(P){case f:return r(N);case a:case s:return new R(+N);case g:return t(N,C);case v:case p:case y:case m:case x:case E:case _:case M:case O:return i(N,C);case o:return new R;case l:case h:return new R(N);case c:return e(N);case u:return new R;case d:return n(N)}}return ev=T,ev}var nv,nS;function EP(){if(nS)return nv;nS=1;var r=Ir(),t=Object.create,e=(function(){function n(){}return function(i){if(!r(i))return{};if(t)return t(i);n.prototype=i;var a=new n;return n.prototype=void 0,a}})();return nv=e,nv}var rv,rS;function SP(){if(rS)return rv;rS=1;var r=EP(),t=wh(),e=xh();function n(i){return typeof i.constructor=="function"&&!e(i)?r(t(i)):{}}return rv=n,rv}var iv,iS;function vG(){if(iS)return iv;iS=1;var r=to(),t=_i(),e="[object Map]";function n(i){return t(i)&&r(i)==e}return iv=n,iv}var av,aS;function pG(){if(aS)return av;aS=1;var r=vG(),t=bh(),e=tb(),n=e&&e.isMap,i=n?t(n):r;return av=i,av}var sv,sS;function yG(){if(sS)return sv;sS=1;var r=to(),t=_i(),e="[object Set]";function n(i){return t(i)&&r(i)==e}return sv=n,sv}var ov,oS;function mG(){if(oS)return ov;oS=1;var r=yG(),t=bh(),e=tb(),n=e&&e.isSet,i=n?t(n):r;return ov=i,ov}var lv,lS;function _P(){if(lS)return lv;lS=1;var r=vh(),t=J1(),e=yh(),n=tG(),i=rG(),a=dP(),s=fP(),o=iG(),l=aG(),c=mP(),u=sG(),h=to(),d=uG(),f=gG(),g=SP(),v=ln(),p=Qs(),y=pG(),m=Ir(),x=mG(),E=wa(),_=us(),M=1,O=2,T=4,N="[object Arguments]",P="[object Array]",C="[object Boolean]",R="[object Date]",I="[object Error]",j="[object Function]",G="[object GeneratorFunction]",H="[object Map]",Z="[object Number]",U="[object Object]",tt="[object RegExp]",gt="[object Set]",xt="[object String]",ut="[object Symbol]",zt="[object WeakMap]",J="[object ArrayBuffer]",W="[object DataView]",Q="[object Float32Array]",ht="[object Float64Array]",Et="[object Int8Array]",Pt="[object Int16Array]",Kt="[object Int32Array]",pe="[object Uint8Array]",pn="[object Uint8ClampedArray]",Ce="[object Uint16Array]",Qe="[object Uint32Array]",Qt={};Qt[N]=Qt[P]=Qt[J]=Qt[W]=Qt[C]=Qt[R]=Qt[Q]=Qt[ht]=Qt[Et]=Qt[Pt]=Qt[Kt]=Qt[H]=Qt[Z]=Qt[U]=Qt[tt]=Qt[gt]=Qt[xt]=Qt[ut]=Qt[pe]=Qt[pn]=Qt[Ce]=Qt[Qe]=!0,Qt[I]=Qt[j]=Qt[zt]=!1;function Er(re,Sr,_e,ds,_r,Ye){var Be,Xn=Sr&M,Kn=Sr&O,kr=Sr&T;if(_e&&(Be=_r?_e(re,ds,_r,Ye):_e(re)),Be!==void 0)return Be;if(!m(re))return re;var ki=v(re);if(ki){if(Be=d(re),!Xn)return s(re,Be)}else{var ei=h(re),fs=ei==j||ei==G;if(p(re))return a(re,Xn);if(ei==U||ei==N||fs&&!_r){if(Be=Kn||fs?{}:g(re),!Xn)return Kn?l(re,i(Be,re)):o(re,n(Be,re))}else{if(!Qt[ei])return _r?re:{};Be=f(re,ei,Xn)}}Ye||(Ye=new r);var gs=Ye.get(re);if(gs)return gs;Ye.set(re,Be),x(re)?re.forEach(function(ni){Be.add(Er(ni,Sr,_e,ni,re,Ye))}):y(re)&&re.forEach(function(ni,ri){Be.set(ri,Er(ni,Sr,_e,ri,re,Ye))});var ld=kr?Kn?u:c:Kn?_:E,Ml=ki?void 0:ld(re);return t(Ml||re,function(ni,ri){Ml&&(ri=ni,ni=re[ri]),e(Be,ri,Er(ni,Sr,_e,ri,re,Ye))}),Be}return lv=Er,lv}var cv,cS;function bG(){if(cS)return cv;cS=1;var r=_P(),t=4;function e(n){return r(n,t)}return cv=e,cv}var uv,uS;function ab(){if(uS)return uv;uS=1;function r(t){return function(){return t}}return uv=r,uv}var hv,hS;function xG(){if(hS)return hv;hS=1;function r(t){return function(e,n,i){for(var a=-1,s=Object(e),o=i(e),l=o.length;l--;){var c=o[t?l:++a];if(n(s[c],c,s)===!1)break}return e}}return hv=r,hv}var dv,dS;function sb(){if(dS)return dv;dS=1;var r=xG(),t=r();return dv=t,dv}var fv,fS;function ob(){if(fS)return fv;fS=1;var r=sb(),t=wa();function e(n,i){return n&&r(n,i,t)}return fv=e,fv}var gv,gS;function wG(){if(gS)return gv;gS=1;var r=$i();function t(e,n){return function(i,a){if(i==null)return i;if(!r(i))return e(i,a);for(var s=i.length,o=n?s:-1,l=Object(i);(n?o--:++o<s)&&a(l[o],o,l)!==!1;);return i}}return gv=t,gv}var vv,vS;function Eh(){if(vS)return vv;vS=1;var r=ob(),t=wG(),e=t(r);return vv=e,vv}var pv,pS;function hs(){if(pS)return pv;pS=1;function r(t){return t}return pv=r,pv}var yv,yS;function kP(){if(yS)return yv;yS=1;var r=hs();function t(e){return typeof e=="function"?e:r}return yv=t,yv}var mv,mS;function MP(){if(mS)return mv;mS=1;var r=J1(),t=Eh(),e=kP(),n=ln();function i(a,s){var o=n(a)?r:t;return o(a,e(s))}return mv=i,mv}var bv,bS;function TP(){return bS||(bS=1,bv=MP()),bv}var xv,xS;function EG(){if(xS)return xv;xS=1;var r=Eh();function t(e,n){var i=[];return r(e,function(a,s,o){n(a,s,o)&&i.push(a)}),i}return xv=t,xv}var wv,wS;function SG(){if(wS)return wv;wS=1;var r="__lodash_hash_undefined__";function t(e){return this.__data__.set(e,r),this}return wv=t,wv}var Ev,ES;function _G(){if(ES)return Ev;ES=1;function r(t){return this.__data__.has(t)}return Ev=r,Ev}var Sv,SS;function OP(){if(SS)return Sv;SS=1;var r=Z1(),t=SG(),e=_G();function n(i){var a=-1,s=i==null?0:i.length;for(this.__data__=new r;++a<s;)this.add(i[a])}return n.prototype.add=n.prototype.push=t,n.prototype.has=e,Sv=n,Sv}var _v,_S;function kG(){if(_S)return _v;_S=1;function r(t,e){for(var n=-1,i=t==null?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1}return _v=r,_v}var kv,kS;function AP(){if(kS)return kv;kS=1;function r(t,e){return t.has(e)}return kv=r,kv}var Mv,MS;function NP(){if(MS)return Mv;MS=1;var r=OP(),t=kG(),e=AP(),n=1,i=2;function a(s,o,l,c,u,h){var d=l&n,f=s.length,g=o.length;if(f!=g&&!(d&&g>f))return!1;var v=h.get(s),p=h.get(o);if(v&&p)return v==o&&p==s;var y=-1,m=!0,x=l&i?new r:void 0;for(h.set(s,o),h.set(o,s);++y<f;){var E=s[y],_=o[y];if(c)var M=d?c(_,E,y,o,s,h):c(E,_,y,s,o,h);if(M!==void 0){if(M)continue;m=!1;break}if(x){if(!t(o,function(O,T){if(!e(x,T)&&(E===O||u(E,O,l,c,h)))return x.push(T)})){m=!1;break}}else if(!(E===_||u(E,_,l,c,h))){m=!1;break}}return h.delete(s),h.delete(o),m}return Mv=a,Mv}var Tv,TS;function MG(){if(TS)return Tv;TS=1;function r(t){var e=-1,n=Array(t.size);return t.forEach(function(i,a){n[++e]=[a,i]}),n}return Tv=r,Tv}var Ov,OS;function lb(){if(OS)return Ov;OS=1;function r(t){var e=-1,n=Array(t.size);return t.forEach(function(i){n[++e]=i}),n}return Ov=r,Ov}var Av,AS;function TG(){if(AS)return Av;AS=1;var r=Js(),t=xP(),e=Zs(),n=NP(),i=MG(),a=lb(),s=1,o=2,l="[object Boolean]",c="[object Date]",u="[object Error]",h="[object Map]",d="[object Number]",f="[object RegExp]",g="[object Set]",v="[object String]",p="[object Symbol]",y="[object ArrayBuffer]",m="[object DataView]",x=r?r.prototype:void 0,E=x?x.valueOf:void 0;function _(M,O,T,N,P,C,R){switch(T){case m:if(M.byteLength!=O.byteLength||M.byteOffset!=O.byteOffset)return!1;M=M.buffer,O=O.buffer;case y:return!(M.byteLength!=O.byteLength||!C(new t(M),new t(O)));case l:case c:case d:return e(+M,+O);case u:return M.name==O.name&&M.message==O.message;case f:case v:return M==O+"";case h:var I=i;case g:var j=N&s;if(I||(I=a),M.size!=O.size&&!j)return!1;var G=R.get(M);if(G)return G==O;N|=o,R.set(M,O);var H=n(I(M),I(O),N,P,C,R);return R.delete(M),H;case p:if(E)return E.call(M)==E.call(O)}return!1}return Av=_,Av}var Nv,NS;function OG(){if(NS)return Nv;NS=1;var r=mP(),t=1,e=Object.prototype,n=e.hasOwnProperty;function i(a,s,o,l,c,u){var h=o&t,d=r(a),f=d.length,g=r(s),v=g.length;if(f!=v&&!h)return!1;for(var p=f;p--;){var y=d[p];if(!(h?y in s:n.call(s,y)))return!1}var m=u.get(a),x=u.get(s);if(m&&x)return m==s&&x==a;var E=!0;u.set(a,s),u.set(s,a);for(var _=h;++p<f;){y=d[p];var M=a[y],O=s[y];if(l)var T=h?l(O,M,y,s,a,u):l(M,O,y,a,s,u);if(!(T===void 0?M===O||c(M,O,o,l,u):T)){E=!1;break}_||(_=y=="constructor")}if(E&&!_){var N=a.constructor,P=s.constructor;N!=P&&"constructor"in a&&"constructor"in s&&!(typeof N=="function"&&N instanceof N&&typeof P=="function"&&P instanceof P)&&(E=!1)}return u.delete(a),u.delete(s),E}return Nv=i,Nv}var Pv,PS;function AG(){if(PS)return Pv;PS=1;var r=vh(),t=NP(),e=TG(),n=OG(),i=to(),a=ln(),s=Qs(),o=Sl(),l=1,c="[object Arguments]",u="[object Array]",h="[object Object]",d=Object.prototype,f=d.hasOwnProperty;function g(v,p,y,m,x,E){var _=a(v),M=a(p),O=_?u:i(v),T=M?u:i(p);O=O==c?h:O,T=T==c?h:T;var N=O==h,P=T==h,C=O==T;if(C&&s(v)){if(!s(p))return!1;_=!0,N=!1}if(C&&!N)return E||(E=new r),_||o(v)?t(v,p,y,m,x,E):e(v,p,O,y,m,x,E);if(!(y&l)){var R=N&&f.call(v,"__wrapped__"),I=P&&f.call(p,"__wrapped__");if(R||I){var j=R?v.value():v,G=I?p.value():p;return E||(E=new r),x(j,G,y,m,E)}}return C?(E||(E=new r),n(v,p,y,m,x,E)):!1}return Pv=g,Pv}var Cv,CS;function PP(){if(CS)return Cv;CS=1;var r=AG(),t=_i();function e(n,i,a,s,o){return n===i?!0:n==null||i==null||!t(n)&&!t(i)?n!==n&&i!==i:r(n,i,a,s,e,o)}return Cv=e,Cv}var Rv,RS;function NG(){if(RS)return Rv;RS=1;var r=vh(),t=PP(),e=1,n=2;function i(a,s,o,l){var c=o.length,u=c,h=!l;if(a==null)return!u;for(a=Object(a);c--;){var d=o[c];if(h&&d[2]?d[1]!==a[d[0]]:!(d[0]in a))return!1}for(;++c<u;){d=o[c];var f=d[0],g=a[f],v=d[1];if(h&&d[2]){if(g===void 0&&!(f in a))return!1}else{var p=new r;if(l)var y=l(g,v,f,a,s,p);if(!(y===void 0?t(v,g,e|n,l,p):y))return!1}}return!0}return Rv=i,Rv}var Lv,LS;function CP(){if(LS)return Lv;LS=1;var r=Ir();function t(e){return e===e&&!r(e)}return Lv=t,Lv}var Iv,IS;function PG(){if(IS)return Iv;IS=1;var r=CP(),t=wa();function e(n){for(var i=t(n),a=i.length;a--;){var s=i[a],o=n[s];i[a]=[s,o,r(o)]}return i}return Iv=e,Iv}var Dv,DS;function RP(){if(DS)return Dv;DS=1;function r(t,e){return function(n){return n==null?!1:n[t]===e&&(e!==void 0||t in Object(n))}}return Dv=r,Dv}var Fv,FS;function CG(){if(FS)return Fv;FS=1;var r=NG(),t=PG(),e=RP();function n(i){var a=t(i);return a.length==1&&a[0][2]?e(a[0][0],a[0][1]):function(s){return s===i||r(s,i,a)}}return Fv=n,Fv}var Bv,BS;function eo(){if(BS)return Bv;BS=1;var r=ls(),t=_i(),e="[object Symbol]";function n(i){return typeof i=="symbol"||t(i)&&r(i)==e}return Bv=n,Bv}var zv,zS;function cb(){if(zS)return zv;zS=1;var r=ln(),t=eo(),e=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(a,s){if(r(a))return!1;var o=typeof a;return o=="number"||o=="symbol"||o=="boolean"||a==null||t(a)?!0:n.test(a)||!e.test(a)||s!=null&&a in Object(s)}return zv=i,zv}var jv,jS;function RG(){if(jS)return jv;jS=1;var r=Z1(),t="Expected a function";function e(n,i){if(typeof n!="function"||i!=null&&typeof i!="function")throw new TypeError(t);var a=function(){var s=arguments,o=i?i.apply(this,s):s[0],l=a.cache;if(l.has(o))return l.get(o);var c=n.apply(this,s);return a.cache=l.set(o,c)||l,c};return a.cache=new(e.Cache||r),a}return e.Cache=r,jv=e,jv}var qv,qS;function LG(){if(qS)return qv;qS=1;var r=RG(),t=500;function e(n){var i=r(n,function(s){return a.size===t&&a.clear(),s}),a=i.cache;return i}return qv=e,qv}var Gv,GS;function IG(){if(GS)return Gv;GS=1;var r=LG(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,e=/\\(\\)?/g,n=r(function(i){var a=[];return i.charCodeAt(0)===46&&a.push(""),i.replace(t,function(s,o,l,c){a.push(l?c.replace(e,"$1"):o||s)}),a});return Gv=n,Gv}var $v,$S;function Sh(){if($S)return $v;$S=1;function r(t,e){for(var n=-1,i=t==null?0:t.length,a=Array(i);++n<i;)a[n]=e(t[n],n,t);return a}return $v=r,$v}var Wv,WS;function DG(){if(WS)return Wv;WS=1;var r=Js(),t=Sh(),e=ln(),n=eo(),i=r?r.prototype:void 0,a=i?i.toString:void 0;function s(o){if(typeof o=="string")return o;if(e(o))return t(o,s)+"";if(n(o))return a?a.call(o):"";var l=o+"";return l=="0"&&1/o==-1/0?"-0":l}return Wv=s,Wv}var Vv,VS;function LP(){if(VS)return Vv;VS=1;var r=DG();function t(e){return e==null?"":r(e)}return Vv=t,Vv}var Uv,US;function _h(){if(US)return Uv;US=1;var r=ln(),t=cb(),e=IG(),n=LP();function i(a,s){return r(a)?a:t(a,s)?[a]:e(n(a))}return Uv=i,Uv}var Yv,YS;function _l(){if(YS)return Yv;YS=1;var r=eo();function t(e){if(typeof e=="string"||r(e))return e;var n=e+"";return n=="0"&&1/e==-1/0?"-0":n}return Yv=t,Yv}var Hv,HS;function kh(){if(HS)return Hv;HS=1;var r=_h(),t=_l();function e(n,i){i=r(i,n);for(var a=0,s=i.length;n!=null&&a<s;)n=n[t(i[a++])];return a&&a==s?n:void 0}return Hv=e,Hv}var Xv,XS;function FG(){if(XS)return Xv;XS=1;var r=kh();function t(e,n,i){var a=e==null?void 0:r(e,n);return a===void 0?i:a}return Xv=t,Xv}var Kv,KS;function BG(){if(KS)return Kv;KS=1;function r(t,e){return t!=null&&e in Object(t)}return Kv=r,Kv}var Zv,ZS;function IP(){if(ZS)return Zv;ZS=1;var r=_h(),t=El(),e=ln(),n=mh(),i=Q1(),a=_l();function s(o,l,c){l=r(l,o);for(var u=-1,h=l.length,d=!1;++u<h;){var f=a(l[u]);if(!(d=o!=null&&c(o,f)))break;o=o[f]}return d||++u!=h?d:(h=o==null?0:o.length,!!h&&i(h)&&n(f,h)&&(e(o)||t(o)))}return Zv=s,Zv}var Jv,JS;function DP(){if(JS)return Jv;JS=1;var r=BG(),t=IP();function e(n,i){return n!=null&&t(n,i,r)}return Jv=e,Jv}var Qv,QS;function zG(){if(QS)return Qv;QS=1;var r=PP(),t=FG(),e=DP(),n=cb(),i=CP(),a=RP(),s=_l(),o=1,l=2;function c(u,h){return n(u)&&i(h)?a(s(u),h):function(d){var f=t(d,u);return f===void 0&&f===h?e(d,u):r(h,f,o|l)}}return Qv=c,Qv}var tp,t_;function FP(){if(t_)return tp;t_=1;function r(t){return function(e){return e==null?void 0:e[t]}}return tp=r,tp}var ep,e_;function jG(){if(e_)return ep;e_=1;var r=kh();function t(e){return function(n){return r(n,e)}}return ep=t,ep}var np,n_;function qG(){if(n_)return np;n_=1;var r=FP(),t=jG(),e=cb(),n=_l();function i(a){return e(a)?r(n(a)):t(a)}return np=i,np}var rp,r_;function Wi(){if(r_)return rp;r_=1;var r=CG(),t=zG(),e=hs(),n=ln(),i=qG();function a(s){return typeof s=="function"?s:s==null?e:typeof s=="object"?n(s)?t(s[0],s[1]):r(s):i(s)}return rp=a,rp}var ip,i_;function BP(){if(i_)return ip;i_=1;var r=gP(),t=EG(),e=Wi(),n=ln();function i(a,s){var o=n(a)?r:t;return o(a,e(s,3))}return ip=i,ip}var ap,a_;function GG(){if(a_)return ap;a_=1;var r=Object.prototype,t=r.hasOwnProperty;function e(n,i){return n!=null&&t.call(n,i)}return ap=e,ap}var sp,s_;function zP(){if(s_)return sp;s_=1;var r=GG(),t=IP();function e(n,i){return n!=null&&t(n,i,r)}return sp=e,sp}var op,o_;function $G(){if(o_)return op;o_=1;var r=eb(),t=to(),e=El(),n=ln(),i=$i(),a=Qs(),s=xh(),o=Sl(),l="[object Map]",c="[object Set]",u=Object.prototype,h=u.hasOwnProperty;function d(f){if(f==null)return!0;if(i(f)&&(n(f)||typeof f=="string"||typeof f.splice=="function"||a(f)||o(f)||e(f)))return!f.length;var g=t(f);if(g==l||g==c)return!f.size;if(s(f))return!r(f).length;for(var v in f)if(h.call(f,v))return!1;return!0}return op=d,op}var lp,l_;function jP(){if(l_)return lp;l_=1;function r(t){return t===void 0}return lp=r,lp}var cp,c_;function qP(){if(c_)return cp;c_=1;var r=Eh(),t=$i();function e(n,i){var a=-1,s=t(n)?Array(n.length):[];return r(n,function(o,l,c){s[++a]=i(o,l,c)}),s}return cp=e,cp}var up,u_;function GP(){if(u_)return up;u_=1;var r=Sh(),t=Wi(),e=qP(),n=ln();function i(a,s){var o=n(a)?r:e;return o(a,t(s,3))}return up=i,up}var hp,h_;function WG(){if(h_)return hp;h_=1;function r(t,e,n,i){var a=-1,s=t==null?0:t.length;for(i&&s&&(n=t[++a]);++a<s;)n=e(n,t[a],a,t);return n}return hp=r,hp}var dp,d_;function VG(){if(d_)return dp;d_=1;function r(t,e,n,i,a){return a(t,function(s,o,l){n=i?(i=!1,s):e(n,s,o,l)}),n}return dp=r,dp}var fp,f_;function $P(){if(f_)return fp;f_=1;var r=WG(),t=Eh(),e=Wi(),n=VG(),i=ln();function a(s,o,l){var c=i(s)?r:n,u=arguments.length<3;return c(s,e(o,4),l,u,t)}return fp=a,fp}var gp,g_;function UG(){if(g_)return gp;g_=1;var r=ls(),t=ln(),e=_i(),n="[object String]";function i(a){return typeof a=="string"||!t(a)&&e(a)&&r(a)==n}return gp=i,gp}var vp,v_;function YG(){if(v_)return vp;v_=1;var r=FP(),t=r("length");return vp=t,vp}var pp,p_;function HG(){if(p_)return pp;p_=1;var r="\\ud800-\\udfff",t="\\u0300-\\u036f",e="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",i=t+e+n,a="\\ufe0e\\ufe0f",s="\\u200d",o=RegExp("["+s+r+i+a+"]");function l(c){return o.test(c)}return pp=l,pp}var yp,y_;function XG(){if(y_)return yp;y_=1;var r="\\ud800-\\udfff",t="\\u0300-\\u036f",e="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",i=t+e+n,a="\\ufe0e\\ufe0f",s="["+r+"]",o="["+i+"]",l="\\ud83c[\\udffb-\\udfff]",c="(?:"+o+"|"+l+")",u="[^"+r+"]",h="(?:\\ud83c[\\udde6-\\uddff]){2}",d="[\\ud800-\\udbff][\\udc00-\\udfff]",f="\\u200d",g=c+"?",v="["+a+"]?",p="(?:"+f+"(?:"+[u,h,d].join("|")+")"+v+g+")*",y=v+g+p,m="(?:"+[u+o+"?",o,h,d,s].join("|")+")",x=RegExp(l+"(?="+l+")|"+m+y,"g");function E(_){for(var M=x.lastIndex=0;x.test(_);)++M;return M}return yp=E,yp}var mp,m_;function KG(){if(m_)return mp;m_=1;var r=YG(),t=HG(),e=XG();function n(i){return t(i)?e(i):r(i)}return mp=n,mp}var bp,b_;function ZG(){if(b_)return bp;b_=1;var r=eb(),t=to(),e=$i(),n=UG(),i=KG(),a="[object Map]",s="[object Set]";function o(l){if(l==null)return 0;if(e(l))return n(l)?i(l):l.length;var c=t(l);return c==a||c==s?l.size:r(l).length}return bp=o,bp}var xp,x_;function JG(){if(x_)return xp;x_=1;var r=J1(),t=EP(),e=ob(),n=Wi(),i=wh(),a=ln(),s=Qs(),o=xl(),l=Ir(),c=Sl();function u(h,d,f){var g=a(h),v=g||s(h)||c(h);if(d=n(d,4),f==null){var p=h&&h.constructor;v?f=g?new p:[]:l(h)?f=o(p)?t(i(h)):{}:f={}}return(v?r:e)(h,function(y,m,x){return d(f,y,m,x)}),f}return xp=u,xp}var wp,w_;function QG(){if(w_)return wp;w_=1;var r=Js(),t=El(),e=ln(),n=r?r.isConcatSpreadable:void 0;function i(a){return e(a)||t(a)||!!(n&&a&&a[n])}return wp=i,wp}var Ep,E_;function ub(){if(E_)return Ep;E_=1;var r=rb(),t=QG();function e(n,i,a,s,o){var l=-1,c=n.length;for(a||(a=t),o||(o=[]);++l<c;){var u=n[l];i>0&&a(u)?i>1?e(u,i-1,a,s,o):r(o,u):s||(o[o.length]=u)}return o}return Ep=e,Ep}var Sp,S_;function t$(){if(S_)return Sp;S_=1;function r(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}return Sp=r,Sp}var _p,__;function WP(){if(__)return _p;__=1;var r=t$(),t=Math.max;function e(n,i,a){return i=t(i===void 0?n.length-1:i,0),function(){for(var s=arguments,o=-1,l=t(s.length-i,0),c=Array(l);++o<l;)c[o]=s[i+o];o=-1;for(var u=Array(i+1);++o<i;)u[o]=s[o];return u[i]=a(c),r(n,this,u)}}return _p=e,_p}var kp,k_;function e$(){if(k_)return kp;k_=1;var r=ab(),t=cP(),e=hs(),n=t?function(i,a){return t(i,"toString",{configurable:!0,enumerable:!1,value:r(a),writable:!0})}:e;return kp=n,kp}var Mp,M_;function n$(){if(M_)return Mp;M_=1;var r=800,t=16,e=Date.now;function n(i){var a=0,s=0;return function(){var o=e(),l=t-(o-s);if(s=o,l>0){if(++a>=r)return arguments[0]}else a=0;return i.apply(void 0,arguments)}}return Mp=n,Mp}var Tp,T_;function VP(){if(T_)return Tp;T_=1;var r=e$(),t=n$(),e=t(r);return Tp=e,Tp}var Op,O_;function Mh(){if(O_)return Op;O_=1;var r=hs(),t=WP(),e=VP();function n(i,a){return e(t(i,a,r),i+"")}return Op=n,Op}var Ap,A_;function UP(){if(A_)return Ap;A_=1;function r(t,e,n,i){for(var a=t.length,s=n+(i?1:-1);i?s--:++s<a;)if(e(t[s],s,t))return s;return-1}return Ap=r,Ap}var Np,N_;function r$(){if(N_)return Np;N_=1;function r(t){return t!==t}return Np=r,Np}var Pp,P_;function i$(){if(P_)return Pp;P_=1;function r(t,e,n){for(var i=n-1,a=t.length;++i<a;)if(t[i]===e)return i;return-1}return Pp=r,Pp}var Cp,C_;function a$(){if(C_)return Cp;C_=1;var r=UP(),t=r$(),e=i$();function n(i,a,s){return a===a?e(i,a,s):r(i,t,s)}return Cp=n,Cp}var Rp,R_;function s$(){if(R_)return Rp;R_=1;var r=a$();function t(e,n){var i=e==null?0:e.length;return!!i&&r(e,n,0)>-1}return Rp=t,Rp}var Lp,L_;function o$(){if(L_)return Lp;L_=1;function r(t,e,n){for(var i=-1,a=t==null?0:t.length;++i<a;)if(n(e,t[i]))return!0;return!1}return Lp=r,Lp}var Ip,I_;function l$(){if(I_)return Ip;I_=1;function r(){}return Ip=r,Ip}var Dp,D_;function c$(){if(D_)return Dp;D_=1;var r=bP(),t=l$(),e=lb(),n=1/0,i=r&&1/e(new r([,-0]))[1]==n?function(a){return new r(a)}:t;return Dp=i,Dp}var Fp,F_;function u$(){if(F_)return Fp;F_=1;var r=OP(),t=s$(),e=o$(),n=AP(),i=c$(),a=lb(),s=200;function o(l,c,u){var h=-1,d=t,f=l.length,g=!0,v=[],p=v;if(u)g=!1,d=e;else if(f>=s){var y=c?null:i(l);if(y)return a(y);g=!1,d=n,p=new r}else p=c?[]:v;t:for(;++h<f;){var m=l[h],x=c?c(m):m;if(m=u||m!==0?m:0,g&&x===x){for(var E=p.length;E--;)if(p[E]===x)continue t;c&&p.push(x),v.push(m)}else d(p,x,u)||(p!==v&&p.push(x),v.push(m))}return v}return Fp=o,Fp}var Bp,B_;function YP(){if(B_)return Bp;B_=1;var r=$i(),t=_i();function e(n){return t(n)&&r(n)}return Bp=e,Bp}var zp,z_;function h$(){if(z_)return zp;z_=1;var r=ub(),t=Mh(),e=u$(),n=YP(),i=t(function(a){return e(r(a,1,n,!0))});return zp=i,zp}var jp,j_;function d$(){if(j_)return jp;j_=1;var r=Sh();function t(e,n){return r(n,function(i){return e[i]})}return jp=t,jp}var qp,q_;function HP(){if(q_)return qp;q_=1;var r=d$(),t=wa();function e(n){return n==null?[]:r(n,t(n))}return qp=e,qp}var Gp,G_;function Dr(){if(G_)return Gp;G_=1;var r;if(typeof X1=="function")try{r={clone:bG(),constant:ab(),each:TP(),filter:BP(),has:zP(),isArray:ln(),isEmpty:$G(),isFunction:xl(),isUndefined:jP(),keys:wa(),map:GP(),reduce:$P(),size:ZG(),transform:JG(),union:h$(),values:HP()}}catch{}return r||(r=window._),Gp=r,Gp}var $p,$_;function hb(){if($_)return $p;$_=1;var r=Dr();$p=i;var t="\0",e="\0",n="";function i(u){this._isDirected=r.has(u,"directed")?u.directed:!0,this._isMultigraph=r.has(u,"multigraph")?u.multigraph:!1,this._isCompound=r.has(u,"compound")?u.compound:!1,this._label=void 0,this._defaultNodeLabelFn=r.constant(void 0),this._defaultEdgeLabelFn=r.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[e]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}i.prototype._nodeCount=0,i.prototype._edgeCount=0,i.prototype.isDirected=function(){return this._isDirected},i.prototype.isMultigraph=function(){return this._isMultigraph},i.prototype.isCompound=function(){return this._isCompound},i.prototype.setGraph=function(u){return this._label=u,this},i.prototype.graph=function(){return this._label},i.prototype.setDefaultNodeLabel=function(u){return r.isFunction(u)||(u=r.constant(u)),this._defaultNodeLabelFn=u,this},i.prototype.nodeCount=function(){return this._nodeCount},i.prototype.nodes=function(){return r.keys(this._nodes)},i.prototype.sources=function(){var u=this;return r.filter(this.nodes(),function(h){return r.isEmpty(u._in[h])})},i.prototype.sinks=function(){var u=this;return r.filter(this.nodes(),function(h){return r.isEmpty(u._out[h])})},i.prototype.setNodes=function(u,h){var d=arguments,f=this;return r.each(u,function(g){d.length>1?f.setNode(g,h):f.setNode(g)}),this},i.prototype.setNode=function(u,h){return r.has(this._nodes,u)?(arguments.length>1&&(this._nodes[u]=h),this):(this._nodes[u]=arguments.length>1?h:this._defaultNodeLabelFn(u),this._isCompound&&(this._parent[u]=e,this._children[u]={},this._children[e][u]=!0),this._in[u]={},this._preds[u]={},this._out[u]={},this._sucs[u]={},++this._nodeCount,this)},i.prototype.node=function(u){return this._nodes[u]},i.prototype.hasNode=function(u){return r.has(this._nodes,u)},i.prototype.removeNode=function(u){var h=this;if(r.has(this._nodes,u)){var d=function(f){h.removeEdge(h._edgeObjs[f])};delete this._nodes[u],this._isCompound&&(this._removeFromParentsChildList(u),delete this._parent[u],r.each(this.children(u),function(f){h.setParent(f)}),delete this._children[u]),r.each(r.keys(this._in[u]),d),delete this._in[u],delete this._preds[u],r.each(r.keys(this._out[u]),d),delete this._out[u],delete this._sucs[u],--this._nodeCount}return this},i.prototype.setParent=function(u,h){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(r.isUndefined(h))h=e;else{h+="";for(var d=h;!r.isUndefined(d);d=this.parent(d))if(d===u)throw new Error("Setting "+h+" as parent of "+u+" would create a cycle");this.setNode(h)}return this.setNode(u),this._removeFromParentsChildList(u),this._parent[u]=h,this._children[h][u]=!0,this},i.prototype._removeFromParentsChildList=function(u){delete this._children[this._parent[u]][u]},i.prototype.parent=function(u){if(this._isCompound){var h=this._parent[u];if(h!==e)return h}},i.prototype.children=function(u){if(r.isUndefined(u)&&(u=e),this._isCompound){var h=this._children[u];if(h)return r.keys(h)}else{if(u===e)return this.nodes();if(this.hasNode(u))return[]}},i.prototype.predecessors=function(u){var h=this._preds[u];if(h)return r.keys(h)},i.prototype.successors=function(u){var h=this._sucs[u];if(h)return r.keys(h)},i.prototype.neighbors=function(u){var h=this.predecessors(u);if(h)return r.union(h,this.successors(u))},i.prototype.isLeaf=function(u){var h;return this.isDirected()?h=this.successors(u):h=this.neighbors(u),h.length===0},i.prototype.filterNodes=function(u){var h=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});h.setGraph(this.graph());var d=this;r.each(this._nodes,function(v,p){u(p)&&h.setNode(p,v)}),r.each(this._edgeObjs,function(v){h.hasNode(v.v)&&h.hasNode(v.w)&&h.setEdge(v,d.edge(v))});var f={};function g(v){var p=d.parent(v);return p===void 0||h.hasNode(p)?(f[v]=p,p):p in f?f[p]:g(p)}return this._isCompound&&r.each(h.nodes(),function(v){h.setParent(v,g(v))}),h},i.prototype.setDefaultEdgeLabel=function(u){return r.isFunction(u)||(u=r.constant(u)),this._defaultEdgeLabelFn=u,this},i.prototype.edgeCount=function(){return this._edgeCount},i.prototype.edges=function(){return r.values(this._edgeObjs)},i.prototype.setPath=function(u,h){var d=this,f=arguments;return r.reduce(u,function(g,v){return f.length>1?d.setEdge(g,v,h):d.setEdge(g,v),v}),this},i.prototype.setEdge=function(){var u,h,d,f,g=!1,v=arguments[0];typeof v=="object"&&v!==null&&"v"in v?(u=v.v,h=v.w,d=v.name,arguments.length===2&&(f=arguments[1],g=!0)):(u=v,h=arguments[1],d=arguments[3],arguments.length>2&&(f=arguments[2],g=!0)),u=""+u,h=""+h,r.isUndefined(d)||(d=""+d);var p=o(this._isDirected,u,h,d);if(r.has(this._edgeLabels,p))return g&&(this._edgeLabels[p]=f),this;if(!r.isUndefined(d)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(u),this.setNode(h),this._edgeLabels[p]=g?f:this._defaultEdgeLabelFn(u,h,d);var y=l(this._isDirected,u,h,d);return u=y.v,h=y.w,Object.freeze(y),this._edgeObjs[p]=y,a(this._preds[h],u),a(this._sucs[u],h),this._in[h][p]=y,this._out[u][p]=y,this._edgeCount++,this},i.prototype.edge=function(u,h,d){var f=arguments.length===1?c(this._isDirected,arguments[0]):o(this._isDirected,u,h,d);return this._edgeLabels[f]},i.prototype.hasEdge=function(u,h,d){var f=arguments.length===1?c(this._isDirected,arguments[0]):o(this._isDirected,u,h,d);return r.has(this._edgeLabels,f)},i.prototype.removeEdge=function(u,h,d){var f=arguments.length===1?c(this._isDirected,arguments[0]):o(this._isDirected,u,h,d),g=this._edgeObjs[f];return g&&(u=g.v,h=g.w,delete this._edgeLabels[f],delete this._edgeObjs[f],s(this._preds[h],u),s(this._sucs[u],h),delete this._in[h][f],delete this._out[u][f],this._edgeCount--),this},i.prototype.inEdges=function(u,h){var d=this._in[u];if(d){var f=r.values(d);return h?r.filter(f,function(g){return g.v===h}):f}},i.prototype.outEdges=function(u,h){var d=this._out[u];if(d){var f=r.values(d);return h?r.filter(f,function(g){return g.w===h}):f}},i.prototype.nodeEdges=function(u,h){var d=this.inEdges(u,h);if(d)return d.concat(this.outEdges(u,h))};function a(u,h){u[h]?u[h]++:u[h]=1}function s(u,h){--u[h]||delete u[h]}function o(u,h,d,f){var g=""+h,v=""+d;if(!u&&g>v){var p=g;g=v,v=p}return g+n+v+n+(r.isUndefined(f)?t:f)}function l(u,h,d,f){var g=""+h,v=""+d;if(!u&&g>v){var p=g;g=v,v=p}var y={v:g,w:v};return f&&(y.name=f),y}function c(u,h){return o(u,h.v,h.w,h.name)}return $p}var Wp,W_;function f$(){return W_||(W_=1,Wp="2.1.8"),Wp}var Vp,V_;function g$(){return V_||(V_=1,Vp={Graph:hb(),version:f$()}),Vp}var Up,U_;function v$(){if(U_)return Up;U_=1;var r=Dr(),t=hb();Up={write:e,read:a};function e(s){var o={options:{directed:s.isDirected(),multigraph:s.isMultigraph(),compound:s.isCompound()},nodes:n(s),edges:i(s)};return r.isUndefined(s.graph())||(o.value=r.clone(s.graph())),o}function n(s){return r.map(s.nodes(),function(o){var l=s.node(o),c=s.parent(o),u={v:o};return r.isUndefined(l)||(u.value=l),r.isUndefined(c)||(u.parent=c),u})}function i(s){return r.map(s.edges(),function(o){var l=s.edge(o),c={v:o.v,w:o.w};return r.isUndefined(o.name)||(c.name=o.name),r.isUndefined(l)||(c.value=l),c})}function a(s){var o=new t(s.options).setGraph(s.value);return r.each(s.nodes,function(l){o.setNode(l.v,l.value),l.parent&&o.setParent(l.v,l.parent)}),r.each(s.edges,function(l){o.setEdge({v:l.v,w:l.w,name:l.name},l.value)}),o}return Up}var Yp,Y_;function p$(){if(Y_)return Yp;Y_=1;var r=Dr();Yp=t;function t(e){var n={},i=[],a;function s(o){r.has(n,o)||(n[o]=!0,a.push(o),r.each(e.successors(o),s),r.each(e.predecessors(o),s))}return r.each(e.nodes(),function(o){a=[],s(o),a.length&&i.push(a)}),i}return Yp}var Hp,H_;function XP(){if(H_)return Hp;H_=1;var r=Dr();Hp=t;function t(){this._arr=[],this._keyIndices={}}return t.prototype.size=function(){return this._arr.length},t.prototype.keys=function(){return this._arr.map(function(e){return e.key})},t.prototype.has=function(e){return r.has(this._keyIndices,e)},t.prototype.priority=function(e){var n=this._keyIndices[e];if(n!==void 0)return this._arr[n].priority},t.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},t.prototype.add=function(e,n){var i=this._keyIndices;if(e=String(e),!r.has(i,e)){var a=this._arr,s=a.length;return i[e]=s,a.push({key:e,priority:n}),this._decrease(s),!0}return!1},t.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var e=this._arr.pop();return delete this._keyIndices[e.key],this._heapify(0),e.key},t.prototype.decrease=function(e,n){var i=this._keyIndices[e];if(n>this._arr[i].priority)throw new Error("New priority is greater than current priority. Key: "+e+" Old: "+this._arr[i].priority+" New: "+n);this._arr[i].priority=n,this._decrease(i)},t.prototype._heapify=function(e){var n=this._arr,i=2*e,a=i+1,s=e;i<n.length&&(s=n[i].priority<n[s].priority?i:s,a<n.length&&(s=n[a].priority<n[s].priority?a:s),s!==e&&(this._swap(e,s),this._heapify(s)))},t.prototype._decrease=function(e){for(var n=this._arr,i=n[e].priority,a;e!==0&&(a=e>>1,!(n[a].priority<i));)this._swap(e,a),e=a},t.prototype._swap=function(e,n){var i=this._arr,a=this._keyIndices,s=i[e],o=i[n];i[e]=o,i[n]=s,a[o.key]=e,a[s.key]=n},Hp}var Xp,X_;function KP(){if(X_)return Xp;X_=1;var r=Dr(),t=XP();Xp=n;var e=r.constant(1);function n(a,s,o,l){return i(a,String(s),o||e,l||function(c){return a.outEdges(c)})}function i(a,s,o,l){var c={},u=new t,h,d,f=function(g){var v=g.v!==h?g.v:g.w,p=c[v],y=o(g),m=d.distance+y;if(y<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+g+" Weight: "+y);m<p.distance&&(p.distance=m,p.predecessor=h,u.decrease(v,m))};for(a.nodes().forEach(function(g){var v=g===s?0:Number.POSITIVE_INFINITY;c[g]={distance:v},u.add(g,v)});u.size()>0&&(h=u.removeMin(),d=c[h],d.distance!==Number.POSITIVE_INFINITY);)l(h).forEach(f);return c}return Xp}var Kp,K_;function y$(){if(K_)return Kp;K_=1;var r=KP(),t=Dr();Kp=e;function e(n,i,a){return t.transform(n.nodes(),function(s,o){s[o]=r(n,o,i,a)},{})}return Kp}var Zp,Z_;function ZP(){if(Z_)return Zp;Z_=1;var r=Dr();Zp=t;function t(e){var n=0,i=[],a={},s=[];function o(l){var c=a[l]={onStack:!0,lowlink:n,index:n++};if(i.push(l),e.successors(l).forEach(function(d){r.has(a,d)?a[d].onStack&&(c.lowlink=Math.min(c.lowlink,a[d].index)):(o(d),c.lowlink=Math.min(c.lowlink,a[d].lowlink))}),c.lowlink===c.index){var u=[],h;do h=i.pop(),a[h].onStack=!1,u.push(h);while(l!==h);s.push(u)}}return e.nodes().forEach(function(l){r.has(a,l)||o(l)}),s}return Zp}var Jp,J_;function m$(){if(J_)return Jp;J_=1;var r=Dr(),t=ZP();Jp=e;function e(n){return r.filter(t(n),function(i){return i.length>1||i.length===1&&n.hasEdge(i[0],i[0])})}return Jp}var Qp,Q_;function b$(){if(Q_)return Qp;Q_=1;var r=Dr();Qp=e;var t=r.constant(1);function e(i,a,s){return n(i,a||t,s||function(o){return i.outEdges(o)})}function n(i,a,s){var o={},l=i.nodes();return l.forEach(function(c){o[c]={},o[c][c]={distance:0},l.forEach(function(u){c!==u&&(o[c][u]={distance:Number.POSITIVE_INFINITY})}),s(c).forEach(function(u){var h=u.v===c?u.w:u.v,d=a(u);o[c][h]={distance:d,predecessor:c}})}),l.forEach(function(c){var u=o[c];l.forEach(function(h){var d=o[h];l.forEach(function(f){var g=d[c],v=u[f],p=d[f],y=g.distance+v.distance;y<p.distance&&(p.distance=y,p.predecessor=v.predecessor)})})}),o}return Qp}var t0,tk;function JP(){if(tk)return t0;tk=1;var r=Dr();t0=t,t.CycleException=e;function t(n){var i={},a={},s=[];function o(l){if(r.has(a,l))throw new e;r.has(i,l)||(a[l]=!0,i[l]=!0,r.each(n.predecessors(l),o),delete a[l],s.push(l))}if(r.each(n.sinks(),o),r.size(i)!==n.nodeCount())throw new e;return s}function e(){}return e.prototype=new Error,t0}var e0,ek;function x$(){if(ek)return e0;ek=1;var r=JP();e0=t;function t(e){try{r(e)}catch(n){if(n instanceof r.CycleException)return!1;throw n}return!0}return e0}var n0,nk;function QP(){if(nk)return n0;nk=1;var r=Dr();n0=t;function t(n,i,a){r.isArray(i)||(i=[i]);var s=(n.isDirected()?n.successors:n.neighbors).bind(n),o=[],l={};return r.each(i,function(c){if(!n.hasNode(c))throw new Error("Graph does not have node: "+c);e(n,c,a==="post",l,s,o)}),o}function e(n,i,a,s,o,l){r.has(s,i)||(s[i]=!0,a||l.push(i),r.each(o(i),function(c){e(n,c,a,s,o,l)}),a&&l.push(i))}return n0}var r0,rk;function w$(){if(rk)return r0;rk=1;var r=QP();r0=t;function t(e,n){return r(e,n,"post")}return r0}var i0,ik;function E$(){if(ik)return i0;ik=1;var r=QP();i0=t;function t(e,n){return r(e,n,"pre")}return i0}var a0,ak;function S$(){if(ak)return a0;ak=1;var r=Dr(),t=hb(),e=XP();a0=n;function n(i,a){var s=new t,o={},l=new e,c;function u(d){var f=d.v===c?d.w:d.v,g=l.priority(f);if(g!==void 0){var v=a(d);v<g&&(o[f]=c,l.decrease(f,v))}}if(i.nodeCount()===0)return s;r.each(i.nodes(),function(d){l.add(d,Number.POSITIVE_INFINITY),s.setNode(d)}),l.decrease(i.nodes()[0],0);for(var h=!1;l.size()>0;){if(c=l.removeMin(),r.has(o,c))s.setEdge(c,o[c]);else{if(h)throw new Error("Input graph is not connected: "+i);h=!0}i.nodeEdges(c).forEach(u)}return s}return a0}var s0,sk;function _$(){return sk||(sk=1,s0={components:p$(),dijkstra:KP(),dijkstraAll:y$(),findCycles:m$(),floydWarshall:b$(),isAcyclic:x$(),postorder:w$(),preorder:E$(),prim:S$(),tarjan:ZP(),topsort:JP()}),s0}var o0,ok;function k$(){if(ok)return o0;ok=1;var r=g$();return o0={Graph:r.Graph,json:v$(),alg:_$(),version:r.version},o0}var l0,lk;function Kr(){if(lk)return l0;lk=1;var r;if(typeof X1=="function")try{r=k$()}catch{}return r||(r=window.graphlib),l0=r,l0}var c0,ck;function M$(){if(ck)return c0;ck=1;var r=_P(),t=1,e=4;function n(i){return r(i,t|e)}return c0=n,c0}var u0,uk;function Th(){if(uk)return u0;uk=1;var r=Zs(),t=$i(),e=mh(),n=Ir();function i(a,s,o){if(!n(o))return!1;var l=typeof s;return(l=="number"?t(o)&&e(s,o.length):l=="string"&&s in o)?r(o[s],a):!1}return u0=i,u0}var h0,hk;function T$(){if(hk)return h0;hk=1;var r=Mh(),t=Zs(),e=Th(),n=us(),i=Object.prototype,a=i.hasOwnProperty,s=r(function(o,l){o=Object(o);var c=-1,u=l.length,h=u>2?l[2]:void 0;for(h&&e(l[0],l[1],h)&&(u=1);++c<u;)for(var d=l[c],f=n(d),g=-1,v=f.length;++g<v;){var p=f[g],y=o[p];(y===void 0||t(y,i[p])&&!a.call(o,p))&&(o[p]=d[p])}return o});return h0=s,h0}var d0,dk;function O$(){if(dk)return d0;dk=1;var r=Wi(),t=$i(),e=wa();function n(i){return function(a,s,o){var l=Object(a);if(!t(a)){var c=r(s,3);a=e(a),s=function(h){return c(l[h],h,l)}}var u=i(a,s,o);return u>-1?l[c?a[u]:u]:void 0}}return d0=n,d0}var f0,fk;function A$(){if(fk)return f0;fk=1;var r=/\s/;function t(e){for(var n=e.length;n--&&r.test(e.charAt(n)););return n}return f0=t,f0}var g0,gk;function N$(){if(gk)return g0;gk=1;var r=A$(),t=/^\s+/;function e(n){return n&&n.slice(0,r(n)+1).replace(t,"")}return g0=e,g0}var v0,vk;function P$(){if(vk)return v0;vk=1;var r=N$(),t=Ir(),e=eo(),n=NaN,i=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,s=/^0o[0-7]+$/i,o=parseInt;function l(c){if(typeof c=="number")return c;if(e(c))return n;if(t(c)){var u=typeof c.valueOf=="function"?c.valueOf():c;c=t(u)?u+"":u}if(typeof c!="string")return c===0?c:+c;c=r(c);var h=a.test(c);return h||s.test(c)?o(c.slice(2),h?2:8):i.test(c)?n:+c}return v0=l,v0}var p0,pk;function tC(){if(pk)return p0;pk=1;var r=P$(),t=1/0,e=17976931348623157e292;function n(i){if(!i)return i===0?i:0;if(i=r(i),i===t||i===-t){var a=i<0?-1:1;return a*e}return i===i?i:0}return p0=n,p0}var y0,yk;function C$(){if(yk)return y0;yk=1;var r=tC();function t(e){var n=r(e),i=n%1;return n===n?i?n-i:n:0}return y0=t,y0}var m0,mk;function R$(){if(mk)return m0;mk=1;var r=UP(),t=Wi(),e=C$(),n=Math.max;function i(a,s,o){var l=a==null?0:a.length;if(!l)return-1;var c=o==null?0:e(o);return c<0&&(c=n(l+c,0)),r(a,t(s,3),c)}return m0=i,m0}var b0,bk;function L$(){if(bk)return b0;bk=1;var r=O$(),t=R$(),e=r(t);return b0=e,b0}var x0,xk;function eC(){if(xk)return x0;xk=1;var r=ub();function t(e){var n=e==null?0:e.length;return n?r(e,1):[]}return x0=t,x0}var w0,wk;function I$(){if(wk)return w0;wk=1;var r=sb(),t=kP(),e=us();function n(i,a){return i==null?i:r(i,t(a),e)}return w0=n,w0}var E0,Ek;function D$(){if(Ek)return E0;Ek=1;function r(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}return E0=r,E0}var S0,Sk;function F$(){if(Sk)return S0;Sk=1;var r=ph(),t=ob(),e=Wi();function n(i,a){var s={};return a=e(a,3),t(i,function(o,l,c){r(s,l,a(o,l,c))}),s}return S0=n,S0}var _0,_k;function db(){if(_k)return _0;_k=1;var r=eo();function t(e,n,i){for(var a=-1,s=e.length;++a<s;){var o=e[a],l=n(o);if(l!=null&&(c===void 0?l===l&&!r(l):i(l,c)))var c=l,u=o}return u}return _0=t,_0}var k0,kk;function B$(){if(kk)return k0;kk=1;function r(t,e){return t>e}return k0=r,k0}var M0,Mk;function z$(){if(Mk)return M0;Mk=1;var r=db(),t=B$(),e=hs();function n(i){return i&&i.length?r(i,e,t):void 0}return M0=n,M0}var T0,Tk;function nC(){if(Tk)return T0;Tk=1;var r=ph(),t=Zs();function e(n,i,a){(a!==void 0&&!t(n[i],a)||a===void 0&&!(i in n))&&r(n,i,a)}return T0=e,T0}var O0,Ok;function j$(){if(Ok)return O0;Ok=1;var r=ls(),t=wh(),e=_i(),n="[object Object]",i=Function.prototype,a=Object.prototype,s=i.toString,o=a.hasOwnProperty,l=s.call(Object);function c(u){if(!e(u)||r(u)!=n)return!1;var h=t(u);if(h===null)return!0;var d=o.call(h,"constructor")&&h.constructor;return typeof d=="function"&&d instanceof d&&s.call(d)==l}return O0=c,O0}var A0,Ak;function rC(){if(Ak)return A0;Ak=1;function r(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}return A0=r,A0}var N0,Nk;function q$(){if(Nk)return N0;Nk=1;var r=wl(),t=us();function e(n){return r(n,t(n))}return N0=e,N0}var P0,Pk;function G$(){if(Pk)return P0;Pk=1;var r=nC(),t=dP(),e=wP(),n=fP(),i=SP(),a=El(),s=ln(),o=YP(),l=Qs(),c=xl(),u=Ir(),h=j$(),d=Sl(),f=rC(),g=q$();function v(p,y,m,x,E,_,M){var O=f(p,m),T=f(y,m),N=M.get(T);if(N){r(p,m,N);return}var P=_?_(O,T,m+"",p,y,M):void 0,C=P===void 0;if(C){var R=s(T),I=!R&&l(T),j=!R&&!I&&d(T);P=T,R||I||j?s(O)?P=O:o(O)?P=n(O):I?(C=!1,P=t(T,!0)):j?(C=!1,P=e(T,!0)):P=[]:h(T)||a(T)?(P=O,a(O)?P=g(O):(!u(O)||c(O))&&(P=i(T))):C=!1}C&&(M.set(T,P),E(P,T,x,_,M),M.delete(T)),r(p,m,P)}return P0=v,P0}var C0,Ck;function $$(){if(Ck)return C0;Ck=1;var r=vh(),t=nC(),e=sb(),n=G$(),i=Ir(),a=us(),s=rC();function o(l,c,u,h,d){l!==c&&e(c,function(f,g){if(d||(d=new r),i(f))n(l,c,g,u,o,h,d);else{var v=h?h(s(l,g),f,g+"",l,c,d):void 0;v===void 0&&(v=f),t(l,g,v)}},a)}return C0=o,C0}var R0,Rk;function W$(){if(Rk)return R0;Rk=1;var r=Mh(),t=Th();function e(n){return r(function(i,a){var s=-1,o=a.length,l=o>1?a[o-1]:void 0,c=o>2?a[2]:void 0;for(l=n.length>3&&typeof l=="function"?(o--,l):void 0,c&&t(a[0],a[1],c)&&(l=o<3?void 0:l,o=1),i=Object(i);++s<o;){var u=a[s];u&&n(i,u,s,l)}return i})}return R0=e,R0}var L0,Lk;function V$(){if(Lk)return L0;Lk=1;var r=$$(),t=W$(),e=t(function(n,i,a){r(n,i,a)});return L0=e,L0}var I0,Ik;function iC(){if(Ik)return I0;Ik=1;function r(t,e){return t<e}return I0=r,I0}var D0,Dk;function U$(){if(Dk)return D0;Dk=1;var r=db(),t=iC(),e=hs();function n(i){return i&&i.length?r(i,e,t):void 0}return D0=n,D0}var F0,Fk;function Y$(){if(Fk)return F0;Fk=1;var r=db(),t=Wi(),e=iC();function n(i,a){return i&&i.length?r(i,t(a,2),e):void 0}return F0=n,F0}var B0,Bk;function H$(){if(Bk)return B0;Bk=1;var r=Jr(),t=function(){return r.Date.now()};return B0=t,B0}var z0,zk;function X$(){if(zk)return z0;zk=1;var r=yh(),t=_h(),e=mh(),n=Ir(),i=_l();function a(s,o,l,c){if(!n(s))return s;o=t(o,s);for(var u=-1,h=o.length,d=h-1,f=s;f!=null&&++u<h;){var g=i(o[u]),v=l;if(g==="__proto__"||g==="constructor"||g==="prototype")return s;if(u!=d){var p=f[g];v=c?c(p,g,f):void 0,v===void 0&&(v=n(p)?p:e(o[u+1])?[]:{})}r(f,g,v),f=f[g]}return s}return z0=a,z0}var j0,jk;function K$(){if(jk)return j0;jk=1;var r=kh(),t=X$(),e=_h();function n(i,a,s){for(var o=-1,l=a.length,c={};++o<l;){var u=a[o],h=r(i,u);s(h,u)&&t(c,e(u,i),h)}return c}return j0=n,j0}var q0,qk;function Z$(){if(qk)return q0;qk=1;var r=K$(),t=DP();function e(n,i){return r(n,i,function(a,s){return t(n,s)})}return q0=e,q0}var G0,Gk;function J$(){if(Gk)return G0;Gk=1;var r=eC(),t=WP(),e=VP();function n(i){return e(t(i,void 0,r),i+"")}return G0=n,G0}var $0,$k;function Q$(){if($k)return $0;$k=1;var r=Z$(),t=J$(),e=t(function(n,i){return n==null?{}:r(n,i)});return $0=e,$0}var W0,Wk;function tW(){if(Wk)return W0;Wk=1;var r=Math.ceil,t=Math.max;function e(n,i,a,s){for(var o=-1,l=t(r((i-n)/(a||1)),0),c=Array(l);l--;)c[s?l:++o]=n,n+=a;return c}return W0=e,W0}var V0,Vk;function eW(){if(Vk)return V0;Vk=1;var r=tW(),t=Th(),e=tC();function n(i){return function(a,s,o){return o&&typeof o!="number"&&t(a,s,o)&&(s=o=void 0),a=e(a),s===void 0?(s=a,a=0):s=e(s),o=o===void 0?a<s?1:-1:e(o),r(a,s,o,i)}}return V0=n,V0}var U0,Uk;function nW(){if(Uk)return U0;Uk=1;var r=eW(),t=r();return U0=t,U0}var Y0,Yk;function rW(){if(Yk)return Y0;Yk=1;function r(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}return Y0=r,Y0}var H0,Hk;function iW(){if(Hk)return H0;Hk=1;var r=eo();function t(e,n){if(e!==n){var i=e!==void 0,a=e===null,s=e===e,o=r(e),l=n!==void 0,c=n===null,u=n===n,h=r(n);if(!c&&!h&&!o&&e>n||o&&l&&u&&!c&&!h||a&&l&&u||!i&&u||!s)return 1;if(!a&&!o&&!h&&e<n||h&&i&&s&&!a&&!o||c&&i&&s||!l&&s||!u)return-1}return 0}return H0=t,H0}var X0,Xk;function aW(){if(Xk)return X0;Xk=1;var r=iW();function t(e,n,i){for(var a=-1,s=e.criteria,o=n.criteria,l=s.length,c=i.length;++a<l;){var u=r(s[a],o[a]);if(u){if(a>=c)return u;var h=i[a];return u*(h=="desc"?-1:1)}}return e.index-n.index}return X0=t,X0}var K0,Kk;function sW(){if(Kk)return K0;Kk=1;var r=Sh(),t=kh(),e=Wi(),n=qP(),i=rW(),a=bh(),s=aW(),o=hs(),l=ln();function c(u,h,d){h.length?h=r(h,function(v){return l(v)?function(p){return t(p,v.length===1?v[0]:v)}:v}):h=[o];var f=-1;h=r(h,a(e));var g=n(u,function(v,p,y){var m=r(h,function(x){return x(v)});return{criteria:m,index:++f,value:v}});return i(g,function(v,p){return s(v,p,d)})}return K0=c,K0}var Z0,Zk;function oW(){if(Zk)return Z0;Zk=1;var r=ub(),t=sW(),e=Mh(),n=Th(),i=e(function(a,s){if(a==null)return[];var o=s.length;return o>1&&n(a,s[0],s[1])?s=[]:o>2&&n(s[0],s[1],s[2])&&(s=[s[0]]),t(a,r(s,1),[])});return Z0=i,Z0}var J0,Jk;function lW(){if(Jk)return J0;Jk=1;var r=LP(),t=0;function e(n){var i=++t;return r(n)+i}return J0=e,J0}var Q0,Qk;function cW(){if(Qk)return Q0;Qk=1;function r(t,e,n){for(var i=-1,a=t.length,s=e.length,o={};++i<a;){var l=i<s?e[i]:void 0;n(o,t[i],l)}return o}return Q0=r,Q0}var ty,tM;function uW(){if(tM)return ty;tM=1;var r=yh(),t=cW();function e(n,i){return t(n||[],i||[],r)}return ty=e,ty}var ey,eM;function Fe(){if(eM)return ey;eM=1;var r;if(typeof X1=="function")try{r={cloneDeep:M$(),constant:ab(),defaults:T$(),each:TP(),filter:BP(),find:L$(),flatten:eC(),forEach:MP(),forIn:I$(),has:zP(),isUndefined:jP(),last:D$(),map:GP(),mapValues:F$(),max:z$(),merge:V$(),min:U$(),minBy:Y$(),now:H$(),pick:Q$(),range:nW(),reduce:$P(),sortBy:oW(),uniqueId:lW(),values:HP(),zipObject:uW()}}catch{}return r||(r=window._),ey=r,ey}var ny,nM;function hW(){if(nM)return ny;nM=1,ny=r;function r(){var n={};n._next=n._prev=n,this._sentinel=n}r.prototype.dequeue=function(){var n=this._sentinel,i=n._prev;if(i!==n)return t(i),i},r.prototype.enqueue=function(n){var i=this._sentinel;n._prev&&n._next&&t(n),n._next=i._next,i._next._prev=n,i._next=n,n._prev=i},r.prototype.toString=function(){for(var n=[],i=this._sentinel,a=i._prev;a!==i;)n.push(JSON.stringify(a,e)),a=a._prev;return"["+n.join(", ")+"]"};function t(n){n._prev._next=n._next,n._next._prev=n._prev,delete n._next,delete n._prev}function e(n,i){if(n!=="_next"&&n!=="_prev")return i}return ny}var ry,rM;function dW(){if(rM)return ry;rM=1;var r=Fe(),t=Kr().Graph,e=hW();ry=i;var n=r.constant(1);function i(c,u){if(c.nodeCount()<=1)return[];var h=o(c,u||n),d=a(h.graph,h.buckets,h.zeroIdx);return r.flatten(r.map(d,function(f){return c.outEdges(f.v,f.w)}),!0)}function a(c,u,h){for(var d=[],f=u[u.length-1],g=u[0],v;c.nodeCount();){for(;v=g.dequeue();)s(c,u,h,v);for(;v=f.dequeue();)s(c,u,h,v);if(c.nodeCount()){for(var p=u.length-2;p>0;--p)if(v=u[p].dequeue(),v){d=d.concat(s(c,u,h,v,!0));break}}}return d}function s(c,u,h,d,f){var g=f?[]:void 0;return r.forEach(c.inEdges(d.v),function(v){var p=c.edge(v),y=c.node(v.v);f&&g.push({v:v.v,w:v.w}),y.out-=p,l(u,h,y)}),r.forEach(c.outEdges(d.v),function(v){var p=c.edge(v),y=v.w,m=c.node(y);m.in-=p,l(u,h,m)}),c.removeNode(d.v),g}function o(c,u){var h=new t,d=0,f=0;r.forEach(c.nodes(),function(p){h.setNode(p,{v:p,in:0,out:0})}),r.forEach(c.edges(),function(p){var y=h.edge(p.v,p.w)||0,m=u(p),x=y+m;h.setEdge(p.v,p.w,x),f=Math.max(f,h.node(p.v).out+=m),d=Math.max(d,h.node(p.w).in+=m)});var g=r.range(f+d+3).map(function(){return new e}),v=d+1;return r.forEach(h.nodes(),function(p){l(g,v,h.node(p))}),{graph:h,buckets:g,zeroIdx:v}}function l(c,u,h){h.out?h.in?c[h.out-h.in+u].enqueue(h):c[c.length-1].enqueue(h):c[0].enqueue(h)}return ry}var iy,iM;function fW(){if(iM)return iy;iM=1;var r=Fe(),t=dW();iy={run:e,undo:i};function e(a){var s=a.graph().acyclicer==="greedy"?t(a,o(a)):n(a);r.forEach(s,function(l){var c=a.edge(l);a.removeEdge(l),c.forwardName=l.name,c.reversed=!0,a.setEdge(l.w,l.v,c,r.uniqueId("rev"))});function o(l){return function(c){return l.edge(c).weight}}}function n(a){var s=[],o={},l={};function c(u){r.has(l,u)||(l[u]=!0,o[u]=!0,r.forEach(a.outEdges(u),function(h){r.has(o,h.w)?s.push(h):c(h.w)}),delete o[u])}return r.forEach(a.nodes(),c),s}function i(a){r.forEach(a.edges(),function(s){var o=a.edge(s);if(o.reversed){a.removeEdge(s);var l=o.forwardName;delete o.reversed,delete o.forwardName,a.setEdge(s.w,s.v,o,l)}})}return iy}var ay,aM;function sr(){if(aM)return ay;aM=1;var r=Fe(),t=Kr().Graph;ay={addDummyNode:e,simplify:n,asNonCompoundGraph:i,successorWeights:a,predecessorWeights:s,intersectRect:o,buildLayerMatrix:l,normalizeRanks:c,removeEmptyRanks:u,addBorderNode:h,maxRank:d,partition:f,time:g,notime:v};function e(p,y,m,x){var E;do E=r.uniqueId(x);while(p.hasNode(E));return m.dummy=y,p.setNode(E,m),E}function n(p){var y=new t().setGraph(p.graph());return r.forEach(p.nodes(),function(m){y.setNode(m,p.node(m))}),r.forEach(p.edges(),function(m){var x=y.edge(m.v,m.w)||{weight:0,minlen:1},E=p.edge(m);y.setEdge(m.v,m.w,{weight:x.weight+E.weight,minlen:Math.max(x.minlen,E.minlen)})}),y}function i(p){var y=new t({multigraph:p.isMultigraph()}).setGraph(p.graph());return r.forEach(p.nodes(),function(m){p.children(m).length||y.setNode(m,p.node(m))}),r.forEach(p.edges(),function(m){y.setEdge(m,p.edge(m))}),y}function a(p){var y=r.map(p.nodes(),function(m){var x={};return r.forEach(p.outEdges(m),function(E){x[E.w]=(x[E.w]||0)+p.edge(E).weight}),x});return r.zipObject(p.nodes(),y)}function s(p){var y=r.map(p.nodes(),function(m){var x={};return r.forEach(p.inEdges(m),function(E){x[E.v]=(x[E.v]||0)+p.edge(E).weight}),x});return r.zipObject(p.nodes(),y)}function o(p,y){var m=p.x,x=p.y,E=y.x-m,_=y.y-x,M=p.width/2,O=p.height/2;if(!E&&!_)throw new Error("Not possible to find intersection inside of the rectangle");var T,N;return Math.abs(_)*M>Math.abs(E)*O?(_<0&&(O=-O),T=O*E/_,N=O):(E<0&&(M=-M),T=M,N=M*_/E),{x:m+T,y:x+N}}function l(p){var y=r.map(r.range(d(p)+1),function(){return[]});return r.forEach(p.nodes(),function(m){var x=p.node(m),E=x.rank;r.isUndefined(E)||(y[E][x.order]=m)}),y}function c(p){var y=r.min(r.map(p.nodes(),function(m){return p.node(m).rank}));r.forEach(p.nodes(),function(m){var x=p.node(m);r.has(x,"rank")&&(x.rank-=y)})}function u(p){var y=r.min(r.map(p.nodes(),function(_){return p.node(_).rank})),m=[];r.forEach(p.nodes(),function(_){var M=p.node(_).rank-y;m[M]||(m[M]=[]),m[M].push(_)});var x=0,E=p.graph().nodeRankFactor;r.forEach(m,function(_,M){r.isUndefined(_)&&M%E!==0?--x:x&&r.forEach(_,function(O){p.node(O).rank+=x})})}function h(p,y,m,x){var E={width:0,height:0};return arguments.length>=4&&(E.rank=m,E.order=x),e(p,"border",E,y)}function d(p){return r.max(r.map(p.nodes(),function(y){var m=p.node(y).rank;if(!r.isUndefined(m))return m}))}function f(p,y){var m={lhs:[],rhs:[]};return r.forEach(p,function(x){y(x)?m.lhs.push(x):m.rhs.push(x)}),m}function g(p,y){var m=r.now();try{return y()}finally{console.log(p+" time: "+(r.now()-m)+"ms")}}function v(p,y){return y()}return ay}var sy,sM;function gW(){if(sM)return sy;sM=1;var r=Fe(),t=sr();sy={run:e,undo:i};function e(a){a.graph().dummyChains=[],r.forEach(a.edges(),function(s){n(a,s)})}function n(a,s){var o=s.v,l=a.node(o).rank,c=s.w,u=a.node(c).rank,h=s.name,d=a.edge(s),f=d.labelRank;if(u!==l+1){a.removeEdge(s);var g,v,p;for(p=0,++l;l<u;++p,++l)d.points=[],v={width:0,height:0,edgeLabel:d,edgeObj:s,rank:l},g=t.addDummyNode(a,"edge",v,"_d"),l===f&&(v.width=d.width,v.height=d.height,v.dummy="edge-label",v.labelpos=d.labelpos),a.setEdge(o,g,{weight:d.weight},h),p===0&&a.graph().dummyChains.push(g),o=g;a.setEdge(o,c,{weight:d.weight},h)}}function i(a){r.forEach(a.graph().dummyChains,function(s){var o=a.node(s),l=o.edgeLabel,c;for(a.setEdge(o.edgeObj,l);o.dummy;)c=a.successors(s)[0],a.removeNode(s),l.points.push({x:o.x,y:o.y}),o.dummy==="edge-label"&&(l.x=o.x,l.y=o.y,l.width=o.width,l.height=o.height),s=c,o=a.node(s)})}return sy}var oy,oM;function xu(){if(oM)return oy;oM=1;var r=Fe();oy={longestPath:t,slack:e};function t(n){var i={};function a(s){var o=n.node(s);if(r.has(i,s))return o.rank;i[s]=!0;var l=r.min(r.map(n.outEdges(s),function(c){return a(c.w)-n.edge(c).minlen}));return(l===Number.POSITIVE_INFINITY||l===void 0||l===null)&&(l=0),o.rank=l}r.forEach(n.sources(),a)}function e(n,i){return n.node(i.w).rank-n.node(i.v).rank-n.edge(i).minlen}return oy}var ly,lM;function aC(){if(lM)return ly;lM=1;var r=Fe(),t=Kr().Graph,e=xu().slack;ly=n;function n(o){var l=new t({directed:!1}),c=o.nodes()[0],u=o.nodeCount();l.setNode(c,{});for(var h,d;i(l,o)<u;)h=a(l,o),d=l.hasNode(h.v)?e(o,h):-e(o,h),s(l,o,d);return l}function i(o,l){function c(u){r.forEach(l.nodeEdges(u),function(h){var d=h.v,f=u===d?h.w:d;!o.hasNode(f)&&!e(l,h)&&(o.setNode(f,{}),o.setEdge(u,f,{}),c(f))})}return r.forEach(o.nodes(),c),o.nodeCount()}function a(o,l){return r.minBy(l.edges(),function(c){if(o.hasNode(c.v)!==o.hasNode(c.w))return e(l,c)})}function s(o,l,c){r.forEach(o.nodes(),function(u){l.node(u).rank+=c})}return ly}var cy,cM;function vW(){if(cM)return cy;cM=1;var r=Fe(),t=aC(),e=xu().slack,n=xu().longestPath,i=Kr().alg.preorder,a=Kr().alg.postorder,s=sr().simplify;cy=o,o.initLowLimValues=h,o.initCutValues=l,o.calcCutValue=u,o.leaveEdge=f,o.enterEdge=g,o.exchangeEdges=v;function o(x){x=s(x),n(x);var E=t(x);h(E),l(E,x);for(var _,M;_=f(E);)M=g(E,x,_),v(E,x,_,M)}function l(x,E){var _=a(x,x.nodes());_=_.slice(0,_.length-1),r.forEach(_,function(M){c(x,E,M)})}function c(x,E,_){var M=x.node(_),O=M.parent;x.edge(_,O).cutvalue=u(x,E,_)}function u(x,E,_){var M=x.node(_),O=M.parent,T=!0,N=E.edge(_,O),P=0;return N||(T=!1,N=E.edge(O,_)),P=N.weight,r.forEach(E.nodeEdges(_),function(C){var R=C.v===_,I=R?C.w:C.v;if(I!==O){var j=R===T,G=E.edge(C).weight;if(P+=j?G:-G,y(x,_,I)){var H=x.edge(_,I).cutvalue;P+=j?-H:H}}}),P}function h(x,E){arguments.length<2&&(E=x.nodes()[0]),d(x,{},1,E)}function d(x,E,_,M,O){var T=_,N=x.node(M);return E[M]=!0,r.forEach(x.neighbors(M),function(P){r.has(E,P)||(_=d(x,E,_,P,M))}),N.low=T,N.lim=_++,O?N.parent=O:delete N.parent,_}function f(x){return r.find(x.edges(),function(E){return x.edge(E).cutvalue<0})}function g(x,E,_){var M=_.v,O=_.w;E.hasEdge(M,O)||(M=_.w,O=_.v);var T=x.node(M),N=x.node(O),P=T,C=!1;T.lim>N.lim&&(P=N,C=!0);var R=r.filter(E.edges(),function(I){return C===m(x,x.node(I.v),P)&&C!==m(x,x.node(I.w),P)});return r.minBy(R,function(I){return e(E,I)})}function v(x,E,_,M){var O=_.v,T=_.w;x.removeEdge(O,T),x.setEdge(M.v,M.w,{}),h(x),l(x,E),p(x,E)}function p(x,E){var _=r.find(x.nodes(),function(O){return!E.node(O).parent}),M=i(x,_);M=M.slice(1),r.forEach(M,function(O){var T=x.node(O).parent,N=E.edge(O,T),P=!1;N||(N=E.edge(T,O),P=!0),E.node(O).rank=E.node(T).rank+(P?N.minlen:-N.minlen)})}function y(x,E,_){return x.hasEdge(E,_)}function m(x,E,_){return _.low<=E.lim&&E.lim<=_.lim}return cy}var uy,uM;function pW(){if(uM)return uy;uM=1;var r=xu(),t=r.longestPath,e=aC(),n=vW();uy=i;function i(l){switch(l.graph().ranker){case"network-simplex":o(l);break;case"tight-tree":s(l);break;case"longest-path":a(l);break;default:o(l)}}var a=t;function s(l){t(l),e(l)}function o(l){n(l)}return uy}var hy,hM;function yW(){if(hM)return hy;hM=1;var r=Fe();hy=t;function t(i){var a=n(i);r.forEach(i.graph().dummyChains,function(s){for(var o=i.node(s),l=o.edgeObj,c=e(i,a,l.v,l.w),u=c.path,h=c.lca,d=0,f=u[d],g=!0;s!==l.w;){if(o=i.node(s),g){for(;(f=u[d])!==h&&i.node(f).maxRank<o.rank;)d++;f===h&&(g=!1)}if(!g){for(;d<u.length-1&&i.node(f=u[d+1]).minRank<=o.rank;)d++;f=u[d]}i.setParent(s,f),s=i.successors(s)[0]}})}function e(i,a,s,o){var l=[],c=[],u=Math.min(a[s].low,a[o].low),h=Math.max(a[s].lim,a[o].lim),d,f;d=s;do d=i.parent(d),l.push(d);while(d&&(a[d].low>u||h>a[d].lim));for(f=d,d=o;(d=i.parent(d))!==f;)c.push(d);return{path:l.concat(c.reverse()),lca:f}}function n(i){var a={},s=0;function o(l){var c=s;r.forEach(i.children(l),o),a[l]={low:c,lim:s++}}return r.forEach(i.children(),o),a}return hy}var dy,dM;function mW(){if(dM)return dy;dM=1;var r=Fe(),t=sr();dy={run:e,cleanup:s};function e(o){var l=t.addDummyNode(o,"root",{},"_root"),c=i(o),u=r.max(r.values(c))-1,h=2*u+1;o.graph().nestingRoot=l,r.forEach(o.edges(),function(f){o.edge(f).minlen*=h});var d=a(o)+1;r.forEach(o.children(),function(f){n(o,l,h,d,u,c,f)}),o.graph().nodeRankFactor=h}function n(o,l,c,u,h,d,f){var g=o.children(f);if(!g.length){f!==l&&o.setEdge(l,f,{weight:0,minlen:c});return}var v=t.addBorderNode(o,"_bt"),p=t.addBorderNode(o,"_bb"),y=o.node(f);o.setParent(v,f),y.borderTop=v,o.setParent(p,f),y.borderBottom=p,r.forEach(g,function(m){n(o,l,c,u,h,d,m);var x=o.node(m),E=x.borderTop?x.borderTop:m,_=x.borderBottom?x.borderBottom:m,M=x.borderTop?u:2*u,O=E!==_?1:h-d[f]+1;o.setEdge(v,E,{weight:M,minlen:O,nestingEdge:!0}),o.setEdge(_,p,{weight:M,minlen:O,nestingEdge:!0})}),o.parent(f)||o.setEdge(l,v,{weight:0,minlen:h+d[f]})}function i(o){var l={};function c(u,h){var d=o.children(u);d&&d.length&&r.forEach(d,function(f){c(f,h+1)}),l[u]=h}return r.forEach(o.children(),function(u){c(u,1)}),l}function a(o){return r.reduce(o.edges(),function(l,c){return l+o.edge(c).weight},0)}function s(o){var l=o.graph();o.removeNode(l.nestingRoot),delete l.nestingRoot,r.forEach(o.edges(),function(c){var u=o.edge(c);u.nestingEdge&&o.removeEdge(c)})}return dy}var fy,fM;function bW(){if(fM)return fy;fM=1;var r=Fe(),t=sr();fy=e;function e(i){function a(s){var o=i.children(s),l=i.node(s);if(o.length&&r.forEach(o,a),r.has(l,"minRank")){l.borderLeft=[],l.borderRight=[];for(var c=l.minRank,u=l.maxRank+1;c<u;++c)n(i,"borderLeft","_bl",s,l,c),n(i,"borderRight","_br",s,l,c)}}r.forEach(i.children(),a)}function n(i,a,s,o,l,c){var u={width:0,height:0,rank:c,borderType:a},h=l[a][c-1],d=t.addDummyNode(i,"border",u,s);l[a][c]=d,i.setParent(d,o),h&&i.setEdge(h,d,{weight:1})}return fy}var gy,gM;function xW(){if(gM)return gy;gM=1;var r=Fe();gy={adjust:t,undo:e};function t(c){var u=c.graph().rankdir.toLowerCase();(u==="lr"||u==="rl")&&n(c)}function e(c){var u=c.graph().rankdir.toLowerCase();(u==="bt"||u==="rl")&&a(c),(u==="lr"||u==="rl")&&(o(c),n(c))}function n(c){r.forEach(c.nodes(),function(u){i(c.node(u))}),r.forEach(c.edges(),function(u){i(c.edge(u))})}function i(c){var u=c.width;c.width=c.height,c.height=u}function a(c){r.forEach(c.nodes(),function(u){s(c.node(u))}),r.forEach(c.edges(),function(u){var h=c.edge(u);r.forEach(h.points,s),r.has(h,"y")&&s(h)})}function s(c){c.y=-c.y}function o(c){r.forEach(c.nodes(),function(u){l(c.node(u))}),r.forEach(c.edges(),function(u){var h=c.edge(u);r.forEach(h.points,l),r.has(h,"x")&&l(h)})}function l(c){var u=c.x;c.x=c.y,c.y=u}return gy}var vy,vM;function wW(){if(vM)return vy;vM=1;var r=Fe();vy=t;function t(e){var n={},i=r.filter(e.nodes(),function(c){return!e.children(c).length}),a=r.max(r.map(i,function(c){return e.node(c).rank})),s=r.map(r.range(a+1),function(){return[]});function o(c){if(!r.has(n,c)){n[c]=!0;var u=e.node(c);s[u.rank].push(c),r.forEach(e.successors(c),o)}}var l=r.sortBy(i,function(c){return e.node(c).rank});return r.forEach(l,o),s}return vy}var py,pM;function EW(){if(pM)return py;pM=1;var r=Fe();py=t;function t(n,i){for(var a=0,s=1;s<i.length;++s)a+=e(n,i[s-1],i[s]);return a}function e(n,i,a){for(var s=r.zipObject(a,r.map(a,function(d,f){return f})),o=r.flatten(r.map(i,function(d){return r.sortBy(r.map(n.outEdges(d),function(f){return{pos:s[f.w],weight:n.edge(f).weight}}),"pos")}),!0),l=1;l<a.length;)l<<=1;var c=2*l-1;l-=1;var u=r.map(new Array(c),function(){return 0}),h=0;return r.forEach(o.forEach(function(d){var f=d.pos+l;u[f]+=d.weight;for(var g=0;f>0;)f%2&&(g+=u[f+1]),f=f-1>>1,u[f]+=d.weight;h+=d.weight*g})),h}return py}var yy,yM;function SW(){if(yM)return yy;yM=1;var r=Fe();yy=t;function t(e,n){return r.map(n,function(i){var a=e.inEdges(i);if(a.length){var s=r.reduce(a,function(o,l){var c=e.edge(l),u=e.node(l.v);return{sum:o.sum+c.weight*u.order,weight:o.weight+c.weight}},{sum:0,weight:0});return{v:i,barycenter:s.sum/s.weight,weight:s.weight}}else return{v:i}})}return yy}var my,mM;function _W(){if(mM)return my;mM=1;var r=Fe();my=t;function t(i,a){var s={};r.forEach(i,function(l,c){var u=s[l.v]={indegree:0,in:[],out:[],vs:[l.v],i:c};r.isUndefined(l.barycenter)||(u.barycenter=l.barycenter,u.weight=l.weight)}),r.forEach(a.edges(),function(l){var c=s[l.v],u=s[l.w];!r.isUndefined(c)&&!r.isUndefined(u)&&(u.indegree++,c.out.push(s[l.w]))});var o=r.filter(s,function(l){return!l.indegree});return e(o)}function e(i){var a=[];function s(c){return function(u){u.merged||(r.isUndefined(u.barycenter)||r.isUndefined(c.barycenter)||u.barycenter>=c.barycenter)&&n(c,u)}}function o(c){return function(u){u.in.push(c),--u.indegree===0&&i.push(u)}}for(;i.length;){var l=i.pop();a.push(l),r.forEach(l.in.reverse(),s(l)),r.forEach(l.out,o(l))}return r.map(r.filter(a,function(c){return!c.merged}),function(c){return r.pick(c,["vs","i","barycenter","weight"])})}function n(i,a){var s=0,o=0;i.weight&&(s+=i.barycenter*i.weight,o+=i.weight),a.weight&&(s+=a.barycenter*a.weight,o+=a.weight),i.vs=a.vs.concat(i.vs),i.barycenter=s/o,i.weight=o,i.i=Math.min(a.i,i.i),a.merged=!0}return my}var by,bM;function kW(){if(bM)return by;bM=1;var r=Fe(),t=sr();by=e;function e(a,s){var o=t.partition(a,function(v){return r.has(v,"barycenter")}),l=o.lhs,c=r.sortBy(o.rhs,function(v){return-v.i}),u=[],h=0,d=0,f=0;l.sort(i(!!s)),f=n(u,c,f),r.forEach(l,function(v){f+=v.vs.length,u.push(v.vs),h+=v.barycenter*v.weight,d+=v.weight,f=n(u,c,f)});var g={vs:r.flatten(u,!0)};return d&&(g.barycenter=h/d,g.weight=d),g}function n(a,s,o){for(var l;s.length&&(l=r.last(s)).i<=o;)s.pop(),a.push(l.vs),o++;return o}function i(a){return function(s,o){return s.barycenter<o.barycenter?-1:s.barycenter>o.barycenter?1:a?o.i-s.i:s.i-o.i}}return by}var xy,xM;function MW(){if(xM)return xy;xM=1;var r=Fe(),t=SW(),e=_W(),n=kW();xy=i;function i(o,l,c,u){var h=o.children(l),d=o.node(l),f=d?d.borderLeft:void 0,g=d?d.borderRight:void 0,v={};f&&(h=r.filter(h,function(_){return _!==f&&_!==g}));var p=t(o,h);r.forEach(p,function(_){if(o.children(_.v).length){var M=i(o,_.v,c,u);v[_.v]=M,r.has(M,"barycenter")&&s(_,M)}});var y=e(p,c);a(y,v);var m=n(y,u);if(f&&(m.vs=r.flatten([f,m.vs,g],!0),o.predecessors(f).length)){var x=o.node(o.predecessors(f)[0]),E=o.node(o.predecessors(g)[0]);r.has(m,"barycenter")||(m.barycenter=0,m.weight=0),m.barycenter=(m.barycenter*m.weight+x.order+E.order)/(m.weight+2),m.weight+=2}return m}function a(o,l){r.forEach(o,function(c){c.vs=r.flatten(c.vs.map(function(u){return l[u]?l[u].vs:u}),!0)})}function s(o,l){r.isUndefined(o.barycenter)?(o.barycenter=l.barycenter,o.weight=l.weight):(o.barycenter=(o.barycenter*o.weight+l.barycenter*l.weight)/(o.weight+l.weight),o.weight+=l.weight)}return xy}var wy,wM;function TW(){if(wM)return wy;wM=1;var r=Fe(),t=Kr().Graph;wy=e;function e(i,a,s){var o=n(i),l=new t({compound:!0}).setGraph({root:o}).setDefaultNodeLabel(function(c){return i.node(c)});return r.forEach(i.nodes(),function(c){var u=i.node(c),h=i.parent(c);(u.rank===a||u.minRank<=a&&a<=u.maxRank)&&(l.setNode(c),l.setParent(c,h||o),r.forEach(i[s](c),function(d){var f=d.v===c?d.w:d.v,g=l.edge(f,c),v=r.isUndefined(g)?0:g.weight;l.setEdge(f,c,{weight:i.edge(d).weight+v})}),r.has(u,"minRank")&&l.setNode(c,{borderLeft:u.borderLeft[a],borderRight:u.borderRight[a]}))}),l}function n(i){for(var a;i.hasNode(a=r.uniqueId("_root")););return a}return wy}var Ey,EM;function OW(){if(EM)return Ey;EM=1;var r=Fe();Ey=t;function t(e,n,i){var a={},s;r.forEach(i,function(o){for(var l=e.parent(o),c,u;l;){if(c=e.parent(l),c?(u=a[c],a[c]=l):(u=s,s=l),u&&u!==l){n.setEdge(u,l);return}l=c}})}return Ey}var Sy,SM;function AW(){if(SM)return Sy;SM=1;var r=Fe(),t=wW(),e=EW(),n=MW(),i=TW(),a=OW(),s=Kr().Graph,o=sr();Sy=l;function l(d){var f=o.maxRank(d),g=c(d,r.range(1,f+1),"inEdges"),v=c(d,r.range(f-1,-1,-1),"outEdges"),p=t(d);h(d,p);for(var y=Number.POSITIVE_INFINITY,m,x=0,E=0;E<4;++x,++E){u(x%2?g:v,x%4>=2),p=o.buildLayerMatrix(d);var _=e(d,p);_<y&&(E=0,m=r.cloneDeep(p),y=_)}h(d,m)}function c(d,f,g){return r.map(f,function(v){return i(d,v,g)})}function u(d,f){var g=new s;r.forEach(d,function(v){var p=v.graph().root,y=n(v,p,g,f);r.forEach(y.vs,function(m,x){v.node(m).order=x}),a(v,g,y.vs)})}function h(d,f){r.forEach(f,function(g){r.forEach(g,function(v,p){d.node(v).order=p})})}return Sy}var _y,_M;function NW(){if(_M)return _y;_M=1;var r=Fe(),t=Kr().Graph,e=sr();_y={positionX:g,findType1Conflicts:n,findType2Conflicts:i,addConflict:s,hasConflict:o,verticalAlignment:l,horizontalCompaction:c,alignCoordinates:d,findSmallestWidthAlignment:h,balance:f};function n(y,m){var x={};function E(_,M){var O=0,T=0,N=_.length,P=r.last(M);return r.forEach(M,function(C,R){var I=a(y,C),j=I?y.node(I).order:N;(I||C===P)&&(r.forEach(M.slice(T,R+1),function(G){r.forEach(y.predecessors(G),function(H){var Z=y.node(H),U=Z.order;(U<O||j<U)&&!(Z.dummy&&y.node(G).dummy)&&s(x,H,G)})}),T=R+1,O=j)}),M}return r.reduce(m,E),x}function i(y,m){var x={};function E(M,O,T,N,P){var C;r.forEach(r.range(O,T),function(R){C=M[R],y.node(C).dummy&&r.forEach(y.predecessors(C),function(I){var j=y.node(I);j.dummy&&(j.order<N||j.order>P)&&s(x,I,C)})})}function _(M,O){var T=-1,N,P=0;return r.forEach(O,function(C,R){if(y.node(C).dummy==="border"){var I=y.predecessors(C);I.length&&(N=y.node(I[0]).order,E(O,P,R,T,N),P=R,T=N)}E(O,P,O.length,N,M.length)}),O}return r.reduce(m,_),x}function a(y,m){if(y.node(m).dummy)return r.find(y.predecessors(m),function(x){return y.node(x).dummy})}function s(y,m,x){if(m>x){var E=m;m=x,x=E}var _=y[m];_||(y[m]=_={}),_[x]=!0}function o(y,m,x){if(m>x){var E=m;m=x,x=E}return r.has(y[m],x)}function l(y,m,x,E){var _={},M={},O={};return r.forEach(m,function(T){r.forEach(T,function(N,P){_[N]=N,M[N]=N,O[N]=P})}),r.forEach(m,function(T){var N=-1;r.forEach(T,function(P){var C=E(P);if(C.length){C=r.sortBy(C,function(H){return O[H]});for(var R=(C.length-1)/2,I=Math.floor(R),j=Math.ceil(R);I<=j;++I){var G=C[I];M[P]===P&&N<O[G]&&!o(x,P,G)&&(M[G]=P,M[P]=_[P]=_[G],N=O[G])}}})}),{root:_,align:M}}function c(y,m,x,E,_){var M={},O=u(y,m,x,_),T=_?"borderLeft":"borderRight";function N(R,I){for(var j=O.nodes(),G=j.pop(),H={};G;)H[G]?R(G):(H[G]=!0,j.push(G),j=j.concat(I(G))),G=j.pop()}function P(R){M[R]=O.inEdges(R).reduce(function(I,j){return Math.max(I,M[j.v]+O.edge(j))},0)}function C(R){var I=O.outEdges(R).reduce(function(G,H){return Math.min(G,M[H.w]-O.edge(H))},Number.POSITIVE_INFINITY),j=y.node(R);I!==Number.POSITIVE_INFINITY&&j.borderType!==T&&(M[R]=Math.max(M[R],I))}return N(P,O.predecessors.bind(O)),N(C,O.successors.bind(O)),r.forEach(E,function(R){M[R]=M[x[R]]}),M}function u(y,m,x,E){var _=new t,M=y.graph(),O=v(M.nodesep,M.edgesep,E);return r.forEach(m,function(T){var N;r.forEach(T,function(P){var C=x[P];if(_.setNode(C),N){var R=x[N],I=_.edge(R,C);_.setEdge(R,C,Math.max(O(y,P,N),I||0))}N=P})}),_}function h(y,m){return r.minBy(r.values(m),function(x){var E=Number.NEGATIVE_INFINITY,_=Number.POSITIVE_INFINITY;return r.forIn(x,function(M,O){var T=p(y,O)/2;E=Math.max(M+T,E),_=Math.min(M-T,_)}),E-_})}function d(y,m){var x=r.values(m),E=r.min(x),_=r.max(x);r.forEach(["u","d"],function(M){r.forEach(["l","r"],function(O){var T=M+O,N=y[T],P;if(N!==m){var C=r.values(N);P=O==="l"?E-r.min(C):_-r.max(C),P&&(y[T]=r.mapValues(N,function(R){return R+P}))}})})}function f(y,m){return r.mapValues(y.ul,function(x,E){if(m)return y[m.toLowerCase()][E];var _=r.sortBy(r.map(y,E));return(_[1]+_[2])/2})}function g(y){var m=e.buildLayerMatrix(y),x=r.merge(n(y,m),i(y,m)),E={},_;r.forEach(["u","d"],function(O){_=O==="u"?m:r.values(m).reverse(),r.forEach(["l","r"],function(T){T==="r"&&(_=r.map(_,function(R){return r.values(R).reverse()}));var N=(O==="u"?y.predecessors:y.successors).bind(y),P=l(y,_,x,N),C=c(y,_,P.root,P.align,T==="r");T==="r"&&(C=r.mapValues(C,function(R){return-R})),E[O+T]=C})});var M=h(y,E);return d(E,M),f(E,y.graph().align)}function v(y,m,x){return function(E,_,M){var O=E.node(_),T=E.node(M),N=0,P;if(N+=O.width/2,r.has(O,"labelpos"))switch(O.labelpos.toLowerCase()){case"l":P=-O.width/2;break;case"r":P=O.width/2;break}if(P&&(N+=x?P:-P),P=0,N+=(O.dummy?m:y)/2,N+=(T.dummy?m:y)/2,N+=T.width/2,r.has(T,"labelpos"))switch(T.labelpos.toLowerCase()){case"l":P=T.width/2;break;case"r":P=-T.width/2;break}return P&&(N+=x?P:-P),P=0,N}}function p(y,m){return y.node(m).width}return _y}var ky,kM;function PW(){if(kM)return ky;kM=1;var r=Fe(),t=sr(),e=NW().positionX;ky=n;function n(a){a=t.asNonCompoundGraph(a),i(a),r.forEach(e(a),function(s,o){a.node(o).x=s})}function i(a){var s=t.buildLayerMatrix(a),o=a.graph().ranksep,l=0;r.forEach(s,function(c){var u=r.max(r.map(c,function(h){return a.node(h).height}));r.forEach(c,function(h){a.node(h).y=l+u/2}),l+=u+o})}return ky}var My,MM;function CW(){if(MM)return My;MM=1;var r=Fe(),t=fW(),e=gW(),n=pW(),i=sr().normalizeRanks,a=yW(),s=sr().removeEmptyRanks,o=mW(),l=bW(),c=xW(),u=AW(),h=PW(),d=sr(),f=Kr().Graph;My=g;function g(J,W){var Q=W&&W.debugTiming?d.time:d.notime;Q("layout",function(){var ht=Q("  buildLayoutGraph",function(){return N(J)});Q("  runLayout",function(){v(ht,Q)}),Q("  updateInputGraph",function(){p(J,ht)})})}function v(J,W){W("    makeSpaceForEdgeLabels",function(){P(J)}),W("    removeSelfEdges",function(){tt(J)}),W("    acyclic",function(){t.run(J)}),W("    nestingGraph.run",function(){o.run(J)}),W("    rank",function(){n(d.asNonCompoundGraph(J))}),W("    injectEdgeLabelProxies",function(){C(J)}),W("    removeEmptyRanks",function(){s(J)}),W("    nestingGraph.cleanup",function(){o.cleanup(J)}),W("    normalizeRanks",function(){i(J)}),W("    assignRankMinMax",function(){R(J)}),W("    removeEdgeLabelProxies",function(){I(J)}),W("    normalize.run",function(){e.run(J)}),W("    parentDummyChains",function(){a(J)}),W("    addBorderSegments",function(){l(J)}),W("    order",function(){u(J)}),W("    insertSelfEdges",function(){gt(J)}),W("    adjustCoordinateSystem",function(){c.adjust(J)}),W("    position",function(){h(J)}),W("    positionSelfEdges",function(){xt(J)}),W("    removeBorderNodes",function(){U(J)}),W("    normalize.undo",function(){e.undo(J)}),W("    fixupEdgeLabelCoords",function(){H(J)}),W("    undoCoordinateSystem",function(){c.undo(J)}),W("    translateGraph",function(){j(J)}),W("    assignNodeIntersects",function(){G(J)}),W("    reversePoints",function(){Z(J)}),W("    acyclic.undo",function(){t.undo(J)})}function p(J,W){r.forEach(J.nodes(),function(Q){var ht=J.node(Q),Et=W.node(Q);ht&&(ht.x=Et.x,ht.y=Et.y,W.children(Q).length&&(ht.width=Et.width,ht.height=Et.height))}),r.forEach(J.edges(),function(Q){var ht=J.edge(Q),Et=W.edge(Q);ht.points=Et.points,r.has(Et,"x")&&(ht.x=Et.x,ht.y=Et.y)}),J.graph().width=W.graph().width,J.graph().height=W.graph().height}var y=["nodesep","edgesep","ranksep","marginx","marginy"],m={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},x=["acyclicer","ranker","rankdir","align"],E=["width","height"],_={width:0,height:0},M=["minlen","weight","width","height","labeloffset"],O={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},T=["labelpos"];function N(J){var W=new f({multigraph:!0,compound:!0}),Q=zt(J.graph());return W.setGraph(r.merge({},m,ut(Q,y),r.pick(Q,x))),r.forEach(J.nodes(),function(ht){var Et=zt(J.node(ht));W.setNode(ht,r.defaults(ut(Et,E),_)),W.setParent(ht,J.parent(ht))}),r.forEach(J.edges(),function(ht){var Et=zt(J.edge(ht));W.setEdge(ht,r.merge({},O,ut(Et,M),r.pick(Et,T)))}),W}function P(J){var W=J.graph();W.ranksep/=2,r.forEach(J.edges(),function(Q){var ht=J.edge(Q);ht.minlen*=2,ht.labelpos.toLowerCase()!=="c"&&(W.rankdir==="TB"||W.rankdir==="BT"?ht.width+=ht.labeloffset:ht.height+=ht.labeloffset)})}function C(J){r.forEach(J.edges(),function(W){var Q=J.edge(W);if(Q.width&&Q.height){var ht=J.node(W.v),Et=J.node(W.w),Pt={rank:(Et.rank-ht.rank)/2+ht.rank,e:W};d.addDummyNode(J,"edge-proxy",Pt,"_ep")}})}function R(J){var W=0;r.forEach(J.nodes(),function(Q){var ht=J.node(Q);ht.borderTop&&(ht.minRank=J.node(ht.borderTop).rank,ht.maxRank=J.node(ht.borderBottom).rank,W=r.max(W,ht.maxRank))}),J.graph().maxRank=W}function I(J){r.forEach(J.nodes(),function(W){var Q=J.node(W);Q.dummy==="edge-proxy"&&(J.edge(Q.e).labelRank=Q.rank,J.removeNode(W))})}function j(J){var W=Number.POSITIVE_INFINITY,Q=0,ht=Number.POSITIVE_INFINITY,Et=0,Pt=J.graph(),Kt=Pt.marginx||0,pe=Pt.marginy||0;function pn(Ce){var Qe=Ce.x,Qt=Ce.y,Er=Ce.width,re=Ce.height;W=Math.min(W,Qe-Er/2),Q=Math.max(Q,Qe+Er/2),ht=Math.min(ht,Qt-re/2),Et=Math.max(Et,Qt+re/2)}r.forEach(J.nodes(),function(Ce){pn(J.node(Ce))}),r.forEach(J.edges(),function(Ce){var Qe=J.edge(Ce);r.has(Qe,"x")&&pn(Qe)}),W-=Kt,ht-=pe,r.forEach(J.nodes(),function(Ce){var Qe=J.node(Ce);Qe.x-=W,Qe.y-=ht}),r.forEach(J.edges(),function(Ce){var Qe=J.edge(Ce);r.forEach(Qe.points,function(Qt){Qt.x-=W,Qt.y-=ht}),r.has(Qe,"x")&&(Qe.x-=W),r.has(Qe,"y")&&(Qe.y-=ht)}),Pt.width=Q-W+Kt,Pt.height=Et-ht+pe}function G(J){r.forEach(J.edges(),function(W){var Q=J.edge(W),ht=J.node(W.v),Et=J.node(W.w),Pt,Kt;Q.points?(Pt=Q.points[0],Kt=Q.points[Q.points.length-1]):(Q.points=[],Pt=Et,Kt=ht),Q.points.unshift(d.intersectRect(ht,Pt)),Q.points.push(d.intersectRect(Et,Kt))})}function H(J){r.forEach(J.edges(),function(W){var Q=J.edge(W);if(r.has(Q,"x"))switch((Q.labelpos==="l"||Q.labelpos==="r")&&(Q.width-=Q.labeloffset),Q.labelpos){case"l":Q.x-=Q.width/2+Q.labeloffset;break;case"r":Q.x+=Q.width/2+Q.labeloffset;break}})}function Z(J){r.forEach(J.edges(),function(W){var Q=J.edge(W);Q.reversed&&Q.points.reverse()})}function U(J){r.forEach(J.nodes(),function(W){if(J.children(W).length){var Q=J.node(W),ht=J.node(Q.borderTop),Et=J.node(Q.borderBottom),Pt=J.node(r.last(Q.borderLeft)),Kt=J.node(r.last(Q.borderRight));Q.width=Math.abs(Kt.x-Pt.x),Q.height=Math.abs(Et.y-ht.y),Q.x=Pt.x+Q.width/2,Q.y=ht.y+Q.height/2}}),r.forEach(J.nodes(),function(W){J.node(W).dummy==="border"&&J.removeNode(W)})}function tt(J){r.forEach(J.edges(),function(W){if(W.v===W.w){var Q=J.node(W.v);Q.selfEdges||(Q.selfEdges=[]),Q.selfEdges.push({e:W,label:J.edge(W)}),J.removeEdge(W)}})}function gt(J){var W=d.buildLayerMatrix(J);r.forEach(W,function(Q){var ht=0;r.forEach(Q,function(Et,Pt){var Kt=J.node(Et);Kt.order=Pt+ht,r.forEach(Kt.selfEdges,function(pe){d.addDummyNode(J,"selfedge",{width:pe.label.width,height:pe.label.height,rank:Kt.rank,order:Pt+ ++ht,e:pe.e,label:pe.label},"_se")}),delete Kt.selfEdges})})}function xt(J){r.forEach(J.nodes(),function(W){var Q=J.node(W);if(Q.dummy==="selfedge"){var ht=J.node(Q.e.v),Et=ht.x+ht.width/2,Pt=ht.y,Kt=Q.x-Et,pe=ht.height/2;J.setEdge(Q.e,Q.label),J.removeNode(W),Q.label.points=[{x:Et+2*Kt/3,y:Pt-pe},{x:Et+5*Kt/6,y:Pt-pe},{x:Et+Kt,y:Pt},{x:Et+5*Kt/6,y:Pt+pe},{x:Et+2*Kt/3,y:Pt+pe}],Q.label.x=Q.x,Q.label.y=Q.y}})}function ut(J,W){return r.mapValues(r.pick(J,W),Number)}function zt(J){var W={};return r.forEach(J,function(Q,ht){W[ht.toLowerCase()]=Q}),W}return My}var Ty,TM;function RW(){if(TM)return Ty;TM=1;var r=Fe(),t=sr(),e=Kr().Graph;Ty={debugOrdering:n};function n(i){var a=t.buildLayerMatrix(i),s=new e({compound:!0,multigraph:!0}).setGraph({});return r.forEach(i.nodes(),function(o){s.setNode(o,{label:o}),s.setParent(o,"layer"+i.node(o).rank)}),r.forEach(i.edges(),function(o){s.setEdge(o.v,o.w,{},o.name)}),r.forEach(a,function(o,l){var c="layer"+l;s.setNode(c,{rank:"same"}),r.reduce(o,function(u,h){return s.setEdge(u,h,{style:"invis"}),h})}),s}return Ty}var Oy,OM;function LW(){return OM||(OM=1,Oy="0.8.5"),Oy}var Ay,AM;function IW(){return AM||(AM=1,Ay={graphlib:Kr(),layout:CW(),debug:RW(),util:{time:sr().time,notime:sr().notime},version:LW()}),Ay}var sC=IW();const DW=Au(sC);class Oh{constructor(t){this.id="dagre",this.options={},Object.assign(this.options,Oh.defaultOptions,t)}execute(t,e){return Xt(this,void 0,void 0,function*(){return this.genericDagreLayout(!1,t,Object.assign(Object.assign({},this.options),e))})}assign(t,e){return Xt(this,void 0,void 0,function*(){yield this.genericDagreLayout(!0,t,Object.assign(Object.assign({},this.options),e))})}genericDagreLayout(t,e,n){return Xt(this,void 0,void 0,function*(){const{nodeSize:i}=n,a=new sC.graphlib.Graph;a.setGraph(n),a.setDefaultEdgeLabel(()=>({}));const s=e.getAllNodes(),o=e.getAllEdges();[...s,...o].some(({id:c})=>St(c))&&console.error("Dagre layout only support string id, it will convert number to string."),e.getAllNodes().forEach(c=>{const{id:u}=c,h=Object.assign({},c.data);if(i!==void 0){const[d,f]=bl(Tt(i)?i(c):i);Object.assign(h,{width:d,height:f})}a.setNode(u.toString(),h)}),e.getAllEdges().forEach(({id:c,source:u,target:h})=>{a.setEdge(u.toString(),h.toString(),{id:c})}),DW.layout(a);const l={nodes:[],edges:[]};return a.nodes().forEach(c=>{const u=a.node(c);l.nodes.push({id:c,data:u}),t&&e.mergeNodeData(c,u)}),a.edges().forEach(c=>{const u=a.edge(c),{id:h}=u,d=Pe(u,["id"]),{v:f,w:g}=c;l.edges.push({id:h,source:f,target:g,data:d}),t&&e.mergeEdgeData(h,d)}),l})}}Oh.defaultOptions={};class fb{constructor(t){this.id=t.id||0,this.rx=t.rx,this.ry=t.ry,this.fx=0,this.fy=0,this.mass=t.mass,this.degree=t.degree,this.g=t.g||0}distanceTo(t){const e=this.rx-t.rx,n=this.ry-t.ry;return Math.hypot(e,n)}setPos(t,e){this.rx=t,this.ry=e}resetForce(){this.fx=0,this.fy=0}addForce(t){const e=t.rx-this.rx,n=t.ry-this.ry;let i=Math.hypot(e,n);i=i<1e-4?1e-4:i;const a=this.g*(this.degree+1)*(t.degree+1)/i;this.fx+=a*e/i,this.fy+=a*n/i}in(t){return t.contains(this.rx,this.ry)}add(t){const e=this.mass+t.mass,n=(this.rx*this.mass+t.rx*t.mass)/e,i=(this.ry*this.mass+t.ry*t.mass)/e,a=this.degree+t.degree,s={rx:n,ry:i,mass:e,degree:a};return new fb(s)}}class As{constructor(t){this.xmid=t.xmid,this.ymid=t.ymid,this.length=t.length,this.massCenter=t.massCenter||[0,0],this.mass=t.mass||1}getLength(){return this.length}contains(t,e){const n=this.length/2;return t<=this.xmid+n&&t>=this.xmid-n&&e<=this.ymid+n&&e>=this.ymid-n}NW(){const t=this.xmid-this.length/4,e=this.ymid+this.length/4,n=this.length/2,i={xmid:t,ymid:e,length:n};return new As(i)}NE(){const t=this.xmid+this.length/4,e=this.ymid+this.length/4,n=this.length/2,i={xmid:t,ymid:e,length:n};return new As(i)}SW(){const t=this.xmid-this.length/4,e=this.ymid-this.length/4,n=this.length/2,i={xmid:t,ymid:e,length:n};return new As(i)}SE(){const t=this.xmid+this.length/4,e=this.ymid-this.length/4,n=this.length/2,i={xmid:t,ymid:e,length:n};return new As(i)}}class Ns{constructor(t){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,t!=null&&(this.quad=t)}insert(t){if(this.body==null){this.body=t;return}this._isExternal()?(this.quad&&(this.NW=new Ns(this.quad.NW()),this.NE=new Ns(this.quad.NE()),this.SW=new Ns(this.quad.SW()),this.SE=new Ns(this.quad.SE())),this._putBody(this.body),this._putBody(t),this.body=this.body.add(t)):(this.body=this.body.add(t),this._putBody(t))}_putBody(t){this.quad&&(t.in(this.quad.NW())&&this.NW?this.NW.insert(t):t.in(this.quad.NE())&&this.NE?this.NE.insert(t):t.in(this.quad.SW())&&this.SW?this.SW.insert(t):t.in(this.quad.SE())&&this.SE&&this.SE.insert(t))}_isExternal(){return this.NW==null&&this.NE==null&&this.SW==null&&this.SE==null}updateForce(t){if(!(this.body==null||t===this.body))if(this._isExternal())t.addForce(this.body);else{const e=this.quad?this.quad.getLength():0,n=this.body.distanceTo(t);e/n<this.theta?t.addForce(this.body):(this.NW&&this.NW.updateForce(t),this.NE&&this.NE.updateForce(t),this.SW&&this.SW.updateForce(t),this.SE&&this.SE.updateForce(t))}}}const FW={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1};class BW{constructor(t={}){this.options=t,this.id="forceAtlas2",this.options=Object.assign(Object.assign({},FW),t)}execute(t,e){return Xt(this,void 0,void 0,function*(){return this.genericForceAtlas2Layout(!1,t,e)})}assign(t,e){return Xt(this,void 0,void 0,function*(){yield this.genericForceAtlas2Layout(!0,t,e)})}genericForceAtlas2Layout(t,e,n){return Xt(this,void 0,void 0,function*(){const i=e.getAllEdges(),a=e.getAllNodes(),s=this.formatOptions(n,a.length),{width:o,height:l,prune:c,maxIteration:u,nodeSize:h,center:d}=s;if(!(a!=null&&a.length)||a.length===1)return os(e,t,d);const f=a.map(y=>yr(y,[o,l])),g=i.filter(y=>{const{source:m,target:x}=y;return m!==x}),v=new vn({nodes:f,edges:g}),p=this.getSizes(v,h);if(this.run(v,e,u,p,t,s),c){for(let m=0;m<g.length;m+=1){const{source:x,target:E}=g[m],_=v.getDegree(x),M=v.getDegree(x);if(_<=1){const O=v.getNode(E);v.mergeNodeData(x,{x:O.data.x,y:O.data.y})}else if(M<=1){const O=v.getNode(x);v.mergeNodeData(E,{x:O.data.x,y:O.data.y})}}const y=Object.assign(Object.assign({},s),{prune:!1,barnesHut:!1});this.run(v,e,100,p,t,y)}return{nodes:f,edges:i}})}getSizes(t,e){const n=t.getAllNodes(),i={};for(let a=0;a<n.length;a+=1){const s=n[a];i[s.id]=U1(e,void 0)(s)}return i}formatOptions(t={},e){const n=Object.assign(Object.assign({},this.options),t),{center:i,width:a,height:s,barnesHut:o,prune:l,maxIteration:c,kr:u,kg:h}=n;return n.width=!a&&typeof window<"u"?window.innerWidth:a,n.height=!s&&typeof window<"u"?window.innerHeight:s,n.center=i||[n.width/2,n.height/2],o===void 0&&e>250&&(n.barnesHut=!0),l===void 0&&e>100&&(n.prune=!0),c===0&&!l?(n.maxIteration=250,e<=200&&e>100?n.maxIteration=1e3:e>200&&(n.maxIteration=1200)):c===0&&l&&(n.maxIteration=100,e<=200&&e>100?n.maxIteration=500:e>200&&(n.maxIteration=950)),u||(n.kr=50,e>100&&e<=500?n.kr=20:e>500&&(n.kr=1)),h||(n.kg=20,e>100&&e<=500?n.kg=10:e>500&&(n.kg=1)),n}run(t,e,n,i,a,s){const{kr:o,barnesHut:l,onTick:c}=s,u=t.getAllNodes();let h=0,d=n;const f={},g={},v={};for(let p=0;p<u.length;p+=1){const{data:y,id:m}=u[p];if(f[m]=[0,0],l){const x={id:p,rx:y.x,ry:y.y,mass:1,g:o,degree:t.getDegree(m)};v[m]=new fb(x)}}for(;d>0;)h=this.oneStep(t,{iter:d,preventOverlapIters:50,krPrime:100,sg:h,forces:f,preForces:g,bodies:v,sizes:i},s),d--,c==null||c({nodes:u,edges:e.getAllEdges()});return t}oneStep(t,e,n){const{iter:i,preventOverlapIters:a,krPrime:s,sg:o,preForces:l,bodies:c,sizes:u}=e;let{forces:h}=e;const{preventOverlap:d,barnesHut:f}=n,g=t.getAllNodes();for(let v=0;v<g.length;v+=1){const{id:p}=g[v];l[p]=[...h[p]],h[p]=[0,0]}return h=this.getAttrForces(t,i,a,u,h,n),f&&(d&&i>a||!d)?h=this.getOptRepGraForces(t,h,c,n):h=this.getRepGraForces(t,i,a,h,s,u,n),this.updatePos(t,h,l,o,n)}getAttrForces(t,e,n,i,a,s){const{preventOverlap:o,dissuadeHubs:l,mode:c,prune:u}=s,h=t.getAllEdges();for(let d=0;d<h.length;d+=1){const{source:f,target:g}=h[d],v=t.getNode(f),p=t.getNode(g),y=t.getDegree(f),m=t.getDegree(g);if(u&&(y<=1||m<=1))continue;const x=[p.data.x-v.data.x,p.data.y-v.data.y];let E=Math.hypot(x[0],x[1]);E=E<1e-4?1e-4:E,x[0]=x[0]/E,x[1]=x[1]/E,o&&e<n&&(E=E-i[f]-i[g]);let _=E,M=_;c==="linlog"&&(_=Math.log(1+E),M=_),l&&(_=E/y,M=E/m),o&&e<n&&E<=0?(_=0,M=0):o&&e<n&&E>0&&(_=E,M=E),a[f][0]+=_*x[0],a[g][0]-=M*x[0],a[f][1]+=_*x[1],a[g][1]-=M*x[1]}return a}getOptRepGraForces(t,e,n,i){const{kg:a,center:s,prune:o}=i,l=t.getAllNodes(),c=l.length;let u=9e10,h=-9e10,d=9e10,f=-9e10;for(let m=0;m<c;m+=1){const{id:x,data:E}=l[m];o&&t.getDegree(x)<=1||(n[x].setPos(E.x,E.y),E.x>=h&&(h=E.x),E.x<=u&&(u=E.x),E.y>=f&&(f=E.y),E.y<=d&&(d=E.y))}const g=Math.max(h-u,f-d),v={xmid:(h+u)/2,ymid:(f+d)/2,length:g,massCenter:s,mass:c},p=new As(v),y=new Ns(p);for(let m=0;m<c;m+=1){const{id:x}=l[m];o&&t.getDegree(x)<=1||n[x].in(p)&&y.insert(n[x])}for(let m=0;m<c;m+=1){const{id:x,data:E}=l[m],_=t.getDegree(x);if(o&&_<=1)continue;n[x].resetForce(),y.updateForce(n[x]),e[x][0]-=n[x].fx,e[x][1]-=n[x].fy;const M=[E.x-s[0],E.y-s[1]];let O=Math.hypot(M[0],M[1]);O=O<1e-4?1e-4:O,M[0]=M[0]/O,M[1]=M[1]/O;const T=a*(_+1);e[x][0]-=T*M[0],e[x][1]-=T*M[1]}return e}getRepGraForces(t,e,n,i,a,s,o){const{preventOverlap:l,kr:c,kg:u,center:h,prune:d}=o,f=t.getAllNodes(),g=f.length;for(let v=0;v<g;v+=1){const p=f[v],y=t.getDegree(p.id);for(let _=v+1;_<g;_+=1){const M=f[_],O=t.getDegree(M.id);if(d&&(y<=1||O<=1))continue;const T=[M.data.x-p.data.x,M.data.y-p.data.y];let N=Math.hypot(T[0],T[1]);N=N<1e-4?1e-4:N,T[0]=T[0]/N,T[1]=T[1]/N,l&&e<n&&(N=N-s[p.id]-s[M.id]);let P=c*(y+1)*(O+1)/N;l&&e<n&&N<0?P=a*(y+1)*(O+1):l&&e<n&&N===0?P=0:l&&e<n&&N>0&&(P=c*(y+1)*(O+1)/N),i[p.id][0]-=P*T[0],i[M.id][0]+=P*T[0],i[p.id][1]-=P*T[1],i[M.id][1]+=P*T[1]}const m=[p.data.x-h[0],p.data.y-h[1]],x=Math.hypot(m[0],m[1]);m[0]=m[0]/x,m[1]=m[1]/x;const E=u*(y+1);i[p.id][0]-=E*m[0],i[p.id][1]-=E*m[1]}return i}updatePos(t,e,n,i,a){const{ks:s,tao:o,prune:l,ksmax:c}=a,u=t.getAllNodes(),h=u.length,d=[],f=[];let g=0,v=0,p=i;for(let m=0;m<h;m+=1){const{id:x}=u[m],E=t.getDegree(x);if(l&&E<=1)continue;const _=[e[x][0]-n[x][0],e[x][1]-n[x][1]],M=Math.hypot(_[0],_[1]),O=[e[x][0]+n[x][0],e[x][1]+n[x][1]],T=Math.hypot(O[0],O[1]);d[m]=M,f[m]=T/2,g+=(E+1)*d[m],v+=(E+1)*f[m]}const y=p;p=o*v/g,y!==0&&(p=p>1.5*y?1.5*y:p);for(let m=0;m<h;m+=1){const{id:x,data:E}=u[m],_=t.getDegree(x);if(l&&_<=1||St(E.fx)&&St(E.fy))continue;let M=s*p/(1+p*Math.sqrt(d[m])),O=Math.hypot(e[x][0],e[x][1]);O=O<1e-4?1e-4:O;const T=c/O;M=M>T?T:M;const N=M*e[x][0],P=M*e[x][1];t.mergeNodeData(x,{x:E.x+N,y:E.y+P})}return p}}const zW={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"},jW=800;class qW{constructor(t={}){this.options=t,this.id="fruchterman",this.timeInterval=0,this.running=!1,this.options=Object.assign(Object.assign({},zW),t)}execute(t,e){return Xt(this,void 0,void 0,function*(){return this.genericFruchtermanLayout(!1,t,e)})}assign(t,e){return Xt(this,void 0,void 0,function*(){yield this.genericFruchtermanLayout(!0,t,e)})}stop(){this.timeInterval&&typeof window<"u"&&window.clearInterval(this.timeInterval),this.running=!1}tick(t=this.options.maxIteration||1){if(this.lastResult)return this.lastResult;for(let n=0;n<t;n++)this.runOneStep(this.lastGraph,this.lastClusterMap,this.lastOptions);const e={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&e.nodes.forEach(n=>this.lastGraph.mergeNodeData(n.id,{x:n.data.x,y:n.data.y,z:this.options.dimensions===3?n.data.z:void 0})),e}genericFruchtermanLayout(t,e,n){return Xt(this,void 0,void 0,function*(){if(this.running)return;const i=this.formatOptions(n),{dimensions:a,width:s,height:o,center:l,clustering:c,nodeClusterBy:u,maxIteration:h,onTick:d}=i,f=e.getAllNodes(),g=e.getAllEdges();if(!(f!=null&&f.length)){const x={nodes:[],edges:g};return this.lastResult=x,x}if(f.length===1){t&&e.mergeNodeData(f[0].id,{x:l[0],y:l[1],z:a===3?l[2]:void 0});const x={nodes:[Object.assign(Object.assign({},f[0]),{data:Object.assign(Object.assign({},f[0].data),{x:l[0],y:l[1],z:a===3?l[2]:void 0})})],edges:g};return this.lastResult=x,x}const v=f.map(x=>yr(x,[s,o])),p=new vn({nodes:v,edges:g}),y={};if(c&&v.forEach(x=>{const E=x.data[u];y[E]||(y[E]={name:E,cx:0,cy:0,count:0})}),this.lastLayoutNodes=v,this.lastLayoutEdges=g,this.lastAssign=t,this.lastGraph=p,this.lastOptions=i,this.lastClusterMap=y,typeof window>"u")return;let m=0;return new Promise(x=>{this.timeInterval=window.setInterval(()=>{if(!this.running){x({nodes:v,edges:g});return}this.runOneStep(p,y,i),t&&v.forEach(({id:E,data:_})=>e.mergeNodeData(E,{x:_.x,y:_.y,z:a===3?_.z:void 0})),d==null||d({nodes:v,edges:g}),m++,m>=h&&(window.clearInterval(this.timeInterval),x({nodes:v,edges:g}))},0),this.running=!0})})}formatOptions(t={}){const e=Object.assign(Object.assign({},this.options),t),{clustering:n,nodeClusterBy:i}=e,{center:a,width:s,height:o}=e;return e.width=!s&&typeof window<"u"?window.innerWidth:s,e.height=!o&&typeof window<"u"?window.innerHeight:o,e.center=a||[e.width/2,e.height/2],e.clustering=n&&!!i,e}runOneStep(t,e,n){const{dimensions:i,height:a,width:s,gravity:o,center:l,speed:c,clustering:u,nodeClusterBy:h,clusterGravity:d}=n,f=a*s,g=Math.sqrt(f)/10,v=t.getAllNodes(),p=f/(v.length+1),y=Math.sqrt(p),m={};if(this.applyCalculate(t,m,y,p),u){for(const E in e)e[E].cx=0,e[E].cy=0,e[E].count=0;v.forEach(E=>{const{data:_}=E,M=e[_[h]];St(_.x)&&(M.cx+=_.x),St(_.y)&&(M.cy+=_.y),M.count++});for(const E in e)e[E].cx/=e[E].count,e[E].cy/=e[E].count;const x=d||o;v.forEach((E,_)=>{const{id:M,data:O}=E;if(!St(O.x)||!St(O.y))return;const T=e[O[h]],N=Math.sqrt((O.x-T.cx)*(O.x-T.cx)+(O.y-T.cy)*(O.y-T.cy)),P=y*x;m[M].x-=P*(O.x-T.cx)/N,m[M].y-=P*(O.y-T.cy)/N})}v.forEach((x,E)=>{const{id:_,data:M}=x;if(!St(M.x)||!St(M.y))return;const O=.01*y*o;m[_].x-=O*(M.x-l[0]),m[_].y-=O*(M.y-l[1]),i===3&&(m[_].z-=O*(M.z-l[2]))}),v.forEach((x,E)=>{const{id:_,data:M}=x;if(St(M.fx)&&St(M.fy)){M.x=M.fx,M.y=M.fy,i===3&&(M.z=M.fz);return}if(!St(M.x)||!St(M.y))return;const O=Math.sqrt(m[_].x*m[_].x+m[_].y*m[_].y+(i===3?m[_].z*m[_].z:0));if(O>0){const T=Math.min(g*(c/jW),O);t.mergeNodeData(_,{x:M.x+m[_].x/O*T,y:M.y+m[_].y/O*T,z:i===3?M.z+m[_].z/O*T:void 0})}})}applyCalculate(t,e,n,i){this.calRepulsive(t,e,i),this.calAttractive(t,e,n)}calRepulsive(t,e,n){const i=t.getAllNodes();i.forEach(({data:a,id:s},o)=>{e[s]={x:0,y:0,z:0},i.forEach(({data:l,id:c},u)=>{if(o<=u||!St(a.x)||!St(l.x)||!St(a.y)||!St(l.y))return;let h=a.x-l.x,d=a.y-l.y,f=this.options.dimensions===3?a.z-l.z:0,g=h*h+d*d+f*f;g===0&&(g=1,h=.01,d=.01,f=.01);const v=n/g,p=h*v,y=d*v,m=f*v;e[s].x+=p,e[s].y+=y,e[c].x-=p,e[c].y-=y,this.options.dimensions===3&&(e[s].z+=m,e[c].z-=m)})})}calAttractive(t,e,n){t.getAllEdges().forEach(a=>{const{source:s,target:o}=a;if(!s||!o||s===o)return;const{data:l}=t.getNode(s),{data:c}=t.getNode(o);if(!St(c.x)||!St(l.x)||!St(c.y)||!St(l.y))return;const u=c.x-l.x,h=c.y-l.y,d=this.options.dimensions===3?c.z-l.z:0,f=Math.sqrt(u*u+h*h+d*d)/n,g=u*f,v=h*f,p=d*f;e[s].x+=g,e[s].y+=v,e[o].x-=g,e[o].y-=v,this.options.dimensions===3&&(e[s].z+=p,e[o].z-=p)})}}const GW={begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30,width:300,height:300};class $W{constructor(t={}){this.options=t,this.id="grid",this.options=Object.assign(Object.assign({},GW),t)}execute(t,e){return Xt(this,void 0,void 0,function*(){return this.genericGridLayout(!1,t,e)})}assign(t,e){return Xt(this,void 0,void 0,function*(){yield this.genericGridLayout(!0,t,e)})}genericGridLayout(t,e,n){return Xt(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),n),{begin:a=[0,0],condense:s,preventOverlapPadding:o,preventOverlap:l,rows:c,cols:u,nodeSpacing:h,nodeSize:d,width:f,height:g,position:v}=i;let{sortBy:p}=i;const y=e.getAllNodes(),m=e.getAllEdges(),x=y==null?void 0:y.length;if(!x||x===1)return os(e,t,a);const E=y.map(G=>yr(G));p!=="id"&&(!ae(p)||E[0].data[p]===void 0)&&(p="degree"),p==="degree"?E.sort((G,H)=>e.getDegree(H.id,"both")-e.getDegree(G.id,"both")):p==="id"?E.sort((G,H)=>St(H.id)&&St(G.id)?H.id-G.id:`${G.id}`.localeCompare(`${H.id}`)):E.sort((G,H)=>H.data[p]-G.data[p]);const _=!f&&typeof window<"u"?window.innerWidth:f,M=!g&&typeof window<"u"?window.innerHeight:g,O=x,T={rows:c,cols:u};if(c!=null&&u!=null)T.rows=c,T.cols=u;else if(c!=null&&u==null)T.rows=c,T.cols=Math.ceil(O/T.rows);else if(c==null&&u!=null)T.cols=u,T.rows=Math.ceil(O/T.cols);else{const G=Math.sqrt(O*M/_);T.rows=Math.round(G),T.cols=Math.round(_/M*G)}if(T.rows=Math.max(T.rows,1),T.cols=Math.max(T.cols,1),T.cols*T.rows>O){const G=wc(T),H=Ec(T);(G-1)*H>=O?wc(T,G-1):(H-1)*G>=O&&Ec(T,H-1)}else for(;T.cols*T.rows<O;){const G=wc(T),H=Ec(T);(H+1)*G>=O?Ec(T,H+1):wc(T,G+1)}let N=s?0:_/T.cols,P=s?0:M/T.rows;if(l||h){const G=Wa(10,h),H=V1(30,d,!1);E.forEach(Z=>{(!Z.data.x||!Z.data.y)&&(Z.data.x=0,Z.data.y=0);const U=e.getNode(Z.id),[tt,gt]=bl(H(U)||30),xt=G!==void 0?G(Z):o,ut=tt+xt,zt=gt+xt;N=Math.max(N,ut),P=Math.max(P,zt)})}const C={},R={row:0,col:0},I={};for(let G=0;G<E.length;G++){const H=E[G];let Z;if(v&&(Z=v(e.getNode(H.id))),Z&&(Z.row!==void 0||Z.col!==void 0)){const U={row:Z.row,col:Z.col};if(U.col===void 0)for(U.col=0;Vm(C,U);)U.col++;else if(U.row===void 0)for(U.row=0;Vm(C,U);)U.row++;I[H.id]=U,oC(C,U)}WW(H,a,N,P,I,T,R,C)}const j={nodes:E,edges:m};return t&&E.forEach(G=>{e.mergeNodeData(G.id,{x:G.data.x,y:G.data.y})}),j})}}const wc=(r,t)=>{let e;const n=r.rows||5,i=r.cols||5;return t==null?e=Math.min(n,i):Math.min(n,i)===r.rows?r.rows=t:r.cols=t,e},Ec=(r,t)=>{let e;const n=r.rows||5,i=r.cols||5;return t==null?e=Math.max(n,i):Math.max(n,i)===r.rows?r.rows=t:r.cols=t,e},Vm=(r,t)=>r[`c-${t.row}-${t.col}`]||!1,oC=(r,t)=>r[`c-${t.row}-${t.col}`]=!0,NM=(r,t)=>{const e=r.cols||5;t.col++,t.col>=e&&(t.col=0,t.row++)},WW=(r,t,e,n,i,a,s,o)=>{let l,c;const u=i[r.id];if(u)l=u.col*e+e/2+t[0],c=u.row*n+n/2+t[1];else{for(;Vm(o,s);)NM(a,s);l=s.col*e+e/2+t[0],c=s.row*n+n/2+t[1],oC(o,s),NM(a,s)}r.data.x=l,r.data.y=c},VW=(r,t,e)=>{try{const n=ia.mul(ia.pow(t,2),-.5),i=n.mean("row"),a=n.mean("column"),s=n.mean();n.add(s).subRowVector(i).subColumnVector(a);const o=new tP(n),l=ia.sqrt(o.diagonalMatrix).diagonal();return o.leftSingularVectors.toJSON().map(c=>ia.mul([c],[l]).toJSON()[0].splice(0,r))}catch{const i=[];for(let a=0;a<t.length;a++){const s=Math.random()*e,o=Math.random()*e;i.push([s,o])}return i}},UW=800,YW={iterations:10,height:10,width:10,speed:100,gravity:10,k:5},HW=(r,t)=>{const e=Object.assign(Object.assign({},YW),t),{positions:n,iterations:i,width:a,k:s,speed:o=100,strictRadial:l,focusIdx:c,radii:u=[],nodeSizeFunc:h}=e,d=r.getAllNodes(),f=[],g=a/10;for(let v=0;v<i;v++)n.forEach((p,y)=>{f[y]={x:0,y:0}}),XW(d,n,f,s,u,h),KW(n,f,o,l,c,g,a,u);return n},XW=(r,t,e,n,i,a)=>{t.forEach((s,o)=>{e[o]={x:0,y:0},t.forEach((l,c)=>{if(o===c||i[o]!==i[c])return;let u=s.x-l.x,h=s.y-l.y,d=Math.sqrt(u*u+h*h);if(d===0){d=1;const f=o>c?1:-1;u=.01*f,h=.01*f}if(d<a(r[o])/2+a(r[c])/2){const f=n*n/d;e[o].x+=u/d*f,e[o].y+=h/d*f}})})},KW=(r,t,e,n,i,a,s,o)=>{const l=a||s/10;return n&&t.forEach((c,u)=>{const h=r[u].x-r[i].x,d=r[u].y-r[i].y,f=Math.sqrt(h*h+d*d);let g=d/f,v=-h/f;const p=Math.sqrt(c.x*c.x+c.y*c.y);let y=Math.acos((g*c.x+v*c.y)/p);y>Math.PI/2&&(y-=Math.PI/2,g*=-1,v*=-1);const m=Math.cos(y)*p;c.x=g*m,c.y=v*m}),r.forEach((c,u)=>{if(u===i)return;const h=Math.sqrt(t[u].x*t[u].x+t[u].y*t[u].y);if(h>0&&u!==i){const d=Math.min(l*(e/UW),h);if(c.x+=t[u].x/h*d,c.y+=t[u].y/h*d,n){let f=c.x-r[i].x,g=c.y-r[i].y;const v=Math.sqrt(f*f+g*g);f=f/v*o[u],g=g/v*o[u],c.x=r[i].x+f,c.y=r[i].y+g}}}),r},ZW={maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,strictRadial:!0,maxPreventOverlapIteration:200,sortStrength:10};class JW{constructor(t={}){this.options=t,this.id="radial",this.options=Object.assign(Object.assign({},ZW),t)}execute(t,e){return Xt(this,void 0,void 0,function*(){return this.genericRadialLayout(!1,t,e)})}assign(t,e){return Xt(this,void 0,void 0,function*(){yield this.genericRadialLayout(!0,t,e)})}genericRadialLayout(t,e,n){return Xt(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),n),{width:a,height:s,center:o,focusNode:l,unitRadius:c,nodeSize:u,nodeSpacing:h,strictRadial:d,preventOverlap:f,maxPreventOverlapIteration:g,sortBy:v,linkDistance:p=50,sortStrength:y=10,maxIteration:m=1e3}=i,x=e.getAllNodes(),E=e.getAllEdges(),_=!a&&typeof window<"u"?window.innerWidth:a,M=!s&&typeof window<"u"?window.innerHeight:s,O=o||[_/2,M/2];if(!(x!=null&&x.length)||x.length===1)return os(e,t,O);let T=x[0];if(ae(l)){for(let ht=0;ht<x.length;ht++)if(x[ht].id===l){T=x[ht];break}}else T=l||x[0];const N=e7(x,T.id),P=XN({nodes:x,edges:E}),C=HN(P),R=r7(C,N);n7(C,N,R+1);const I=C[N];let j=_-O[0]>O[0]?O[0]:_-O[0],G=M-O[1]>O[1]?O[1]:M-O[1];j===0&&(j=_/2),G===0&&(G=M/2);const H=Math.min(j,G),Z=Math.max(...I),U=[],tt=c||H/Z;I.forEach((ht,Et)=>{U[Et]=ht*tt});const gt=QW(x,C,p,U,tt,v,y),xt=t7(gt),ut=VW(p,gt,p);let zt=ut.map(([ht,Et])=>({x:(isNaN(ht)?Math.random()*p:ht)-ut[N][0],y:(isNaN(Et)?Math.random()*p:Et)-ut[N][1]}));this.run(m,zt,xt,gt,U,N);let J;if(f){J=U1(u,h);const ht={nodes:x,nodeSizeFunc:J,positions:zt,radii:U,height:M,width:_,strictRadial:!!d,focusIdx:N,iterations:g||200,k:zt.length/4.5};zt=HW(e,ht)}const W=[];return zt.forEach((ht,Et)=>{const Pt=yr(x[Et]);Pt.data.x=ht.x+O[0],Pt.data.y=ht.y+O[1],W.push(Pt)}),t&&W.forEach(ht=>e.mergeNodeData(ht.id,{x:ht.data.x,y:ht.data.y})),{nodes:W,edges:E}})}run(t,e,n,i,a,s){for(let o=0;o<=t;o++){const l=o/t;this.oneIteration(l,e,a,i,n,s)}}oneIteration(t,e,n,i,a,s){const o=1-t;e.forEach((l,c)=>{const u=Kw(l,{x:0,y:0}),h=u===0?0:1/u;if(c===s)return;let d=0,f=0,g=0;e.forEach((p,y)=>{if(c===y)return;const m=Kw(l,p),x=m===0?0:1/m,E=i[y][c];g+=a[c][y],d+=a[c][y]*(p.x+E*(l.x-p.x)*x),f+=a[c][y]*(p.y+E*(l.y-p.y)*x)});const v=n[c]===0?0:1/n[c];g*=o,g+=t*v*v,d*=o,d+=t*v*l.x*h,l.x=d/g,f*=o,f+=t*v*l.y*h,l.y=f/g})}}const QW=(r,t,e,n,i,a,s)=>{if(!r)return[];const o=[];if(t){const l={};t.forEach((c,u)=>{const h=[];c.forEach((d,f)=>{var g,v;if(u===f)h.push(0);else if(n[u]===n[f])if(a==="data")h.push(d*(Math.abs(u-f)*s)/(n[u]/i));else if(a){let p,y;if(l[r[u].id])p=l[r[u].id];else{const m=(a==="id"?r[u].id:(g=r[u].data)===null||g===void 0?void 0:g[a])||0;ae(m)?p=m.charCodeAt(0):p=m,l[r[u].id]=p}if(l[r[f].id])y=l[r[f].id];else{const m=(a==="id"?r[f].id:(v=r[f].data)===null||v===void 0?void 0:v[a])||0;ae(m)?y=m.charCodeAt(0):y=m,l[r[f].id]=y}h.push(d*(Math.abs(p-y)*s)/(n[u]/i))}else h.push(d*e/(n[u]/i));else{const p=(e+i)/2;h.push(d*p)}}),o.push(h)})}return o},t7=r=>{const t=r.length,e=r[0].length,n=[];for(let i=0;i<t;i++){const a=[];for(let s=0;s<e;s++)r[i][s]!==0?a.push(1/(r[i][s]*r[i][s])):a.push(0);n.push(a)}return n},e7=(r,t)=>{let e=-1;return r.forEach((n,i)=>{n.id===t&&(e=i)}),Math.max(e,0)},n7=(r,t,e)=>{const n=r.length;for(let i=0;i<n;i++)if(r[t][i]===1/0){r[t][i]=e,r[i][t]=e;for(let a=0;a<n;a++)r[i][a]!==1/0&&r[t][a]===1/0&&(r[t][a]=e+r[i][a],r[a][t]=e+r[i][a])}for(let i=0;i<n;i++)if(i!==t){for(let a=0;a<n;a++)if(r[i][a]===1/0){let s=Math.abs(r[t][i]-r[t][a]);s=s===0?1:s,r[i][a]=s}}},r7=(r,t)=>{let e=0;for(let n=0;n<r[t].length;n++)r[t][n]!==1/0&&(e=r[t][n]>e?r[t][n]:e);return e},i7={center:[0,0],width:300,height:300};class a7{constructor(t={}){this.options=t,this.id="random",this.options=Object.assign(Object.assign({},i7),t)}execute(t,e){return Xt(this,void 0,void 0,function*(){return this.genericRandomLayout(!1,t,e)})}assign(t,e){return Xt(this,void 0,void 0,function*(){yield this.genericRandomLayout(!0,t,e)})}genericRandomLayout(t,e,n){return Xt(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),n),{center:a,width:s,height:o}=i,l=e.getAllNodes(),c=.9,u=!s&&typeof window<"u"?window.innerWidth:s,h=!o&&typeof window<"u"?window.innerHeight:o,d=a||[u/2,h/2],f=[];return l&&l.forEach(v=>{f.push({id:v.id,data:{x:(Math.random()-.5)*c*u+d[0],y:(Math.random()-.5)*c*h+d[1]}})}),t&&f.forEach(v=>e.mergeNodeData(v.id,{x:v.data.x,y:v.data.y})),{nodes:f,edges:e.getAllEdges()}})}}/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const lC=Symbol("Comlink.proxy"),s7=Symbol("Comlink.endpoint"),cC=Symbol("Comlink.releaseProxy"),Ny=Symbol("Comlink.finalizer"),zc=Symbol("Comlink.thrown"),uC=r=>typeof r=="object"&&r!==null||typeof r=="function",o7={canHandle:r=>uC(r)&&r[lC],serialize(r){const{port1:t,port2:e}=new MessageChannel;return dC(r,t),[e,[e]]},deserialize(r){return r.start(),gC(r)}},l7={canHandle:r=>uC(r)&&zc in r,serialize({value:r}){let t;return r instanceof Error?t={isError:!0,value:{message:r.message,name:r.name,stack:r.stack}}:t={isError:!1,value:r},[t,[]]},deserialize(r){throw r.isError?Object.assign(new Error(r.value.message),r.value):r.value}},hC=new Map([["proxy",o7],["throw",l7]]);function c7(r,t){for(const e of r)if(t===e||e==="*"||e instanceof RegExp&&e.test(t))return!0;return!1}function dC(r,t=globalThis,e=["*"]){t.addEventListener("message",function n(i){if(!i||!i.data)return;if(!c7(e,i.origin)){console.warn(`Invalid origin '${i.origin}' for comlink proxy`);return}const{id:a,type:s,path:o}=Object.assign({path:[]},i.data),l=(i.data.argumentList||[]).map(Ia);let c;try{const u=o.slice(0,-1).reduce((d,f)=>d[f],r),h=o.reduce((d,f)=>d[f],r);switch(s){case"GET":c=h;break;case"SET":u[o.slice(-1)[0]]=Ia(i.data.value),c=!0;break;case"APPLY":c=h.apply(u,l);break;case"CONSTRUCT":{const d=new h(...l);c=v7(d)}break;case"ENDPOINT":{const{port1:d,port2:f}=new MessageChannel;dC(r,f),c=g7(d,[d])}break;case"RELEASE":c=void 0;break;default:return}}catch(u){c={value:u,[zc]:0}}Promise.resolve(c).catch(u=>({value:u,[zc]:0})).then(u=>{const[h,d]=Su(u);t.postMessage(Object.assign(Object.assign({},h),{id:a}),d),s==="RELEASE"&&(t.removeEventListener("message",n),fC(t),Ny in r&&typeof r[Ny]=="function"&&r[Ny]())}).catch(u=>{const[h,d]=Su({value:new TypeError("Unserializable return value"),[zc]:0});t.postMessage(Object.assign(Object.assign({},h),{id:a}),d)})}),t.start&&t.start()}function u7(r){return r.constructor.name==="MessagePort"}function fC(r){u7(r)&&r.close()}function gC(r,t){const e=new Map;return r.addEventListener("message",function(i){const{data:a}=i;if(!a||!a.id)return;const s=e.get(a.id);if(s)try{s(a)}finally{e.delete(a.id)}}),Um(r,e,[],t)}function Sc(r){if(r)throw new Error("Proxy has been released and is not useable")}function vC(r){return Ms(r,new Map,{type:"RELEASE"}).then(()=>{fC(r)})}const wu=new WeakMap,Eu="FinalizationRegistry"in globalThis&&new FinalizationRegistry(r=>{const t=(wu.get(r)||0)-1;wu.set(r,t),t===0&&vC(r)});function h7(r,t){const e=(wu.get(t)||0)+1;wu.set(t,e),Eu&&Eu.register(r,t,r)}function d7(r){Eu&&Eu.unregister(r)}function Um(r,t,e=[],n=function(){}){let i=!1;const a=new Proxy(n,{get(s,o){if(Sc(i),o===cC)return()=>{d7(a),vC(r),t.clear(),i=!0};if(o==="then"){if(e.length===0)return{then:()=>a};const l=Ms(r,t,{type:"GET",path:e.map(c=>c.toString())}).then(Ia);return l.then.bind(l)}return Um(r,t,[...e,o])},set(s,o,l){Sc(i);const[c,u]=Su(l);return Ms(r,t,{type:"SET",path:[...e,o].map(h=>h.toString()),value:c},u).then(Ia)},apply(s,o,l){Sc(i);const c=e[e.length-1];if(c===s7)return Ms(r,t,{type:"ENDPOINT"}).then(Ia);if(c==="bind")return Um(r,t,e.slice(0,-1));const[u,h]=PM(l);return Ms(r,t,{type:"APPLY",path:e.map(d=>d.toString()),argumentList:u},h).then(Ia)},construct(s,o){Sc(i);const[l,c]=PM(o);return Ms(r,t,{type:"CONSTRUCT",path:e.map(u=>u.toString()),argumentList:l},c).then(Ia)}});return h7(a,r),a}function f7(r){return Array.prototype.concat.apply([],r)}function PM(r){const t=r.map(Su);return[t.map(e=>e[0]),f7(t.map(e=>e[1]))]}const pC=new WeakMap;function g7(r,t){return pC.set(r,t),r}function v7(r){return Object.assign(r,{[lC]:!0})}function Su(r){for(const[t,e]of hC)if(e.canHandle(r)){const[n,i]=e.serialize(r);return[{type:"HANDLER",name:t,value:n},i]}return[{type:"RAW",value:r},pC.get(r)||[]]}function Ia(r){switch(r.type){case"HANDLER":return hC.get(r.name).deserialize(r.value);case"RAW":return r.value}}function Ms(r,t,e,n){return new Promise(i=>{const a=p7();t.set(a,i),r.start&&r.start(),r.postMessage(Object.assign({id:a},e),n)})}function p7(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}class y7 extends Qu{constructor(t,e,n){super(),this.graph=t,this.layout=e,this.options=n,this.spawnWorker()}spawnWorker(){this.proxy=gC(new Worker(new URL("/assets/worker-B9qc9nkC.js",import.meta.url),{type:"module"})),this.running&&(this.running=!1,this.execute())}execute(){var t;return Xt(this,void 0,void 0,function*(){if(this.running)return this;this.running=!0;const e=this.layout.options,{onTick:n}=e,i=Pe(e,["onTick"]),a={};Object.keys(i).forEach(c=>{Tt(i[c])||(a[c]=i[c])});const s={layout:{id:this.layout.id,options:a,iterations:(t=this.options)===null||t===void 0?void 0:t.iterations},nodes:this.graph.getAllNodes(),edges:this.graph.getAllEdges()},o=new Float32Array([0]),[l]=yield this.proxy.calculateLayout(s,[o]);return l})}stop(){return this.running=!1,this.proxy.stopLayout(),this}kill(){this.proxy[cC]()}isRunning(){return this.running}}var m7=function(r,t,e,n){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((n=n.apply(r,t||[])).next())})};class Ah extends th{constructor(){super(...arguments),this.id="fishbone"}getRoot(){const t=this.context.model.getRootsData();if(!(ui(t)||t.length>2))return t[0]}formatSize(t){const e=typeof t=="function"?t:()=>t;return n=>br(e(n))}doLayout(t,e){const{hGap:n,getRibSep:i,vGap:a,nodeSize:s,height:o}=e,{model:l}=this.context,c=this.formatSize(s);let u=c(t)[0]+i(t);const h=(x,E=0)=>{var _;return E+=n*((x.children||[]).length+1),(_=x.children)===null||_===void 0||_.forEach(M=>{var O;(O=l.getNodeLikeDatum(M).children)===null||O===void 0||O.forEach(N=>{const P=l.getNodeLikeDatum(N);E=h(P,E)})}),E},d=x=>{if(x.depth===1)return u;const E=l.getParentData(x.id,"tree");if(bs(x)){const _=l.getParentData(E.id,"tree"),M=v(x)-v(_);return d(E)+M*n/a}else{const _=(E.children||[]).indexOf(x.id),M=l.getNodeData((E.children||[]).slice(_));return f(E)-M.reduce((O,T)=>O+h(T),0)-c(E)[0]/2}},f=rm(x=>{if(Py(x))return c(x)[0]/2;const E=l.getParentData(x.id,"tree");if(bs(x))return d(x)+h(x)+c(x)[0]/2;{const _=v(x)-v(E),M=n/a;return d(x)+_*M}},x=>x.id),g=x=>v(l.getParentData(x,"tree")),v=rm(x=>{if(Py(x))return o/2;if(bs(x)){const E=l.getParentData(x.id,"tree"),_=E.children.indexOf(x.id);if(_===0)return g(E.id)+a;const M=l.getNodeLikeDatum(E.children[_-1]);if(ui(M.children))return v(M)+a;const O=l.getDescendantsData(M.id);return Math.max(...O.map(T=>bs(T)?g(T.id):v(T)))+a}else{if(ui(x.children))return g(x.id)+a;const E=l.getNodeLikeDatum(x.children.slice(-1)[0]);if(ui(E.children))return v(E)+a;const _=l.getDescendantsData(x.id).slice(-1)[0];return(bs(_)?g(_.id):v(_))+a}},x=>x.id);let p=0;const y={nodes:[],edges:[]},m=x=>{var E;(E=x.children)===null||E===void 0||E.forEach(N=>m(l.getNodeLikeDatum(N)));const _=v(x),M=f(x);if(y.nodes.push({id:x.id,x:M,y:_}),Py(x))return;const O=l.getRelatedEdgesData(x.id,"in")[0],T=[d(x),bs(x)?_:g(x.id)];y.edges.push({id:K(O),controlPoints:[T],relatedNodeId:x.id}),p=Math.max(p,M+i(x)),x.depth===1&&(u=p)};return m(t),y}placeAlterative(t,e){const n=(e.children||[]).filter((o,l)=>l%2!==0);if(n.length===0)return t;const{model:i}=this.context,a=t.nodes.find(o=>o.id===e.id).y,s=o=>{const l=i.getAncestorsData(o,"tree");if(ui(l))return!1;const c=l.length===1?o:l[l.length-2].id;return n.includes(c)};t.nodes.forEach(o=>{s(o.id)&&(o.y=2*a-o.y)}),t.edges.forEach(o=>{s(o.relatedNodeId)&&(o.controlPoints=o.controlPoints.map(l=>[l[0],2*a-l[1]]))})}rightToLeft(t,e){return t.nodes.forEach(n=>n.x=e.width-n.x),t.edges.forEach(n=>{n.controlPoints=n.controlPoints.map(i=>[e.width-i[0],i[1]])}),t}execute(t,e){return m7(this,void 0,void 0,function*(){const n=Object.assign(Object.assign(Object.assign({},Ah.defaultOptions),this.options),e),{direction:i,nodeSize:a}=n,s=this.getRoot();if(!s)return t;const o=this.formatSize(a);n.vGap||(n.vGap=Math.max(...(t.nodes||[]).map(d=>o(d)[1]))),n.hGap||(n.hGap=Math.max(...(t.nodes||[]).map(d=>o(d)[0])));let l=this.doLayout(s,n);this.placeAlterative(l,s),i==="RL"&&(l=this.rightToLeft(l,n));const{model:c}=this.context,u=[],h=[];return l.nodes.forEach(d=>{const{id:f,x:g,y:v}=d,p=c.getNodeLikeDatum(f);u.push(CM(p,{x:g,y:v}))}),l.edges.forEach(d=>{const{id:f,controlPoints:g}=d,v=c.getEdgeDatum(f);h.push(CM(v,{controlPoints:g}))}),{nodes:u,edges:h}})}}Ah.defaultOptions={direction:"RL",getRibSep:()=>60};const CM=(r,t)=>Object.assign(Object.assign({},r),{style:Object.assign(Object.assign({},r.style||{}),t)}),Py=r=>r.depth===0,bs=r=>(r.depth||(r.depth=0))%2===0;var b7=function(r,t,e,n){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((n=n.apply(r,t||[])).next())})};class Nh extends th{constructor(){super(...arguments),this.id="snake"}formatSize(t,e){const n=typeof e=="function"?e:(()=>e);return t.reduce((i,a)=>{const[s,o]=br(n(a))||[0,0];return[Math.max(i[0],s),Math.max(i[1],o)]},[0,0])}validate(t){const{nodes:e=[],edges:n=[]}=t,i={},a={},s={};e.forEach(d=>{i[d.id]=0,a[d.id]=0,s[d.id]=[]}),n.forEach(d=>{i[d.target]++,a[d.source]++,s[d.source].push(d.target)});const o=new Set,l=d=>{o.has(d)||(o.add(d),s[d].forEach(l))};if(l(e[0].id),o.size!==e.length)return!1;const c=e.filter(d=>i[d.id]===0),u=e.filter(d=>a[d.id]===0);return!(c.length!==1||u.length!==1||e.filter(d=>i[d.id]===1&&a[d.id]===1).length!==e.length-2)}execute(t,e){return b7(this,void 0,void 0,function*(){var n;if(!this.validate(t))return t;const{nodeSize:i,padding:a,sortBy:s,cols:o,colGap:l,rowGap:c,clockwise:u,width:h,height:d}=Object.assign({},Nh.defaultOptions,this.options,e),[f,g,v,p]=Lr(a),y=this.formatSize(t.nodes||[],i),m=Math.ceil((t.nodes||[]).length/o);let x=l||(h-p-g-o*y[0])/(o-1),E=c||(d-f-v-m*y[1])/(m-1);return(E===1/0||E<0)&&(E=0),(x===1/0||x<0)&&(x=0),{nodes:((s?(n=t.nodes)===null||n===void 0?void 0:n.sort(s):x7(t))||[]).map((O,T)=>{const N=Math.floor(T/o),P=T%o,C=u?N%2===0?P:o-1-P:N%2===0?o-1-P:P,R=p+C*(y[0]+x)+y[0]/2,I=f+N*(y[1]+E)+y[1]/2;return{id:O.id,style:{x:R,y:I}}})}})}}Nh.defaultOptions={padding:0,cols:5,clockwise:!0};function x7(r){const{nodes:t=[],edges:e=[]}=r,n={},i={};t.forEach(o=>{n[o.id]=0,i[o.id]=[]}),e.forEach(o=>{n[o.target]++,i[o.source].push(o.target)});const a=[],s=[];for(t.forEach(o=>{n[o.id]===0&&a.push(o.id)});a.length>0;){const o=a.shift(),l=t.find(c=>c.id===o);s.push(l),i[o].forEach(c=>{n[c]--,n[c]===0&&a.push(c)})}return s}const w7=["rgb(158, 1, 66)","rgb(213, 62, 79)","rgb(244, 109, 67)","rgb(253, 174, 97)","rgb(254, 224, 139)","rgb(255, 255, 191)","rgb(230, 245, 152)","rgb(171, 221, 164)","rgb(102, 194, 165)","rgb(50, 136, 189)","rgb(94, 79, 162)"],E7=["rgb(78, 121, 167)","rgb(242, 142, 44)","rgb(225, 87, 89)","rgb(118, 183, 178)","rgb(89, 161, 79)","rgb(237, 201, 73)","rgb(175, 122, 161)","rgb(255, 157, 167)","rgb(156, 117, 95)","rgb(186, 176, 171)"],S7=["rgb(255, 245, 235)","rgb(254, 230, 206)","rgb(253, 208, 162)","rgb(253, 174, 107)","rgb(253, 141, 60)","rgb(241, 105, 19)","rgb(217, 72, 1)","rgb(166, 54, 3)","rgb(127, 39, 4)"],_7=["rgb(247, 252, 245)","rgb(229, 245, 224)","rgb(199, 233, 192)","rgb(161, 217, 155)","rgb(116, 196, 118)","rgb(65, 171, 93)","rgb(35, 139, 69)","rgb(0, 109, 44)","rgb(0, 68, 27)"],k7=["rgb(247, 251, 255)","rgb(222, 235, 247)","rgb(198, 219, 239)","rgb(158, 202, 225)","rgb(107, 174, 214)","rgb(66, 146, 198)","rgb(33, 113, 181)","rgb(8, 81, 156)","rgb(8, 48, 107)"];class En extends N1{}function no(r,t=!0,e){const n=document.createElement("div");return n.setAttribute("class",`g6-${r}`),Object.assign(n.style,{position:"absolute",display:"block"}),t&&Object.assign(n.style,{position:"unset",gridArea:"1 / 1 / 2 / 2",inset:"0px",height:"100%",width:"100%",overflow:"hidden",pointerEvents:"none"}),e&&Object.assign(n.style,e),n}function Ym(r,t="div",e={},n="",i=document.body){const a=document.getElementById(r);a&&a.remove();const s=document.createElement(t);return s.innerHTML=n,s.id=r,Object.assign(s.style,e),i.appendChild(s),s}var M7=function(r,t,e,n){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((n=n.apply(r,t||[])).next())})};class Ph extends En{constructor(t,e){super(t,Object.assign({},Ph.defaultOptions,e)),this.$element=no("background"),this.context.canvas.getContainer().prepend(this.$element),this.update(e)}update(t){const e=Object.create(null,{update:{get:()=>super.update}});return M7(this,void 0,void 0,function*(){e.update.call(this,t),Object.assign(this.$element.style,h1(this.options,["key","type"]))})}destroy(){super.destroy(),this.$element.remove()}}Ph.defaultOptions={transition:"background 0.5s",backgroundSize:"cover",zIndex:"-1"};function gb(r,t,e,n,i,a){const s=r,o=t,l=e-s,c=n-o;let u=i-s,h=a-o,d=u*l+h*c,f=0;d<=0?f=0:(u=l-u,h=c-h,d=u*l+h*c,d<=0?f=0:f=d*d/(l*l+c*c));const g=u*u+h*h-f;return g<0?0:g}function sa(r,t,e,n){return(r-e)*(r-e)+(t-n)*(t-n)}function RM(r,t,e,n,i){return sa(r,t,e,n)<i*i}function T7(r){if(!Number.isFinite(r))return e=>e;if(r===0)return Math.round;const t=Math.pow(10,r);return e=>Math.round(e*t)/t}function yC(r){const t=Math.min(r.x1,r.x2),e=Math.max(r.x1,r.x2),n=Math.min(r.y1,r.y2),i=Math.max(r.y1,r.y2);return{x:t,y:n,x2:e,y2:i,width:e-t,height:i-n}}class xn{constructor(t,e,n,i){this.x1=t,this.y1=e,this.x2=n,this.y2=i}equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2}draw(t){t.moveTo(this.x1,this.y1),t.lineTo(this.x2,this.y2)}toString(){return`Line(from=(${this.x1},${this.y1}),to=(${this.x2},${this.y2}))`}static from(t){return new xn(t.x1,t.y1,t.x2,t.y2)}cuts(t,e){if(this.y1===this.y2||e<this.y1&&e<=this.y2||e>this.y1&&e>=this.y2||t>this.x1&&t>=this.x2)return!1;if(t<this.x1&&t<=this.x2)return!0;const n=this.x1+(e-this.y1)*(this.x2-this.x1)/(this.y2-this.y1);return t<=n}distSquare(t,e){return gb(this.x1,this.y1,this.x2,this.y2,t,e)}ptClose(t,e,n){if(this.x1<this.x2){if(t<this.x1-n||t>this.x2+n)return!1}else if(t<this.x2-n||t>this.x1+n)return!1;if(this.y1<this.y2){if(e<this.y1-n||e>this.y2+n)return!1}else if(e<this.y2-n||e>this.y1+n)return!1;return!0}}var We;(function(r){r[r.POINT=1]="POINT",r[r.PARALLEL=2]="PARALLEL",r[r.COINCIDENT=3]="COINCIDENT",r[r.NONE=4]="NONE"})(We||(We={}));class Cy{constructor(t,e=0,n=0){this.state=t,this.x=e,this.y=n}}function _c(r,t){const e=(t.x2-t.x1)*(r.y1-t.y1)-(t.y2-t.y1)*(r.x1-t.x1),n=(r.x2-r.x1)*(r.y1-t.y1)-(r.y2-r.y1)*(r.x1-t.x1),i=(t.y2-t.y1)*(r.x2-r.x1)-(t.x2-t.x1)*(r.y2-r.y1);if(i){const a=e/i,s=n/i;return 0<=a&&a<=1&&0<=s&&s<=1?new Cy(We.POINT,r.x1+a*(r.x2-r.x1),r.y1+a*(r.y2-r.y1)):new Cy(We.NONE)}return new Cy(e===0||n===0?We.COINCIDENT:We.PARALLEL)}function mC(r,t){const e=(t.x2-t.x1)*(r.y1-t.y1)-(t.y2-t.y1)*(r.x1-t.x1),n=(r.x2-r.x1)*(r.y1-t.y1)-(r.y2-r.y1)*(r.x1-t.x1),i=(t.y2-t.y1)*(r.x2-r.x1)-(t.x2-t.x1)*(r.y2-r.y1);if(i){const a=e/i,s=n/i;if(0<=a&&a<=1&&0<=s&&s<=1)return a}return Number.POSITIVE_INFINITY}function O7(r,t){function e(i,a,s,o){let l=mC(t,new xn(i,a,s,o));return l=Math.abs(l-.5),l>=0&&l<=1?1:0}let n=e(r.x,r.y,r.x2,r.y);return n+=e(r.x,r.y,r.x,r.y2),n>1||(n+=e(r.x,r.y2,r.x2,r.y2),n>1)?!0:(n+=e(r.x2,r.y,r.x2,r.y2),n>0)}var Ve;(function(r){r[r.LEFT=0]="LEFT",r[r.TOP=1]="TOP",r[r.RIGHT=2]="RIGHT",r[r.BOTTOM=3]="BOTTOM"})(Ve||(Ve={}));function jc(r,t,e){const n=new Set;return r.width<=0?(n.add(Ve.LEFT),n.add(Ve.RIGHT)):t<r.x?n.add(Ve.LEFT):t>r.x+r.width&&n.add(Ve.RIGHT),r.height<=0?(n.add(Ve.TOP),n.add(Ve.BOTTOM)):e<r.y?n.add(Ve.TOP):e>r.y+r.height&&n.add(Ve.BOTTOM),n}function bC(r,t){let e=t.x1,n=t.y1;const i=t.x2,a=t.y2,s=Array.from(jc(r,i,a));if(s.length===0)return!0;let o=jc(r,e,n);for(;o.size!==0;){for(const l of s)if(o.has(l))return!1;if(o.has(Ve.RIGHT)||o.has(Ve.LEFT)){let l=r.x;o.has(Ve.RIGHT)&&(l+=r.width),n=n+(l-e)*(a-n)/(i-e),e=l}else{let l=r.y;o.has(Ve.BOTTOM)&&(l+=r.height),e=e+(l-n)*(i-e)/(a-n),n=l}o=jc(r,e,n)}return!0}function A7(r,t){let e=Number.POSITIVE_INFINITY,n=0;function i(a,s,o,l){let c=mC(t,new xn(a,s,o,l));c=Math.abs(c-.5),c>=0&&c<=1&&(n++,c<e&&(e=c))}return i(r.x,r.y,r.x2,r.y),i(r.x,r.y,r.x,r.y2),n>1||(i(r.x,r.y2,r.x2,r.y2),n>1)?e:(i(r.x2,r.y,r.x2,r.y2),n===0?-1:e)}function N7(r,t){let e=0;const n=_c(r,new xn(t.x,t.y,t.x2,t.y));e+=n.state===We.POINT?1:0;const i=_c(r,new xn(t.x,t.y,t.x,t.y2));e+=i.state===We.POINT?1:0;const a=_c(r,new xn(t.x,t.y2,t.x2,t.y2));e+=a.state===We.POINT?1:0;const s=_c(r,new xn(t.x2,t.y,t.x2,t.y2));return e+=s.state===We.POINT?1:0,{top:n,left:i,bottom:a,right:s,count:e}}class Dn{constructor(t,e,n,i){this.x=t,this.y=e,this.width=n,this.height=i}get x2(){return this.x+this.width}get y2(){return this.y+this.height}get cx(){return this.x+this.width/2}get cy(){return this.y+this.height/2}get radius(){return Math.max(this.width,this.height)/2}static from(t){return new Dn(t.x,t.y,t.width,t.height)}equals(t){return this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height}clone(){return new Dn(this.x,this.y,this.width,this.height)}add(t){const e=Math.min(this.x,t.x),n=Math.min(this.y,t.y),i=Math.max(this.x2,t.x+t.width),a=Math.max(this.y2,t.y+t.height);this.x=e,this.y=n,this.width=i-e,this.height=a-n}addPoint(t){const e=Math.min(this.x,t.x),n=Math.min(this.y,t.y),i=Math.max(this.x2,t.x),a=Math.max(this.y2,t.y);this.x=e,this.y=n,this.width=i-e,this.height=a-n}toString(){return`Rectangle[x=${this.x}, y=${this.y}, w=${this.width}, h=${this.height}]`}draw(t){t.rect(this.x,this.y,this.width,this.height)}containsPt(t,e){return t>=this.x&&t<=this.x2&&e>=this.y&&e<=this.y2}get area(){return this.width*this.height}intersects(t){return this.area<=0||t.width<=0||t.height<=0?!1:t.x+t.width>this.x&&t.y+t.height>this.y&&t.x<this.x2&&t.y<this.y2}distSquare(t,e){if(this.containsPt(t,e))return 0;const n=jc(this,t,e);return n.has(Ve.TOP)?n.has(Ve.LEFT)?sa(t,e,this.x,this.y):n.has(Ve.RIGHT)?sa(t,e,this.x2,this.y):(this.y-e)*(this.y-e):n.has(Ve.BOTTOM)?n.has(Ve.LEFT)?sa(t,e,this.x,this.y2):n.has(Ve.RIGHT)?sa(t,e,this.x2,this.y2):(e-this.y2)*(e-this.y2):n.has(Ve.LEFT)?(this.x-t)*(this.x-t):n.has(Ve.RIGHT)?(t-this.x2)*(t-this.x2):0}}function P7(r){if(r.length===0)return null;const t=r[0],e=new Dn(t.x,t.y,0,0);for(const n of r)e.addPoint(n);return e}class _u{constructor(t,e,n){this.cx=t,this.cy=e,this.radius=n}get x(){return this.cx-this.radius}get x2(){return this.cx+this.radius}get width(){return this.radius*2}get y(){return this.cy-this.radius}get y2(){return this.cy+this.radius}get height(){return this.radius*2}static from(t){return new _u(t.cx,t.cy,t.radius)}containsPt(t,e){return sa(this.cx,this.cy,t,e)<this.radius*this.radius}distSquare(t,e){const n=sa(this.cx,this.cy,t,e);if(n<this.radius*this.radius)return 0;const i=Math.sqrt(n)-this.radius;return i*i}draw(t){t.ellipse(this.cx,this.cy,this.radius,this.radius,0,0,Math.PI*2)}}class Va{constructor(t,e=0,n=0,i=0,a=0,s=10,o=10,l=new Float32Array(Math.max(0,s*o)).fill(0)){this.pixelGroup=t,this.i=e,this.j=n,this.pixelX=i,this.pixelY=a,this.width=s,this.height=o,this.area=l}createSub(t,e){return new Va(this.pixelGroup,t.x,t.y,e.x,e.y,t.width,t.height)}static fromPixelRegion(t,e){return new Va(e,0,0,t.x,t.y,Math.ceil(t.width/e),Math.ceil(t.height/e))}copy(t,e){return new Va(this.pixelGroup,this.scaleX(e.x),this.scaleY(e.y),e.x,e.y,t.width,t.height,t.area)}boundX(t){return t<this.i?this.i:t>=this.width?this.width-1:t}boundY(t){return t<this.j?this.j:t>=this.height?this.height-1:t}scaleX(t){return this.boundX(Math.floor((t-this.pixelX)/this.pixelGroup))}scaleY(t){return this.boundY(Math.floor((t-this.pixelY)/this.pixelGroup))}scale(t){const e=this.scaleX(t.x),n=this.scaleY(t.y),i=this.boundX(Math.ceil((t.x+t.width-this.pixelX)/this.pixelGroup)),a=this.boundY(Math.ceil((t.y+t.height-this.pixelY)/this.pixelGroup)),s=i-e,o=a-n;return new Dn(e,n,s,o)}invertScaleX(t){return Math.round(t*this.pixelGroup+this.pixelX)}invertScaleY(t){return Math.round(t*this.pixelGroup+this.pixelY)}addPadding(t,e){const n=Math.ceil(e/this.pixelGroup),i=this.boundX(t.x-n),a=this.boundY(t.y-n),s=this.boundX(t.x2+n),o=this.boundY(t.y2+n),l=s-i,c=o-a;return new Dn(i,a,l,c)}get(t,e){return t<0||e<0||t>=this.width||e>=this.height?Number.NaN:this.area[t+e*this.width]}inc(t,e,n){t<0||e<0||t>=this.width||e>=this.height||(this.area[t+e*this.width]+=n)}set(t,e,n){t<0||e<0||t>=this.width||e>=this.height||(this.area[t+e*this.width]=n)}incArea(t,e){if(t.width<=0||t.height<=0||e===0)return;const n=this.width,i=t.width,a=Math.max(0,t.i),s=Math.max(0,t.j),o=Math.min(t.i+t.width,n),l=Math.min(t.j+t.height,this.height);if(!(l<=0||o<=0||a>=n||l>=this.height))for(let c=s;c<l;c++){const u=(c-t.j)*i,h=c*n;for(let d=a;d<o;d++){const f=t.area[d-t.i+u];f!==0&&(this.area[d+h]+=e*f)}}}fill(t){this.area.fill(t)}fillArea(t,e){const n=t.x+t.y*this.width;for(let i=0;i<t.height;i++){const a=n+i*this.width;this.area.fill(e,a,a+t.width)}}fillHorizontalLine(t,e,n,i){const a=t+e*this.width;this.area.fill(i,a,a+n)}fillVerticalLine(t,e,n,i){const a=t+e*this.width;for(let s=0;s<n;s++)this.area[a+s*this.width]=i}clear(){this.area.fill(0)}toString(){let t="";for(let e=0;e<this.height;e++){const n=e*this.width;for(let i=0;i<this.width;i++){const a=this.area[n+i];t+=a.toFixed(1).padStart(6),t+=" "}t+=`
`}return t}draw(t,e=!0){if(this.width<=0||this.height<=0)return;t.save(),e&&t.translate(this.pixelX,this.pixelY);const n=this.area.reduce((s,o)=>Math.min(s,o),Number.POSITIVE_INFINITY),i=this.area.reduce((s,o)=>Math.max(s,o),Number.NEGATIVE_INFINITY),a=s=>(s-n)/(i-n);t.scale(this.pixelGroup,this.pixelGroup);for(let s=0;s<this.width;s++)for(let o=0;o<this.height;o++){const l=this.area[s+o*this.width];t.fillStyle=`rgba(0, 0, 0, ${a(l)})`,t.fillRect(s,o,1,1)}t.restore()}drawThreshold(t,e,n=!0){if(!(this.width<=0||this.height<=0)){t.save(),n&&t.translate(this.pixelX,this.pixelY),t.scale(this.pixelGroup,this.pixelGroup);for(let i=0;i<this.width;i++)for(let a=0;a<this.height;a++){const s=this.area[i+a*this.width];t.fillStyle=s>e?"black":"white",t.fillRect(i,a,1,1)}t.restore()}}}function xC(r,t){const e=n=>({x:n.x-t,y:n.y-t,width:n.width+2*t,height:n.height+2*t});return Array.isArray(r)?r.map(e):e(r)}function LM(r,t,e){return wC(Object.assign(yC(r),{distSquare:(n,i)=>gb(r.x1,r.y1,r.x2,r.y2,n,i)}),t,e)}function wC(r,t,e){const n=xC(r,e),i=t.scale(n),a=t.createSub(i,n);return C7(a,t,e,(s,o)=>r.distSquare(s,o)),a}function C7(r,t,e,n){const i=e*e;for(let a=0;a<r.height;a++)for(let s=0;s<r.width;s++){const o=t.invertScaleX(r.i+s),l=t.invertScaleY(r.j+a),c=n(o,l);if(c===0){r.set(s,a,i);continue}if(c<i){const u=e-Math.sqrt(c);r.set(s,a,u*u)}}return r}function R7(r,t,e){const n=t.scale(r),i=t.addPadding(n,e),a=t.createSub(i,{x:r.x-e,y:r.y-e}),s=n.x-i.x,o=n.y-i.y,l=i.x2-n.x2,c=i.y2-n.y2,u=i.width-s-l,h=i.height-o-c,d=e*e;a.fillArea({x:s,y:o,width:u+1,height:h+1},d);const f=[0],g=Math.max(o,s,l,c);{const m=t.invertScaleX(n.x+n.width/2);for(let x=1;x<g;x++){const E=t.invertScaleY(n.y-x),_=r.distSquare(m,E);if(_<d){const M=e-Math.sqrt(_);f.push(M*M)}else break}}const v=[],p=Math.max(s,l),y=Math.max(o,l);for(let m=1;m<p;m++){const x=t.invertScaleX(n.x-m),E=[];for(let _=1;_<y;_++){const M=t.invertScaleY(n.y-_),O=r.distSquare(x,M);if(O<d){const T=e-Math.sqrt(O);E.push(T*T)}else E.push(0)}v.push(E)}for(let m=1;m<Math.min(o,f.length);m++){const x=f[m];a.fillHorizontalLine(s,o-m,u+1,x)}for(let m=1;m<Math.min(c,f.length);m++){const x=f[m];a.fillHorizontalLine(s,o+h+m,u+1,x)}for(let m=1;m<Math.min(s,f.length);m++){const x=f[m];a.fillVerticalLine(s-m,o,h+1,x)}for(let m=1;m<Math.min(c,f.length);m++){const x=f[m];a.fillVerticalLine(s+u+m,o,h+1,x)}for(let m=1;m<s;m++){const x=v[m-1],E=s-m;for(let _=1;_<o;_++)a.set(E,o-_,x[_-1]);for(let _=1;_<c;_++)a.set(E,o+h+_,x[_-1])}for(let m=1;m<l;m++){const x=v[m-1],E=s+u+m;for(let _=1;_<o;_++)a.set(E,o-_,x[_-1]);for(let _=1;_<c;_++)a.set(E,o+h+_,x[_-1])}return a}function Te(r,t){return{x:r,y:t}}function L7(r,t,e,n){if(r.length===0)return[];const i=z7(r);return i.map((a,s)=>{const o=i.slice(0,s);return I7(t,a,o,e,n)}).flat()}function I7(r,t,e,n,i){const a=Te(t.cx,t.cy),s=B7(a,e,r);if(s==null)return[];const o=new xn(a.x,a.y,s.cx,s.cy),l=D7(o,r,n,i);return F7(l,r)}function D7(r,t,e,n){const i=[],a=[];a.push(r);let s=!0;for(let o=0;o<e&&s;o++)for(s=!1;!s&&a.length>0;){const l=a.pop(),c=EC(t,l),u=c?N7(l,c):null;if(!c||!u||u.count!==2){s||i.push(l);continue}let h=n,d=Mc(c,h,u,!0),f=Ui(d,a)||Ui(d,i),g=kc(d,t);for(;!f&&g&&h>=1;)h/=1.5,d=Mc(c,h,u,!0),f=Ui(d,a)||Ui(d,i),g=kc(d,t);if(d&&!f&&!g&&(a.push(new xn(l.x1,l.y1,d.x,d.y)),a.push(new xn(d.x,d.y,l.x2,l.y2)),s=!0),s)continue;h=n,d=Mc(c,h,u,!1);let v=Ui(d,a)||Ui(d,i);for(g=kc(d,t);!v&&g&&h>=1;)h/=1.5,d=Mc(c,h,u,!1),v=Ui(d,a)||Ui(d,i),g=kc(d,t);d&&!v&&(a.push(new xn(l.x1,l.y1,d.x,d.y)),a.push(new xn(d.x,d.y,l.x2,l.y2)),s=!0),s||i.push(l)}for(;a.length>0;)i.push(a.pop());return i}function F7(r,t){const e=[];for(;r.length>0;){const n=r.pop();if(r.length===0){e.push(n);break}const i=r.pop(),a=new xn(n.x1,n.y1,i.x2,i.y2);EC(t,a)?(e.push(n),r.push(i)):r.push(a)}return e}function B7(r,t,e){let n=Number.POSITIVE_INFINITY;return t.reduce((i,a)=>{const s=sa(r.x,r.y,a.cx,a.cy);if(s>n)return i;const o=new xn(r.x,r.y,a.cx,a.cy),l=j7(e,o);return s*(l+1)*(l+1)<n&&(i=a,n=s*(l+1)*(l+1)),i},null)}function z7(r){if(r.length<2)return r;let t=0,e=0;return r.forEach(n=>{t+=n.cx,e+=n.cy}),t/=r.length,e/=r.length,r.map(n=>{const i=t-n.cx,a=e-n.cy,s=i*i+a*a;return[n,s]}).sort((n,i)=>n[1]-i[1]).map(n=>n[0])}function kc(r,t){return t.some(e=>e.containsPt(r.x,r.y))}function Ui(r,t){return t.some(e=>!!(RM(e.x1,e.y1,r.x,r.y,.001)||RM(e.x2,e.y2,r.x,r.y,.001)))}function EC(r,t){let e=Number.POSITIVE_INFINITY,n=null;for(const i of r){if(!bC(i,t))continue;const a=A7(i,t);a>=0&&a<e&&(n=i,e=a)}return n}function j7(r,t){return r.reduce((e,n)=>bC(n,t)&&O7(n,t)?e+1:e,0)}function Mc(r,t,e,n){const i=e.top,a=e.left,s=e.bottom,o=e.right;if(n){if(a.state===We.POINT){if(i.state===We.POINT)return Te(r.x-t,r.y-t);if(s.state===We.POINT)return Te(r.x-t,r.y2+t);const d=r.width*r.height;return r.width*((a.y-r.y+(o.y-r.y))*.5)<d*.5?a.y>o.y?Te(r.x-t,r.y-t):Te(r.x2+t,r.y-t):a.y<o.y?Te(r.x-t,r.y2+t):Te(r.x2+t,r.y2+t)}if(o.state===We.POINT){if(i.state===We.POINT)return Te(r.x2+t,r.y-t);if(s.state===We.POINT)return Te(r.x2+t,r.y2+t)}const u=r.height*r.width;return r.height*((i.x-r.x+(o.x-r.x))*.5)<u*.5?i.x>s.x?Te(r.x-t,r.y-t):Te(r.x-t,r.y2+t):i.x<s.x?Te(r.x2+t,r.y-t):Te(r.x2+t,r.y2+t)}if(a.state===We.POINT){if(i.state===We.POINT)return Te(r.x2+t,r.y2+t);if(s.state===We.POINT)return Te(r.x2+t,r.y-t);const u=r.height*r.width;return r.width*((a.y-r.y+(o.y-r.y))*.5)<u*.5?a.y>o.y?Te(r.x2+t,r.y2+t):Te(r.x-t,r.y2+t):a.y<o.y?Te(r.x2+t,r.y-t):Te(r.x-t,r.y-t)}if(o.state===We.POINT){if(i.state===We.POINT)return Te(r.x-t,r.y2+t);if(s.state===We.POINT)return Te(r.x-t,r.y-t)}const l=r.height*r.width;return r.height*((i.x-r.x+(o.x-r.x))*.5)<l*.5?i.x>s.x?Te(r.x2+t,r.y2+t):Te(r.x2+t,r.y-t):i.x<s.x?Te(r.x-t,r.y2+t):Te(r.x-t,r.y-t)}function q7(r,t,e,n){if(!(r.closed?e<r.length:e<r.length-1))return!1;const a=r.get(t),s=r.get(e+1);for(let o=t+1;o<=e;o++){const l=r.get(o);if(gb(a.x,a.y,s.x,s.y,l.x,l.y)>n)return!1}return!0}function G7(r=0){return t=>{if(r<0||t.length<3)return t;const e=[];let n=0;const i=r*r;for(;n<t.length;){let a=n+1;for(;q7(t,n,a,i);)a++;e.push(t.get(n)),n=a}return new ro(e)}}function $7(r,t){switch(r){case-2:return(((-t+3)*t-3)*t+1)/6;case-1:return((3*t-6)*t*t+4)/6;case 0:return(((-3*t+3)*t+3)*t+1)/6;case 1:return t*t*t/6;default:throw new Error("unknown error")}}function W7(r=6){function a(s,o,l){let c=0,u=0;for(let h=-2;h<=1;h++){const d=s.get(o+h),f=$7(h,l);c+=f*d.x,u+=f*d.y}return{x:c,y:u}}return s=>{if(s.length<3)return s;const o=[],l=s.closed,c=s.length+3-1+(l?0:2);o.push(a(s,2-(l?0:2),0));for(let u=2-(l?0:2);u<c;u++)for(let h=1;h<=r;h++)o.push(a(s,u,h/r));return new ro(o)}}function V7(r=8){return t=>{let e=r,n=t.length;if(e>1)for(n=Math.floor(t.length/e);n<3&&e>1;)e-=1,n=Math.floor(t.length/e);const i=[];for(let a=0,s=0;s<n;s++,a+=e)i.push(t.get(a));return new ro(i)}}class ro{constructor(t=[],e=!0){this.points=t,this.closed=e}get(t){const e=t,n=this.points.length;return t<0?this.closed?this.get(t+n):this.points[0]:t>=n?this.closed?this.get(t-n):this.points[n-1]:this.points[e]}get length(){return this.points.length}toString(t=1/0){const e=this.points;if(e.length===0)return"";const n=typeof t=="function"?t:T7(t);let i="M";for(const a of e)i+=`${n(a.x)},${n(a.y)} L`;return i=i.slice(0,-1),this.closed&&(i+=" Z"),i}draw(t){const e=this.points;if(e.length!==0){t.beginPath(),t.moveTo(e[0].x,e[0].y);for(const n of e)t.lineTo(n.x,n.y);this.closed&&t.closePath()}}sample(t){return V7(t)(this)}simplify(t){return G7(t)(this)}bSplines(t){return W7(t)(this)}apply(t){return t(this)}containsElements(t){const e=P7(this.points);return e?t.every(n=>e.containsPt(n.cx,n.cy)&&this.withinArea(n.cx,n.cy)):!1}withinArea(t,e){if(this.length===0)return!1;let n=0;const i=this.points[0],a=new xn(i.x,i.y,i.x,i.y);for(let s=1;s<this.points.length;s++){const o=this.points[s];a.x1=a.x2,a.y1=a.y2,a.x2=o.x,a.y2=o.y,a.cuts(t,e)&&n++}return a.x1=a.x2,a.y1=a.y2,a.x2=i.x,a.y2=i.y,a.cuts(t,e)&&n++,n%2===1}}class U7{constructor(t=0){this.count=0,this.arr=[],this.set=new Set,this.arr.length=t}add(t){this.set.add(`${t.x}x${t.y}`),this.arr[this.count++]=t}contains(t){return this.set.has(`${t.x}x${t.y}`)}isFirst(t){if(this.count===0)return!1;const e=this.arr[0];return e!=null&&e.x===t.x&&e.y===t.y}path(){return new ro(this.arr.slice(0,this.count))}clear(){this.set.clear(),this.count=0}get(t){return this.arr[t]}get length(){return this.count}}const yo=0,Tc=1,Oc=2,Ry=3;function Y7(r,t){const e=(Math.floor(r.width)+Math.floor(r.height))*2,n=new U7(e);function i(l,c,u,h){const d=r.get(l,c);return Number.isNaN(d)?Number.NaN:d>t?u+h:u}function a(l,c){let u=yo;return u=i(l,c,u,1),u=i(l+1,c,u,2),u=i(l,c+1,u,4),u=i(l+1,c+1,u,8),Number.isNaN(u)?-1:u}let s=Tc;function o(l,c){let u=l,h=c,d=r.invertScaleX(u),f=r.invertScaleY(h);for(let g=0;g<r.width*r.height;g++){const v={x:d,y:f};if(n.contains(v)){if(n.isFirst(v))return!0}else n.add(v);const p=a(u,h);switch(p){case-1:return!0;case 0:case 3:case 2:case 7:s=Oc;break;case 12:case 14:case 4:s=Ry;break;case 6:s=s===yo?Ry:Oc;break;case 1:case 13:case 5:s=yo;break;case 9:s=s===Oc?yo:Tc;break;case 10:case 8:case 11:s=Tc;break;default:return console.warn("Marching squares invalid state: "+p),!0}switch(s){case yo:h--,f-=r.pixelGroup;break;case Tc:h++,f+=r.pixelGroup;break;case Ry:u--,d-=r.pixelGroup;break;case Oc:u++,d+=r.pixelGroup;break;default:return console.warn("Marching squares invalid state: "+p),!0}}return!0}for(let l=0;l<r.width;l++)for(let c=0;c<r.height;c++){if(r.get(l,c)<=t)continue;const u=a(l,c);if(!(u<0||u===15)&&o(l,c))return n.path()}return null}const Ch={maxRoutingIterations:100,maxMarchingIterations:20,pixelGroup:4,edgeR0:10,edgeR1:20,nodeR0:15,nodeR1:50,morphBuffer:10,threshold:1,memberInfluenceFactor:1,edgeInfluenceFactor:1,nonMemberInfluenceFactor:-.8,virtualEdges:!0};function Fo(r){return r!=null&&typeof r.radius=="number"}function IM(r,t){if(Fo(r)!==Fo(t))return!1;if(Fo(r)){const n=t;return r.cx===n.cx&&r.cy===n.cy&&r.radius===n.radius}const e=t;return r.x===e.x&&r.y===e.y&&r.width===e.width&&r.height===e.height}var qr;(function(r){r[r.MEMBERS=0]="MEMBERS",r[r.NON_MEMBERS=1]="NON_MEMBERS",r[r.EDGES=2]="EDGES"})(qr||(qr={}));let DM=class{constructor(t={}){this.dirty=new Set,this.members=[],this.nonMembers=[],this.virtualEdges=[],this.edges=[],this.activeRegion=new Dn(0,0,0,0),this.potentialArea=new Va(1,0,0,0,0,0,0),this.o=Object.assign({},Ch,t)}pushMember(...t){if(t.length!==0){this.dirty.add(qr.MEMBERS);for(const e of t)this.members.push({raw:e,obj:Fo(e)?_u.from(e):Dn.from(e),area:null})}}removeMember(t){const e=this.members.findIndex(n=>IM(n.raw,t));return e<0?!1:(this.members.splice(e,1),this.dirty.add(qr.MEMBERS),!0)}removeNonMember(t){const e=this.nonMembers.findIndex(n=>IM(n.raw,t));return e<0?!1:(this.nonMembers.splice(e,1),this.dirty.add(qr.NON_MEMBERS),!0)}removeEdge(t){const e=this.edges.findIndex(n=>n.obj.equals(t));return e<0?!1:(this.edges.splice(e,1),this.dirty.add(qr.NON_MEMBERS),!0)}pushNonMember(...t){if(t.length!==0){this.dirty.add(qr.NON_MEMBERS);for(const e of t)this.nonMembers.push({raw:e,obj:Fo(e)?_u.from(e):Dn.from(e),area:null})}}pushEdge(...t){if(t.length!==0){this.dirty.add(qr.EDGES);for(const e of t)this.edges.push({raw:e,obj:xn.from(e),area:null})}}update(){const t=this.dirty.has(qr.MEMBERS),e=this.dirty.has(qr.NON_MEMBERS);let n=this.dirty.has(qr.EDGES);this.dirty.clear();const i=this.members.map(c=>c.obj);if(this.o.virtualEdges&&(t||e)){const c=this.nonMembers.map(d=>d.obj),u=L7(i,c,this.o.maxRoutingIterations,this.o.morphBuffer),h=new Map(this.virtualEdges.map(d=>[d.obj.toString(),d.area]));this.virtualEdges=u.map(d=>{var f;return{raw:d,obj:d,area:(f=h.get(d.toString()))!==null&&f!==void 0?f:null}}),n=!0}let a=!1;if(t||n){const c=this.virtualEdges.concat(this.edges).map(f=>f.obj),u=X7(i,c),h=Math.max(this.o.edgeR1,this.o.nodeR1)+this.o.morphBuffer,d=Dn.from(xC(u,h));d.equals(this.activeRegion)||(a=!0,this.activeRegion=d)}if(a){const c=Math.ceil(this.activeRegion.width/this.o.pixelGroup),u=Math.ceil(this.activeRegion.height/this.o.pixelGroup);this.activeRegion.x!==this.potentialArea.pixelX||this.activeRegion.y!==this.potentialArea.pixelY?(this.potentialArea=Va.fromPixelRegion(this.activeRegion,this.o.pixelGroup),this.members.forEach(h=>h.area=null),this.nonMembers.forEach(h=>h.area=null),this.edges.forEach(h=>h.area=null),this.virtualEdges.forEach(h=>h.area=null)):(c!==this.potentialArea.width||u!==this.potentialArea.height)&&(this.potentialArea=Va.fromPixelRegion(this.activeRegion,this.o.pixelGroup))}const s=new Map,o=c=>{if(c.area){const u=`${c.obj.width}x${c.obj.height}x${c.obj instanceof Dn?"R":"C"}`;s.set(u,c.area)}},l=c=>{if(c.area)return;const u=`${c.obj.width}x${c.obj.height}x${c.obj instanceof Dn?"R":"C"}`;if(s.has(u)){const d=s.get(u);c.area=this.potentialArea.copy(d,{x:c.obj.x-this.o.nodeR1,y:c.obj.y-this.o.nodeR1});return}const h=c.obj instanceof Dn?R7(c.obj,this.potentialArea,this.o.nodeR1):wC(c.obj,this.potentialArea,this.o.nodeR1);c.area=h,s.set(u,h)};this.members.forEach(o),this.nonMembers.forEach(o),this.members.forEach(l),this.nonMembers.forEach(c=>{this.activeRegion.intersects(c.obj)?l(c):c.area=null}),this.edges.forEach(c=>{c.area||(c.area=LM(c.obj,this.potentialArea,this.o.edgeR1))}),this.virtualEdges.forEach(c=>{c.area||(c.area=LM(c.obj,this.potentialArea,this.o.edgeR1))})}drawMembers(t){for(const e of this.members)e.obj.draw(t)}drawNonMembers(t){for(const e of this.nonMembers)e.obj.draw(t)}drawEdges(t){for(const e of this.edges)e.obj.draw(t)}drawPotentialArea(t,e=!0){this.potentialArea.draw(t,e)}compute(){if(this.members.length===0)return new ro([]);this.dirty.size>0&&this.update();const{o:t,potentialArea:e}=this,n=this.members.map(o=>o.area),i=this.virtualEdges.concat(this.edges).map(o=>o.area),a=this.nonMembers.filter(o=>o.area!=null).map(o=>o.area),s=this.members.map(o=>o.obj);return H7(e,n,i,a,o=>o.containsElements(s),t)}};function H7(r,t,e,n,i,a={}){const s=Object.assign({},Ch,a);let o=s.threshold,l=s.memberInfluenceFactor,c=s.edgeInfluenceFactor,u=s.nonMemberInfluenceFactor;const h=(s.nodeR0-s.nodeR1)*(s.nodeR0-s.nodeR1),d=(s.edgeR0-s.edgeR1)*(s.edgeR0-s.edgeR1);for(let f=0;f<s.maxMarchingIterations;f++){if(r.clear(),l!==0){const v=l/h;for(const p of t)r.incArea(p,v)}if(c!==0){const v=c/d;for(const p of e)r.incArea(p,v)}if(u!==0){const v=u/h;for(const p of n)r.incArea(p,v)}const g=Y7(r,o);if(g&&i(g))return g;if(o*=.95,f<=s.maxMarchingIterations*.5)l*=1.2,c*=1.2;else if(u!==0&&n.length>0)u*=.8;else break}return new ro([])}function X7(r,t){if(r.length===0)return new Dn(0,0,0,0);const e=Dn.from(r[0]);for(const n of r)e.add(n);for(const n of t)e.add(yC(n));return e}var K7=function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(e[n[i]]=r[n[i]]);return e};class Rh extends En{constructor(t,e){super(t,An({},Rh.defaultOptions,e)),this.members=new Map,this.avoidMembers=new Map,this.bubbleSetOptions={},this.drawBubbleSets=()=>{const{style:n,bubbleSetOptions:i}=this.parseOptions();Ge(this.bubbleSetOptions,i)||this.init(),this.bubbleSetOptions=Object.assign({},i);const a=Object.assign(Object.assign({},n),{d:this.getPath()});this.shape?this.shape.update(a):(this.shape=new gl({style:a}),this.context.canvas.appendChild(this.shape))},this.updateBubbleSetsPath=n=>{if(!this.shape)return;const i=K(n.data);[...this.options.members,...this.options.avoidMembers].includes(i)&&this.shape.update(Object.assign(Object.assign({},this.parseOptions().style),{d:this.getPath(i)}))},this.getPath=n=>{const{graph:i}=this.context,a=this.options.members,s=[...this.members.keys()],o=this.options.avoidMembers,l=[...this.avoidMembers.keys()];if(!n&&Ge(a,s)&&Ge(o,l))return this.path;const{enter:c=[],exit:u=[]}=ca(s,a,p=>p),{enter:h=[],exit:d=[]}=ca(l,o,p=>p);n&&(u.push(n),c.push(n));const f=(p,y,m)=>{p.forEach(x=>{const E=m?this.members:this.avoidMembers,_=m?"pushMember":"pushNonMember",M=m?"removeMember":"removeNonMember";if(y){let O;i.getElementType(x)==="edge"?([O]=J7(i,x),this.bubbleSets.pushEdge(O)):([O]=Z7(i,x),this.bubbleSets[_](O)),E.set(x,O)}else{const O=E.get(x);O&&(i.getElementType(x)==="edge"?this.bubbleSets.removeEdge(O):this.bubbleSets[M](O),E.delete(x))}})};f(u,!1,!0),f(c,!0,!0),f(d,!1,!1),f(h,!0,!1);const v=this.bubbleSets.compute().sample(8).simplify(0).bSplines().simplify(0);return this.path=aN(v.points.map(On)),this.path},this.bindEvents(),this.bubbleSets=new DM(this.options)}bindEvents(){this.context.graph.on(ft.AFTER_RENDER,this.drawBubbleSets),this.context.graph.on(ft.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath)}init(){this.bubbleSets=new DM(this.options),this.members=new Map,this.avoidMembers=new Map}parseOptions(){const t=this.options,{type:e,key:n,members:i,avoidMembers:a}=t,s=K7(t,["type","key","members","avoidMembers"]),o=Object.keys(s).reduce((l,c)=>(c in Ch?l.bubbleSetOptions[c]=s[c]:l.style[c]=s[c],l),{style:{},bubbleSetOptions:{}});return Object.assign({type:e,key:n,members:i,avoidMembers:a},o)}addMember(t){const e=Array.isArray(t)?t:[t];e.some(n=>this.options.avoidMembers.includes(n))&&(this.options.avoidMembers=this.options.avoidMembers.filter(n=>!e.includes(n))),this.options.members=[...new Set([...this.options.members,...e])],this.drawBubbleSets()}removeMember(t){const e=Array.isArray(t)?t:[t];this.options.members=this.options.members.filter(n=>!e.includes(n)),this.drawBubbleSets()}updateMember(t){this.options.members=Tt(t)?t(this.options.members):t,this.drawBubbleSets()}getMember(){return this.options.members}addAvoidMember(t){const e=Array.isArray(t)?t:[t];e.some(n=>this.options.members.includes(n))&&(this.options.members=this.options.members.filter(n=>!e.includes(n))),this.options.avoidMembers=[...new Set([...this.options.avoidMembers,...e])],this.drawBubbleSets()}removeAvoidMember(t){const e=Array.isArray(t)?t:[t];this.options.avoidMembers.some(n=>e.includes(n))&&(this.options.avoidMembers=this.options.avoidMembers.filter(n=>!e.includes(n)),this.drawBubbleSets())}updateAvoidMember(t){this.options.avoidMembers=Array.isArray(t)?t:[t],this.drawBubbleSets()}getAvoidMember(){return this.options.avoidMembers}destroy(){this.context.graph.off(ft.AFTER_RENDER,this.drawBubbleSets),this.context.graph.off(ft.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath),this.shape.destroy(),super.destroy()}}Rh.defaultOptions=Object.assign({members:[],avoidMembers:[],fill:"lightblue",fillOpacity:.2,stroke:"blue",strokeOpacity:.2},Ch);const Z7=(r,t)=>(Array.isArray(t)?t:[t]).map(n=>{const i=r.getElementRenderBounds(n);return new Dn(i.min[0],i.min[1],Ei(i),Si(i))}),J7=(r,t)=>(Array.isArray(t)?t:[t]).map(n=>{const i=r.getEdgeData(n),a=r.getElementPosition(i.source),s=r.getElementPosition(i.target);return xn.from({x1:a[0],y1:a[1],x2:s[0],y2:s[1]})});function Q7(r){return`
    <ul class="g6-contextmenu-ul">
      ${r.map(t=>`<li  class="g6-contextmenu-li" value="${t.value}">${t.name}</li>`).join("")}
    </ul>
  `}const tV=`
  .g6-contextmenu {
    font-size: 12px;
    background-color: rgba(255, 255, 255, 0.96);
    border-radius: 4px;
    overflow: hidden;
    box-shadow: rgba(0, 0, 0, 0.12) 0px 6px 12px 0px;
    transition: visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1) 0s, left 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s, top 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s;
  }

  .g6-contextmenu-ul {
    max-width: 256px;
    min-width: 96px;
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .g6-contextmenu-li {
    padding: 8px 12px;
    cursor: pointer;
    user-select: none;
  }

  .g6-contextmenu-li:hover {
    background-color: #f5f5f5;
    cursor: pointer;
  }
`;var FM=function(r,t,e,n){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((n=n.apply(r,t||[])).next())})};class Lh extends En{constructor(t,e){super(t,Object.assign({},Lh.defaultOptions,e)),this.targetElement=null,this.onTriggerEvent=n=>{var i;(i=n.preventDefault)===null||i===void 0||i.call(n),this.show(n)},this.onMenuItemClick=n=>{const{onClick:i,trigger:a}=this.options;if(n.target instanceof HTMLElement&&n.target.className.includes("g6-contextmenu-li")){const s=n.target.getAttribute("value");i==null||i(s,n.target,this.targetElement),this.hide()}a!=="click"&&this.hide()},this.initElement(),this.update(e)}initElement(){this.$element=no("contextmenu",!1,{zIndex:"99"});const{className:t}=this.options;t&&this.$element.classList.add(t),this.context.canvas.getContainer().appendChild(this.$element),Ym("g6-contextmenu-css","style",{},tV,document.head)}show(t){return FM(this,void 0,void 0,function*(){const{enable:e,offset:n}=this.options;if(typeof e=="function"&&!e(t)||!e){this.hide();return}const i=yield this.getDOMContent(t);i instanceof HTMLElement?(this.$element.innerHTML="",this.$element.appendChild(i)):this.$element.innerHTML=i;const a=this.context.graph.getCanvas().getContainer().getBoundingClientRect();this.$element.style.left=`${t.client.x-a.left+n[0]}px`,this.$element.style.top=`${t.client.y-a.top+n[1]}px`,this.$element.style.display="block",this.targetElement=t.target})}hide(){this.$element.style.display="none",this.targetElement=null}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy(),this.$element.remove()}getDOMContent(t){return FM(this,void 0,void 0,function*(){const{getContent:e,getItems:n}=this.options;return n?Q7(yield n(t)):yield e(t)})}bindEvents(){const{graph:t}=this.context,{trigger:e}=this.options;t.on(`canvas:${e}`,this.onTriggerEvent),t.on(`node:${e}`,this.onTriggerEvent),t.on(`edge:${e}`,this.onTriggerEvent),t.on(`combo:${e}`,this.onTriggerEvent),document.addEventListener("click",this.onMenuItemClick)}unbindEvents(){const{graph:t}=this.context,{trigger:e}=this.options;t.off(`canvas:${e}`,this.onTriggerEvent),t.off(`node:${e}`,this.onTriggerEvent),t.off(`edge:${e}`,this.onTriggerEvent),t.off(`combo:${e}`,this.onTriggerEvent),document.removeEventListener("click",this.onMenuItemClick)}}Lh.defaultOptions={trigger:"contextmenu",offset:[4,4],loadingContent:'<div class="g6-contextmenu-loading">Loading...</div>',getContent:()=>"It is a empty context menu.",enable:()=>!0};class Ih extends En{constructor(t,e){super(t,Object.assign({},Ih.defaultOptions,e)),this.edgeBundles={},this.edgePoints={},this.onBundle=()=>{const{model:n,element:i}=this.context,a=n.getEdgeData();this.divideEdges(this.options.divisions);const{cycles:s,iterRate:o,divRate:l}=this.options;let{lambda:c,divisions:u,iterations:h}=this.options;for(let d=0;d<s;d++){for(let f=0;f<h;f++){const g={};a.forEach(v=>{var p;if(v.source===v.target)return;const y=K(v);g[y]=this.getEdgeForces(v,u,c);for(let m=0;m<u+1;m++)(p=this.edgePoints)[y]||(p[y]=[]),this.edgePoints[y][m]=qt(this.edgePoints[y][m],g[y][m])})}c/=2,u*=l,h*=o,this.divideEdges(u)}a.forEach(d=>{const f=K(d),g=i.getElement(f);g==null||g.update({d:z1(this.edgePoints[f])})})},this.bindEvents()}get nodeMap(){const t=this.context.model.getNodeData();return Object.fromEntries(t.map(e=>[K(e),Ja(dn(e))]))}divideEdges(t){this.context.model.getEdgeData().forEach(n=>{var i;const a=K(n);(i=this.edgePoints)[a]||(i[a]=[]);const s=this.nodeMap[n.source],o=this.nodeMap[n.target];if(t===1)this.edgePoints[a].push(s),this.edgePoints[a].push(Xr(qt(s,o),2)),this.edgePoints[a].push(o);else{const c=(this.edgePoints[a].length===0?Ee(s,o):aV(this.edgePoints[a]))/(t+1);let u=c;const h=[s];for(let d=1;d<this.edgePoints[a].length;d++){const f=this.edgePoints[a][d-1],g=this.edgePoints[a][d];let v=Ee(g,f);for(;v>u;){const p=u/v,y=qt(f,Wr(fe(g,f),p));h.push(y),v-=u,u=c}u-=v}h.push(o),this.edgePoints[a]=h}})}getVectorPosition(t){const e=this.nodeMap[t.source],n=this.nodeMap[t.target],[i,a]=fe(n,e),s=Ee(e,n);return{source:e,target:n,vx:i,vy:a,length:s}}measureEdgeCompatibility(t,e){const n=this.getVectorPosition(t),i=this.getVectorPosition(e),a=eV(n,i),s=nV(n,i),o=rV(n,i),l=iV(n,i);return a*s*o*l}getEdgeBundles(){const t={},e=this.options.bundleThreshold,n=this.context.model.getEdgeData();return n.forEach((i,a)=>{n.forEach((s,o)=>{var l,c;if(o<=a)return;this.measureEdgeCompatibility(i,s)>=e&&(t[l=K(i)]||(t[l]=[]),t[K(i)].push(s),t[c=K(s)]||(t[c]=[]),t[K(s)].push(i))})}),t}getSpringForce(t,e){const{pre:n,cur:i,next:a}=t;return Wr(fe(qt(n,a),Wr(i,2)),e)}getElectrostaticForce(t,e){ui(this.edgeBundles)&&(this.edgeBundles=this.getEdgeBundles());const n=this.edgeBundles[K(e)];let i=[0,0];return n==null||n.forEach(a=>{const s=this.edgePoints[K(a)][t],o=this.edgePoints[K(e)][t],l=fe(s,o),c=Ee(s,o);i=qt(i,Wr(l,1/c))}),i}getEdgeForces(t,e,n){const i=this.nodeMap[t.source],a=this.nodeMap[t.target],s=this.options.K/(Ee(i,a)*(e+1)),o=[[0,0]],l=K(t);for(let c=1;c<e;c++){const u=this.getSpringForce({pre:this.edgePoints[l][c-1],cur:this.edgePoints[l][c],next:this.edgePoints[l][c+1]||[0,0]},s),h=this.getElectrostaticForce(c,t);o.push(Wr(qt(u,h),n))}return o.push([0,0]),o}bindEvents(){const{graph:t}=this.context;t.on(ft.AFTER_RENDER,this.onBundle)}unbindEvents(){const{graph:t}=this.context;t.off(ft.AFTER_RENDER,this.onBundle)}destroy(){this.unbindEvents(),super.destroy()}}Ih.defaultOptions={K:.1,lambda:.1,divisions:1,divRate:2,cycles:6,iterations:90,iterRate:2/3,bundleThreshold:.6};const eV=(r,t)=>Math.abs(o5([r.vx,r.vy],[t.vx,t.vy])/(r.length*t.length)),nV=(r,t)=>{const e=(r.length+t.length)/2;return 2/(e/Math.min(r.length,t.length)+Math.max(r.length,t.length)/e)},rV=(r,t)=>{const e=(r.length+t.length)/2,n=Xr(qt(r.source,r.target),2),i=Xr(qt(t.source,t.target),2);return e/(e+Ee(n,i))},BM=(r,t)=>{if(t.source[0]===t.target[0])return[t.source[0],r[1]];if(t.source[1]===t.target[1])return[r[0],t.source[1]];const e=(t.source[1]-t.target[1])/(t.source[0]-t.target[0]),n=(e*e*t.source[0]+e*(r[1]-t.source[1])+r[0])/(e*e+1),i=e*(n-t.source[0])+t.source[1];return[n,i]},zM=(r,t)=>{const e=BM(t.source,r),n=BM(t.target,r),i=Xr(qt(e,n),2),a=Xr(qt(r.source,r.target),2);return Ee(e,n)===0?0:Math.max(0,1-2*Ee(a,i)/Ee(e,n))},iV=(r,t)=>Math.min(zM(r,t),zM(t,r)),aV=r=>{let t=0;for(let e=1;e<r.length;e++)t+=Ee(r[e],r[e-1]);return t},sV={fill:"#fff",fillOpacity:1,lineWidth:1,stroke:"#000",strokeOpacity:.8,zIndex:-1/0},jM=.05;class Dh extends En{constructor(t,e){super(t,Object.assign({},Dh.defaultOptions,e)),this.shapes=new Map,this.r=this.options.r,this.onEdgeFilter=n=>{if(this.options.trigger==="drag"&&this.isLensOn)return;const i=On(n.canvas);this.renderLens(i),this.renderFocusElements()},this.renderLens=n=>{const i=Object.assign({},sV,this.options.style);this.isLensOn||(this.lens=new vl({style:i}),this.canvas.appendChild(this.lens)),Object.assign(i,Vr(n),{size:this.r*2}),this.lens.update(i)},this.getFilterData=()=>{const{filter:n}=this.options,{model:i}=this.context,a=i.getData();if(!n)return a;const{nodes:s,edges:o,combos:l}=a;return{nodes:s.filter(c=>n(K(c),"node")),edges:o.filter(c=>n(K(c),"edge")),combos:l.filter(c=>n(K(c),"combo"))}},this.getFocusElements=n=>{const{nodes:i,edges:a}=this.getFilterData(),s=i.filter(c=>Ee(dn(c),n)<this.r),o=s.map(c=>K(c)),l=a.filter(c=>{const{source:u,target:h}=c,d=o.includes(u),f=o.includes(h);switch(this.options.nodeType){case"both":return d&&f;case"either":return d!==f;case"source":return d&&!f;case"target":return!d&&f;default:return!1}});return{nodes:s,edges:l}},this.renderFocusElements=()=>{const{element:n,graph:i}=this.context;if(!this.isLensOn)return;const a=this.lens.getCenter(),{nodes:s,edges:o}=this.getFocusElements(a),l=new Set,c=u=>{const h=K(u);l.add(h);const d=n.getElement(h);if(!d)return;const f=this.shapes.get(h)||d.cloneNode();f.setPosition(d.getPosition()),f.id=d.id,this.shapes.has(h)?Object.entries(d.attributes).forEach(([p,y])=>{f.style[p]!==y&&(f.style[p]=y)}):(this.canvas.appendChild(f),this.shapes.set(h,f));const g=i.getElementType(h),v=this.getElementStyle(g,u);f.update(v)};s.forEach(c),o.forEach(c),this.shapes.forEach((u,h)=>{l.has(h)||(u.destroy(),this.shapes.delete(h))})},this.scaleRByWheel=n=>{var i;this.options.preventDefault&&n.preventDefault();const{clientX:a,clientY:s,deltaX:o,deltaY:l}=n,{graph:c,canvas:u}=this.context,h=c.getCanvasByClient([a,s]),d=(i=this.lens)===null||i===void 0?void 0:i.getCenter();if(!this.isLensOn||Ee(h,d)>this.r)return;const{maxR:f,minR:g}=this.options,v=o+l>0?1/(1-jM):1-jM,p=Math.min(...u.getSize())/2;this.r=Math.max(g||0,Math.min(f||p,this.r*v)),this.renderLens(d),this.renderFocusElements()},this.isLensDragging=!1,this.onDragStart=n=>{var i;const a=On(n.canvas),s=(i=this.lens)===null||i===void 0?void 0:i.getCenter();!this.isLensOn||Ee(a,s)>this.r||(this.isLensDragging=!0)},this.onDrag=n=>{if(!this.isLensDragging)return;const i=On(n.canvas);this.renderLens(i),this.renderFocusElements()},this.onDragEnd=()=>{this.isLensDragging=!1},this.bindEvents()}get canvas(){return this.context.canvas.getLayer("transient")}get isLensOn(){return this.lens&&!this.lens.destroyed}getElementStyle(t,e){const n=t==="node"?this.options.nodeStyle:this.options.edgeStyle;return typeof n=="function"?n(e):n}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}bindEvents(){var t;const{graph:e}=this.context,{trigger:n,scaleRBy:i}=this.options,a=e.getCanvas().getLayer();["click","drag"].includes(n)&&a.addEventListener(rt.CLICK,this.onEdgeFilter),n==="pointermove"?a.addEventListener(rt.POINTER_MOVE,this.onEdgeFilter):n==="drag"&&(a.addEventListener(rt.DRAG_START,this.onDragStart),a.addEventListener(rt.DRAG,this.onDrag),a.addEventListener(rt.DRAG_END,this.onDragEnd)),i==="wheel"&&((t=this.graphDom)===null||t===void 0||t.addEventListener(rt.WHEEL,this.scaleRByWheel,{passive:!1}))}unbindEvents(){var t;const{graph:e}=this.context,{trigger:n,scaleRBy:i}=this.options,a=e.getCanvas().getLayer();["click","drag"].includes(n)&&a.removeEventListener(rt.CLICK,this.onEdgeFilter),n==="pointermove"?a.removeEventListener(rt.POINTER_MOVE,this.onEdgeFilter):n==="drag"&&(a.removeEventListener(rt.DRAG_START,this.onDragStart),a.removeEventListener(rt.DRAG,this.onDrag),a.removeEventListener(rt.DRAG_END,this.onDragEnd)),i==="wheel"&&((t=this.graphDom)===null||t===void 0||t.removeEventListener(rt.WHEEL,this.scaleRByWheel))}update(t){var e;this.unbindEvents(),super.update(t),this.r=(e=t.r)!==null&&e!==void 0?e:this.r,this.bindEvents()}destroy(){this.unbindEvents(),this.isLensOn&&this.lens.destroy(),this.shapes.forEach((t,e)=>{t.destroy(),this.shapes.delete(e)}),super.destroy()}}Dh.defaultOptions={trigger:"pointermove",r:60,nodeType:"both",filter:()=>!0,style:{lineWidth:2},nodeStyle:{label:!1},edgeStyle:{label:!0},scaleRBy:"wheel",preventDefault:!0};const oV={fill:"#ccc",fillOpacity:.1,lineWidth:2,stroke:"#000",strokeOpacity:.8,labelFontSize:12},qM=.05,GM=.1;class Fh extends En{constructor(t,e){super(t,Object.assign({},Fh.defaultOptions,e)),this.r=this.options.r,this.d=this.options.d,this.onCreateFisheye=n=>{if(this.options.trigger==="drag"&&this.isLensOn)return;const i=On(n.canvas);this.onMagnify(i)},this.onMagnify=n=>{n.some(isNaN)||(this.renderLens(n),this.renderFocusElements())},this.renderLens=n=>{const i=Object.assign({},oV,this.options.style);this.isLensOn||(this.lens=new vl({style:i}),this.canvas.appendChild(this.lens)),Object.assign(i,Vr(n),{size:this.r*2,label:this.options.showDPercent,labelText:this.getDPercent()}),this.lens.update(i)},this.getDPercent=()=>{const{minD:n,maxD:i}=this.options;return`${Math.round((this.d-n)/(i-n)*100)}%`},this.prevMagnifiedStyleMap=new Map,this.prevOriginStyleMap=new Map,this.renderFocusElements=()=>{if(!this.isLensOn)return;const{graph:n}=this.context,i=this.lens.getCenter(),a=(this.d+1)*this.r,s=new Map,o=new Map;n.getNodeData().forEach(c=>{const u=dn(c),h=Ee(u,i);if(h>this.r)return;const d=a*h/(this.d*h+this.r),[f,g]=u,[v,p]=i,y=(f-v)/h,m=(g-p)/h,x=[v+d*y,p+d*m],E=K(c),_=this.getNodeStyle(c),M=Ya(n.getElementRenderStyle(E),Object.keys(_));s.set(E,Object.assign(Object.assign({},Vr(x)),_)),o.set(E,Object.assign(Object.assign({},Vr(u)),M))}),this.updateStyle(s,o)},this.getNodeStyle=n=>{const{nodeStyle:i}=this.options;return typeof i=="function"?i(n):i},this.updateStyle=(n,i)=>{const{graph:a,element:s}=this.context,{enter:o,exit:l,keep:c}=ca(Array.from(this.prevMagnifiedStyleMap.keys()),Array.from(n.keys()),d=>d),u=new Set,h=(d,f)=>{const g=s.getElement(d);g==null||g.update(f),a.getRelatedEdgesData(d).forEach(v=>{u.add(K(v))})};[...o,...c].forEach(d=>{h(d,n.get(d))}),l.forEach(d=>{h(d,this.prevOriginStyleMap.get(d)),this.prevOriginStyleMap.delete(d)}),u.forEach(d=>{const f=s.getElement(d);f==null||f.update({})}),this.prevMagnifiedStyleMap=n,i.forEach((d,f)=>{this.prevOriginStyleMap.has(f)||this.prevOriginStyleMap.set(f,d)})},this.isWheelValid=n=>{if(this.options.preventDefault&&n.preventDefault(),!this.isLensOn)return!1;const{clientX:i,clientY:a}=n,s=this.context.graph.getCanvasByClient([i,a]),o=this.lens.getCenter();return!(Ee(s,o)>this.r)},this.scaleR=n=>{const{maxR:i,minR:a}=this.options,s=n?1/(1-qM):1-qM,o=Math.min(...this.context.canvas.getSize())/2;this.r=Math.max(a||0,Math.min(i||o,this.r*s))},this.scaleD=n=>{const{maxD:i,minD:a}=this.options,s=n?this.d+GM:this.d-GM;this.d=Math.max(a,Math.min(i,s))},this.scaleRByWheel=n=>{if(!this.isWheelValid(n))return;const{deltaX:i,deltaY:a}=n;this.scaleR(i+a>0);const s=this.lens.getCenter();this.onMagnify(s)},this.scaleDByWheel=n=>{if(!this.isWheelValid(n))return;const{deltaX:i,deltaY:a}=n;this.scaleD(i+a>0);const s=this.lens.getCenter();this.onMagnify(s)},this.isDragValid=n=>{if(this.options.preventDefault&&n.preventDefault(),!this.isLensOn)return!1;const i=On(n.canvas),a=this.lens.getCenter();return!(Ee(i,a)>this.r)},this.isLensDragging=!1,this.onDragStart=n=>{this.isDragValid(n)&&(this.isLensDragging=!0)},this.onDrag=n=>{if(!this.isLensDragging)return;const i=On(n.canvas);this.onMagnify(i)},this.onDragEnd=()=>{this.isLensDragging=!1},this.scaleRByDrag=n=>{if(!this.isLensDragging)return;const{dx:i,dy:a}=n;this.scaleR(i-a>0);const s=this.lens.getCenter();this.onMagnify(s)},this.scaleDByDrag=n=>{if(!this.isLensDragging)return;const{dx:i,dy:a}=n;this.scaleD(i-a>0);const s=this.lens.getCenter();this.onMagnify(s)},this.bindEvents()}get canvas(){return this.context.canvas.getLayer("transient")}get isLensOn(){return this.lens&&!this.lens.destroyed}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}bindEvents(){var t;const{graph:e}=this.context,{trigger:n,scaleRBy:i,scaleDBy:a}=this.options,s=e.getCanvas().getLayer();if(["click","drag"].includes(n)&&s.addEventListener(rt.CLICK,this.onCreateFisheye),n==="pointermove"&&s.addEventListener(rt.POINTER_MOVE,this.onCreateFisheye),n==="drag"||i==="drag"||a==="drag"){s.addEventListener(rt.DRAG_START,this.onDragStart),s.addEventListener(rt.DRAG_END,this.onDragEnd);const o=n==="drag"?this.onDrag:i==="drag"?this.scaleRByDrag:this.scaleDByDrag;s.addEventListener(rt.DRAG,o)}if(i==="wheel"||a==="wheel"){const o=i==="wheel"?this.scaleRByWheel:this.scaleDByWheel;(t=this.graphDom)===null||t===void 0||t.addEventListener(rt.WHEEL,o,{passive:!1})}}unbindEvents(){var t;const{graph:e}=this.context,{trigger:n,scaleRBy:i,scaleDBy:a}=this.options,s=e.getCanvas().getLayer();if(["click","drag"].includes(n)&&s.removeEventListener(rt.CLICK,this.onCreateFisheye),n==="pointermove"&&s.removeEventListener(rt.POINTER_MOVE,this.onCreateFisheye),n==="drag"||i==="drag"||a==="drag"){s.removeEventListener(rt.DRAG_START,this.onDragStart),s.removeEventListener(rt.DRAG_END,this.onDragEnd);const o=n==="drag"?this.onDrag:i==="drag"?this.scaleRByDrag:this.scaleDByDrag;s.removeEventListener(rt.DRAG,o)}if(i==="wheel"||a==="wheel"){const o=i==="wheel"?this.scaleRByWheel:this.scaleDByWheel;(t=this.graphDom)===null||t===void 0||t.removeEventListener(rt.WHEEL,o)}}update(t){var e,n;this.unbindEvents(),super.update(t),this.r=(e=t.r)!==null&&e!==void 0?e:this.r,this.d=(n=t.d)!==null&&n!==void 0?n:this.d,this.bindEvents()}destroy(){var t;this.unbindEvents(),this.isLensOn&&((t=this.lens)===null||t===void 0||t.destroy()),this.prevMagnifiedStyleMap.clear(),this.prevOriginStyleMap.clear(),super.destroy()}}Fh.defaultOptions={trigger:"pointermove",r:120,d:1.5,maxD:5,minD:0,showDPercent:!0,style:{},nodeStyle:{label:!0},preventDefault:!0};class Bh extends En{constructor(t,e){super(t,Object.assign({},Bh.defaultOptions,e)),this.$el=this.context.canvas.getContainer(),this.graphSize=[0,0],this.onFullscreenChange=()=>{var n,i,a,s;const o=!!document.fullscreenElement;this.options.autoFit&&this.setGraphSize(o),o?(i=(n=this.options).onEnter)===null||i===void 0||i.call(n):(s=(a=this.options).onExit)===null||s===void 0||s.call(a)},this.shortcut=new Ys(t.graph),this.bindEvents(),this.style=document.createElement("style"),document.head.appendChild(this.style),this.style.innerHTML=`
      :not(:root):fullscreen::backdrop {
        background: transparent;
      }
    `}bindEvents(){this.unbindEvents(),this.shortcut.unbindAll();const{request:t=[],exit:e=[]}=this.options.trigger;this.shortcut.bind(t,this.request),this.shortcut.bind(e,this.exit),["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach(i=>{document.addEventListener(i,this.onFullscreenChange,!1)})}unbindEvents(){this.shortcut.unbindAll(),["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach(e=>{document.removeEventListener(e,this.onFullscreenChange,!1)})}setGraphSize(t=!0){var e,n;let i,a;t?(i=((e=globalThis.screen)===null||e===void 0?void 0:e.width)||0,a=((n=globalThis.screen)===null||n===void 0?void 0:n.height)||0,this.graphSize=this.context.graph.getSize()):[i,a]=this.graphSize,this.context.graph.setSize(i,a),this.context.graph.render()}request(){document.fullscreenElement||!lV()||this.$el.requestFullscreen().catch(t=>{wi.warn(`Error attempting to enable full-screen: ${t.message} (${t.name})`)})}exit(){document.fullscreenElement&&document.exitFullscreen()}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.exit(),this.style.remove(),super.destroy()}}Bh.defaultOptions={trigger:{},autoFit:!0};function lV(){return document.fullscreenEnabled||Reflect.get(document,"webkitFullscreenEnabled")||Reflect.get(document,"mozFullscreenEnabled")||Reflect.get(document,"msFullscreenEnabled")}class zh extends En{constructor(t,e){super(t,Object.assign({},zh.defaultOptions,e)),this.$element=no("grid-line",!0),this.offset=[0,0],this.currentScale=1,this.followZoom=i=>{const{data:{scale:a,origin:s}}=i;if(!a||s===void 0&&this.context.viewport===void 0)return;const o=this.currentScale;this.currentScale=a;const l=a/o,c=Wr(s||this.context.graph.getCanvasCenter(),1-l),u=this.baseSize*a,h=Wr(this.offset,l),d=Dd(h,u),f=qt(d,c);this.$element.style.backgroundSize=`${u}px ${u}px`,this.$element.style.backgroundPosition=`${f[0]}px ${f[1]}px`,this.offset=Dd(f,u)},this.followTranslate=i=>{if(!this.options.follow)return;const{data:{translate:a}}=i;a&&this.updateOffset(a)},this.onTransform=i=>{const a=this.parseFollow(this.options.follow);a.zoom&&this.followZoom(i),a.translate&&this.followTranslate(i)},this.context.canvas.getContainer().prepend(this.$element),this.baseSize=this.options.size,this.updateStyle(),this.bindEvents()}update(t){super.update(t),t.size!==void 0&&(this.baseSize=t.size),this.updateStyle()}bindEvents(){const{graph:t}=this.context;t.on(ft.AFTER_TRANSFORM,this.onTransform)}updateStyle(){const{stroke:t,lineWidth:e,border:n,borderLineWidth:i,borderStroke:a,borderStyle:s}=this.options,o=this.baseSize*this.currentScale;Object.assign(this.$element.style,{border:n?`${i}px ${s} ${a}`:"none",backgroundImage:`linear-gradient(${t} ${e}px, transparent ${e}px), linear-gradient(90deg, ${t} ${e}px, transparent ${e}px)`,backgroundSize:`${o}px ${o}px`,backgroundRepeat:"repeat"})}updateOffset(t){const e=this.baseSize*this.currentScale;this.offset=Dd(qt(this.offset,t),e),this.$element.style.backgroundPosition=`${this.offset[0]}px ${this.offset[1]}px`}parseFollow(t){var e,n;return qo(t)?{translate:t,zoom:t}:{translate:(e=t==null?void 0:t.translate)!==null&&e!==void 0?e:!1,zoom:(n=t==null?void 0:t.zoom)!==null&&n!==void 0?n:!1}}destroy(){this.context.graph.off(ft.AFTER_TRANSFORM,this.onTransform),this.$element.remove(),super.destroy()}}zh.defaultOptions={border:!0,borderLineWidth:1,borderStroke:"#eee",borderStyle:"solid",lineWidth:1,size:20,stroke:"#eee"};function vb(r){const t={Added:new Map,Updated:new Map,Removed:new Map};return r.forEach(e=>{const{type:n,value:i}=e,a=K(i);if(n==="NodeAdded"||n==="EdgeAdded"||n==="ComboAdded")t.Added.set(a,e);else if(n==="NodeUpdated"||n==="EdgeUpdated"||n==="ComboUpdated")if(t.Added.has(a))t.Added.set(a,{type:n.replace("Updated","Added"),value:i});else if(t.Updated.has(a)){const{original:s}=t.Updated.get(a);t.Updated.set(a,{type:n,value:i,original:s})}else t.Removed.has(a)||t.Updated.set(a,e);else(n==="NodeRemoved"||n==="EdgeRemoved"||n==="ComboRemoved")&&(t.Added.has(a)?t.Added.delete(a):(t.Updated.has(a)&&t.Updated.delete(a),t.Removed.set(a,e)))}),[...Array.from(t.Added.values()),...Array.from(t.Updated.values()),...Array.from(t.Removed.values())]}function SC(r){const{NodeAdded:t=[],NodeUpdated:e=[],NodeRemoved:n=[],EdgeAdded:i=[],EdgeUpdated:a=[],EdgeRemoved:s=[],ComboAdded:o=[],ComboUpdated:l=[],ComboRemoved:c=[]}=Nu(r,u=>u.type);return{add:{nodes:t,edges:i,combos:o},update:{nodes:e,edges:a,combos:l},remove:{nodes:n,edges:s,combos:c}}}function _C(r,t){for(const e in r)Ze(r[e])&&!Array.isArray(r[e])&&r[e]!==null?(t[e]||(t[e]={}),_C(r[e],t[e])):t[e]===void 0&&(t[e]=Yo(e))}function cV(r,t=!1,e){const n={animation:t,current:{add:{},update:{},remove:{}},original:{add:{},update:{},remove:{}}},{add:i,update:a,remove:s}=SC(vb(r));return["nodes","edges","combos"].forEach(o=>{a[o]&&a[o].forEach(l=>{var c,u;const h=Object.assign({},l.value);let d=Object.assign({},l.original);if(e){const f=e.graph.getElementType(K(l.original)),g=f==="edge"?"stroke":"fill",v=e.element.getElementComputedStyle(f,l.original);d=Object.assign(Object.assign({},l.original),{style:Object.assign({[g]:v[g]},l.original.style)})}_C(h,d),(c=n.current.update)[o]||(c[o]=[]),n.current.update[o].push(h),(u=n.original.update)[o]||(u[o]=[]),n.original.update[o].push(d)}),i[o]&&i[o].forEach(l=>{var c,u;const h=Object.assign({},l.value);(c=n.current.add)[o]||(c[o]=[]),n.current.add[o].push(h),(u=n.original.remove)[o]||(u[o]=[]),n.original.remove[o].push(h)}),s[o]&&s[o].forEach(l=>{var c,u;const h=Object.assign({},l.value);(c=n.current.remove)[o]||(c[o]=[]),n.current.remove[o].push(h),(u=n.original.add)[o]||(u[o]=[]),n.original.add[o].push(h)})}),n}class jh extends En{constructor(t,e){super(t,Object.assign({},jh.defaultOptions,e)),this.batchChanges=null,this.batchAnimation=!1,this.undoStack=[],this.redoStack=[],this.freezed=!1,this.executeCommand=(i,a=!0)=>{var s,o,l;this.freezed=!0,(o=(s=this.options).executeCommand)===null||o===void 0||o.call(s,i);const c=a?i.original:i.current;this.context.graph.addData(c.add),this.context.graph.updateData(c.update),this.context.graph.removeData(GA(c.remove,!1)),(l=this.context.element)===null||l===void 0||l.draw({silence:!0,animation:i.animation}),this.freezed=!1},this.addCommand=i=>{var a;if(!this.freezed){if(i.type===ft.AFTER_DRAW){const{dataChanges:s=[],animation:o=!0}=i.data;if(!((a=this.context.batch)===null||a===void 0)&&a.isBatching){if(!this.batchChanges)return;this.batchChanges.push(s),this.batchAnimation&&(this.batchAnimation=o);return}this.batchChanges=[s],this.batchAnimation=o}this.undoStackPush(cV(this.batchChanges.flat(),this.batchAnimation,this.context)),this.notify(Zi.ADD,this.undoStack[this.undoStack.length-1])}},this.initBatchCommand=i=>{const{initiate:a}=i.data;this.batchAnimation=!1,a?this.batchChanges=[]:this.undoStack.pop()||(this.batchChanges=null)},this.emitter=new Qu;const{graph:n}=this.context;n.on(ft.AFTER_DRAW,this.addCommand),n.on(ft.BATCH_START,this.initBatchCommand),n.on(ft.BATCH_END,this.addCommand)}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}undo(){var t,e,n,i;const a=this.undoStack.pop();if(a){if(this.executeCommand(a),((e=(t=this.options).beforeAddCommand)===null||e===void 0?void 0:e.call(t,a,!1))===!1)return;this.redoStack.push(a),(i=(n=this.options).afterAddCommand)===null||i===void 0||i.call(n,a,!1),this.notify(Zi.UNDO,a)}return this}redo(){const t=this.redoStack.pop();return t&&(this.executeCommand(t,!1),this.undoStackPush(t),this.notify(Zi.REDO,t)),this}undoAndCancel(){const t=this.undoStack.pop();return t&&(this.executeCommand(t,!1),this.redoStack=[],this.notify(Zi.CANCEL,t)),this}undoStackPush(t){var e,n,i,a;const{stackSize:s}=this.options;s!==0&&this.undoStack.length>=s&&this.undoStack.shift(),((n=(e=this.options).beforeAddCommand)===null||n===void 0?void 0:n.call(e,t,!0))!==!1&&(this.undoStack.push(t),(a=(i=this.options).afterAddCommand)===null||a===void 0||a.call(i,t,!0))}clear(){this.undoStack=[],this.redoStack=[],this.batchChanges=null,this.batchAnimation=!1,this.notify(Zi.CLEAR,null)}notify(t,e){this.emitter.emit(t,{cmd:e}),this.emitter.emit(Zi.CHANGE,{cmd:e})}on(t,e){this.emitter.on(t,e)}destroy(){const{graph:t}=this.context;t.off(ft.AFTER_DRAW,this.addCommand),t.off(ft.BATCH_START,this.initBatchCommand),t.off(ft.BATCH_END,this.addCommand),this.emitter.off(),super.destroy(),this.undoStack=[],this.redoStack=[]}}jh.defaultOptions={stackSize:0};const Ly={toXy(r,t){if(!t)return[...r];const e=t[0].slice(1),n=t[1].slice(1);return r.map(i=>[i[e],i[n]])},fromXy(r,t){if(!t)return[...r];const e=t[0].slice(1),n=t[1].slice(1);return r.map(([i,a])=>({[e]:i,[n]:a}))}};let uV=class{constructor(t,e){this._cells=[],this._cellSize=e,this._reverseCellSize=1/e;for(const n of t){const i=this.coordToCellNum(n[0]),a=this.coordToCellNum(n[1]);this._cells[i]||(this._cells[i]=[]),this._cells[i][a]||(this._cells[i][a]=[]),this._cells[i][a].push(n)}}cellPoints(t,e){var n;return((n=this._cells[t])===null||n===void 0?void 0:n[e])||[]}rangePoints(t){const e=this.coordToCellNum(t[0]),n=this.coordToCellNum(t[1]),i=this.coordToCellNum(t[2]),a=this.coordToCellNum(t[3]),s=[];for(let o=e;o<=i;o++)for(let l=n;l<=a;l++){const c=this.cellPoints(o,l);for(const u of c)s.push(u)}return s}removePoint(t){const e=this.coordToCellNum(t[0]),n=this.coordToCellNum(t[1]),i=this._cells[e][n],a=i.findIndex(([s,o])=>s===t[0]&&o===t[1]);return a>-1&&i.splice(a,1),i}trunc(t){return Math.trunc(t)}coordToCellNum(t){return this.trunc(t*this._reverseCellSize)}extendBbox(t,e){return[t[0]-e*this._cellSize,t[1]-e*this._cellSize,t[2]+e*this._cellSize,t[3]+e*this._cellSize]}};function hV(r,t){return new uV(r,t)}const $M=+(Math.pow(2,27)+1);function qc(r,t,e){const n=r*t,i=$M*r,a=i-r,s=i-a,o=r-s,l=$M*t,c=l-t,u=l-c,h=t-u,g=n-s*u-o*u-s*h,v=o*h-g;return e?(e[0]=v,e[1]=n,e):[v,n]}function dV(r,t,e){const n=r+t,i=n-r,a=n-i,s=t-i,o=r-a;return e?(e[0]=o+s,e[1]=n,e):[o+s,n]}function fV(r,t){const e=r.length;if(e===1){const o=qc(r[0],t);return o[0]?o:[o[1]]}const n=new Array(2*e),i=[.1,.1],a=[.1,.1];let s=0;qc(r[0],t,i),i[0]&&(n[s++]=i[0]);for(let o=1;o<e;++o){qc(r[o],t,a);const l=i[1];dV(l,a[0],i),i[0]&&(n[s++]=i[0]);const c=a[1],u=i[1],h=c+u,d=h-c,f=u-d;i[1]=h,f&&(n[s++]=f)}return i[1]&&(n[s++]=i[1]),s===0&&(n[s++]=0),n.length=s,n}function gV(r,t){const e=r+t,n=e-r,i=e-n,a=t-n,o=r-i+a;return o?[o,e]:[e]}function vV(r,t){const e=r.length|0,n=t.length|0;if(e===1&&n===1)return gV(r[0],-t[0]);const i=e+n,a=new Array(i);let s=0,o=0,l=0;const c=Math.abs;let u=r[o],h=c(u),d=-t[l],f=c(d),g,v;h<f?(v=u,o+=1,o<e&&(u=r[o],h=c(u))):(v=d,l+=1,l<n&&(d=-t[l],f=c(d))),o<e&&h<f||l>=n?(g=u,o+=1,o<e&&(u=r[o],h=c(u))):(g=d,l+=1,l<n&&(d=-t[l],f=c(d)));let p=g+v,y=p-g,m=v-y,x=m,E=p,_,M,O,T,N;for(;o<e&&l<n;)h<f?(g=u,o+=1,o<e&&(u=r[o],h=c(u))):(g=d,l+=1,l<n&&(d=-t[l],f=c(d))),v=x,p=g+v,y=p-g,m=v-y,m&&(a[s++]=m),_=E+p,M=_-E,O=_-M,T=p-M,N=E-O,x=N+T,E=_;for(;o<e;)g=u,v=x,p=g+v,y=p-g,m=v-y,m&&(a[s++]=m),_=E+p,M=_-E,O=_-M,T=p-M,N=E-O,x=N+T,E=_,o+=1,o<e&&(u=r[o]);for(;l<n;)g=d,v=x,p=g+v,y=p-g,m=v-y,m&&(a[s++]=m),_=E+p,M=_-E,O=_-M,T=p-M,N=E-O,x=N+T,E=_,l+=1,l<n&&(d=-t[l]);return x&&(a[s++]=x),E&&(a[s++]=E),s||(a[s++]=0),a.length=s,a}function pV(r,t){const e=r+t,n=e-r,i=e-n,a=t-n,o=r-i+a;return o?[o,e]:[e]}function yV(r,t){const e=r.length|0,n=t.length|0;if(e===1&&n===1)return pV(r[0],t[0]);const i=e+n,a=new Array(i);let s=0,o=0,l=0;const c=Math.abs;let u=r[o],h=c(u),d=t[l],f=c(d),g,v;h<f?(v=u,o+=1,o<e&&(u=r[o],h=c(u))):(v=d,l+=1,l<n&&(d=t[l],f=c(d))),o<e&&h<f||l>=n?(g=u,o+=1,o<e&&(u=r[o],h=c(u))):(g=d,l+=1,l<n&&(d=t[l],f=c(d)));let p=g+v,y=p-g,m=v-y,x=m,E=p,_,M,O,T,N;for(;o<e&&l<n;)h<f?(g=u,o+=1,o<e&&(u=r[o],h=c(u))):(g=d,l+=1,l<n&&(d=t[l],f=c(d))),v=x,p=g+v,y=p-g,m=v-y,m&&(a[s++]=m),_=E+p,M=_-E,O=_-M,T=p-M,N=E-O,x=N+T,E=_;for(;o<e;)g=u,v=x,p=g+v,y=p-g,m=v-y,m&&(a[s++]=m),_=E+p,M=_-E,O=_-M,T=p-M,N=E-O,x=N+T,E=_,o+=1,o<e&&(u=r[o]);for(;l<n;)g=d,v=x,p=g+v,y=p-g,m=v-y,m&&(a[s++]=m),_=E+p,M=_-E,O=_-M,T=p-M,N=E-O,x=N+T,E=_,l+=1,l<n&&(d=t[l]);return x&&(a[s++]=x),E&&(a[s++]=E),s||(a[s++]=0),a.length=s,a}const WM=5,ku=11102230246251565e-32,mV=(3+16*ku)*ku,bV=(7+56*ku)*ku;function xV(r,t,e,n){return function(a,s,o){const l=r(r(t(s[1],o[0]),t(-o[1],s[0])),r(t(a[1],s[0]),t(-s[1],a[0]))),c=r(t(a[1],o[0]),t(-o[1],a[0])),u=n(l,c);return u[u.length-1]}}function wV(r,t,e,n){return function(a,s,o,l){const c=r(r(e(r(t(o[1],l[0]),t(-l[1],o[0])),s[2]),r(e(r(t(s[1],l[0]),t(-l[1],s[0])),-o[2]),e(r(t(s[1],o[0]),t(-o[1],s[0])),l[2]))),r(e(r(t(s[1],l[0]),t(-l[1],s[0])),a[2]),r(e(r(t(a[1],l[0]),t(-l[1],a[0])),-s[2]),e(r(t(a[1],s[0]),t(-s[1],a[0])),l[2])))),u=r(r(e(r(t(o[1],l[0]),t(-l[1],o[0])),a[2]),r(e(r(t(a[1],l[0]),t(-l[1],a[0])),-o[2]),e(r(t(a[1],o[0]),t(-o[1],a[0])),l[2]))),r(e(r(t(s[1],o[0]),t(-o[1],s[0])),a[2]),r(e(r(t(a[1],o[0]),t(-o[1],a[0])),-s[2]),e(r(t(a[1],s[0]),t(-s[1],a[0])),o[2])))),h=n(c,u);return h[h.length-1]}}function EV(r,t,e,n){return function(a,s,o,l,c){const u=r(r(r(e(r(e(r(t(l[1],c[0]),t(-c[1],l[0])),o[2]),r(e(r(t(o[1],c[0]),t(-c[1],o[0])),-l[2]),e(r(t(o[1],l[0]),t(-l[1],o[0])),c[2]))),s[3]),r(e(r(e(r(t(l[1],c[0]),t(-c[1],l[0])),s[2]),r(e(r(t(s[1],c[0]),t(-c[1],s[0])),-l[2]),e(r(t(s[1],l[0]),t(-l[1],s[0])),c[2]))),-o[3]),e(r(e(r(t(o[1],c[0]),t(-c[1],o[0])),s[2]),r(e(r(t(s[1],c[0]),t(-c[1],s[0])),-o[2]),e(r(t(s[1],o[0]),t(-o[1],s[0])),c[2]))),l[3]))),r(e(r(e(r(t(o[1],l[0]),t(-l[1],o[0])),s[2]),r(e(r(t(s[1],l[0]),t(-l[1],s[0])),-o[2]),e(r(t(s[1],o[0]),t(-o[1],s[0])),l[2]))),-c[3]),r(e(r(e(r(t(l[1],c[0]),t(-c[1],l[0])),s[2]),r(e(r(t(s[1],c[0]),t(-c[1],s[0])),-l[2]),e(r(t(s[1],l[0]),t(-l[1],s[0])),c[2]))),a[3]),e(r(e(r(t(l[1],c[0]),t(-c[1],l[0])),a[2]),r(e(r(t(a[1],c[0]),t(-c[1],a[0])),-l[2]),e(r(t(a[1],l[0]),t(-l[1],a[0])),c[2]))),-s[3])))),r(r(e(r(e(r(t(s[1],c[0]),t(-c[1],s[0])),a[2]),r(e(r(t(a[1],c[0]),t(-c[1],a[0])),-s[2]),e(r(t(a[1],s[0]),t(-s[1],a[0])),c[2]))),l[3]),r(e(r(e(r(t(s[1],l[0]),t(-l[1],s[0])),a[2]),r(e(r(t(a[1],l[0]),t(-l[1],a[0])),-s[2]),e(r(t(a[1],s[0]),t(-s[1],a[0])),l[2]))),-c[3]),e(r(e(r(t(o[1],l[0]),t(-l[1],o[0])),s[2]),r(e(r(t(s[1],l[0]),t(-l[1],s[0])),-o[2]),e(r(t(s[1],o[0]),t(-o[1],s[0])),l[2]))),a[3]))),r(e(r(e(r(t(o[1],l[0]),t(-l[1],o[0])),a[2]),r(e(r(t(a[1],l[0]),t(-l[1],a[0])),-o[2]),e(r(t(a[1],o[0]),t(-o[1],a[0])),l[2]))),-s[3]),r(e(r(e(r(t(s[1],l[0]),t(-l[1],s[0])),a[2]),r(e(r(t(a[1],l[0]),t(-l[1],a[0])),-s[2]),e(r(t(a[1],s[0]),t(-s[1],a[0])),l[2]))),o[3]),e(r(e(r(t(s[1],o[0]),t(-o[1],s[0])),a[2]),r(e(r(t(a[1],o[0]),t(-o[1],a[0])),-s[2]),e(r(t(a[1],s[0]),t(-s[1],a[0])),o[2]))),-l[3]))))),h=r(r(r(e(r(e(r(t(l[1],c[0]),t(-c[1],l[0])),o[2]),r(e(r(t(o[1],c[0]),t(-c[1],o[0])),-l[2]),e(r(t(o[1],l[0]),t(-l[1],o[0])),c[2]))),a[3]),e(r(e(r(t(l[1],c[0]),t(-c[1],l[0])),a[2]),r(e(r(t(a[1],c[0]),t(-c[1],a[0])),-l[2]),e(r(t(a[1],l[0]),t(-l[1],a[0])),c[2]))),-o[3])),r(e(r(e(r(t(o[1],c[0]),t(-c[1],o[0])),a[2]),r(e(r(t(a[1],c[0]),t(-c[1],a[0])),-o[2]),e(r(t(a[1],o[0]),t(-o[1],a[0])),c[2]))),l[3]),e(r(e(r(t(o[1],l[0]),t(-l[1],o[0])),a[2]),r(e(r(t(a[1],l[0]),t(-l[1],a[0])),-o[2]),e(r(t(a[1],o[0]),t(-o[1],a[0])),l[2]))),-c[3]))),r(r(e(r(e(r(t(o[1],c[0]),t(-c[1],o[0])),s[2]),r(e(r(t(s[1],c[0]),t(-c[1],s[0])),-o[2]),e(r(t(s[1],o[0]),t(-o[1],s[0])),c[2]))),a[3]),e(r(e(r(t(o[1],c[0]),t(-c[1],o[0])),a[2]),r(e(r(t(a[1],c[0]),t(-c[1],a[0])),-o[2]),e(r(t(a[1],o[0]),t(-o[1],a[0])),c[2]))),-s[3])),r(e(r(e(r(t(s[1],c[0]),t(-c[1],s[0])),a[2]),r(e(r(t(a[1],c[0]),t(-c[1],a[0])),-s[2]),e(r(t(a[1],s[0]),t(-s[1],a[0])),c[2]))),o[3]),e(r(e(r(t(s[1],o[0]),t(-o[1],s[0])),a[2]),r(e(r(t(a[1],o[0]),t(-o[1],a[0])),-s[2]),e(r(t(a[1],s[0]),t(-s[1],a[0])),o[2]))),-c[3])))),d=n(u,h);return d[d.length-1]}}function qh(r){return(r===3?xV:r===4?wV:EV)(yV,qc,fV,vV)}const SV=qh(3),_V=qh(4),Da=[function(){return 0},function(){return 0},function(t,e){return e[0]-t[0]},function(t,e,n){const i=(t[1]-n[1])*(e[0]-n[0]),a=(t[0]-n[0])*(e[1]-n[1]),s=i-a;let o;if(i>0){if(a<=0)return s;o=i+a}else if(i<0){if(a>=0)return s;o=-(i+a)}else return s;const l=mV*o;return s>=l||s<=-l?s:SV(t,e,n)},function(t,e,n,i){const a=t[0]-i[0],s=e[0]-i[0],o=n[0]-i[0],l=t[1]-i[1],c=e[1]-i[1],u=n[1]-i[1],h=t[2]-i[2],d=e[2]-i[2],f=n[2]-i[2],g=s*u,v=o*c,p=o*l,y=a*u,m=a*c,x=s*l,E=h*(g-v)+d*(p-y)+f*(m-x),_=(Math.abs(g)+Math.abs(v))*Math.abs(h)+(Math.abs(p)+Math.abs(y))*Math.abs(d)+(Math.abs(m)+Math.abs(x))*Math.abs(f),M=bV*_;return E>M||-E>M?E:_V(t,e,n,i)}];function kV(r){let t=Da[r.length];return t||(t=Da[r.length]=qh(r.length)),t.apply(void 0,...r)}function MV(r,t,e,n,i,a,s){return function(...l){switch(l.length){case 0:case 1:return 0;case 2:return n(l[0],l[1]);case 3:return i(l[0],l[1],l[2]);case 4:return a(l[0],l[1],l[2],l[3]);case 5:return s(l[0],l[1],l[2],l[3],l[4])}return r(l)}}function TV(){for(;Da.length<=WM;)Da.push(qh(Da.length));const r=MV(void 0,kV,...Da);for(let t=0;t<=WM;++t)r[t]=Da[t];return r}const Oo=TV(),VM=Oo[3];function OV(r){const t=r.length;if(t<3){const o=new Array(t);for(let l=0;l<t;++l)o[l]=l;return t===2&&r[0][0]===r[1][0]&&r[0][1]===r[1][1]?[0]:o}const e=new Array(t);for(let o=0;o<t;++o)e[o]=o;e.sort((o,l)=>{const c=r[o][0]-r[l][0];return c||r[o][1]-r[l][1]});const n=[e[0],e[1]],i=[e[0],e[1]];for(let o=2;o<t;++o){const l=e[o],c=r[l];let u=n.length;for(;u>1&&VM(r[n[u-2]],r[n[u-1]],c)<=0;)u-=1,n.pop();for(n.push(l),u=i.length;u>1&&VM(r[i[u-2]],r[i[u-1]],c)>=0;)u-=1,i.pop();i.push(l)}const a=new Array(i.length+n.length-2);let s=0;for(let o=0,l=n.length;o<l;++o)a[s++]=n[o];for(let o=i.length-2;o>0;--o)a[s++]=i[o];return a}function AV(r,t,e,n){for(let i=0;i<2;++i){const a=r[i],s=t[i],[o,l]=[Math.min(a,s),Math.max(a,s)],c=e[i],u=n[i],[h,d]=[Math.min(c,u),Math.max(c,u)];if(d<o||l<h)return!1}return!0}function NV(r,t,e,n){const i=Oo(r,e,n),a=Oo(t,e,n);if(i>0&&a>0||i<0&&a<0)return!1;const s=Oo(e,r,t),o=Oo(n,r,t);return s>0&&o>0||s<0&&o<0?!1:i===0&&a===0&&s===0&&o===0?AV(r,t,e,n):!0}function PV(r){const t=[r[0]];let e=r[0];for(let n=1;n<r.length;n++){const i=r[n];(e[0]!==i[0]||e[1]!==i[1])&&t.push(i),e=i}return t}function CV(r){return r.sort(function(t,e){return t[0]-e[0]||t[1]-e[1]})}function Hm(r,t){return Math.pow(t[0]-r[0],2)+Math.pow(t[1]-r[1],2)}function UM(r,t,e){const n=[t[0]-r[0],t[1]-r[1]],i=[e[0]-r[0],e[1]-r[1]],a=Hm(r,t),s=Hm(r,e);return(n[0]*i[0]+n[1]*i[1])/Math.sqrt(a*s)}function YM(r,t){for(let e=0;e<t.length-1;e++){const n=[t[e],t[e+1]];if(!(r[0][0]===n[0][0]&&r[0][1]===n[0][1]||r[0][0]===n[1][0]&&r[0][1]===n[1][1])&&NV(r[0],r[1],n[0],n[1]))return!0}return!1}function RV(r){let t=1/0,e=1/0,n=-1/0,i=-1/0;for(let a=r.length-1;a>=0;a--)r[a][0]<t&&(t=r[a][0]),r[a][1]<e&&(e=r[a][1]),r[a][0]>n&&(n=r[a][0]),r[a][1]>i&&(i=r[a][1]);return[n-t,i-e]}function LV(r){return[Math.min(r[0][0],r[1][0]),Math.min(r[0][1],r[1][1]),Math.max(r[0][0],r[1][0]),Math.max(r[0][1],r[1][1])]}function IV(r,t,e){let n=null,i=HM,a=HM,s,o;for(let l=0;l<t.length;l++)s=UM(r[0],r[1],t[l]),o=UM(r[1],r[0],t[l]),s>i&&o>a&&!YM([r[0],t[l]],e)&&!YM([r[1],t[l]],e)&&(i=s,a=o,n=t[l]);return n}function kC(r,t,e,n,i){let a=!1;for(let s=0;s<r.length-1;s++){const o=[r[s],r[s+1]],l=o[0][0]+","+o[0][1]+","+o[1][0]+","+o[1][1];if(Hm(o[0],o[1])<t||i.has(l))continue;let c=0,u=LV(o),h,d,f;do u=n.extendBbox(u,c),h=u[2]-u[0],d=u[3]-u[1],f=IV(o,n.rangePoints(u),r),c++;while(f===null&&(e[0]>h||e[1]>d));h>=e[0]&&d>=e[1]&&i.add(l),f!==null&&(r.splice(s+1,0,f),n.removePoint(f),a=!0)}return a?kC(r,t,e,n,i):r}function DV(r,t,e){const n=t||20,i=PV(CV(Ly.toXy(r,e)));if(i.length<4){const h=i.concat([i[0]]);return e?Ly.fromXy(h,e):h}const a=RV(i),s=[a[0]*XM,a[1]*XM],o=OV(i).reverse().map(h=>i[h]);o.push(o[0]);const l=i.filter(function(h){return o.indexOf(h)<0}),c=Math.ceil(1/(i.length/(a[0]*a[1]))),u=kC(o,Math.pow(n,2),s,hV(l,c),new Set);return e?Ly.fromXy(u,e):u}const HM=Math.cos(90/(180/Math.PI)),XM=.6;function FV(r,t,e){if(r.length===1)return BV(r[0],t,e);if(r.length===2)return KM(r,t,e);if(r.length===3){const[n,i,a]=R1(r);if(KA(n,i,a))return KM([n,a],t,e)}switch(e){case"smooth":return jV(r,t);case"sharp":return qV(r,t);case"rounded":default:return zV(r,t)}}const BV=(r,t,e)=>{if(e==="sharp")return[["M",r[0]-t,r[1]-t],["L",r[0]+t,r[1]-t],["L",r[0]+t,r[1]+t],["L",r[0]-t,r[1]+t],["Z"]];const n=[t,t,0,0,0];return[["M",r[0],r[1]-t],["A",...n,r[0],r[1]+t],["A",...n,r[0],r[1]-t]]},KM=(r,t,e)=>{const n=[t,t,0,0,0],i=e==="sharp"?qt(r[0],na(Fi(fe(r[0],r[1])),t)):r[0],a=e==="sharp"?qt(r[1],na(Fi(fe(r[1],r[0])),t)):r[1],s=na(Fi(Fu(fe(i,a),!1)),t),o=na(s,-1),l=qt(i,s),c=qt(a,s),u=qt(a,o),h=qt(i,o);return e==="sharp"?[["M",l[0],l[1]],["L",c[0],c[1]],["L",u[0],u[1]],["L",h[0],h[1]],["Z"]]:[["M",l[0],l[1]],["L",c[0],c[1]],["A",...n,u[0],u[1]],["L",h[0],h[1]],["A",...n,l[0],l[1]]]},zV=(r,t)=>{const e=R1(r).map((o,l)=>{const c=(l-2+r.length)%r.length,u=(l-1+r.length)%r.length,h=(l+1)%r.length,d=r[c],f=r[u],g=r[h],v=fe(d,f),p=fe(f,o),y=fe(o,g),m=(O,T)=>P1(O,T,!0)<Math.PI,x=m(v,p),E=m(p,y),_=O=>na(Fi(Fu(O,!1)),t),M=_(p);return[{p:Ja(x?qt(f,_(v)):qt(f,M)),concave:x&&f},{p:Ja(E?qt(o,_(y)):qt(o,M)),concave:E&&o}]}),n=[t,t,0,0,0],i=e.findIndex((o,l)=>!e[(l-1+e.length)%e.length][0].concave&&!e[(l-1+e.length)%e.length][1].concave&&!o[0].concave&&!o[0].concave&&!o[1].concave),a=e.slice(i).concat(e.slice(0,i));let s=[];return a.flatMap((o,l)=>{const c=[],u=a[e.length-1];return l===0&&c.push(["M",...u[1].p]),o[0].concave?s.push(o[0].p,o[1].p):c.push(["A",...n,...o[0].p]),o[1].concave?s.unshift(o[1].p):c.push(["L",...o[1].p]),s.length===3&&(c.pop(),c.push(["C",...s.flat()]),s=[]),c})},jV=(r,t)=>{const e=R1(r).map((n,i)=>{const a=r[(i+1)%r.length];return{p:n,v:Fi(fe(a,n))}});return e.forEach((n,i)=>{const a=i>0?i-1:r.length-1,s=e[a].v,o=Fi(qt(s,na(n.v,P1(s,n.v,!0)<Math.PI?1:-1)));n.p=qt(n.p,na(o,t))}),aN(e.map(n=>n.p))},qV=(r,t)=>{const n=r.map((a,s)=>{const o=r[s===0?r.length-1:s-1],l=Ho(na(Fi(Fu(fe(o,a),!1)),t));return[qt(o,l),qt(a,l)]}).flat();return n.map((a,s)=>{if(s%2===0)return null;const o=[n[(s-1)%n.length],n[s%n.length]],l=[n[(s+1)%n.length],n[(s+2)%n.length]];return C1(o,l,!0)}).filter(Boolean).map((a,s)=>[s===0?"M":"L",a[0],a[1]]).concat([["Z"]])};var GV=function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(e[n[i]]=r[n[i]]);return e};class Gh extends En{constructor(t,e){super(t,Object.assign({},Gh.defaultOptions,e)),this.hullMemberIds=[],this.drawHull=()=>{if(!this.shape)this.shape=new gl({style:this.getHullStyle()}),this.context.canvas.appendChild(this.shape);else{const n=!Ge(this.optionsCache,this.options);this.shape.update(this.getHullStyle(n))}this.optionsCache=Object.assign({},this.options)},this.updateHullPath=n=>{this.shape&&this.options.members.includes(K(n.data))&&this.shape.update({d:this.getHullPath(!0)})},this.getHullPath=(n=!1)=>{const{graph:i}=this.context,a=this.getMember();if(a.length===0)return"";const s=a.map(c=>i.getNodeData(c)),o=DV(s.map(dn),this.options.concavity).slice(1).reverse(),l=o.flatMap(c=>s.filter(u=>Ge(dn(u),c)).map(K));return Ge(l,this.hullMemberIds)&&!n?this.path:(this.hullMemberIds=l,this.path=FV(o,this.getPadding(),this.options.corner),this.path)},this.bindEvents()}bindEvents(){this.context.graph.on(ft.AFTER_RENDER,this.drawHull),this.context.graph.on(ft.AFTER_ELEMENT_UPDATE,this.updateHullPath)}unbindEvents(){this.context.graph.off(ft.AFTER_RENDER,this.drawHull),this.context.graph.off(ft.AFTER_ELEMENT_UPDATE,this.updateHullPath)}getHullStyle(t){const e=this.options,{members:n,padding:i,corner:a}=e,s=GV(e,["members","padding","corner"]);return Object.assign(Object.assign({},s),{d:this.getHullPath(t)})}getPadding(){const{graph:t}=this.context;return this.hullMemberIds.reduce((n,i)=>{const{halfExtents:a}=t.getElementRenderBounds(i),s=Math.max(a[0],a[1]);return Math.max(n,s)},0)+this.options.padding}addMember(t){const e=Array.isArray(t)?t:[t];this.options.members=[...new Set([...this.options.members,...e])],this.shape.update({d:this.getHullPath()})}removeMember(t){const e=Array.isArray(t)?t:[t];this.options.members=this.options.members.filter(n=>!e.includes(n)),e.some(n=>this.hullMemberIds.includes(n))&&this.shape.update({d:this.getHullPath()})}updateMember(t){this.options.members=Tt(t)?t(this.options.members):t,this.shape.update(this.getHullStyle(!0))}getMember(){return this.options.members}destroy(){this.unbindEvents(),this.shape.destroy(),this.hullMemberIds=[],super.destroy()}}Gh.defaultOptions={members:[],padding:10,corner:"rounded",concavity:1/0,fill:"lightblue",fillOpacity:.2,labelOpacity:1,stroke:"blue",strokeOpacity:.2};function MC(r,t){t(r),r.children&&r.children.forEach(function(e){e&&MC(e,t)})}function kl(r){$h(r,!0)}function Ur(r){$h(r,!1)}function $h(r,t){var e=t?"visible":"hidden";MC(r,function(n){n.attr("visibility",e)})}var $V=(function(r){Ut(t,r);function t(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var i=r.apply(this,Nt([],q(e),!1))||this;return i.isMutationObserved=!0,i.addEventListener(Jt.INSERTED,function(){Ur(i)}),i}return t})(gn);function TC(r){var t=r.appendChild(new $V({class:"offscreen"}));return Ur(t),t}function WV(r){for(var t=r;t;){if(t.className==="offscreen")return!0;t=t.parent}return!1}var pb=(function(r){Ut(t,r);function t(e){e===void 0&&(e={});var n=e.style,i=Pe(e,["style"]);return r.call(this,at({style:at({text:"",fill:"black",fontFamily:"sans-serif",fontSize:16,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",lineWidth:1,textAlign:"start",textBaseline:"middle"},n)},i))||this}return Object.defineProperty(t.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=TC(this)),this._offscreen},enumerable:!1,configurable:!0}),t.prototype.disconnectedCallback=function(){var e;(e=this._offscreen)===null||e===void 0||e.destroy()},t})(as);function Vs(r){return r*Math.PI/180}function OC(r){return Number((r*180/Math.PI).toPrecision(5))}var Yn=(function(){function r(t,e,n,i){t===void 0&&(t=0),e===void 0&&(e=0),n===void 0&&(n=0),i===void 0&&(i=0),this.x=0,this.y=0,this.width=0,this.height=0,this.x=t,this.y=e,this.width=n,this.height=i}return Object.defineProperty(r.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),r.fromRect=function(t){return new r(t.x,t.y,t.width,t.height)},r.prototype.toJSON=function(){return{x:this.x,y:this.y,width:this.width,height:this.height,top:this.top,right:this.right,bottom:this.bottom,left:this.left}},r.prototype.isPointIn=function(t,e){return t>=this.left&&t<=this.right&&e>=this.top&&e<=this.bottom},r})();function lr(r,t){return Tt(r)?r.apply(void 0,Nt([],q(t),!1)):r}var Qr=function(r,t){var e=function(i){return"".concat(t,"-").concat(i)},n=Object.fromEntries(Object.entries(r).map(function(i){var a=q(i,2),s=a[0],o=a[1],l=e(o);return[s,{name:l,class:".".concat(l),id:"#".concat(l),toString:function(){return l}}]}));return Object.assign(n,{prefix:e}),n},VV=5,AC=function(r,t,e,n){e===void 0&&(e=0),n===void 0&&(n=VV),Object.entries(t).forEach(function(i){var a=q(i,2),s=a[0],o=a[1],l=r;Object.prototype.hasOwnProperty.call(t,s)&&(o?js(o)?(js(r[s])||(l[s]={}),e<n?AC(r[s],o,e+1,n):l[s]=t[s]):cr(o)?(l[s]=[],l[s]=l[s].concat(o)):l[s]=o:l[s]=o)})},on=function(r){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];for(var n=0;n<t.length;n+=1)AC(r,t[n]);return r},UV=function(r){return r!==void 0&&r!=null&&!Number.isNaN(r)},Ac,YV=rm(function(r,t){var e=t.fontSize,n=t.fontFamily,i=t.fontWeight,a=t.fontStyle,s=t.fontVariant;return Ac||(Ac=ct.offscreenCanvasCreator.getOrCreateContext(void 0)),Ac.font=[a,s,i,"".concat(e,"px"),n].join(" "),Ac.measureText(r).width},function(r,t){return[r,Object.values(t||NC(r)).join()].join("")},4096),NC=function(r){var t=r.style.fontFamily||"sans-serif",e=r.style.fontWeight||"normal",n=r.style.fontStyle||"normal",i=r.style.fontVariant,a=r.style.fontSize;return a=typeof a=="object"?a.value:a,{fontSize:a,fontFamily:t,fontWeight:e,fontStyle:n,fontVariant:i}};function PC(r){return r.nodeName==="text"?r:r.nodeName==="g"&&r.children.length===1&&r.children[0].nodeName==="text"?r.children[0]:null}function CC(r,t){var e=PC(r);e&&e.attr(t)}function Xm(r,t,e){e===void 0&&(e="..."),CC(r,{wordWrap:!0,wordWrapWidth:t,maxLines:1,textOverflow:e})}function HV(r,t,e,n){e===void 0&&(e=2),n===void 0&&(n="top"),CC(r,{wordWrap:!0,wordWrapWidth:t,maxLines:e,textBaseline:n})}function ZM(r){var t=r.nativeEvent,e=r.touches,n=r.clientX,i=r.clientY;if(t)return[t.clientX,t.clientY];if(e){var a=e[0],s=a.clientX,o=a.clientY;return[s,o]}return typeof n=="number"&&typeof i=="number"?[n,i]:[0,0]}function qi(r){return typeof r=="function"?r():ae(r)||St(r)?new pb({style:{text:String(r)}}):r}function XV(r,t){return typeof r=="function"?r():ae(r)||St(r)?new rs({style:at(at({pointerEvents:"auto"},t),{innerHTML:r})}):r}function KV(r,t){return r.reduce(function(e,n){return(e[n[t]]=e[n[t]]||[]).push(n),e},{})}function or(r,t,e,n,i){return n===void 0&&(n=!0),i===void 0&&(i=function(a){a.node().removeChildren()}),r?e(t):(n&&i(t),null)}function kn(r,t,e,n,i){return n===void 0&&(n=!0),i===void 0&&(i=!1),n&&r===t||i&&r===e?!0:r>t&&r<e}var ZV=function(r,t){return function(e){return r*(1-e)+t*e}};function JV(r,t){var e=t?t.length:0,n=r?Math.min(e,r.length):0;return function(i){var a=new Array(n),s=new Array(e),o=0;for(o=0;o<n;++o)a[o]=yb(r[o],t[o]);for(;o<e;++o)s[o]=t[o];for(o=0;o<n;++o)s[o]=a[o](i);return s}}function QV(r,t){r===void 0&&(r={}),t===void 0&&(t={});var e={},n={};return Object.entries(t).forEach(function(i){var a=q(i,2),s=a[0],o=a[1];s in r?e[s]=yb(r[s],o):n[s]=o}),function(i){return Object.entries(e).forEach(function(a){var s=q(a,2),o=s[0],l=s[1];return n[o]=l(i)}),n}}function yb(r,t){return typeof r=="number"&&typeof t=="number"?ZV(r,t):Array.isArray(r)&&Array.isArray(t)?JV(r,t):typeof r=="object"&&typeof t=="object"?QV(r,t):(function(e){return r})}function tU(r,t,e,n){if(!n)return r.attr("__keyframe_data__",e),null;var i=n.duration,a=i===void 0?0:i,s=yb(t,e),o=Math.ceil(+a/16),l=new Array(o).fill(0).map(function(c,u,h){return{__keyframe_data__:s(u/(h.length-1))}});return r.animate(l,at({fill:"both"},n))}function Ri(r,t){return[r[0]*t,r[1]*t]}function Ao(r,t){return[r[0]+t[0],r[1]+t[1]]}function Iy(r,t){return[r[0]-t[0],r[1]-t[1]]}function Oa(r,t){return[Math.min(r[0],t[0]),Math.min(r[1],t[1])]}function Aa(r,t){return[Math.max(r[0],t[0]),Math.max(r[1],t[1])]}function el(r,t){return Math.sqrt(Math.pow(r[0]-t[0],2)+Math.pow(r[1]-t[1],2))}function RC(r){if(r[0]===0&&r[1]===0)return[0,0];var t=Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2));return[r[0]/t,r[1]/t]}function eU(r,t){return t?[r[1],-r[0]]:[-r[1],r[0]]}function JM(r,t){return+r.toPrecision(t)}function Km(r,t){var e={},n=Array.isArray(t)?t:[t];for(var i in r)n.includes(i)||(e[i]=r[i]);return e}function nU(r,t,e,n){var i,a=[],s=!!n,o,l,c=[1/0,1/0],u=[-1/0,-1/0],h,d,f;if(s){i=q(n,2),c=i[0],u=i[1];for(var g=0,v=r.length;g<v;g+=1){var p=r[g];c=Oa(c,p),u=Aa(u,p)}}for(var g=0,y=r.length;g<y;g+=1){var p=r[g];if(g===0)f=p;else if(g===y-1)d=p,a.push(f),a.push(d);else{var m=[g?g-1:y-1,g-1][1];o=r[m],l=r[g+1];var x=[0,0];x=Iy(l,o),x=Ri(x,t);var E=el(p,o),_=el(p,l),M=E+_;M!==0&&(E/=M,_/=M);var O=Ri(x,-E),T=Ri(x,_);d=Ao(p,O),h=Ao(p,T),h=Oa(h,Aa(l,p)),h=Aa(h,Oa(l,p)),O=Iy(h,p),O=Ri(O,-E/_),d=Ao(p,O),d=Oa(d,Aa(o,p)),d=Aa(d,Oa(o,p)),T=Iy(p,d),T=Ri(T,_/E),h=Ao(p,T),s&&(d=Aa(d,c),d=Oa(d,u),h=Aa(h,c),h=Oa(h,u)),a.push(f),a.push(d),f=h}}return a}function rU(r,t,e){e===void 0&&(e=[[0,0],[1,1]]);for(var n=!1,i=[],a=0,s=r.length;a<s;a+=2)i.push([r[a],r[a+1]]);for(var o=nU(i,.4,n,e),l=i.length,c=[],u,h,d,a=0;a<l-1;a+=1)u=o[a*2],h=o[a*2+1],d=i[a+1],c.push(["C",u[0],u[1],h[0],h[1],d[0],d[1]]);return c}var iU=["$el","cx","cy","d","dx","dy","fill","fillOpacity","filter","fontFamily","fontSize","fontStyle","fontVariant","fontWeight","height","img","increasedLineWidthForHitTesting","innerHTML","isBillboard","billboardRotation","isSizeAttenuation","isClosed","isOverflowing","leading","letterSpacing","lineDash","lineHeight","lineWidth","markerEnd","markerEndOffset","markerMid","markerStart","markerStartOffset","maxLines","metrics","miterLimit","offsetX","offsetY","opacity","path","points","r","radius","rx","ry","shadowColor","src","stroke","strokeOpacity","text","textAlign","textBaseline","textDecorationColor","textDecorationLine","textDecorationStyle","textOverflow","textPath","textPathSide","textPathStartOffset","transform","transformOrigin","visibility","width","wordWrap","wordWrapWidth","x","x1","x2","y","y1","y2","z1","z2","zIndex"];function aU(r){return iU.includes(r)}function QM(r){var t={};for(var e in r)aU(e)&&(t[e]=r[e]);return t}function sU(r,t){if(r.length<=t)return r;for(var e=Math.floor(r.length/t),n=[],i=0;i<r.length;i+=e)n.push(r[i]);return n}function mb(r,t,e){var n=r.getBBox(),i=n.width,a=n.height,s=t/Math.max(i,a);return r.style.transform="scale(".concat(s,")"),s}function oU(r,t){var e=new Map;return r.forEach(function(n){var i=t(n);e.has(i)||e.set(i,[]),e.get(i).push(n)}),e}function lU(r){throw new Error(r)}var cU=(function(){function r(i,a,s,o,l,c,u){i===void 0&&(i=null),a===void 0&&(a=null),s===void 0&&(s=null),o===void 0&&(o=null),l===void 0&&(l=[null,null,null,null,null]),c===void 0&&(c=[]),u===void 0&&(u=[]),t.add(this),this._elements=Array.from(i),this._data=a,this._parent=s,this._document=o,this._enter=l[0],this._update=l[1],this._exit=l[2],this._merge=l[3],this._split=l[4],this._transitions=c,this._facetElements=u}r.prototype.selectAll=function(i){var a=typeof i=="string"?this._parent.querySelectorAll(i):i;return new e(a,null,this._elements[0],this._document)},r.prototype.selectFacetAll=function(i){var a=typeof i=="string"?this._parent.querySelectorAll(i):i;return new e(this._elements,null,this._parent,this._document,void 0,void 0,a)},r.prototype.select=function(i){var a=typeof i=="string"?this._parent.querySelectorAll(i)[0]||null:i;return new e([a],null,a,this._document)},r.prototype.append=function(i){var a=this,s=typeof i=="function"?i:function(){return a.createElement(i)},o=[];if(this._data!==null){for(var l=0;l<this._data.length;l++){var c=this._data[l],u=q(Array.isArray(c)?c:[c,null],2),h=u[0],d=u[1],f=s(h,l);f.__data__=h,d!==null&&(f.__fromElements__=d),this._parent.appendChild(f),o.push(f)}return new e(o,null,this._parent,this._document)}for(var l=0;l<this._elements.length;l++){var g=this._elements[l],h=g.__data__,f=s(h,l);g.appendChild(f),o.push(f)}return new e(o,null,o[0],this._document)},r.prototype.maybeAppend=function(i,a){var s=md(this,t,"m",n).call(this,i[0]==="#"?i:"#".concat(i),a);return s.attr("id",i),s},r.prototype.maybeAppendByClassName=function(i,a){var s=i.toString(),o=md(this,t,"m",n).call(this,s[0]==="."?s:".".concat(s),a);return o.attr("className",s),o},r.prototype.maybeAppendByName=function(i,a){var s=md(this,t,"m",n).call(this,'[name="'.concat(i,'"]'),a);return s.attr("name",i),s},r.prototype.data=function(i,a,s){var o,l;a===void 0&&(a=function(P){return P}),s===void 0&&(s=function(){return null});for(var c=[],u=[],h=new Set(this._elements),d=[],f=new Set,g=new Map(this._elements.map(function(P,C){return[a(P.__data__,C),P]})),v=new Map(this._facetElements.map(function(P,C){return[a(P.__data__,C),P]})),p=oU(this._elements,function(P){return s(P.__data__)}),y=0;y<i.length;y++){var m=i[y],x=a(m,y),E=s(m,y);if(g.has(x)){var _=g.get(x);_.__data__=m,_.__facet__=!1,u.push(_),h.delete(_),g.delete(x)}else if(v.has(x)){var _=v.get(x);_.__data__=m,_.__facet__=!0,u.push(_),v.delete(x)}else if(p.has(x)){var M=p.get(x);d.push([m,M]);try{for(var O=(o=void 0,sl(M)),T=O.next();!T.done;T=O.next()){var _=T.value;h.delete(_)}}catch(P){o={error:P}}finally{try{T&&!T.done&&(l=O.return)&&l.call(O)}finally{if(o)throw o.error}}p.delete(x)}else if(g.has(E)){var _=g.get(E);_.__toData__?_.__toData__.push(m):_.__toData__=[m],f.add(_),h.delete(_)}else c.push(m)}var N=[new e([],c,this._parent,this._document),new e(u,null,this._parent,this._document),new e(h,null,this._parent,this._document),new e([],d,this._parent,this._document),new e(f,null,this._parent,this._document)];return new e(this._elements,null,this._parent,this._document,N)},r.prototype.merge=function(i){var a=Nt(Nt([],q(this._elements),!1),q(i._elements),!1),s=Nt(Nt([],q(this._transitions),!1),q(i._transitions),!1);return new e(a,null,this._parent,this._document,void 0,s)},r.prototype.createElement=function(i){if(this._document)return this._document.createElement(i,{});var a=e.registry[i];return a?new a:lU("Unknown node type: ".concat(i))},r.prototype.join=function(i,a,s,o,l){i===void 0&&(i=function(g){return g}),a===void 0&&(a=function(g){return g}),s===void 0&&(s=function(g){return g.remove()}),o===void 0&&(o=function(g){return g}),l===void 0&&(l=function(g){return g.remove()});var c=i(this._enter),u=a(this._update),h=s(this._exit),d=o(this._merge),f=l(this._split);return u.merge(c).merge(h).merge(d).merge(f)},r.prototype.remove=function(){for(var i=function(o){var l=a._elements[o],c=a._transitions[o];c?c.then(function(){return l.remove()}):l.remove()},a=this,s=0;s<this._elements.length;s++)i(s);return new e([],null,this._parent,this._document,void 0,this._transitions)},r.prototype.each=function(i){for(var a=0;a<this._elements.length;a++){var s=this._elements[a],o=s.__data__;i.call(s,o,a)}return this},r.prototype.attr=function(i,a){var s=typeof a!="function"?function(){return a}:a;return this.each(function(o,l){a!==void 0&&(this[i]=s.call(this,o,l))})},r.prototype.style=function(i,a,s){s===void 0&&(s=!0);var o=typeof a!="function"||!s?function(){return a}:a;return this.each(function(l,c){a!==void 0&&(this.style[i]=o.call(this,l,c))})},r.prototype.styles=function(i,a){return i===void 0&&(i={}),a===void 0&&(a=!0),this.each(function(s,o){var l=this;Object.entries(i).forEach(function(c){var u=q(c,2),h=u[0],d=u[1],f=typeof d!="function"||!a?function(){return d}:d;d!==void 0&&l.attr(h,f.call(l,s,o))})})},r.prototype.update=function(i,a){a===void 0&&(a=!0);var s=typeof i!="function"||!a?function(){return i}:i;return this.each(function(o,l){i&&this.update&&this.update(s.call(this,o,l))})},r.prototype.maybeUpdate=function(i,a){a===void 0&&(a=!0);var s=typeof i!="function"||!a?function(){return i}:i;return this.each(function(o,l){i&&this.update&&this.update(s.call(this,o,l))})},r.prototype.transition=function(i){this._transitions;var a=new Array(this._elements.length);return this.each(function(s,o){a[o]=i.call(this,s,o)}),this._transitions=I3(a),this},r.prototype.on=function(i,a){return this.each(function(){this.addEventListener(i,a)}),this},r.prototype.call=function(i){for(var a=[],s=1;s<arguments.length;s++)a[s-1]=arguments[s];return i.call.apply(i,Nt([this._parent,this],q(a),!1)),this},r.prototype.node=function(){return this._elements[0]},r.prototype.nodes=function(){return this._elements},r.prototype.transitions=function(){return this._transitions.filter(function(i){return!!i})},r.prototype.parent=function(){return this._parent};var t,e,n;return e=r,t=new WeakSet,n=function(a,s){var o=this._elements[0],l=o.querySelector(a);if(l)return new e([l],null,this._parent,this._document);var c=typeof s=="string"?this.createElement(s):s();return o.appendChild(c),new e([c],null,this._parent,this._document)},r.registry={g:gn,rect:Nn,circle:mi,path:pr,text:pb,ellipse:cl,image:ul,line:Ka,polygon:is,polyline:Lu,html:rs},r})();function Ot(r){return new cU([r],null,r,r.ownerDocument)}function uU(r,t,e){return r.querySelector(t)?Ot(r).select(t):Ot(r).append(e)}function Pn(r){if(St(r))return[r,r,r,r];if(cr(r)){var t=r.length;if(t===1)return[r[0],r[0],r[0],r[0]];if(t===2)return[r[0],r[1],r[0],r[1]];if(t===3)return[r[0],r[1],r[2],r[1]];if(t===4)return r}return[0,0,0,0]}function tT(r){var t=r.getLocalBounds(),e=t.min,n=t.max,i=q([e,n],2),a=q(i[0],2),s=a[0],o=a[1],l=q(i[1],2),c=l[0],u=l[1];return{x:s,y:o,width:c-s,height:u-o,left:s,bottom:u,top:o,right:c}}function hU(r,t){var e=q(r,2),n=e[0],i=e[1],a=q(t,2),s=a[0],o=a[1];return n!==s&&i===o}function dU(r,t){var e,n,i=t.attributes;try{for(var a=sl(Object.entries(i)),s=a.next();!s.done;s=a.next()){var o=q(s.value,2),l=o[0],c=o[1];l!=="id"&&l!=="className"&&r.attr(l,c)}}catch(u){e={error:u}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}}function bb(r){return r.toString().charAt(0).toUpperCase()+r.toString().slice(1)}function fU(r){return r.toString().charAt(0).toLowerCase()+r.toString().slice(1)}function gU(r,t){return"".concat(t).concat(bb(r))}function eT(r,t,e){var n;e===void 0&&(e=!0);var i=t||((n=r.match(/^([a-z][a-z0-9]+)/))===null||n===void 0?void 0:n[0])||"",a=r.replace(new RegExp("^(".concat(i,")")),"");return e?fU(a):a}function vU(r,t){Object.entries(t).forEach(function(e){var n=q(e,2),i=n[0],a=n[1];Nt([r],q(r.querySelectorAll(i)),!1).filter(function(s){return s.matches(i)}).forEach(function(s){if(s){var o=s;o.style.cssText+=Object.entries(a).reduce(function(l,c){return"".concat(l).concat(c.join(":"),";")},"")}})})}var Nc=function(r,t){if(!(r!=null&&r.startsWith(t)))return!1;var e=r[t.length];return e>="A"&&e<="Z"};function jt(r,t,e){e===void 0&&(e=!1);var n={};return Object.entries(r).forEach(function(i){var a=q(i,2),s=a[0],o=a[1];if(!(s==="className"||s==="class")){if(Nc(s,"show")&&Nc(eT(s,"show"),t)!==e)s===gU(t,"show")?n[s]=o:n[s.replace(new RegExp(bb(t)),"")]=o;else if(!Nc(s,"show")&&Nc(s,t)!==e){var l=eT(s,t);l==="filter"&&typeof o=="function"||(n[l]=o)}}}),n}function Ts(r,t){return Object.entries(r).reduce(function(e,n){var i=q(n,2),a=i[0],s=i[1];return a.startsWith("show")?e["show".concat(t).concat(a.slice(4))]=s:e["".concat(t).concat(bb(a))]=s,e},{})}function Gi(r,t){t===void 0&&(t=["x","y","class","className"]);var e=["transform","transformOrigin","anchor","visibility","pointerEvents","zIndex","cursor","clipPath","clipPathTargets","offsetPath","offsetPathTargets","offsetDistance","draggable","droppable"],n={},i={};return Object.entries(r).forEach(function(a){var s=q(a,2),o=s[0],l=s[1];t.includes(o)||(e.indexOf(o)!==-1?i[o]=l:n[o]=l)}),[n,i]}function Qn(r,t){var e={YYYY:r.getFullYear(),MM:r.getMonth()+1,DD:r.getDate(),HH:r.getHours(),mm:r.getMinutes(),ss:r.getSeconds()},n=t;return Object.keys(e).forEach(function(i){var a=e[i];n=n.replace(i,i==="YYYY"?"".concat(a):"".concat(a).padStart(2,"0"))}),n}function pU(r,t,e){var n=r.getBBox(),i=n.width,a=n.height,s=q([t,e].map(function(c,u){var h;return c.includes("%")?parseFloat(((h=c.match(/[+-]?([0-9]*[.])?[0-9]+/))===null||h===void 0?void 0:h[0])||"0")/100*(u===0?i:a):c}),2),o=s[0],l=s[1];return[o,l]}function LC(r,t){if(t)try{var e=/translate\(([+-]*[\d]+[%]*),[ ]*([+-]*[\d]+[%]*)\)/g,n=t.replace(e,function(i,a,s){return"translate(".concat(pU(r,a,s),")")});r.attr("transform",n)}catch{}}function yU(r){var t;return((t=r[0])===null||t===void 0?void 0:t.map(function(e,n){return r.map(function(i){return i[n]})}))||[]}var nT=function(r,t){if(t==null){r.innerHTML="";return}r.replaceChildren?Array.isArray(t)?r.replaceChildren.apply(r,Nt([],q(t),!1)):r.replaceChildren(t):(r.innerHTML="",Array.isArray(t)?t.forEach(function(e){return r.appendChild(e)}):r.appendChild(t))};function Wh(r){return/\S+-\S+/g.test(r)?r.split("-").map(function(t){return t[0]}):r.length>2?[r[0]]:r.split("")}var mU=function(r){var t=new DOMParser,e=t.parseFromString(r,"text/html"),n=e.body.firstElementChild;if(console.log(n==null?void 0:n.getClientRects(),11),!n)return 0;var i=n.getAttribute("style")||"",a=Object.fromEntries(i.split(";").map(function(p){return p.trim()}).filter(function(p){return p.includes(":")}).map(function(p){var y=q(p.split(":").map(function(E){return E.trim()}),2),m=y[0],x=y[1];return[m.toLowerCase(),x]})),s=function(p){if(!p)return 0;var y=p.match(/([\d.]+)px/);return y?parseFloat(y[1]):0};if(a.height)return s(a.height);var o=s(a["font-size"])||16,l=a["line-height"],c;!l||l==="normal"?c=1.2*o:l.endsWith("px")?c=s(l):/^[\d.]+$/.test(l)?c=parseFloat(l)*o:c=o;var u=s(a["padding-top"]),h=s(a["padding-bottom"]);if(a.padding){var d=a.padding.split(/\s+/).map(s);d.length===1||d.length===2?(u=d[0],h=d[0]):(d.length===3||d.length===4)&&(u=d[0],h=d[2])}var f=s(a["border-top-width"]),g=s(a["border-bottom-width"]);if(a.border){var v=a.border.match(/([\d.]+)px/);v&&(f=parseFloat(v[1]),g=parseFloat(v[1]))}if(a["border-width"]){var d=a["border-width"].split(/\s+/).map(s);d.length===1||d.length===2?(f=d[0],g=d[0]):(d.length===3||d.length===4)&&(f=d[0],g=d[2])}return c+u+h+f+g};function bU(){$h(this,this.attributes.visibility!=="hidden")}var $e=(function(r){Ut(t,r);function t(e,n){n===void 0&&(n={});var i=r.call(this,on({},{style:n},e))||this;return i.initialized=!1,i._defaultOptions=n,i}return Object.defineProperty(t.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=TC(this)),this._offscreen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"defaultOptions",{get:function(){return this._defaultOptions},enumerable:!1,configurable:!0}),t.prototype.connectedCallback=function(){this.render(this.attributes,this),this.bindEvents(this.attributes,this),this.initialized=!0},t.prototype.disconnectedCallback=function(){var e;(e=this._offscreen)===null||e===void 0||e.destroy()},t.prototype.attributeChangedCallback=function(e){e==="visibility"&&bU.call(this)},t.prototype.update=function(e,n){var i;return this.attr(on({},this.attributes,e||{})),(i=this.render)===null||i===void 0?void 0:i.call(this,this.attributes,this,n)},t.prototype.clear=function(){this.removeChildren()},t.prototype.bindEvents=function(e,n){},t.prototype.getSubShapeStyle=function(e){e.x,e.y,e.transform,e.transformOrigin,e.class,e.className,e.zIndex;var n=Pe(e,["x","y","transform","transformOrigin","class","className","zIndex"]);return n},t})(E1),IC=function(r,t,e){return[["M",r-e,t],["A",e,e,0,1,0,r+e,t],["A",e,e,0,1,0,r-e,t],["Z"]]},xU=IC,wU=function(r,t,e){return[["M",r-e,t-e],["L",r+e,t-e],["L",r+e,t+e],["L",r-e,t+e],["Z"]]},EU=function(r,t,e){return[["M",r-e,t],["L",r,t-e],["L",r+e,t],["L",r,t+e],["Z"]]},SU=function(r,t,e){var n=e*Math.sin(.3333333333333333*Math.PI);return[["M",r-e,t+n],["L",r,t-n],["L",r+e,t+n],["Z"]]},_U=function(r,t,e){var n=e*Math.sin(.3333333333333333*Math.PI);return[["M",r-e,t-n],["L",r+e,t-n],["L",r,t+n],["Z"]]},kU=function(r,t,e){var n=e/2*Math.sqrt(3);return[["M",r,t-e],["L",r+n,t-e/2],["L",r+n,t+e/2],["L",r,t+e],["L",r-n,t+e/2],["L",r-n,t-e/2],["Z"]]},MU=function(r,t,e){var n=e-1.5;return[["M",r-e,t-n],["L",r+e,t+n],["L",r+e,t-n],["L",r-e,t+n],["Z"]]},DC=function(r,t,e){return[["M",r,t+e],["L",r,t-e]]},TU=function(r,t,e){return[["M",r-e,t-e],["L",r+e,t+e],["M",r+e,t-e],["L",r-e,t+e]]},OU=function(r,t,e){return[["M",r-e/2,t-e],["L",r+e/2,t-e],["M",r,t-e],["L",r,t+e],["M",r-e/2,t+e],["L",r+e/2,t+e]]},AU=function(r,t,e){return[["M",r-e,t],["L",r+e,t],["M",r,t-e],["L",r,t+e]]},NU=function(r,t,e){return[["M",r-e,t],["L",r+e,t]]},FC=function(r,t,e){return[["M",r-e,t],["L",r+e,t]]},PU=FC,CU=function(r,t,e){return[["M",r-e,t],["A",e/2,e/2,0,1,1,r,t],["A",e/2,e/2,0,1,0,r+e,t]]},RU=function(r,t,e){return[["M",r-e-1,t-2.5],["L",r,t-2.5],["L",r,t+2.5],["L",r+e+1,t+2.5]]},LU=function(r,t,e){return[["M",r-e-1,t+2.5],["L",r,t+2.5],["L",r,t-2.5],["L",r+e+1,t-2.5]]},IU=function(r,t,e){return[["M",r-(e+1),t+2.5],["L",r-e/2,t+2.5],["L",r-e/2,t-2.5],["L",r+e/2,t-2.5],["L",r+e/2,t+2.5],["L",r+e+1,t+2.5]]};function DU(r,t){return[["M",r-5,t+2.5],["L",r-5,t],["L",r,t],["L",r,t-3],["L",r,t+3],["L",r+6.5,t+3]]}var FU=function(r,t,e){return[["M",r-e,t-e],["L",r+e,t],["L",r-e,t+e],["Z"]]},BU=function(r,t,e){var n=e,i=e*.2,a=e*.7;return[["M",r-n,t],["A",n,n,0,1,0,r+n,t],["A",n,n,0,1,0,r-n,t],["Z"],["M",r-a,t],["L",r-i,t],["M",r+i,t],["L",r+a,t],["M",r,t-a],["L",r,t-i],["M",r,t+i],["L",r,t+a]]};function zU(r){var t="default";if(Ze(r)&&r instanceof Image)t="image";else if(Tt(r))t="symbol";else if(ae(r)){var e=new RegExp("data:(image|text)");r.match(e)?t="base64":/^(https?:\/\/(([a-zA-Z0-9]+-?)+[a-zA-Z0-9]+\.)+[a-zA-Z]+)(:\d+)?(\/.*)?(\?.*)?(#.*)?$/.test(r)?t="url":t="symbol"}return t}function jU(r){var t=zU(r);return["base64","url","image"].includes(t)?"image":r&&t==="symbol"?"path":null}var le=(function(r){Ut(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.render=function(e,n){var i=e.x,a=i===void 0?0:i,s=e.y,o=s===void 0?0:s,l=this.getSubShapeStyle(e),c=l.symbol,u=l.size,h=u===void 0?16:u,d=Pe(l,["symbol","size"]),f=jU(c);or(!!f,Ot(n),function(g){g.maybeAppendByClassName("marker",f).attr("className","marker ".concat(f,"-marker")).call(function(v){if(f==="image"){var p=h*2;v.styles({img:c,width:p,height:p,x:a-h,y:o-h})}else{var p=h/2,y=Tt(c)?c:t.getSymbol(c);v.styles(at({d:y==null?void 0:y(a,o,p)},d))}})})},t.MARKER_SYMBOL_MAP=new Map,t.registerSymbol=function(e,n){t.MARKER_SYMBOL_MAP.set(e,n)},t.getSymbol=function(e){return t.MARKER_SYMBOL_MAP.get(e)},t.getSymbols=function(){return Array.from(t.MARKER_SYMBOL_MAP.keys())},t})($e);le.registerSymbol("cross",TU);le.registerSymbol("hyphen",NU);le.registerSymbol("line",DC);le.registerSymbol("plus",AU);le.registerSymbol("tick",OU);le.registerSymbol("circle",IC);le.registerSymbol("point",xU);le.registerSymbol("bowtie",MU);le.registerSymbol("hexagon",kU);le.registerSymbol("square",wU);le.registerSymbol("diamond",EU);le.registerSymbol("triangle",SU);le.registerSymbol("triangle-down",_U);le.registerSymbol("line",DC);le.registerSymbol("dot",FC);le.registerSymbol("dash",PU);le.registerSymbol("smooth",CU);le.registerSymbol("hv",RU);le.registerSymbol("vh",LU);le.registerSymbol("hvh",IU);le.registerSymbol("vhv",DU);le.registerSymbol("focus",BU);function Mu(r,...t){return t.reduce((e,n)=>i=>e(n(i)),r)}function Zm(r,t){return t-r?e=>(e-r)/(t-r):e=>.5}function qU(r,t){const e=t<r?t:r,n=r>t?r:t;return i=>Math.min(Math.max(e,i),n)}function GU(r,t,e,n,i){let a=e,s=n||r.length;const o=(l=>l);for(;a<s;){const l=Math.floor((a+s)/2);o(r[l])>t?s=l:a=l+1}return a}const rT=Math.sqrt(50),iT=Math.sqrt(10),aT=Math.sqrt(2);function Gc(r,t,e){const n=(t-r)/Math.max(0,e),i=Math.floor(Math.log(n)/Math.LN10),a=n/10**i;return i>=0?(a>=rT?10:a>=iT?5:a>=aT?2:1)*10**i:-(10**-i)/(a>=rT?10:a>=iT?5:a>=aT?2:1)}const $U=(r,t,e=5)=>{const n=[r,t];let i=0,a=n.length-1,s=n[i],o=n[a],l;return o<s&&([s,o]=[o,s],[i,a]=[a,i]),l=Gc(s,o,e),l>0?(s=Math.floor(s/l)*l,o=Math.ceil(o/l)*l,l=Gc(s,o,e)):l<0&&(s=Math.ceil(s*l)/l,o=Math.floor(o*l)/l,l=Gc(s,o,e)),l>0?(n[i]=Math.floor(s/l)*l,n[a]=Math.ceil(o/l)*l):l<0&&(n[i]=Math.ceil(s*l)/l,n[a]=Math.floor(o*l)/l),n};function sT(r){return!Dt(r)&&!Y3(r)&&!Number.isNaN(r)}var Dy={exports:{}},Fy,oT;function WU(){return oT||(oT=1,Fy={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}),Fy}var By={exports:{}},zy,lT;function VU(){return lT||(lT=1,zy=function(t){return!t||typeof t=="string"?!1:t instanceof Array||Array.isArray(t)||t.length>=0&&(t.splice instanceof Function||Object.getOwnPropertyDescriptor(t,t.length-1)&&t.constructor.name!=="String")}),zy}var cT;function UU(){if(cT)return By.exports;cT=1;var r=VU(),t=Array.prototype.concat,e=Array.prototype.slice,n=By.exports=function(a){for(var s=[],o=0,l=a.length;o<l;o++){var c=a[o];r(c)?s=t.call(s,e.call(c)):s.push(c)}return s};return n.wrap=function(i){return function(){return i(n(arguments))}},By.exports}var uT;function YU(){if(uT)return Dy.exports;uT=1;var r=WU(),t=UU(),e=Object.hasOwnProperty,n=Object.create(null);for(var i in r)e.call(r,i)&&(n[r[i]]=i);var a=Dy.exports={to:{},get:{}};a.get=function(l){var c=l.substring(0,3).toLowerCase(),u,h;switch(c){case"hsl":u=a.get.hsl(l),h="hsl";break;case"hwb":u=a.get.hwb(l),h="hwb";break;default:u=a.get.rgb(l),h="rgb";break}return u?{model:h,value:u}:null},a.get.rgb=function(l){if(!l)return null;var c=/^#([a-f0-9]{3,4})$/i,u=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,h=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,d=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,f=/^(\w+)$/,g=[0,0,0,1],v,p,y;if(v=l.match(u)){for(y=v[2],v=v[1],p=0;p<3;p++){var m=p*2;g[p]=parseInt(v.slice(m,m+2),16)}y&&(g[3]=parseInt(y,16)/255)}else if(v=l.match(c)){for(v=v[1],y=v[3],p=0;p<3;p++)g[p]=parseInt(v[p]+v[p],16);y&&(g[3]=parseInt(y+y,16)/255)}else if(v=l.match(h)){for(p=0;p<3;p++)g[p]=parseInt(v[p+1],0);v[4]&&(v[5]?g[3]=parseFloat(v[4])*.01:g[3]=parseFloat(v[4]))}else if(v=l.match(d)){for(p=0;p<3;p++)g[p]=Math.round(parseFloat(v[p+1])*2.55);v[4]&&(v[5]?g[3]=parseFloat(v[4])*.01:g[3]=parseFloat(v[4]))}else return(v=l.match(f))?v[1]==="transparent"?[0,0,0,0]:e.call(r,v[1])?(g=r[v[1]],g[3]=1,g):null:null;for(p=0;p<3;p++)g[p]=s(g[p],0,255);return g[3]=s(g[3],0,1),g},a.get.hsl=function(l){if(!l)return null;var c=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,u=l.match(c);if(u){var h=parseFloat(u[4]),d=(parseFloat(u[1])%360+360)%360,f=s(parseFloat(u[2]),0,100),g=s(parseFloat(u[3]),0,100),v=s(isNaN(h)?1:h,0,1);return[d,f,g,v]}return null},a.get.hwb=function(l){if(!l)return null;var c=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,u=l.match(c);if(u){var h=parseFloat(u[4]),d=(parseFloat(u[1])%360+360)%360,f=s(parseFloat(u[2]),0,100),g=s(parseFloat(u[3]),0,100),v=s(isNaN(h)?1:h,0,1);return[d,f,g,v]}return null},a.to.hex=function(){var l=t(arguments);return"#"+o(l[0])+o(l[1])+o(l[2])+(l[3]<1?o(Math.round(l[3]*255)):"")},a.to.rgb=function(){var l=t(arguments);return l.length<4||l[3]===1?"rgb("+Math.round(l[0])+", "+Math.round(l[1])+", "+Math.round(l[2])+")":"rgba("+Math.round(l[0])+", "+Math.round(l[1])+", "+Math.round(l[2])+", "+l[3]+")"},a.to.rgb.percent=function(){var l=t(arguments),c=Math.round(l[0]/255*100),u=Math.round(l[1]/255*100),h=Math.round(l[2]/255*100);return l.length<4||l[3]===1?"rgb("+c+"%, "+u+"%, "+h+"%)":"rgba("+c+"%, "+u+"%, "+h+"%, "+l[3]+")"},a.to.hsl=function(){var l=t(arguments);return l.length<4||l[3]===1?"hsl("+l[0]+", "+l[1]+"%, "+l[2]+"%)":"hsla("+l[0]+", "+l[1]+"%, "+l[2]+"%, "+l[3]+")"},a.to.hwb=function(){var l=t(arguments),c="";return l.length>=4&&l[3]!==1&&(c=", "+l[3]),"hwb("+l[0]+", "+l[1]+"%, "+l[2]+"%"+c+")"},a.to.keyword=function(l){return n[l.slice(0,3)]};function s(l,c,u){return Math.min(Math.max(c,l),u)}function o(l){var c=Math.round(l).toString(16).toUpperCase();return c.length<2?"0"+c:c}return Dy.exports}var HU=YU();const XU=Au(HU);function jy(r,t,e){let n=e;return n<0&&(n+=1),n>1&&(n-=1),n<1/6?r+(t-r)*6*n:n<1/2?t:n<2/3?r+(t-r)*(2/3-n)*6:r}function KU(r){const t=r[0]/360,e=r[1]/100,n=r[2]/100,i=r[3];if(e===0)return[n*255,n*255,n*255,i];const a=n<.5?n*(1+e):n+e-n*e,s=2*n-a,o=jy(s,a,t+1/3),l=jy(s,a,t),c=jy(s,a,t-1/3);return[o*255,l*255,c*255,i]}function hT(r){const t=XU.get(r);if(!t)return null;const{model:e,value:n}=t;return e==="rgb"?n:e==="hsl"?KU(n):null}const Tu=(r,t)=>e=>r*(1-e)+t*e,ZU=(r,t)=>{const e=hT(r),n=hT(t);return e===null||n===null?e?()=>r:()=>t:i=>{const a=new Array(4);for(let u=0;u<4;u+=1){const h=e[u],d=n[u];a[u]=h*(1-i)+d*i}const[s,o,l,c]=a;return`rgba(${Math.round(s)}, ${Math.round(o)}, ${Math.round(l)}, ${c})`}},JU=(r,t)=>typeof r=="number"&&typeof t=="number"?Tu(r,t):typeof r=="string"&&typeof t=="string"?ZU(r,t):()=>r,QU=(r,t)=>{const e=Tu(r,t);return n=>Math.round(e(n))};function dT({map:r,initKey:t},e){const n=t(e);return r.has(n)?r.get(n):e}function tY({map:r,initKey:t},e){const n=t(e);return r.has(n)?r.get(n):(r.set(n,e),e)}function eY({map:r,initKey:t},e){const n=t(e);return r.has(n)&&(e=r.get(n),r.delete(n)),e}function nY(r){return typeof r=="object"?r.valueOf():r}class fT extends Map{constructor(t){if(super(),this.map=new Map,this.initKey=nY,t!==null)for(const[e,n]of t)this.set(e,n)}get(t){return super.get(dT({map:this.map,initKey:this.initKey},t))}has(t){return super.has(dT({map:this.map,initKey:this.initKey},t))}set(t,e){return super.set(tY({map:this.map,initKey:this.initKey},t),e)}delete(t){return super.delete(eY({map:this.map,initKey:this.initKey},t))}}class BC{constructor(t){this.options=An({},this.getDefaultOptions()),this.update(t)}getOptions(){return this.options}update(t={}){this.options=An({},this.options,t),this.rescale(t)}rescale(t){}}const xb=Symbol("defaultUnknown");function gT(r,t,e){for(let n=0;n<t.length;n+=1)r.has(t[n])||r.set(e(t[n]),n)}function vT(r){const{value:t,from:e,to:n,mapper:i,notFoundReturn:a}=r;let s=i.get(t);if(s===void 0){if(a!==xb)return a;s=e.push(t)-1,i.set(t,s)}return n[s%n.length]}function pT(r){return r instanceof Date?t=>`${t}`:typeof r=="object"?t=>JSON.stringify(t):t=>t}class wb extends BC{getDefaultOptions(){return{domain:[],range:[],unknown:xb}}constructor(t){super(t)}map(t){return this.domainIndexMap.size===0&&gT(this.domainIndexMap,this.getDomain(),this.domainKey),vT({value:this.domainKey(t),mapper:this.domainIndexMap,from:this.getDomain(),to:this.getRange(),notFoundReturn:this.options.unknown})}invert(t){return this.rangeIndexMap.size===0&&gT(this.rangeIndexMap,this.getRange(),this.rangeKey),vT({value:this.rangeKey(t),mapper:this.rangeIndexMap,from:this.getRange(),to:this.getDomain(),notFoundReturn:this.options.unknown})}rescale(t){const[e]=this.options.domain,[n]=this.options.range;if(this.domainKey=pT(e),this.rangeKey=pT(n),!this.rangeIndexMap){this.rangeIndexMap=new Map,this.domainIndexMap=new Map;return}(!t||t.range)&&this.rangeIndexMap.clear(),(!t||t.domain||t.compare)&&(this.domainIndexMap.clear(),this.sortedDomain=void 0)}clone(){return new wb(this.options)}getRange(){return this.options.range}getDomain(){if(this.sortedDomain)return this.sortedDomain;const{domain:t,compare:e}=this.options;return this.sortedDomain=e?[...t].sort(e):t,this.sortedDomain}}function rY(r){const t=Math.min(...r);return r.map(e=>e/t)}function iY(r,t){const e=r.length,n=t-e;return n>0?[...r,...new Array(n).fill(1)]:n<0?r.slice(0,t):r}function aY(r){return Math.round(r*1e12)/1e12}function sY(r){const{domain:t,range:e,paddingOuter:n,paddingInner:i,flex:a,round:s,align:o}=r,l=t.length,c=iY(a,l),[u,h]=e,d=h-u,f=2/l*n+1-1/l*i,g=d/f,v=g*i/l,p=g-l*v,y=rY(c),m=y.reduce((R,I)=>R+I),x=p/m,E=new fT(t.map((R,I)=>{const j=y[I]*x;return[R,s?Math.floor(j):j]})),_=new fT(t.map((R,I)=>{const G=y[I]*x+v;return[R,s?Math.floor(G):G]})),M=Array.from(_.values()).reduce((R,I)=>R+I),T=(d-(M-M/l*i))*o,N=u+T;let P=s?Math.round(N):N;const C=new Array(l);for(let R=0;R<l;R+=1){C[R]=aY(P);const I=t[R];P+=_.get(I)}return{valueBandWidth:E,valueStep:_,adjustedRange:C}}function oY(r){var t;const{domain:e}=r,n=e.length;if(n===0)return{valueBandWidth:void 0,valueStep:void 0,adjustedRange:[]};if(!!(!((t=r.flex)===null||t===void 0)&&t.length))return sY(r);const{range:a,paddingOuter:s,paddingInner:o,round:l,align:c}=r;let u,h,d=a[0];const g=a[1]-d,v=s*2,p=n-o;u=g/Math.max(1,v+p),l&&(u=Math.floor(u)),d+=(g-u*(n-o))*c,h=u*(1-o),l&&(d=Math.round(d),h=Math.round(h));const y=new Array(n).fill(0).map((m,x)=>d+x*u);return{valueStep:u,valueBandWidth:h,adjustedRange:y}}class Eb extends wb{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,paddingInner:0,paddingOuter:0,padding:0,unknown:xb,flex:[]}}constructor(t){super(t)}clone(){return new Eb(this.options)}getStep(t){return this.valueStep===void 0?1:typeof this.valueStep=="number"?this.valueStep:t===void 0?Array.from(this.valueStep.values())[0]:this.valueStep.get(t)}getBandWidth(t){return this.valueBandWidth===void 0?1:typeof this.valueBandWidth=="number"?this.valueBandWidth:t===void 0?Array.from(this.valueBandWidth.values())[0]:this.valueBandWidth.get(t)}getRange(){return this.adjustedRange}getPaddingInner(){const{padding:t,paddingInner:e}=this.options;return t>0?t:e}getPaddingOuter(){const{padding:t,paddingOuter:e}=this.options;return t>0?t:e}rescale(){super.rescale();const{align:t,domain:e,range:n,round:i,flex:a}=this.options,{adjustedRange:s,valueBandWidth:o,valueStep:l}=oY({align:t,range:n,round:i,flex:a,paddingInner:this.getPaddingInner(),paddingOuter:this.getPaddingOuter(),domain:e});this.valueStep=l,this.valueBandWidth=o,this.adjustedRange=s}}const lY=(r,t,e)=>{let n,i,a=r,s=t;if(a===s&&e>0)return[a];let o=Gc(a,s,e);if(o===0||!Number.isFinite(o))return[];if(o>0){a=Math.ceil(a/o),s=Math.floor(s/o),i=new Array(n=Math.ceil(s-a+1));for(let l=0;l<n;l+=1)i[l]=(a+l)*o}else{o=-o,a=Math.ceil(a*o),s=Math.floor(s*o),i=new Array(n=Math.ceil(s-a+1));for(let l=0;l<n;l+=1)i[l]=(a+l)/o}return i},cY=(r,t,e)=>{const[n,i]=r,[a,s]=t;let o,l;return n<i?(o=Zm(n,i),l=e(a,s)):(o=Zm(i,n),l=e(s,a)),Mu(l,o)},uY=(r,t,e)=>{const n=Math.min(r.length,t.length)-1,i=new Array(n),a=new Array(n),s=r[0]>r[n],o=s?[...r].reverse():r,l=s?[...t].reverse():t;for(let c=0;c<n;c+=1)i[c]=Zm(o[c],o[c+1]),a[c]=e(l[c],l[c+1]);return c=>{const u=GU(r,c,1,n)-1,h=i[u],d=a[u];return Mu(d,h)(c)}},yT=(r,t,e,n)=>(Math.min(r.length,t.length)>2?uY:cY)(r,t,n?QU:e);class hY extends BC{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,interpolate:Tu,tickCount:5}}map(t){return sT(t)?this.output(t):this.options.unknown}invert(t){return sT(t)?this.input(t):this.options.unknown}nice(){if(!this.options.nice)return;const[t,e,n,...i]=this.getTickMethodOptions();this.options.domain=this.chooseNice()(t,e,n,...i)}getTicks(){const{tickMethod:t}=this.options,[e,n,i,...a]=this.getTickMethodOptions();return t(e,n,i,...a)}getTickMethodOptions(){const{domain:t,tickCount:e}=this.options,n=t[0],i=t[t.length-1];return[n,i,e]}chooseNice(){return $U}rescale(){this.nice();const[t,e]=this.chooseTransforms();this.composeOutput(t,this.chooseClamp(t)),this.composeInput(t,e,this.chooseClamp(e))}chooseClamp(t){const{clamp:e,range:n}=this.options,i=this.options.domain.map(t),a=Math.min(i.length,n.length);return e?qU(i[0],i[a-1]):im}composeOutput(t,e){const{domain:n,range:i,round:a,interpolate:s}=this.options,o=yT(n.map(t),i,s,a);this.output=Mu(o,e,t)}composeInput(t,e,n){const{domain:i,range:a}=this.options,s=yT(a,i.map(t),Tu);this.input=Mu(e,n,s)}}class Bo extends hY{getDefaultOptions(){return{domain:[0,1],range:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolate:JU,tickMethod:lY,tickCount:5}}chooseTransforms(){return[im,im]}clone(){return new Bo(this.options)}}var dY=(function(r){Ut(t,r);function t(e){var n=this,i=e.style,a=Pe(e,["style"]);return n=r.call(this,An({},{type:"column"},at({style:i},a)))||this,n.columnsGroup=new gn({name:"columns"}),n.appendChild(n.columnsGroup),n.render(),n}return t.prototype.render=function(){var e=this.attributes,n=e.columns,i=e.x,a=e.y;this.columnsGroup.style.transform="translate(".concat(i,", ").concat(a,")"),Ot(this.columnsGroup).selectAll(".column").data(n.flat()).join(function(s){return s.append("rect").attr("className","column").each(function(o){this.attr(o)})},function(s){return s.each(function(o){this.attr(o)})},function(s){return s.remove()})},t.prototype.update=function(e){this.attr(on({},this.attributes,e)),this.render()},t.prototype.clear=function(){this.removeChildren()},t})(Se),fY=(function(r){Ut(t,r);function t(e){var n=this,i=e.style,a=Pe(e,["style"]);return n=r.call(this,An({},{type:"lines"},at({style:i},a)))||this,n.linesGroup=n.appendChild(new gn),n.areasGroup=n.appendChild(new gn),n.render(),n}return t.prototype.render=function(){var e=this.attributes,n=e.lines,i=e.areas,a=e.x,s=e.y;this.style.transform="translate(".concat(a,", ").concat(s,")"),n&&this.renderLines(n),i&&this.renderAreas(i)},t.prototype.clear=function(){this.linesGroup.removeChildren(),this.areasGroup.removeChildren()},t.prototype.update=function(e){this.attr(on({},this.attributes,e)),this.render()},t.prototype.renderLines=function(e){Ot(this.linesGroup).selectAll(".line").data(e).join(function(n){return n.append("path").attr("className","line").each(function(i){this.attr(i)})},function(n){return n.each(function(i){this.attr(i)})},function(n){return n.remove()})},t.prototype.renderAreas=function(e){Ot(this.linesGroup).selectAll(".area").data(e).join(function(n){return n.append("path").attr("className","area").each(function(i){this.attr(i)})},function(n){return n.each(function(i){this.style(i)})},function(n){return n.remove()})},t})(Se);function gY(r,t){var e,n=t.x,i=t.y,a=q(i.getOptions().range||[0,0],2),s=a[0],o=a[1];return o>s&&(e=q([s,o],2),o=e[0],s=e[1]),r.map(function(l){var c=l.map(function(u,h){return[n.map(h),qe(i.map(u),o,s)]});return c})}function nl(r,t){t===void 0&&(t=!1);var e=t?r.length-1:0,n=r.map(function(i,a){return Nt([a===e?"M":"L"],q(i),!1)});return t?n.reverse():n}function Ou(r,t){if(t===void 0&&(t=!1),r.length<=2)return nl(r);for(var e=[],n=r.length,i=0;i<n;i+=1){var a=t?r[n-i-1]:r[i];Ge(a,e.slice(-2))||e.push.apply(e,Nt([],q(a),!1))}var s=rU(e);return t?s.unshift(Nt(["M"],q(r[n-1]),!1)):s.unshift(Nt(["M"],q(r[0]),!1)),s}function Sb(r,t,e){var n=da(r);return n.push(["L",t,e],["L",0,e],["Z"]),n}function vY(r,t,e,n){return r.map(function(i){return Sb(t?Ou(i):nl(i),e,n)})}function pY(r,t,e){for(var n=[],i=r.length-1;i>=0;i-=1){var a=r[i],s=nl(a),o=void 0;if(i===0)o=Sb(s,t,e);else{var l=r[i-1],c=nl(l,!0);c[0][0]="L",o=Nt(Nt(Nt([],q(s),!1),q(c),!1),[["Z"]],!1)}n.push(o)}return n}function yY(r,t,e){for(var n=[],i=r.length-1;i>=0;i-=1){var a=r[i],s=Ou(a),o=void 0;if(i===0)o=Sb(s,t,e);else{var l=r[i-1],c=Ou(l,!0),u=a[0];c[0][0]="L",o=Nt(Nt(Nt([],q(s),!1),q(c),!1),[Nt(["M"],q(u),!1),["Z"]],!1)}n.push(o)}return n}function mT(r){return r.length===0?[0,0]:[Kc(q3(r,function(t){return Kc(t)||0})),Xc(j3(r,function(t){return Xc(t)||0}))]}function bT(r){for(var t=da(r),e=t[0].length,n=q([Array(e).fill(0),Array(e).fill(0)],2),i=n[0],a=n[1],s=0;s<t.length;s+=1)for(var o=t[s],l=0;l<e;l+=1)o[l]>=0?(o[l]+=i[l],i[l]=o[l]):(o[l]+=a[l],a[l]=o[l]);return t}var mY=(function(r){Ut(t,r);function t(e){return r.call(this,e,{type:"line",x:0,y:0,width:200,height:20,isStack:!1,color:["#83daad","#edbf45","#d2cef9","#e290b3","#6f63f4"],smooth:!0,lineLineWidth:1,areaOpacity:0,isGroup:!1,columnLineWidth:1,columnStroke:"#fff",scale:1,spacing:0})||this}return Object.defineProperty(t.prototype,"rawData",{get:function(){var e=this.attributes.data;if(!e||(e==null?void 0:e.length)===0)return[[]];var n=da(e);return St(n[0])?[n]:n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this.attributes.isStack?bT(this.rawData):this.rawData},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scales",{get:function(){return this.createScales(this.data)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"baseline",{get:function(){var e=this.scales.y,n=q(e.getOptions().domain||[0,0],2),i=n[0],a=n[1];return a<0?e.map(a):e.map(i<0?0:i)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"containerShape",{get:function(){var e=this.attributes,n=e.width,i=e.height;return{width:n,height:i}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"linesStyle",{get:function(){var e=this,n=this.attributes,i=n.type,a=n.isStack,s=n.smooth;if(i!=="line")throw new Error("linesStyle can only be used in line type");var o=jt(this.attributes,"area"),l=jt(this.attributes,"line"),c=this.containerShape.width,u=this.data;if(u[0].length===0)return{lines:[],areas:[]};var h=this.scales,d=h.x,f=h.y,g=gY(u,{x:d,y:f}),v=[];if(o){var p=this.baseline;a?v=s?yY(g,c,p):pY(g,c,p):v=vY(g,s,c,p)}return{lines:g.map(function(y,m){return at({stroke:e.getColor(m),d:s?Ou(y):nl(y)},l)}),areas:v.map(function(y,m){return at({d:y,fill:e.getColor(m)},o)})}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"columnsStyle",{get:function(){var e=this,n=jt(this.attributes,"column"),i=this.attributes,a=i.isStack,s=i.type,o=i.scale;if(s!=="column")throw new Error("columnsStyle can only be used in column type");var l=this.containerShape.height,c=this.rawData;if(!c)return{columns:[]};a&&(c=bT(c));var u=this.createScales(c),h=u.x,d=u.y,f=q(mT(c),2),g=f[0],v=f[1],p=new Bo({domain:[0,v-(g>0?0:g)],range:[0,l*o]}),y=h.getBandWidth(),m=this.rawData;return{columns:c.map(function(x,E){return x.map(function(_,M){var O=y/c.length,T=function(){return{x:h.map(M)+O*E,y:_>=0?d.map(_):d.map(0),width:O,height:p.map(Math.abs(_))}},N=function(){return{x:h.map(M),y:d.map(_),width:y,height:p.map(m[E][M])}};return at(at({fill:e.getColor(E)},n),a?N():T())})})}},enumerable:!1,configurable:!0}),t.prototype.render=function(e,n){uU(n,".container","rect").attr("className","container").node();var i=e.type,a=e.x,s=e.y,o="spark".concat(i),l=at({x:a,y:s},i==="line"?this.linesStyle:this.columnsStyle);Ot(n).selectAll(".spark").data([i]).join(function(c){return c.append(function(u){return u==="line"?new fY({className:o,style:l}):new dY({className:o,style:l})}).attr("className","spark ".concat(o))},function(c){return c.update(l)},function(c){return c.remove()})},t.prototype.getColor=function(e){var n=this.attributes.color;return cr(n)?n[e%n.length]:Tt(n)?n.call(null,e):n},t.prototype.createScales=function(e){var n,i,a=this.attributes,s=a.type,o=a.scale,l=a.range,c=l===void 0?[]:l,u=a.spacing,h=this.containerShape,d=h.width,f=h.height,g=q(mT(e),2),v=g[0],p=g[1],y=new Bo({domain:[(n=c[0])!==null&&n!==void 0?n:v,(i=c[1])!==null&&i!==void 0?i:p],range:[f,f*(1-o)]});return s==="line"?{type:s,x:new Bo({domain:[0,e[0].length-1],range:[0,d]}),y}:{type:s,x:new Eb({domain:e[0].map(function(m,x){return x}),range:[0,d],paddingInner:u,paddingOuter:u/2,align:.5}),y}},t.tag="sparkline",t})($e);function bY(r){return typeof r=="boolean"?!1:"enter"in r&&"update"in r&&"exit"in r}function xT(r){if(!r)return{enter:!1,update:!1,exit:!1};var t=["enter","update","exit"],e=Object.fromEntries(Object.entries(r).filter(function(n){var i=q(n,1),a=i[0];return!t.includes(a)}));return Object.fromEntries(t.map(function(n){return bY(r)?r[n]===!1?[n,!1]:[n,at(at({},r[n]),e)]:[n,e]}))}function io(r,t){r?r.finished.then(t):t()}function xY(r,t){r.length===0?t():Promise.all(r.map(function(e){return e==null?void 0:e.finished})).then(t)}function zC(r,t){"update"in r?r.update(t):r.attr(t)}function jC(r,t,e){if(t.length===0)return null;if(!e){var n=t.slice(-1)[0];return zC(r,{style:n}),null}return r.animate(t,e)}function wY(r,t){return!(r.nodeName!=="text"||t.nodeName!=="text"||r.attributes.text!==t.attributes.text)}function EY(r,t,e,n){if(n===void 0&&(n="destroy"),wY(r,t))return r.remove(),[null];var i=function(){n==="destroy"?r.destroy():n==="hide"&&Ur(r),t.isVisible()&&kl(t)};if(!e)return i(),[null];var a=e.duration,s=a===void 0?0:a,o=e.delay,l=o===void 0?0:o,c=Math.ceil(+s/2),u=+s/4,h=q(r.getGeometryBounds().center,2),d=h[0],f=h[1],g=q(t.getGeometryBounds().center,2),v=g[0],p=g[1],y=q([(d+v)/2-d,(f+p)/2-f],2),m=y[0],x=y[1],E=r.style.opacity,_=E===void 0?1:E,M=t.style.opacity,O=M===void 0?1:M,T=r.style.transform||"",N=t.style.transform||"",P=r.animate([{opacity:_,transform:"translate(0, 0) ".concat(T)},{opacity:0,transform:"translate(".concat(m,", ").concat(x,") ").concat(T)}],at(at({fill:"both"},e),{duration:l+c+u})),C=t.animate([{opacity:0,transform:"translate(".concat(-m,", ").concat(-x,") ").concat(N),offset:.01},{opacity:O,transform:"translate(0, 0) ".concat(N)}],at(at({fill:"both"},e),{duration:c+u,delay:l+c-u}));return io(C,i),[P,C]}function Yr(r,t,e){var n={},i={};return Object.entries(t).forEach(function(a){var s=q(a,2),o=s[0],l=s[1];if(!Rt(l)){var c=r.style[o]||r.parsedStyle[o]||0;c!==l&&(n[o]=c,i[o]=l)}}),e?jC(r,[n,i],at({fill:"both"},e)):(zC(r,i),null)}function Vh(r,t){return r.style.opacity||(r.style.opacity=1),Yr(r,{opacity:0},t)}var qC={fill:"#fff",lineWidth:1,radius:2,size:10,stroke:"#bfbfbf",strokeOpacity:1,zIndex:0},GC={fill:"#000",fillOpacity:.45,fontSize:12,textAlign:"center",textBaseline:"middle",zIndex:1},$C={x:0,y:0,orientation:"horizontal",showLabel:!0,type:"start"},li=Qr({foreground:"foreground",handle:"handle",selection:"selection",sparkline:"sparkline",sparklineGroup:"sparkline-group",track:"track",brushArea:"brush-area"},"slider"),Pr=Qr({labelGroup:"label-group",label:"label",iconGroup:"icon-group",icon:"icon",iconRect:"icon-rect",iconLine:"icon-line"},"handle"),SY=(function(r){Ut(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.render=function(e,n){var i=e.x,a=e.y,s=e.size,o=s===void 0?10:s,l=e.radius,c=l===void 0?o/4:l,u=e.orientation,h=e.classNamePrefix,d=Pe(e,["x","y","size","radius","orientation","classNamePrefix"]),f=o,g=f*2.4,v=h?"".concat(Pr.iconRect.name," ").concat(h,"handle-icon-rect"):Pr.iconRect.name,p=function(M){return h?"".concat(Pr.iconLine,"-").concat(M," ").concat(h,"handle-icon-line"):"".concat(Pr.iconLine,"-").concat(M)},y=Ot(n).maybeAppendByClassName(Pr.iconRect,"rect").attr("className",v).styles(at(at({},d),{width:f,height:g,radius:c,x:i-f/2,y:a-g/2,transformOrigin:"center"})),m=i+1/3*f-f/2,x=i+2/3*f-f/2,E=a+1/4*g-g/2,_=a+3/4*g-g/2;y.maybeAppendByClassName("".concat(Pr.iconLine,"-1"),"line").attr("className",p(1)).styles(at({x1:m,x2:m,y1:E,y2:_},d)),y.maybeAppendByClassName("".concat(Pr.iconLine,"-2"),"line").attr("className",p(2)).styles(at({x1:x,x2:x,y1:E,y2:_},d)),u==="vertical"&&(y.node().style.transform="rotate(90)")},t})($e),_Y=(function(r){Ut(t,r);function t(e){return r.call(this,e,$C)||this}return t.prototype.renderLabel=function(e){var n=this,i=this.attributes,a=i.x,s=i.y,o=i.showLabel,l=jt(this.attributes,"label"),c=l.x,u=c===void 0?0:c,h=l.y,d=h===void 0?0:h,f=l.transform,g=l.transformOrigin,v=Pe(l,["x","y","transform","transformOrigin"]),p=q(Gi(v,[]),2),y=p[0],m=p[1],x=Ot(e).maybeAppendByClassName(Pr.labelGroup,"g").styles(m),E=at(at({},GC),y),_=E.text,M=Pe(E,["text"]);or(!!o,x,function(O){n.label=O.maybeAppendByClassName(Pr.label,"text").styles(at(at({},M),{x:a+u,y:s+d,transform:f,transformOrigin:g,text:"".concat(_)})),n.label.on("mousedown",function(T){T.stopPropagation()}),n.label.on("touchstart",function(T){T.stopPropagation()})})},t.prototype.renderIcon=function(e){var n=this.attributes,i=n.x,a=n.y,s=n.orientation,o=n.type,l=n.classNamePrefix,c=at(at({x:i,y:a,orientation:s,classNamePrefix:l},qC),jt(this.attributes,"icon")),u=this.attributes.iconShape,h=u===void 0?function(){return new SY({style:c})}:u,d=Ot(e).maybeAppendByClassName(Pr.iconGroup,"g");d.selectAll(Pr.icon.class).data([h]).join(function(f){return f.append(typeof h=="string"?h:function(){return h(o)}).attr("className",Pr.icon.name)},function(f){return f.update(c)},function(f){return f.remove()})},t.prototype.render=function(e,n){this.renderIcon(n),this.renderLabel(n)},t})($e),kY=(function(r){Ut(t,r);function t(e){var n=r.call(this,e,at(at(at({x:0,y:0,animate:{duration:100,fill:"both"},brushable:!0,formatter:function(i){return i.toString()},handleSpacing:2,orientation:"horizontal",padding:0,autoFitLabel:!0,scrollable:!0,selectionFill:"#5B8FF9",selectionFillOpacity:.45,selectionZIndex:2,showHandle:!0,showLabel:!0,slidable:!0,trackFill:"#416180",trackLength:200,trackOpacity:.05,trackSize:20,trackZIndex:-1,values:[0,1],type:"range",selectionType:"select",handleIconOffset:0},Ts($C,"handle")),Ts(qC,"handleIcon")),Ts(GC,"handleLabel")))||this;return n.range=[0,1],n.onDragStart=function(i){return function(a){a.stopPropagation(),n.target=i,n.prevPos=n.getOrientVal(ZM(a));var s=n.availableSpace,o=s.x,l=s.y,c=n.getBBox(),u=c.x,h=c.y;n.selectionStartPos=n.getRatio(n.prevPos-n.getOrientVal([o,l])-n.getOrientVal([+u,+h])),n.selectionWidth=0,document.addEventListener("pointermove",n.onDragging),document.addEventListener("pointerup",n.onDragEnd)}},n.onDragging=function(i){var a=n.attributes,s=a.slidable,o=a.brushable,l=a.type;i.stopPropagation();var c=n.getOrientVal(ZM(i)),u=c-n.prevPos;if(u){var h=n.getRatio(u);switch(n.target){case"start":s&&n.setValuesOffset(h);break;case"end":s&&n.setValuesOffset(0,h);break;case"selection":s&&n.setValuesOffset(h,h);break;case"track":if(!o)return;n.selectionWidth+=h,l==="range"?n.innerSetValues([n.selectionStartPos,n.selectionStartPos+n.selectionWidth].sort(),!0):n.innerSetValues([0,n.selectionStartPos+n.selectionWidth],!0);break}n.prevPos=c}},n.onDragEnd=function(){document.removeEventListener("pointermove",n.onDragging),document.removeEventListener("pointermove",n.onDragging),document.removeEventListener("pointerup",n.onDragEnd),n.target="",n.updateHandlesPosition(!1)},n.onValueChange=function(i){var a=n.attributes,s=a.onChange,o=a.type,l=o==="range"?i:i[1],c=o==="range"?n.getValues():n.getValues()[1],u=new rn("valuechange",{detail:{oldValue:l,value:c}});n.dispatchEvent(u),s==null||s(c)},n.selectionStartPos=0,n.selectionWidth=0,n.prevPos=0,n.target="",n}return Object.defineProperty(t.prototype,"values",{get:function(){return this.attributes.values},set:function(e){this.attributes.values=this.clampValues(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sparklineStyle",{get:function(){var e=this.attributes.orientation;if(e!=="horizontal")return null;var n=jt(this.attributes,"sparkline");return at(at({zIndex:0},this.availableSpace),n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shape",{get:function(){var e=this.attributes,n=e.trackLength,i=e.trackSize,a=q(this.getOrientVal([[n,i],[i,n]]),2),s=a[0],o=a[1];return{width:s,height:o}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"availableSpace",{get:function(){var e=this.attributes;e.x,e.y;var n=e.padding,i=q(Pn(n),4),a=i[0],s=i[1],o=i[2],l=i[3],c=this.shape,u=c.width,h=c.height;return{x:l,y:a,width:u-(l+s),height:h-(a+o)}},enumerable:!1,configurable:!0}),t.prototype.getValues=function(){return this.values},t.prototype.setValues=function(e,n){e===void 0&&(e=[0,0]),n===void 0&&(n=!1),this.attributes.values=e;var i=n===!1?!1:this.attributes.animate;this.updateSelectionArea(i),this.updateHandlesPosition(i)},t.prototype.updateSelectionArea=function(e){var n=this.calcSelectionArea();this.foregroundGroup.selectAll(li.selection.class).each(function(i,a){Yr(this,n[a],e)})},t.prototype.updateHandlesPosition=function(e){this.attributes.showHandle&&(this.startHandle&&Yr(this.startHandle,this.getHandleStyle("start"),e),this.endHandle&&Yr(this.endHandle,this.getHandleStyle("end"),e))},t.prototype.innerSetValues=function(e,n){e===void 0&&(e=[0,0]),n===void 0&&(n=!1);var i=this.values,a=this.clampValues(e);this.attributes.values=a,this.setValues(a),n&&this.onValueChange(i)},t.prototype.renderTrack=function(e){var n=this.attributes,i=n.x,a=n.y,s=jt(this.attributes,"track");this.trackShape=Ot(e).maybeAppendByClassName(li.track,"rect").styles(at(at({x:i,y:a},this.shape),s))},t.prototype.renderBrushArea=function(e){var n=this.attributes,i=n.x,a=n.y,s=n.brushable;this.brushArea=Ot(e).maybeAppendByClassName(li.brushArea,"rect").styles(at({x:i,y:a,fill:"transparent",cursor:s?"crosshair":"default"},this.shape))},t.prototype.renderSparkline=function(e){var n=this,i=this.attributes,a=i.x,s=i.y,o=i.orientation,l=Ot(e).maybeAppendByClassName(li.sparklineGroup,"g");or(o==="horizontal",l,function(c){var u=at(at({},n.sparklineStyle),{x:a,y:s});c.maybeAppendByClassName(li.sparkline,function(){return new mY({style:u})}).update(u)})},t.prototype.renderHandles=function(){var e=this,n,i=this.attributes,a=i.showHandle,s=i.type,o=s==="range"?["start","end"]:["end"],l=a?o:[],c=this;(n=this.foregroundGroup)===null||n===void 0||n.selectAll(li.handle.class).data(l.map(function(u){return{type:u}}),function(u){return u.type}).join(function(u){return u.append(function(h){var d=h.type;return new _Y({style:e.getHandleStyle(d)})}).each(function(h){var d=h.type;this.attr("class","".concat(li.handle.name," ").concat(d,"-handle"));var f="".concat(d,"Handle");c[f]=this,this.addEventListener("pointerdown",c.onDragStart(d))})},function(u){return u.each(function(h){var d=h.type;this.update(c.getHandleStyle(d))})},function(u){return u.each(function(h){var d=h.type,f="".concat(d,"Handle");c[f]=void 0}).remove()})},t.prototype.renderSelection=function(e){var n=this.attributes,i=n.x,a=n.y,s=n.type,o=n.selectionType;this.foregroundGroup=Ot(e).maybeAppendByClassName(li.foreground,"g");var l=jt(this.attributes,"selection"),c=function(h){return h.style("visibility",function(d){return d.show?"visible":"hidden"}).style("cursor",function(d){return o==="select"?"grab":o==="invert"?"crosshair":"default"}).styles(at(at({},l),{transform:"translate(".concat(i,", ").concat(a,")")}))},u=this;this.foregroundGroup.selectAll(li.selection.class).data(s==="value"?[]:this.calcSelectionArea().map(function(h,d){return{style:at({},h),index:d,show:o==="select"?d===1:d!==1}}),function(h){return h.index}).join(function(h){return h.append("rect").attr("className",li.selection.name).call(c).each(function(d,f){var g=this;f===1?(u.selectionShape=Ot(this),this.on("pointerdown",function(v){g.attr("cursor","grabbing"),u.onDragStart("selection")(v)}),u.dispatchCustomEvent(this,"pointerenter","selectionMouseenter"),u.dispatchCustomEvent(this,"pointerleave","selectionMouseleave"),u.dispatchCustomEvent(this,"click","selectionClick"),this.addEventListener("pointerdown",function(){g.attr("cursor","grabbing")}),this.addEventListener("pointerup",function(){g.attr("cursor","pointer")}),this.addEventListener("pointerover",function(){g.attr("cursor","pointer")})):this.on("pointerdown",u.onDragStart("track"))})},function(h){return h.call(c)},function(h){return h.remove()}),this.updateSelectionArea(!1),this.renderHandles()},t.prototype.render=function(e,n){this.renderTrack(n),this.renderSparkline(n),this.renderBrushArea(n),this.renderSelection(n)},t.prototype.clampValues=function(e,n){var i;n===void 0&&(n=4);var a=q(this.range,2),s=a[0],o=a[1],l=q(this.getValues().map(function(p){return JM(p,n)}),2),c=l[0],u=l[1],h=Array.isArray(e)?e:[c,e??u],d=q((h||[c,u]).map(function(p){return JM(p,n)}),2),f=d[0],g=d[1];if(this.attributes.type==="value")return[0,qe(g,s,o)];f>g&&(i=q([g,f],2),f=i[0],g=i[1]);var v=g-f;return v>o-s?[s,o]:f<s?c===s&&u===g?[s,g]:[s,v+s]:g>o?u===o&&c===f?[f,o]:[o-v,o]:[f,g]},t.prototype.calcSelectionArea=function(e){var n=q(this.clampValues(e),2),i=n[0],a=n[1],s=this.availableSpace,o=s.x,l=s.y,c=s.width,u=s.height;return this.getOrientVal([[{y:l,height:u,x:o,width:i*c},{y:l,height:u,x:i*c+o,width:(a-i)*c},{y:l,height:u,x:a*c,width:(1-a)*c}],[{x:o,width:c,y:l,height:i*u},{x:o,width:c,y:i*u+l,height:(a-i)*u},{x:o,width:c,y:a*u,height:(1-a)*u}]])},t.prototype.calcHandlePosition=function(e){var n=this.attributes.handleIconOffset,i=this.availableSpace,a=i.x,s=i.y,o=i.width,l=i.height,c=q(this.clampValues(),2),u=c[0],h=c[1],d=e==="start"?-n:n,f=(e==="start"?u:h)*this.getOrientVal([o,l])+d;return{x:a+this.getOrientVal([f,o/2]),y:s+this.getOrientVal([l/2,f])}},t.prototype.inferTextStyle=function(e){var n=this.attributes.orientation;return n==="horizontal"?{}:e==="start"?{transformOrigin:"left center",transform:"rotate(90)",textAlign:"start"}:e==="end"?{transformOrigin:"right center",transform:"rotate(90)",textAlign:"end"}:{}},t.prototype.calcHandleText=function(e){var n,i=this.attributes,a=i.type,s=i.orientation,o=i.formatter,l=i.autoFitLabel,c=jt(this.attributes,"handle"),u=jt(c,"label"),h=c.spacing,d=this.getHandleSize(),f=this.clampValues(),g=e==="start"?f[0]:f[1],v=o(g),p=new pb({style:at(at(at({},u),this.inferTextStyle(e)),{text:v})}),y=p.getBBox(),m=y.width,x=y.height;if(p.destroy(),!l){if(a==="value")return{text:v,x:0,y:-x-h};var E=h+d+(s==="horizontal"?m/2:0);return n={text:v},n[s==="horizontal"?"x":"y"]=e==="start"?-E:E,n}var _=0,M=0,O=this.availableSpace,T=O.width,N=O.height,P=this.calcSelectionArea()[1],C=P.x,R=P.y,I=P.width,j=P.height,G=h+d;if(s==="horizontal"){var H=G+m/2;if(e==="start"){var Z=C-G-m;_=Z>0?-H:H}else{var U=T-C-I-G>m;_=U?H:-H}}else{var tt=G,gt=x+G;e==="start"?M=R-d>x?-gt:tt:M=N-(R+j)-d>x?gt:-tt}return{x:_,y:M,text:v}},t.prototype.getHandleLabelStyle=function(e){var n=jt(this.attributes,"handleLabel");return at(at(at({},n),this.calcHandleText(e)),this.inferTextStyle(e))},t.prototype.getHandleIconStyle=function(){var e=this.attributes.handleIconShape,n=jt(this.attributes,"handleIcon"),i=this.getOrientVal(["ew-resize","ns-resize"]),a=this.getHandleSize();return at({cursor:i,shape:e,size:a},n)},t.prototype.getHandleStyle=function(e){var n=this.attributes,i=n.x,a=n.y,s=n.showLabel,o=n.showLabelOnInteraction,l=n.orientation,c=this.calcHandlePosition(e),u=c.x,h=c.y,d=this.calcHandleText(e),f=s;return!s&&o&&(this.target?f=!0:f=!1),at(at(at({},Ts(this.getHandleIconStyle(),"icon")),Ts(at(at({},this.getHandleLabelStyle(e)),d),"label")),{transform:"translate(".concat(u+i,", ").concat(h+a,")"),orientation:l,showLabel:f,type:e,zIndex:3})},t.prototype.getHandleSize=function(){var e=this.attributes,n=e.handleIconSize,i=e.width,a=e.height;return n||Math.floor((this.getOrientVal([+a,+i])+4)/2.4)},t.prototype.getOrientVal=function(e){var n=q(e,2),i=n[0],a=n[1],s=this.attributes.orientation;return s==="horizontal"?i:a},t.prototype.setValuesOffset=function(e,n){n===void 0&&(n=0);var i=this.attributes.type,a=q(this.getValues(),2),s=a[0],o=a[1],l=i==="range"?e:0,c=[s+l,o+n].sort();this.innerSetValues(c,!0)},t.prototype.getRatio=function(e){var n=this.availableSpace,i=n.width,a=n.height;return e/this.getOrientVal([i,a])},t.prototype.dispatchCustomEvent=function(e,n,i){var a=this;e.on(n,function(s){s.stopPropagation(),a.dispatchEvent(new rn(i,{detail:s}))})},t.prototype.bindEvents=function(){this.addEventListener("wheel",this.onScroll);var e=this.brushArea;this.dispatchCustomEvent(e,"click","trackClick"),this.dispatchCustomEvent(e,"pointerenter","trackMouseenter"),this.dispatchCustomEvent(e,"pointerleave","trackMouseleave"),e.on("pointerdown",this.onDragStart("track"))},t.prototype.onScroll=function(e){var n=this.attributes.scrollable;if(n){var i=e.deltaX,a=e.deltaY,s=a||i,o=this.getRatio(s);this.setValuesOffset(o,o)}},t.tag="slider",t})($e),oe={gridGroup:"grid-group",mainGroup:"main-group",lineGroup:"line-group",tickGroup:"tick-group",labelGroup:"label-group",titleGroup:"title-group",grid:"grid",line:"line",lineFirst:"line-first",lineSecond:"line-second",tick:"tick",tickItem:"tick-item",label:"label",labelItem:"label-item",title:"title"},_b={data:[],animate:{enter:!1,update:{duration:100,easing:"ease-in-out-sine",fill:"both"},exit:{duration:100,fill:"both"}},showArrow:!0,showGrid:!0,showLabel:!0,showLine:!0,showTick:!0,showTitle:!0,showTrunc:!1,dataThreshold:100,lineLineWidth:1,lineStroke:"black",crossPadding:10,titleFill:"black",titleFontSize:12,titlePosition:"lb",titleSpacing:0,titleTextAlign:"center",titleTextBaseline:"middle",lineArrow:function(){return new pr({style:{d:[["M",10,10],["L",-10,0],["L",10,-10],["L",0,0],["L",10,10],["Z"]],fill:"black",transformOrigin:"center"}})},labelAlign:"parallel",labelDirection:"positive",labelFontSize:12,labelSpacing:0,gridConnect:"line",gridControlAngles:[],gridDirection:"positive",gridLength:0,gridType:"segment",lineArrowOffset:15,lineArrowSize:10,tickDirection:"positive",tickLength:5,tickLineWidth:1,tickStroke:"black",labelOverlap:[]};An({},_b,{style:{type:"arc"}});An({},_b,{style:{}});var Ft=Qr({mainGroup:oe.mainGroup,gridGroup:oe.gridGroup,grid:oe.grid,lineGroup:oe.lineGroup,line:oe.line,tickGroup:oe.tickGroup,tick:oe.tick,tickItem:oe.tickItem,labelGroup:oe.labelGroup,label:oe.label,labelItem:oe.labelItem,titleGroup:oe.titleGroup,title:oe.title,lineFirst:oe.lineFirst,lineSecond:oe.lineSecond},"axis"),Us=Qr({lineGroup:"line-group",line:"line",regionGroup:"region-group",region:"region"},"grid");function WC(r){return r.reduce(function(t,e,n){return t.push(Nt([n===0?"M":"L"],q(e),!1)),t},[])}function MY(r,t,e){var n=t.connect,i=n===void 0?"line":n,a=t.center;if(i==="line")return WC(r);if(!a)return[];var s=el(r[0],a),o=e?0:1;return r.reduce(function(l,c,u){return u===0?l.push(Nt(["M"],q(c),!1)):l.push(Nt(["A",s,s,0,0,o],q(c),!1)),l},[])}function Jm(r,t,e){return t.type==="surround"?MY(r,t,e):WC(r)}function TY(r,t,e){var n=e.type,i=e.connect,a=e.center,s=e.closed,o=s?[["Z"]]:[],l=q([Jm(r,e),Jm(t.slice().reverse(),e,!0)],2),c=l[0],u=l[1],h=q([r[0],t.slice(-1)[0]],2),d=h[0],f=h[1],g=function(m,x){return[c,m,u,x,o].flat()};if(i==="line"||n==="surround")return g([Nt(["L"],q(f),!1)],[Nt(["L"],q(d),!1)]);if(!a)throw new Error("Arc grid need to specified center");var v=q([el(f,a),el(d,a)],2),p=v[0],y=v[1];return g([Nt(["A",p,p,0,0,1],q(f),!1),Nt(["L"],q(f),!1)],[Nt(["A",y,y,0,0,0],q(d),!1),Nt(["L"],q(d),!1)])}function OY(r,t,e,n){var i=e.animate,a=e.isBillboard,s=t.map(function(o,l){return{id:o.id||"grid-line-".concat(l),d:Jm(o.points,e)}});return r.selectAll(Us.line.class).data(s,function(o){return o.id}).join(function(o){return o.append("path").each(function(l,c){var u=lr(QM(at({d:l.d},n)),[l,c,s]);this.attr(at({class:Us.line.name,stroke:"#D9D9D9",lineWidth:1,lineDash:[4,4],isBillboard:a},u))})},function(o){return o.transition(function(l,c){var u=lr(QM(at({d:l.d},n)),[l,c,s]);return Yr(this,u,i.update)})},function(o){return o.transition(function(){var l=this,c=Vh(this,i.exit);return io(c,function(){return l.remove()}),c})}).transitions()}function AY(r,t,e){var n=e.animate,i=e.connect,a=e.areaFill;if(t.length<2||!a||!i)return[];for(var s=Array.isArray(a)?a:[a,"transparent"],o=function(g){return s[g%s.length]},l=[],c=0;c<t.length-1;c++){var u=q([t[c].points,t[c+1].points],2),h=u[0],d=u[1],f=TY(h,d,e);l.push({d:f,fill:o(c)})}return r.selectAll(Us.region.class).data(l,function(g,v){return v}).join(function(g){return g.append("path").each(function(v,p){var y=lr(v,[v,p,l]);this.attr(y)}).attr("className",Us.region.name)},function(g){return g.transition(function(v,p){var y=lr(v,[v,p,l]);return Yr(this,y,n.update)})},function(g){return g.transition(function(){var v=this,p=Vh(this,n.exit);return io(p,function(){return v.remove()}),p})}).transitions()}function NY(r){var t=r.data,e=t===void 0?[]:t,n=r.closed;return n?e.map(function(i){var a=i.points,s=q(a,1),o=s[0];return at(at({},i),{points:Nt(Nt([],q(a),!1),[o],!1)})}):e}var PY=(function(r){Ut(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.render=function(e,n){e.type,e.center,e.areaFill,e.closed;var i=Pe(e,["type","center","areaFill","closed"]),a=NY(e),s=Ot(n).maybeAppendByClassName(Us.lineGroup,"g"),o=Ot(n).maybeAppendByClassName(Us.regionGroup,"g"),l=OY(s,a,e,i),c=AY(o,a,e);return Nt(Nt([],q(l),!1),q(c),!1)},t})($e);function VC(r,t){return Object.fromEntries(Object.entries(r).map(function(e){var n=q(e,2),i=n[0],a=n[1];return[i,lr(a,t)]}))}function kb(r,t){return t&&Tt(t)?r.filter(t):r}function UC(r,t){var e=t.startAngle,n=t.endAngle;return(n-e)*r+e}function Uh(r,t){if(t.type==="linear"){var e=q(t.startPos,2),n=e[0],i=e[1],a=q(t.endPos,2),s=a[0],o=a[1],l=q([s-n,o-i],2),c=l[0],u=l[1];return RC([c,u])}var h=Vs(UC(r,t));return[-Math.sin(h),Math.cos(h)]}function Mb(r,t,e){var n=Uh(r,e);return eU(n,t!=="positive")}function ao(r,t){return Mb(r,t.labelDirection,t)}function $c(r,t,e){return e?"".concat(r," ").concat(e,"axis-").concat(t):r}function xr(r,t,e,n){return n&&r.attr("className",$c(t.name,e,n)),r}function CY(r,t){var e=q(t.startPos,2),n=e[0],i=e[1],a=q(t.endPos,2),s=a[0],o=a[1],l=q([s-n,o-i],2),c=l[0],u=l[1];return[n+c*r,i+u*r]}function RY(r,t){var e=t.radius,n=q(t.center,2),i=n[0],a=n[1],s=Vs(UC(r,t));return[i+e*Math.cos(s),a+e*Math.sin(s)]}function Yh(r,t){return t.type==="linear"?CY(r,t):RY(r,t)}function Tb(r){return Uh(0,r)[1]===0}function YC(r){return Uh(0,r)[0]===0}function HC(r,t){return t-r===360}function wT(r,t,e,n,i){var a=t-r,s=q([i,i],2),o=s[0],l=s[1],c=q([Vs(r),Vs(t)],2),u=c[0],h=c[1],d=function(N){return[e+i*Math.cos(N),n+i*Math.sin(N)]},f=q(d(u),2),g=f[0],v=f[1],p=q(d(h),2),y=p[0],m=p[1];if(HC(r,t)){var x=(h+u)/2,E=q(d(x),2),_=E[0],M=E[1];return[["M",g,v],["A",o,l,0,1,0,_,M],["A",o,l,0,1,0,y,m]]}var O=a>180?1:0,T=r>t?0:1;return"M".concat(g,",").concat(v,",A").concat(o,",").concat(l,",0,").concat(O,",").concat(T,",").concat(y,",").concat(m)}function LY(r){var t=r.attributes,e=t.startAngle,n=t.endAngle,i=t.center,a=t.radius;return Nt(Nt([e,n],q(i),!1),[a],!1)}function IY(r,t,e,n){var i=t.startAngle,a=t.endAngle,s=t.center,o=t.radius,l=t.classNamePrefix;return r.selectAll(Ft.line.class).data([{d:wT.apply(void 0,Nt(Nt([i,a],q(s),!1),[o],!1))}],function(c,u){return u}).join(function(c){var u=c.append("path").attr("className",Ft.line.name).styles(t).styles({d:function(h){return h.d}});return xr(u,Ft.line,oe.line,l),u},function(c){return c.transition(function(){var u=this,h=tU(this,LY(this),Nt(Nt([i,a],q(s),!1),[o],!1),n.update);if(h){var d=function(){var f=Mn(u.attributes,"__keyframe_data__");u.style.d=wT.apply(void 0,Nt([],q(f),!1))};h.onframe=d,h.onfinish=d}return h}).styles(t)},function(c){return c.remove()}).styles(e).transitions()}function DY(r,t){t.truncRange,t.truncShape,t.lineExtension}function FY(r,t,e){e===void 0&&(e=[0,0]);var n=q([r,t,e],3),i=q(n[0],2),a=i[0],s=i[1],o=q(n[1],2),l=o[0],c=o[1],u=q(n[2],2),h=u[0],d=u[1],f=q([l-a,c-s],2),g=f[0],v=f[1],p=Math.sqrt(Math.pow(g,2)+Math.pow(v,2)),y=q([-h/p,d/p],2),m=y[0],x=y[1];return[m*g,m*v,x*g,x*v]}function ET(r){var t=q(r,2),e=q(t[0],2),n=e[0],i=e[1],a=q(t[1],2),s=a[0],o=a[1];return{x1:n,y1:i,x2:s,y2:o}}function BY(r,t,e,n){var i=t.showTrunc,a=t.startPos,s=t.endPos,o=t.truncRange,l=t.lineExtension,c=t.classNamePrefix,u=q([a,s],2),h=q(u[0],2),d=h[0],f=h[1],g=q(u[1],2),v=g[0],p=g[1],y=q(l?FY(a,s,l):new Array(4).fill(0),4),m=y[0],x=y[1],E=y[2],_=y[3],M=function(tt){return r.selectAll(Ft.line.class).data(tt,function(gt,xt){return xt}).join(function(gt){var xt=gt.append("line").styles(e).transition(function(ut){return Yr(this,ET(ut.line),!1)});return xt.attr("className",function(ut){if(!c)return"".concat(Ft.line.name," ").concat(ut.className);var zt=$c(Ft.line.name,oe.line,c);if(ut.className===Ft.lineFirst.name){var J=$c(Ft.lineFirst.name,oe.lineFirst,c);return"".concat(zt," ").concat(J)}if(ut.className===Ft.lineSecond.name){var J=$c(Ft.lineSecond.name,oe.lineSecond,c);return"".concat(zt," ").concat(J)}return zt}),xt},function(gt){return gt.styles(e).transition(function(xt){var ut=xt.line;return Yr(this,ET(ut),n.update)})},function(gt){return gt.remove()}).transitions()};if(!i||!o)return M([{line:[[d+m,f+x],[v+E,p+_]],className:Ft.line.name}]);var O=q(o,2),T=O[0],N=O[1],P=v-d,C=p-f,R=q([d+P*T,f+C*T],2),I=R[0],j=R[1],G=q([d+P*N,f+C*N],2),H=G[0],Z=G[1],U=M([{line:[[d+m,f+x],[I,j]],className:Ft.lineFirst.name},{line:[[H,Z],[v+E,p+_]],className:Ft.lineSecond.name}]);return DY(r,t),U}function zY(r,t,e,n){var i=e.showArrow,a=e.showTrunc,s=e.lineArrow,o=e.lineArrowOffset,l=e.lineArrowSize,c;if(t==="arc"?c=r.select(Ft.line.class):a?c=r.select(Ft.lineSecond.class):c=r.select(Ft.line.class),!i||!s||e.type==="arc"&&HC(e.startAngle,e.endAngle)){var u=c.node();u&&(u.style.markerEnd=void 0);return}var h=qi(s);h.attr(n),mb(h,l),c.style("markerEnd",h).style("markerEndOffset",-o)}function jY(r,t,e){var n=t.type,i,a=jt(t,"line");return n==="linear"?i=BY(r,t,Km(a,"arrow"),e):i=IY(r,t,Km(a,"arrow"),e),zY(r,n,t,a),i}function qY(r,t){return Mb(r,t.gridDirection,t)}function XC(r){var t=r.type,e=r.gridCenter;return t==="linear"?e:e||r.center}function GY(r,t){var e=t.gridLength;return r.map(function(n,i){var a=n.value,s=q(Yh(a,t),2),o=s[0],l=s[1],c=q(Ri(qY(a,t),e),2),u=c[0],h=c[1];return{id:i,points:[[o,l],[o+u,l+h]]}})}function $Y(r,t){var e=t.gridControlAngles,n=XC(t);if(!n)throw new Error("grid center is not provide");if(r.length<2)throw new Error("Invalid grid data");if(!e||e.length===0)throw new Error("Invalid gridControlAngles");var i=q(n,2),a=i[0],s=i[1];return r.map(function(o,l){var c=o.value,u=q(Yh(c,t),2),h=u[0],d=u[1],f=q([h-a,d-s],2),g=f[0],v=f[1],p=[];return e.forEach(function(y){var m=Vs(y),x=q([Math.cos(m),Math.sin(m)],2),E=x[0],_=x[1],M=g*E-v*_+a,O=g*_+v*E+s;p.push([M,O])}),{points:p,id:l}})}function WY(r,t,e,n){var i=e.classNamePrefix,a=jt(e,"grid"),s=a.type,o=a.areaFill,l=XC(e),c=kb(t,e.gridFilter),u=s==="segment"?GY(c,e):$Y(c,e),h=at(at({},a),{center:l,areaFill:Tt(o)?c.map(function(d,f){return lr(o,[d,f,c])}):o,animate:n,data:u});return r.selectAll(Ft.grid.class).data([1]).join(function(d){var f=d.append(function(){return new PY({style:h})}).attr("className",Ft.grid.name);return xr(f,Ft.grid,oe.grid,i),f},function(d){return d.transition(function(){return this.update(h)})},function(d){return d.remove()}).transitions()}var Qm=(function(){function r(t,e,n,i){this.set(t,e,n,i)}return Object.defineProperty(r.prototype,"left",{get:function(){return this.x1},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"top",{get:function(){return this.y1},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"right",{get:function(){return this.x2},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"bottom",{get:function(){return this.y2},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"width",{get:function(){return this.defined("x2")&&this.defined("x1")?this.x2-this.x1:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"height",{get:function(){return this.defined("y2")&&this.defined("y1")?this.y2-this.y1:void 0},enumerable:!1,configurable:!0}),r.prototype.rotatedPoints=function(t,e,n){var i=this,a=i.x1,s=i.y1,o=i.x2,l=i.y2,c=Math.cos(t),u=Math.sin(t),h=e-e*c+n*u,d=n-e*u-n*c,f=[[c*a-u*l+h,u*a+c*l+d],[c*o-u*l+h,u*o+c*l+d],[c*a-u*s+h,u*a+c*s+d],[c*o-u*s+h,u*o+c*s+d]];return f},r.prototype.set=function(t,e,n,i){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),i<e?(this.y2=e,this.y1=i):(this.y1=e,this.y2=i),this},r.prototype.defined=function(t){return this[t]!==Number.MAX_VALUE&&this[t]!==-Number.MAX_VALUE},r})();function t1(r,t){var e=r.getEulerAngles()||0;r.setEulerAngles(0);var n=r.getBounds(),i=q(n.min,2),a=i[0],s=i[1],o=q(n.max,2),l=o[0],c=o[1],u=r.getBBox(),h=u.width,d=u.height,f=d,g=0,v=0,p=a,y=s,m=PC(r);if(m){f-=1.5;var x=m.style.textAlign,E=m.style.textBaseline;x==="center"?p=(a+l)/2:(x==="right"||x==="end")&&(p=l),E==="middle"?y=(s+c)/2:E==="bottom"&&(y=c)}var _=q(Pn(t),4),M=_[0],O=M===void 0?0:M,T=_[1],N=T===void 0?0:T,P=_[2],C=P===void 0?O:P,R=_[3],I=R===void 0?N:R,j=new Qm((g+=a)-I,(v+=s)-O,g+h+N,v+f+C);return r.setEulerAngles(e),j.rotatedPoints(Vs(e),p,y)}function No(r,t){return t[0]<=Math.max(r[0][0],r[1][0])&&t[0]<=Math.min(r[0][0],r[1][0])&&t[1]<=Math.max(r[0][1],r[1][1])&&t[1]<=Math.min(r[0][1],r[1][1])}function Po(r,t,e){var n=(t[1]-r[1])*(e[0]-t[0])-(t[0]-r[0])*(e[1]-t[1]);return n===0?0:n<0?2:1}function VY(r,t){var e=Po(r[0],r[1],t[0]),n=Po(r[0],r[1],t[1]),i=Po(t[0],t[1],r[0]),a=Po(t[0],t[1],r[1]);return!!(e!==n&&i!==a||e===0&&No(r,t[0])||n===0&&No(r,t[1])||i===0&&No(t,r[0])||a===0&&No(t,r[1]))}function UY(r,t){var e=r.length;if(e<3)return!1;var n=[t,[9999,t[1]]],i=0,a=0;do{var s=[r[a],r[(a+1)%e]];if(VY(s,n)){if(Po(s[0],t,s[1])===0)return No(s,t);i++}a=(a+1)%e}while(a!==0);return!!(i&1)}function YY(r,t){return t.every(function(e){return UY(r,e)})}function HY(r,t,e){var n=r.x1,i=r.x2,a=r.y1,s=r.y2,o=[[n,a],[i,a],[i,s],[n,s]],l=t1(t,e);return YY(o,l)}function XY(r,t){var e=q(r,4),n=e[0],i=e[1],a=e[2],s=e[3],o=q(t,4),l=o[0],c=o[1],u=o[2],h=o[3],d=a-n,f=s-i,g=u-l,v=h-c,p=d*v-g*f;if(p===0)return!1;var y=p>0,m=n-l,x=i-c,E=d*x-f*m;if(E<0===y)return!1;var _=g*x-v*m;return!(_<0===y||E>p===y||_>p===y)}function KY(r,t){var e=[[r[0],r[1],r[2],r[3]],[r[2],r[3],r[4],r[5]],[r[4],r[5],r[6],r[7]],[r[6],r[7],r[0],r[1]]];return e.some(function(n){return XY(t,n)})}function ZY(r,t,e){var n,i,a=t1(r,e).flat(1),s=t1(t,e).flat(1),o=[[a[0],a[1],a[2],a[3]],[a[0],a[1],a[4],a[5]],[a[4],a[5],a[6],a[7]],[a[2],a[3],a[6],a[7]]];try{for(var l=sl(o),c=l.next();!c.done;c=l.next()){var u=c.value;if(KY(s,u))return!0}}catch(h){n={error:h}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}return!1}function JY(r,t){var e=r.type,n=r.labelDirection,i=r.crossSize;if(!i)return!1;if(e==="arc"){var a=r.center,s=r.radius,o=q(a,2),l=o[0],c=o[1],u=n==="negative"?0:i,h=-s-u,d=s+u,f=q(Pn(t),4),g=f[0],v=f[1],p=f[2],y=f[3];return new Qm(l+h-y,c+h-g,l+d+v,c+d+p)}var m=q(r.startPos,2),x=m[0],E=m[1],_=q(r.endPos,2),M=_[0],O=_[1],T=q(YC(r)?[-t,0,t,0]:[0,t,0,-t],4),N=T[0],P=T[1],C=T[2],R=T[3],I=ao(0,r),j=Ri(I,i),G=new Qm(x,E,M,O);return G.x1+=R,G.y1+=N,G.x2+=P+j[0],G.y2+=C+j[1],G}function Hh(r,t,e){var n,i,a=t.crossPadding,s=new Set,o=null,l=JY(t,a),c=function(g){return l?HY(l,g):!0},u=function(g,v){return!g||!g.firstChild?!0:!ZY(g.firstChild,v.firstChild,Pn(e))};try{for(var h=sl(r),d=h.next();!d.done;d=h.next()){var f=d.value;c(f)?!o||u(o,f)?o=f:(s.add(o),s.add(f)):s.add(f)}}catch(g){n={error:g}}finally{try{d&&!d.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}return Array.from(s)}function qy(r,t){return t===void 0&&(t={}),Rt(r)?0:typeof r=="number"?r:Math.floor(YV(r,t))}function QY(r,t,e,n){if(!(r.length<=0)){var i=t.suffix,a=i===void 0?"...":i,s=t.minLength,o=t.maxLength,l=o===void 0?1/0:o,c=t.step,u=c===void 0?" ":c,h=t.margin,d=h===void 0?[0,0,0,0]:h,f=NC(n.getTextShape(r[0])),g=qy(u,f),v=s?qy(s,f):g,p=qy(l,f);(Rt(p)||p===1/0)&&(p=Math.max.apply(null,r.map(function(M){return M.getBBox().width})));var y=r.slice(),m=q(d,4);m[0],m[1],m[2],m[3];for(var x=function(M){if(y.forEach(function(O){n.ellipsis(n.getTextShape(O),M,a)}),y=Hh(r,e,d),y.length<1)return{value:void 0}},E=p;E>v+g;E-=g){var _=x(E);if(typeof _=="object")return _.value}}}var tH={parity:function(r,t){var e=t.seq,n=e===void 0?2:e;return r.filter(function(i,a){return a%n?(Ur(i),!1):!0})}},eH=function(r){return r.filter(UV)};function nH(r,t,e,n){var i=r.length,a=t.keepHeader,s=t.keepTail;if(!(i<=1||i===2&&a&&s)){var o=tH.parity,l=function(x){return x.forEach(n.show),x},c=2,u=r.slice(),h=r.slice(),d=Math.min.apply(Math,Nt([1],q(r.map(function(x){return x.getBBox().width})),!1));if(e.type==="linear"&&(Tb(e)||YC(e))){var f=tT(r[0]).left,g=tT(r[i-1]).right,v=Math.abs(g-f)||1;c=Math.max(Math.floor(i*d/v),c)}var p,y;for(a&&(p=u.splice(0,1)[0]),s&&(y=u.splice(-1,1)[0],u.reverse()),l(u);c<r.length&&Hh(eH(y?Nt(Nt([y],q(h),!1),[p],!1):Nt([p],q(h),!1)),e,t==null?void 0:t.margin).length;){if(y&&!p&&c%2===0){var m=u.splice(0,1);m.forEach(n.hide)}else if(y&&p){var m=u.splice(0,1);m.forEach(n.hide)}h=o(l(u),{seq:c}),c++}}}function rH(r,t,e,n){var i,a,s=t.optionalAngles,o=s===void 0?[0,45,90]:s,l=t.margin,c=t.recoverWhenFailed,u=c===void 0?!0:c,h=r.map(function(y){return y.getLocalEulerAngles()}),d=function(){return Hh(r,e,l).length<1},f=function(y){return r.forEach(function(m,x){var E=Array.isArray(y)?y[x]:y;n.rotate(m,+E)})};try{for(var g=sl(o),v=g.next();!v.done;v=g.next()){var p=v.value;if(f(p),d())return}}catch(y){i={error:y}}finally{try{v&&!v.done&&(a=g.return)&&a.call(g)}finally{if(i)throw i.error}}u&&f(h)}function iH(r){var t=r.type,e=r.labelDirection;return t==="linear"&&Tb(r)?e==="negative"?"bottom":"top":"middle"}function aH(r,t,e,n,i){var a,s=t.maxLines,o=s===void 0?3:s,l=t.recoverWhenFailed,c=l===void 0?!0:l,u=t.margin,h=u===void 0?[0,0,0,0]:u,d=lr((a=t.wordWrapWidth)!==null&&a!==void 0?a:50,[i]),f=r.map(function(x){return x.attr("maxLines")||1}),g=Math.min.apply(Math,Nt([],q(f),!1)),v=function(){return Hh(r,e,h).length<1},p=iH(e),y=function(x){return r.forEach(function(E,_){var M=Array.isArray(x)?x[_]:x;n.wrap(E,d,M,p)})};if(!(g>o)){if(e.type==="linear"&&Tb(e)){if(y(o),v())return}else for(var m=g;m<=o;m++)if(y(m),v())return;c&&y(f)}}var sH=new Map([["hide",nH],["rotate",rH],["ellipsis",QY],["wrap",aH]]);function oH(r,t,e){return t.labelOverlap.length<1?!1:e==="hide"?!WV(r[0]):e==="rotate"?!r.some(function(n){var i;return!!(!((i=n.attr("transform"))===null||i===void 0)&&i.includes("rotate"))}):e==="ellipsis"||e==="wrap"?r.filter(function(n){return n.querySelector("text")}).length>=1:!0}function lH(r,t,e,n){var i=t.labelOverlap,a=i===void 0?[]:i;a.length&&a.forEach(function(s){var o=s.type,l=sH.get(o);oH(r,t,o)&&(l==null||l(r,s,t,n,e))})}function cH(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var e=function(n){return n==="positive"?-1:1};return r.reduce(function(n,i){return n*e(i)},1)}function ST(r){for(var t=r;t<0;)t+=360;return Math.round(t%360)}function e1(r,t){var e=q(r,2),n=e[0],i=e[1],a=q(t,2),s=a[0],o=a[1],l=q([n*s+i*o,n*o-i*s],2),c=l[0],u=l[1];return Math.atan2(u,c)}function uH(r){var t=(r+360)%180;return kn(t,-90,90)||(t+=180),t}function hH(r,t,e){var n,i=e.labelAlign,a=(n=t.style.transform)===null||n===void 0?void 0:n.includes("rotate");if(a)return t.getLocalEulerAngles();var s=0,o=ao(r.value,e),l=Uh(r.value,e);return i==="horizontal"?0:(i==="perpendicular"?s=e1([1,0],o):s=e1([l[0]<0?-1:1,0],l),uH(OC(s)))}function KC(r,t,e){var n=e.type,i=e.labelAlign,a=ao(r,e),s=ST(t),o=ST(OC(e1([1,0],a))),l="center",c="middle";return n==="linear"?[90,270].includes(o)&&s===0?(l="center",c=a[1]===1?"top":"bottom"):!(o%180)&&[90,270].includes(s)?l="center":o===0?(kn(s,0,90,!1,!0)||kn(s,0,90)||kn(s,270,360))&&(l="start"):o===90?kn(s,0,90,!1,!0)?l="start":(kn(s,90,180)||kn(s,270,360))&&(l="end"):o===270?kn(s,0,90,!1,!0)?l="end":(kn(s,90,180)||kn(s,270,360))&&(l="start"):o===180&&(s===90?l="start":(kn(s,0,90)||kn(s,270,360))&&(l="end")):i==="parallel"?kn(o,0,180,!0)?c="top":c="bottom":i==="horizontal"?kn(o,90,270,!1)?l="end":(kn(o,270,360,!1)||kn(o,0,90))&&(l="start"):i==="perpendicular"&&(kn(o,90,270)?l="end":l="start"),{textAlign:l,textBaseline:c}}function dH(r,t,e){t.setLocalEulerAngles(r);var n=t.__data__.value,i=KC(n,r,e),a=t.querySelector(Ft.labelItem.class);a&&ZC(a,i)}function _T(r,t,e){var n=e.showTick,i=e.tickLength,a=e.tickDirection,s=e.labelDirection,o=e.labelSpacing,l=t.indexOf(r),c=lr(o,[r,l,t]),u=q([ao(r.value,e),cH(s,a)],2),h=u[0],d=u[1],f=d===1?lr(n?i:0,[r,l,t]):0,g=q(Ao(Ri(h,c+f),Yh(r.value,e)),2),v=g[0],p=g[1];return{x:v,y:p}}function fH(r,t,e,n){var i=n.labelFormatter,a=Tt(i)?function(){return qi(lr(i,[r,t,e,ao(r.value,n)]))}:function(){return qi(r.label||"")};return a}function gH(r,t,e,n){var i=n.labelRender,a=(Mn(n,"endPos.0",400)-Mn(n,"startPos.0",0))/e.length,s=Tt(i)?lr(i,[r,t,e,ao(r.value,n)]):r.label||"",o=mU(s)||30;return function(){return XV(s,{width:a,height:o})}}var vH={html:["fill"],text:[]};function ZC(r,t){["text","html"].includes(r.nodeName)&&r.attr(Km(t,vH[r.nodeName]))}function pH(r,t){lH(this.node().childNodes,r,t,{hide:Ur,show:kl,rotate:function(e,n){dH(+n,e,r)},ellipsis:function(e,n,i){e&&Xm(e,n||1/0,i)},wrap:function(e,n,i){e&&HV(e,n,i)},getTextShape:function(e){return e.querySelector(Ft.labelItem.class)}})}function kT(r,t,e,n,i){var a=e.indexOf(t),s=i.labelRender,o=i.classNamePrefix,l=Ot(r).append(s?gH(t,a,e,i):fH(t,a,e,i)).attr("className",Ft.labelItem.name).node();xr(Ot(l),Ft.labelItem,oe.labelItem,o);var c=q(Gi(VC(n,[t,a,e])),2),u=c[0],h=c[1],d=h.transform,f=Pe(h,["transform"]);LC(l,d);var g=hH(t,l,i);if(l.getLocalEulerAngles()||l.setLocalEulerAngles(g),ZC(l,at(at({},KC(t.value,g,i)),u)),l.nodeName==="html"){var v=l.getBBox(),p=l.style.x||0;l.attr("x",p-v.width/2)}return r.attr(f),l}function yH(r,t,e,n,i){var a=e.classNamePrefix,s=kb(t,e.labelFilter),o=jt(e,"label"),l,c=r.selectAll(Ft.label.class).data(s,function(u,h){return h}).join(function(u){var h=u.append("g").attr("className",Ft.label.name).transition(function(d){kT(this,d,t,o,e);var f=_T(d,t,e),g=f.x,v=f.y;return this.style.transform="translate(".concat(g,", ").concat(v,")"),null});return xr(h,Ft.label,oe.label,a),h},function(u){return u.transition(function(h){var d=this.querySelector(Ft.labelItem.class),f=kT(this,h,t,o,e),g=EY(d,f,n.update),v=_T(h,t,e),p=v.x,y=v.y,m=Yr(this,{transform:"translate(".concat(p,", ").concat(y,")")},n.update);return Nt(Nt([],q(g),!1),[m],!1)})},function(u){return l=u,u.transition(function(){var h=this,d=Vh(this.childNodes[0],n.exit);return io(d,function(){return Ot(h).remove()}),d}),l}).transitions();return xY(c,function(){pH.call(r,e,i)}),c}function JC(r,t){return Mb(r,t.tickDirection,t)}function mH(r,t){var e=q(r,2),n=e[0],i=e[1];return[[0,0],[n*t,i*t]]}function bH(r,t,e,n,i){var a=i.tickLength,s=q(mH(n,lr(a,[r,t,e])),2),o=q(s[0],2),l=o[0],c=o[1],u=q(s[1],2),h=u[0],d=u[1];return{x1:l,x2:h,y1:c,y2:d}}function xH(r,t,e,n,i){var a=i.tickFormatter,s=i.classNamePrefix,o=JC(t.value,i),l="line";Tt(a)&&(l=function(){return lr(a,[t,e,n,o])});var c=r.append(l).attr("className",Ft.tickItem.name);return xr(c,Ft.tickItem,oe.tickItem,s),c}function wH(r,t,e,n,i,a,s){var o=JC(r.value,a),l=bH(r,t,e,o,a),c=l.x1,u=l.x2,h=l.y1,d=l.y2,f=q(Gi(VC(s,[r,t,e,o])),2),g=f[0],v=f[1];n.node().nodeName==="line"&&n.styles(at({x1:c,x2:u,y1:h,y2:d},g)),i.attr(v),n.styles(g)}function MT(r,t,e,n,i,a){var s=xH(Ot(this),r,t,e,n);wH(r,t,e,s,this,n,i);var o=q(Yh(r.value,n),2),l=o[0],c=o[1];return Yr(this,{transform:"translate(".concat(l,", ").concat(c,")")},a)}function EH(r,t,e,n){var i=e.classNamePrefix,a=kb(t,e.tickFilter),s=jt(e,"tick");return r.selectAll(Ft.tick.class).data(a,function(o){return o.id||o.label}).join(function(o){var l=o.append("g").attr("className",Ft.tick.name).transition(function(c,u){return MT.call(this,c,u,a,e,s,!1)});return xr(l,Ft.tick,oe.tick,i),l},function(o){return o.transition(function(l,c){return this.removeChildren(),MT.call(this,l,c,a,e,s,n.update)})},function(o){return o.transition(function(){var l=this,c=Vh(this.childNodes[0],n.exit);return io(c,function(){return l.remove()}),c})}).transitions()}function SH(r,t,e){var n=e.titlePosition,i=n===void 0?"lb":n,a=e.titleSpacing,s=Wh(i),o=r.node().getLocalBounds(),l=q(o.min,2),c=l[0],u=l[1],h=q(o.halfExtents,2),d=h[0],f=h[1],g=q(t.node().getLocalBounds().halfExtents,2),v=g[0],p=g[1],y=q([c+d,u+f],2),m=y[0],x=y[1],E=q(Pn(a),4),_=E[0],M=E[1],O=E[2],T=E[3];if(["start","end"].includes(i)&&e.type==="linear"){var N=e.startPos,P=e.endPos,C=q(i==="start"?[N,P]:[P,N],2),R=C[0],I=C[1],j=RC([-I[0]+R[0],-I[1]+R[1]]),G=q(Ri(j,_),2),H=G[0],Z=G[1];return{x:R[0]+H,y:R[1]+Z}}return s.includes("t")&&(x-=f+p+_),s.includes("r")&&(m+=d+v+M),s.includes("l")&&(m-=d+v+T),s.includes("b")&&(x+=f+p+O),{x:m,y:x}}function _H(r,t,e){var n=r.getGeometryBounds().halfExtents,i=n[1]*2;if(t==="vertical"){if(e==="left")return"rotate(-90) translate(0, ".concat(i/2,")");if(e==="right")return"rotate(-90) translate(0, -".concat(i/2,")")}return""}function TT(r,t,e,n,i){var a=jt(n,"title"),s=q(Gi(a),2),o=s[0],l=s[1],c=l.transform,u=l.transformOrigin,h=Pe(l,["transform","transformOrigin"]);t.styles(h);var d=c||_H(r.node(),o.direction,o.position);r.styles(at(at({},o),{transformOrigin:u})),LC(r.node(),d);var f=SH(Ot(e._offscreen||e.querySelector(Ft.mainGroup.class)),t,n),g=f.x,v=f.y,p=Yr(t.node(),{transform:"translate(".concat(g,", ").concat(v,")")},i);return p}function kH(r,t,e,n){var i=e.titleText,a=e.classNamePrefix;return r.selectAll(Ft.title.class).data([{title:i}].filter(function(s){return!!s.title}),function(s,o){return s.title}).join(function(s){var o=s.append(function(){return qi(i)}).attr("className",Ft.title.name).transition(function(){return TT(Ot(this),r,t,e,n.enter)});return xr(o,Ft.title,oe.title,a),o},function(s){return s.transition(function(){return TT(Ot(this),r,t,e,n.update)})},function(s){return s.remove()}).transitions()}function OT(r,t,e,n){var i=r.showLine,a=r.showTick,s=r.showLabel,o=r.classNamePrefix,l=t.maybeAppendByClassName(Ft.lineGroup,"g");xr(l,Ft.lineGroup,oe.lineGroup,o);var c=or(i,l,function(g){return jY(g,r,n)})||[],u=t.maybeAppendByClassName(Ft.tickGroup,"g");xr(u,Ft.tickGroup,oe.tickGroup,o);var h=or(a,u,function(g){return EH(g,e,r,n)})||[],d=t.maybeAppendByClassName(Ft.labelGroup,"g");xr(d,Ft.labelGroup,oe.labelGroup,o);var f=or(s,d,function(g){return yH(g,e,r,n,t.node())})||[];return Nt(Nt(Nt([],q(c),!1),q(h),!1),q(f),!1).filter(function(g){return!!g})}var MH=(function(r){Ut(t,r);function t(e){return r.call(this,e,_b)||this}return t.prototype.render=function(e,n,i){var a=this,s=e.titleText,o=e.data,l=e.animate,c=e.showTitle,u=e.showGrid,h=e.dataThreshold,d=e.truncRange,f=e.classNamePrefix,g=n.className||"axis";f?n.attr("className","".concat(g," ").concat(f,"axis")):n.className||n.attr("className","axis");var v=sU(o,h).filter(function(O){var T=O.value;return!(d&&T>d[0]&&T<d[1])}),p=xT(i===void 0?l:i),y=Ot(n).maybeAppendByClassName(Ft.gridGroup,"g");xr(y,Ft.gridGroup,oe.gridGroup,f);var m=or(u,y,function(O){return WY(O,v,e,p)})||[],x=Ot(n).maybeAppendByClassName(Ft.mainGroup,"g");xr(x,Ft.mainGroup,oe.mainGroup,f),s&&(!this.initialized&&p.enter||this.initialized&&p.update)&&OT(e,Ot(this.offscreenGroup),v,xT(!1));var E=OT(e,Ot(x.node()),v,p),_=Ot(n).maybeAppendByClassName(Ft.titleGroup,"g");xr(_,Ft.titleGroup,oe.titleGroup,f);var M=or(c,_,function(O){return kH(O,a,e,p)})||[];return Nt(Nt(Nt([],q(m),!1),q(E),!1),q(M),!1).flat().filter(function(O){return!!O})},t})($e);function $n(r,t,e){return e?"".concat(r," ").concat(e,"legend-").concat(t):r}function TH(r,t,e){var n=1.4,i=n*e;return[["M",r-e,t-i],["L",r+e,t-i],["L",r+e,t+i],["L",r-e,t+i],["Z"]]}var QC=1.4,tR=.4;function OH(r,t,e){var n=e,i=n*QC,a=n/2,s=n/6,o=r+i*tR;return[["M",r,t],["L",o,t+a],["L",r+i,t+a],["L",r+i,t-a],["L",o,t-a],["Z"],["M",o,t+s],["L",r+i-2,t+s],["M",o,t-s],["L",r+i-2,t-s]]}function AH(r,t,e){var n=e,i=n*QC,a=n/2,s=n/6,o=t+i*tR;return[["M",r,t],["L",r-a,o],["L",r-a,t+i],["L",r+a,t+i],["L",r+a,o],["Z"],["M",r-s,o],["L",r-s,t+i-2],["M",r+s,o],["L",r+s,t+i-2]]}le.registerSymbol("hiddenHandle",TH);le.registerSymbol("verticalHandle",OH);le.registerSymbol("horizontalHandle",AH);function n1(r,t,e){return r===void 0&&(r="horizontal"),r==="horizontal"?t:e}var Wn={title:"title",item:"item",marker:"marker",label:"label",value:"value",focusIcon:"focus-icon",background:"background",handleMarker:"handle-marker",handleLabel:"handle-label",prevBtn:"prev-btn",nextBtn:"next-btn",pageInfo:"page-info"},Na=Qr({markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label"},"handle"),eR={showLabel:!0,formatter:function(r){return r.toString()},markerSize:25,markerStroke:"#c5c5c5",markerFill:"#fff",markerLineWidth:1,labelFontSize:12,labelFill:"#c5c5c5",labelText:"",orientation:"vertical",spacing:0};(function(r){Ut(t,r);function t(e){return r.call(this,e,eR)||this}return t.prototype.render=function(e,n){var i=Ot(n).maybeAppendByClassName(Na.markerGroup,"g");this.renderMarker(i);var a=Ot(n).maybeAppendByClassName(Na.labelGroup,"g");this.renderLabel(a)},t.prototype.renderMarker=function(e){var n=this,i=this.attributes,a=i.orientation,s=i.classNamePrefix,o=i.markerSymbol,l=o===void 0?n1(a,"horizontalHandle","verticalHandle"):o;or(!!l,e,function(c){var u=jt(n.attributes,"marker"),h=at({symbol:l},u),d=$n(Na.marker.name,Wn.handleMarker,s);if(n.marker=c.maybeAppendByClassName(Na.marker,function(){return new le({style:h,className:d})}).update(h),s){var f=n.marker.node().querySelector(".marker");if(f){var g=f.getAttribute("class")||"",v=g.split(" ")[0],p=$n(v,Wn.handleMarker,s);f.setAttribute("class",p)}}})},t.prototype.renderLabel=function(e){var n=this,i=this.attributes,a=i.showLabel,s=i.orientation,o=i.spacing,l=o===void 0?0:o,c=i.formatter,u=i.classNamePrefix;or(a,e,function(h){var d,f=jt(n.attributes,"label"),g=f.text,v=Pe(f,["text"]),p=((d=h.select(Na.marker.class))===null||d===void 0?void 0:d.node().getBBox())||{},y=p.width,m=y===void 0?0:y,x=p.height,E=x===void 0?0:x,_=q(n1(s,[0,E+l,"center","top"],[m+l,0,"start","middle"]),4),M=_[0],O=_[1],T=_[2],N=_[3],P=$n(Na.label.name,Wn.handleLabel,u);h.maybeAppendByClassName(Na.label,"text").attr("className",P).styles(at(at({},v),{x:M,y:O,text:c(g).toString(),textAlign:T,textBaseline:N}))})},t})($e);var nR={showTitle:!0,padding:0,orientation:"horizontal",backgroundFill:"transparent",titleText:"",titleSpacing:4,titlePosition:"top-left",titleFill:"#2C3542",titleFontWeight:"bold",titleFontFamily:"sans-serif",titleFontSize:12},NH=on({},nR,{});on({},nR,Ts(eR,"handle"),{color:["#d0e3fa","#acc7f6","#8daaf2","#6d8eea","#4d73cd","#325bb1","#5a3e75","#8c3c79","#e23455","#e7655b"],indicatorBackgroundFill:"#262626",indicatorLabelFill:"white",indicatorLabelFontSize:12,indicatorVisibility:"hidden",labelAlign:"value",labelDirection:"positive",labelSpacing:5,showHandle:!0,showIndicator:!0,showLabel:!0,slidable:!0,titleText:"",type:"continuous"});var Pa=Qr({title:"title",html:"html",titleGroup:"title-group",items:"items",itemsGroup:"items-group",contentGroup:"content-group",ribbonGroup:"ribbon-group",ribbon:"ribbon",handlesGroup:"handles-group",handle:"handle",startHandle:"start-handle",endHandle:"end-handle",labelGroup:"label-group",label:"label",indicator:"indicator"},"legend"),Gy=Qr({text:"text"},"title");function PH(r,t){var e=r.attributes,n=e.position,i=e.spacing,a=e.inset,s=e.text,o=r.getBBox(),l=t.getBBox(),c=Wh(n),u=q(Pn(s?i:0),4),h=u[0],d=u[1],f=u[2],g=u[3],v=q(Pn(a),4),p=v[0],y=v[1],m=v[2],x=v[3],E=q([g+d,h+f],2),_=E[0],M=E[1],O=q([x+y,p+m],2),T=O[0],N=O[1];if(c[0]==="l")return new Yn(o.x,o.y,l.width+o.width+_+T,Math.max(l.height+N,o.height));if(c[0]==="t")return new Yn(o.x,o.y,Math.max(l.width+T,o.width),l.height+o.height+M+N);var P=q([t.attributes.width||l.width,t.attributes.height||l.height],2),C=P[0],R=P[1];return new Yn(l.x,l.y,C+o.width+_+T,R+o.height+M+N)}function CH(r,t){var e=Object.entries(t).reduce(function(n,i){var a=q(i,2),s=a[0],o=a[1],l=r.node().attr(s);return l||(n[s]=o),n},{});r.styles(e)}function RH(r){var t,e,n,i,a=r,s=a.width,o=a.height,l=a.position,c=q([+s/2,+o/2],2),u=c[0],h=c[1],d=q([+u,+h,"center","middle"],4),f=d[0],g=d[1],v=d[2],p=d[3],y=Wh(l);return y.includes("l")&&(t=q([0,"start"],2),f=t[0],v=t[1]),y.includes("r")&&(e=q([+s,"end"],2),f=e[0],v=e[1]),y.includes("t")&&(n=q([0,"top"],2),g=n[0],p=n[1]),y.includes("b")&&(i=q([+o,"bottom"],2),g=i[0],p=i[1]),{x:f,y:g,textAlign:v,textBaseline:p}}var LH=(function(r){Ut(t,r);function t(e){return r.call(this,e,{text:"",width:0,height:0,fill:"#4a505a",fontWeight:"bold",fontSize:12,fontFamily:"sans-serif",inset:0,spacing:0,position:"top-left"})||this}return t.prototype.getAvailableSpace=function(){var e=this,n=this.attributes,i=n.width,a=n.height,s=n.position,o=n.spacing,l=n.inset,c=e.querySelector(Gy.text.class);if(!c)return new Yn(0,0,+i,+a);var u=c.getBBox(),h=u.width,d=u.height,f=q(Pn(o),4),g=f[0],v=f[1],p=f[2],y=f[3],m=q([0,0,+i,+a],4),x=m[0],E=m[1],_=m[2],M=m[3],O=Wh(s);if(O.includes("i"))return new Yn(x,E,_,M);O.forEach(function(H,Z){var U,tt,gt,xt;H==="t"&&(U=q(Z===0?[d+p,+a-d-p]:[0,+a],2),E=U[0],M=U[1]),H==="r"&&(tt=q([+i-h-y],1),_=tt[0]),H==="b"&&(gt=q([+a-d-g],1),M=gt[0]),H==="l"&&(xt=q(Z===0?[h+v,+i-h-v]:[0,+i],2),x=xt[0],_=xt[1])});var T=q(Pn(l),4),N=T[0],P=T[1],C=T[2],R=T[3],I=q([R+P,N+C],2),j=I[0],G=I[1];return new Yn(x+R,E+N,_-j,M-G)},t.prototype.getBBox=function(){return this.title?this.title.getBBox():new Yn(0,0,0,0)},t.prototype.render=function(e,n){var i=this;e.width,e.height,e.position,e.spacing;var a=e.classNamePrefix,s=Pe(e,["width","height","position","spacing","classNamePrefix"]),o=q(Gi(s),1),l=o[0],c=RH(e),u=c.x,h=c.y,d=c.textAlign,f=c.textBaseline;or(!!s.text,Ot(n),function(g){var v=$n(Gy.text.name,Wn.title,a);i.title=g.maybeAppendByClassName(Gy.text,"text").attr("className",v).styles(l).call(CH,{x:u,y:h,textAlign:d,textBaseline:f}).node()})},t})($e),qn=Qr({prevBtnGroup:"prev-btn-group",prevBtn:"prev-btn",nextBtnGroup:"next-btn-group",nextBtn:"next-btn",pageInfoGroup:"page-info-group",pageInfo:"page-info",playWindow:"play-window",contentGroup:"content-group",controller:"controller",clipPath:"clip-path"},"navigator"),IH=(function(r){Ut(t,r);function t(e){var n=r.call(this,e,{x:0,y:0,animate:{easing:"linear",duration:200,fill:"both"},buttonCursor:"pointer",buttonFill:"black",buttonD:FU(0,0,6),buttonSize:12,controllerPadding:5,controllerSpacing:5,formatter:function(i,a){return"".concat(i,"/").concat(a)},defaultPage:0,loop:!1,orientation:"horizontal",pageNumFill:"black",pageNumFontSize:12,pageNumTextAlign:"start",pageNumTextBaseline:"middle"})||this;return n.playState="idle",n.contentGroup=n.appendChild(new gn({class:qn.contentGroup.name})),n.playWindow=n.contentGroup.appendChild(new gn({class:qn.playWindow.name})),n.innerCurrPage=n.defaultPage,n}return Object.defineProperty(t.prototype,"defaultPage",{get:function(){var e=this.attributes.defaultPage;return qe(e,0,Math.max(this.pageViews.length-1,0))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageViews",{get:function(){return this.playWindow.children},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"controllerShape",{get:function(){return this.totalPages>1?{width:55,height:0}:{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageShape",{get:function(){var e=this.pageViews,n=q(yU(e.map(function(h){var d=h.getBBox(),f=d.width,g=d.height;return[f,g]})).map(function(h){return Math.max.apply(Math,Nt([],q(h),!1))}),2),i=n[0],a=n[1],s=this.attributes,o=s.pageWidth,l=o===void 0?i:o,c=s.pageHeight,u=c===void 0?a:c;return{pageWidth:l,pageHeight:u}},enumerable:!1,configurable:!0}),t.prototype.getContainer=function(){return this.playWindow},Object.defineProperty(t.prototype,"totalPages",{get:function(){return this.pageViews.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currPage",{get:function(){return this.innerCurrPage},enumerable:!1,configurable:!0}),t.prototype.getBBox=function(){var e=r.prototype.getBBox.call(this),n=e.x,i=e.y,a=this.controllerShape,s=this.pageShape,o=s.pageWidth,l=s.pageHeight;return new Yn(n,i,o+a.width,l)},t.prototype.goTo=function(e){var n=this,i=this.attributes.animate,a=this,s=a.currPage,o=a.playState,l=a.playWindow,c=a.pageViews;if(o!=="idle"||e<0||c.length<=0||e>=c.length)return null;c[s].setLocalPosition(0,0),this.prepareFollowingPage(e);var u=q(this.getFollowingPageDiff(e),2),h=u[0],d=u[1];this.playState="running";var f=jC(l,[{transform:"translate(0, 0)"},{transform:"translate(".concat(-h,", ").concat(-d,")")}],i);return io(f,function(){n.innerCurrPage=e,n.playState="idle",n.setVisiblePages([e]),n.updatePageInfo()}),f},t.prototype.prev=function(){var e=this.attributes.loop,n=this.pageViews.length,i=this.currPage;if(!e&&i<=0)return null;var a=e?(i-1+n)%n:qe(i-1,0,n);return this.goTo(a)},t.prototype.next=function(){var e=this.attributes.loop,n=this.pageViews.length,i=this.currPage;if(!e&&i>=n-1)return null;var a=e?(i+1)%n:qe(i+1,0,n);return this.goTo(a)},t.prototype.renderClipPath=function(e){var n=this.pageShape,i=n.pageWidth,a=n.pageHeight;if(!i||!a){this.contentGroup.style.clipPath=void 0;return}this.clipPath=e.maybeAppendByClassName(qn.clipPath,"rect").styles({width:i,height:a}),this.contentGroup.attr("clipPath",this.clipPath.node())},t.prototype.setVisiblePages=function(e){this.playWindow.children.forEach(function(n,i){e.includes(i)?kl(n):Ur(n)})},t.prototype.adjustControllerLayout=function(){var e=this,n=e.prevBtnGroup,i=e.nextBtnGroup,a=e.pageInfoGroup,s=this.attributes,o=s.orientation,l=s.controllerPadding,c=a.getBBox(),u=c.width;c.height;var h=q(o==="horizontal"?[-180,0]:[-90,90],2),d=h[0],f=h[1];n.setLocalEulerAngles(d),i.setLocalEulerAngles(f);var g=n.getBBox(),v=g.width,p=g.height,y=i.getBBox(),m=y.width,x=y.height,E=Math.max(v,u,m),_=o==="horizontal"?{offset:[[0,0],[v/2+l,0],[v+u+l*2,0]],textAlign:"start"}:{offset:[[E/2,-p-l],[E/2,0],[E/2,x+l]],textAlign:"center"},M=q(_.offset,3),O=q(M[0],2),T=O[0],N=O[1],P=q(M[1],2),C=P[0],R=P[1],I=q(M[2],2),j=I[0],G=I[1],H=_.textAlign,Z=a.querySelector("text");Z&&(Z.style.textAlign=H),n.setLocalPosition(T,N),a.setLocalPosition(C,R),i.setLocalPosition(j,G)},t.prototype.updatePageInfo=function(){var e,n=this,i=n.currPage,a=n.pageViews,s=n.attributes.formatter;a.length<2||((e=this.pageInfoGroup.querySelector(qn.pageInfo.class))===null||e===void 0||e.attr("text",s(i+1,a.length)),this.adjustControllerLayout())},t.prototype.getFollowingPageDiff=function(e){var n=this.currPage;if(n===e)return[0,0];var i=this.attributes.orientation,a=this.pageShape,s=a.pageWidth,o=a.pageHeight,l=e<n?-1:1;return i==="horizontal"?[l*s,0]:[0,l*o]},t.prototype.prepareFollowingPage=function(e){var n=this,i=n.currPage,a=n.pageViews;if(this.setVisiblePages([e,i]),e!==i){var s=q(this.getFollowingPageDiff(e),2),o=s[0],l=s[1];a[e].setLocalPosition(o,l)}},t.prototype.renderController=function(e){var n=this,i=this.attributes,a=i.controllerSpacing,s=i.classNamePrefix,o=s===void 0?"":s,l=this.pageShape,c=l.pageWidth,u=l.pageHeight,h=this.pageViews.length>=2,d=e.maybeAppendByClassName(qn.controller,"g");if($h(d.node(),h),!!h){var f=jt(this.attributes,"button"),g=jt(this.attributes,"pageNum"),v=q(Gi(f),2),p=v[0],y=v[1],m=p.size,x=Pe(p,["size"]),E=!d.select(qn.prevBtnGroup.class).node(),_=d.maybeAppendByClassName(qn.prevBtnGroup,"g").styles(y);this.prevBtnGroup=_.node();var M=_.maybeAppendByClassName(qn.prevBtn,"path");if(o){var O=$n(qn.prevBtn.name,Wn.prevBtn,o);M.node().setAttribute("class",O)}var T=d.maybeAppendByClassName(qn.nextBtnGroup,"g").styles(y);this.nextBtnGroup=T.node();var N=T.maybeAppendByClassName(qn.nextBtn,"path");if(o){var P=$n(qn.nextBtn.name,Wn.nextBtn,o);N.node().setAttribute("class",P)}[M,N].forEach(function(j){j.styles(at(at({},x),{transformOrigin:"center"})),mb(j.node(),m)});var C=d.maybeAppendByClassName(qn.pageInfoGroup,"g");this.pageInfoGroup=C.node();var R=C.maybeAppendByClassName(qn.pageInfo,"text");if(R.styles(g),o){var I=$n(qn.pageInfo.name,Wn.pageInfo,o);R.node().setAttribute("class",I)}this.updatePageInfo(),d.node().setLocalPosition(c+a,u/2),E&&(this.prevBtnGroup.addEventListener("click",function(){n.prev()}),this.nextBtnGroup.addEventListener("click",function(){n.next()}))}},t.prototype.render=function(e,n){var i=e.x,a=i===void 0?0:i,s=e.y,o=s===void 0?0:s;this.attr("transform","translate(".concat(a,", ").concat(o,")"));var l=Ot(n);this.renderClipPath(l),this.renderController(l),this.setVisiblePages([this.defaultPage]),this.goTo(this.defaultPage)},t.prototype.bindEvents=function(){var e=this,n=al(function(){return e.render(e.attributes,e)},50);this.playWindow.addEventListener(Jt.INSERTED,n),this.playWindow.addEventListener(Jt.REMOVED,n)},t})($e),Zt,DH="component-poptip",Wt={CONTAINER:"component-poptip",ARROW:"component-poptip-arrow",TEXT:"component-poptip-text"},AT=(Zt={},Zt[".".concat(Wt.CONTAINER)]={visibility:"visible",position:"absolute","background-color":"rgba(0, 0, 0)","box-shadow":"0px 0px 10px #aeaeae","border-radius":"3px",color:"#fff",opacity:.8,"font-size":"12px",padding:"4px 6px",display:"flex","justify-content":"center","align-items":"center","z-index":8,transition:"visibility 50ms"},Zt[".".concat(Wt.TEXT)]={"text-align":"center"},Zt[".".concat(Wt.CONTAINER,"[data-position='top']")]={transform:"translate(-50%, -100%)"},Zt[".".concat(Wt.CONTAINER,"[data-position='left']")]={transform:"translate(-100%, -50%)"},Zt[".".concat(Wt.CONTAINER,"[data-position='right']")]={transform:"translate(0, -50%)"},Zt[".".concat(Wt.CONTAINER,"[data-position='bottom']")]={transform:"translate(-50%, 0)"},Zt[".".concat(Wt.CONTAINER,"[data-position='top-left']")]={transform:"translate(0,-100%)"},Zt[".".concat(Wt.CONTAINER,"[data-position='top-right']")]={transform:"translate(-100%,-100%)"},Zt[".".concat(Wt.CONTAINER,"[data-position='left-top']")]={transform:"translate(-100%, 0)"},Zt[".".concat(Wt.CONTAINER,"[data-position='left-bottom']")]={transform:"translate(-100%, -100%)"},Zt[".".concat(Wt.CONTAINER,"[data-position='right-top']")]={transform:"translate(0, 0)"},Zt[".".concat(Wt.CONTAINER,"[data-position='right-bottom']")]={transform:"translate(0, -100%)"},Zt[".".concat(Wt.CONTAINER,"[data-position='bottom-left']")]={transform:"translate(0, 0)"},Zt[".".concat(Wt.CONTAINER,"[data-position='bottom-right']")]={transform:"translate(-100%, 0)"},Zt[".".concat(Wt.ARROW)]={width:"4px",height:"4px",transform:"rotate(45deg)","background-color":"rgba(0, 0, 0)",position:"absolute","z-index":-1},Zt[".".concat(Wt.CONTAINER,"[data-position='top']")]={transform:"translate(-50%, calc(-100% - 5px))"},Zt["[data-position='top'] .".concat(Wt.ARROW)]={bottom:"-2px"},Zt[".".concat(Wt.CONTAINER,"[data-position='left']")]={transform:"translate(calc(-100% - 5px), -50%)"},Zt["[data-position='left'] .".concat(Wt.ARROW)]={right:"-2px"},Zt[".".concat(Wt.CONTAINER,"[data-position='right']")]={transform:"translate(5px, -50%)"},Zt["[data-position='right'] .".concat(Wt.ARROW)]={left:"-2px"},Zt[".".concat(Wt.CONTAINER,"[data-position='bottom']")]={transform:"translate(-50%, 5px)"},Zt["[data-position='bottom'] .".concat(Wt.ARROW)]={top:"-2px"},Zt[".".concat(Wt.CONTAINER,"[data-position='top-left']")]={transform:"translate(0, calc(-100% - 5px))"},Zt["[data-position='top-left'] .".concat(Wt.ARROW)]={left:"10px",bottom:"-2px"},Zt[".".concat(Wt.CONTAINER,"[data-position='top-right']")]={transform:"translate(-100%, calc(-100% - 5px))"},Zt["[data-position='top-right'] .".concat(Wt.ARROW)]={right:"10px",bottom:"-2px"},Zt[".".concat(Wt.CONTAINER,"[data-position='left-top']")]={transform:"translate(calc(-100% - 5px), 0)"},Zt["[data-position='left-top'] .".concat(Wt.ARROW)]={right:"-2px",top:"8px"},Zt[".".concat(Wt.CONTAINER,"[data-position='left-bottom']")]={transform:"translate(calc(-100% - 5px), -100%)"},Zt["[data-position='left-bottom'] .".concat(Wt.ARROW)]={right:"-2px",bottom:"8px"},Zt[".".concat(Wt.CONTAINER,"[data-position='right-top']")]={transform:"translate(5px, 0)"},Zt["[data-position='right-top'] .".concat(Wt.ARROW)]={left:"-2px",top:"8px"},Zt[".".concat(Wt.CONTAINER,"[data-position='right-bottom']")]={transform:"translate(5px, -100%)"},Zt["[data-position='right-bottom'] .".concat(Wt.ARROW)]={left:"-2px",bottom:"8px"},Zt[".".concat(Wt.CONTAINER,"[data-position='bottom-left']")]={transform:"translate(0, 5px)"},Zt["[data-position='bottom-left'] .".concat(Wt.ARROW)]={top:"-2px",left:"8px"},Zt[".".concat(Wt.CONTAINER,"[data-position='bottom-right']")]={transform:"translate(-100%, 5px)"},Zt["[data-position='bottom-right'] .".concat(Wt.ARROW)]={top:"-2px",right:"8px"},Zt),FH=void 0;function BH(r,t,e,n,i,a){if(i===void 0&&(i=!1),a===void 0&&(a=!1),a)return[r,t];var s=e.getBoundingClientRect(),o=s.x,l=s.y,c=s.width,u=s.height;switch(n){case"top":return i?[o+c/2,l]:[r,l];case"left":return i?[o,l+u/2]:[o,t];case"bottom":return i?[o+c/2,l+u]:[r,l+u];case"right":return i?[o+c,l+u/2]:[o+c,t];case"top-right":case"right-top":return[o+c,l];case"left-bottom":case"bottom-left":return[o,l+u];case"right-bottom":case"bottom-right":return[o+c,l+u];case"top-left":case"left-top":default:return[o,l]}}var zH=function(r){var t;return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t||(t=r.apply(FH,e)),t}};function jH(r){var t=r&&document.getElementById(r);return t||(t=document.createElement("div"),t.setAttribute("id",r),document.body.appendChild(t)),t}function qH(r){var t=zH(jH)(r);return t}var GH=(function(r){Ut(t,r);function t(e){var n=r.call(this,An({style:{id:DH}},t.defaultOptions,e))||this;return n.visibility="visible",n.map=new Map,n.domStyles="",n.initShape(),n.render(n.attributes,n),n}return Object.defineProperty(t.prototype,"visible",{get:function(){return this.visibility==="visible"},enumerable:!1,configurable:!0}),t.prototype.render=function(e,n){this.visibility=this.style.visibility,this.updatePoptipElement()},t.prototype.update=function(e){this.attr(An({},this.style,e)),this.render(this.attributes,this)},t.prototype.bind=function(e,n){var i=this;if(e){var a=this.style.text,s=function(l){var c=e,u=i.style,h=a;if(n){var d=typeof n=="function"?n.call(null,l):n,f=d.html,g=d.target,v=Pe(d,["html","target"]);u=Z3({},i.style,v),(g||g===!1)&&(c=g),typeof f=="string"&&(h=f)}var p=u.position,y=u.arrowPointAtCenter,m=u.follow,x=u.offset;if(c){var E=l,_=E.clientX,M=E.clientY,O=q(BH(_,M,c,p,y,m),2),T=O[0],N=O[1];i.showTip(T,N,{text:h,position:p,offset:x})}else i.hideTip()},o=function(){i.hideTip()};e.addEventListener("mousemove",s),e.addEventListener("mouseleave",o),this.map.set(e,[s,o])}},t.prototype.unbind=function(e){if(this.map.has(e)){var n=q(this.map.get(e)||[],2),i=n[0],a=n[1];i&&e.removeEventListener("mousemove",i),a&&e.removeEventListener("mouseleave",a),this.map.delete(e)}},t.prototype.clear=function(){this.container.innerHTML=""},t.prototype.destroy=function(){var e=this,n;Nt([],q(this.map.keys()),!1).forEach(function(i){return e.unbind(i)}),(n=this.container)===null||n===void 0||n.remove(),r.prototype.destroy.call(this)},t.prototype.showTip=function(e,n,i){var a=Mn(i,"text");if(!(a&&typeof a!="string")&&(this.applyStyles(),e&&n&&i)){var s=i.offset,o=i.position;if(o&&this.container.setAttribute("data-position",o),this.setOffsetPosition(e,n,s),typeof a=="string"){var l=this.container.querySelector(".".concat(Wt.TEXT));l&&(l.innerHTML=a)}this.visibility="visible",this.container.style.visibility="visible"}},t.prototype.hideTip=function(){this.visibility="hidden",this.container.style.visibility="hidden"},t.prototype.getContainer=function(){return this.container},t.prototype.getClassName=function(){var e=this.style.containerClassName;return"".concat(Wt.CONTAINER).concat(e?" ".concat(e):"")},t.prototype.initShape=function(){var e=this,n=this.style.id;this.container=qH(n),this.container.className=this.getClassName(),this.container.addEventListener("mousemove",function(){return e.showTip()}),this.container.addEventListener("mouseleave",function(){return e.hideTip()})},t.prototype.updatePoptipElement=function(){var e=this.container;this.clear();var n=this.style,i=n.id,a=n.template,s=n.text;this.container.setAttribute("id",i),this.container.className=this.getClassName();var o='<span class="'.concat(Wt.ARROW,'"></span>');e.innerHTML=o,ae(a)?e.innerHTML+=a:a&&K3(a)&&e.appendChild(a),s&&(e.getElementsByClassName(Wt.TEXT)[0].textContent=s),this.applyStyles(),this.container.style.visibility=this.visibility},t.prototype.applyStyles=function(){var e=on({},AT,this.style.domStyles),n=Object.entries(e).reduce(function(a,s){var o=q(s,2),l=o[0],c=o[1],u=Object.entries(c).reduce(function(h,d){var f=q(d,2),g=f[0],v=f[1];return"".concat(h).concat(g,": ").concat(v,";")},"");return"".concat(a).concat(l,"{").concat(u,"}")},"");if(this.domStyles!==n){this.domStyles=n;var i=this.container.querySelector("style");i&&this.container.removeChild(i),i=document.createElement("style"),i.innerHTML=n,this.container.appendChild(i)}},t.prototype.setOffsetPosition=function(e,n,i){i===void 0&&(i=this.style.offset);var a=q(i,2),s=a[0],o=s===void 0?0:s,l=a[1],c=l===void 0?0:l;this.container.style.left="".concat(e+o,"px"),this.container.style.top="".concat(n+c,"px")},t.tag="poptip",t.defaultOptions={style:{x:0,y:0,width:0,height:0,target:null,visibility:"hidden",text:"",position:"top",follow:!1,offset:[0,0],domStyles:AT,template:'<div class="'.concat(Wt.TEXT,'"></div>')}},t})($e),tn=Qr({layout:"flex",markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label",valueGroup:"value-group",focusGroup:"focus-group",focus:"focus",value:"value",backgroundGroup:"background-group",background:"background"},"legend-category-item"),$H={offset:[0,20],domStyles:{".component-poptip":{opacity:"1",padding:"8px 12px",background:"#fff",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.15)"},".component-poptip-arrow":{display:"none"},".component-poptip-text":{color:"#000",lineHeight:"20px"}}};function WH(r){var t=r.querySelector(tn.marker.class);return t?t.style:{}}var VH=(function(r){Ut(t,r);function t(e,n){var i=r.call(this,e,{span:[1,1],marker:function(){return new mi({style:{r:6}})},markerSize:10,labelFill:"#646464",valueFill:"#646464",labelFontSize:12,valueFontSize:12,labelTextBaseline:"middle",valueTextBaseline:"middle"})||this;return i.keyFields={},i.keyFields=n||{},i}return Object.defineProperty(t.prototype,"showValue",{get:function(){var e=this.attributes.valueText;return e?typeof e=="string"||typeof e=="number"?e!=="":typeof e=="function"?!0:e.attr("text")!=="":!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"actualSpace",{get:function(){var e=this.labelGroup,n=this.valueGroup,i=this.attributes,a=i.markerSize,s=i.focus,o=i.focusMarkerSize,l=e.node().getBBox(),c=l.width,u=l.height,h=n.node().getBBox(),d=h.width,f=h.height,g=s?o??12:0;return{markerWidth:a,labelWidth:c,valueWidth:d,focusWidth:g,height:Math.max(a,u,f)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"span",{get:function(){var e=this.attributes.span;if(!e)return[1,1];var n=q(Pn(e),2),i=n[0],a=n[1],s=this.showValue?a:0,o=i+s;return[i/o,s/o]},enumerable:!1,configurable:!0}),t.prototype.setAttribute=function(e,n){r.prototype.setAttribute.call(this,e,n)},Object.defineProperty(t.prototype,"shape",{get:function(){var e,n=this.attributes,i=n.markerSize,a=n.width,s=this.actualSpace,o=s.markerWidth,l=s.focusWidth,c=s.height,u=this.actualSpace,h=u.labelWidth,d=u.valueWidth,f=q(this.spacing,3),g=f[0],v=f[1],p=f[2];if(a){var y=a-i-g-v-l-p,m=q(this.span,2),x=m[0],E=m[1];e=q([x*y,E*y],2),h=e[0],d=e[1]}var _=o+h+d+g+v+l+p;return{width:_,height:c,markerWidth:o,labelWidth:h,valueWidth:d,focusWidth:l}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"spacing",{get:function(){var e=this.attributes,n=e.spacing,i=e.focus;if(!n)return[0,0,0];var a=q(Pn(n),3),s=a[0],o=a[1],l=a[2];return[s,this.showValue?o:0,i?l:0]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"layout",{get:function(){var e=this.shape,n=e.markerWidth,i=e.labelWidth,a=e.valueWidth,s=e.focusWidth,o=e.width,l=e.height,c=q(this.spacing,3),u=c[0],h=c[1],d=c[2];return{height:l,width:o,markerWidth:n,labelWidth:i,valueWidth:a,focusWidth:s,position:[n/2,n+u,n+i+u+h,n+i+a+u+h+d+s/2]}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scaleSize",{get:function(){var e=WH(this.markerGroup.node()),n=this.attributes,i=n.markerSize,a=n.markerStrokeWidth,s=a===void 0?e.strokeWidth:a,o=n.markerLineWidth,l=o===void 0?e.lineWidth:o,c=n.markerStroke,u=c===void 0?e.stroke:c,h=+(s||l||(u?1:0))*Math.sqrt(2),d=this.markerGroup.node().getBBox(),f=d.width,g=d.height;return(1-h/Math.max(f,g))*i},enumerable:!1,configurable:!0}),t.prototype.renderMarker=function(e){var n=this,i=this.attributes,a=i.marker,s=i.classNamePrefix,o=jt(this.attributes,"marker");this.markerGroup=e.maybeAppendByClassName(tn.markerGroup,"g").style("zIndex",0),or(!!a,this.markerGroup,function(){var l,c=n.markerGroup.node(),u=(l=c.childNodes)===null||l===void 0?void 0:l[0],h=$n(tn.marker.name,Wn.marker,s),d=typeof a=="string"?new le({style:{symbol:a},className:h}):a();if(u)if(d.nodeName===u.nodeName)u instanceof le?u.update(at(at({},o),{symbol:a})):(dU(u,d),Ot(u).styles(o));else{if(u.remove(),!(d instanceof le)){var g=$n(tn.marker.name,Wn.marker,s);d.className=g}Ot(d).styles(o),c.appendChild(d)}else{if(!(d instanceof le)){var f=$n(tn.marker.name,Wn.marker,s);d.className=f,Ot(d).styles(o)}c.appendChild(d)}n.markerGroup.node().scale(1/n.markerGroup.node().getScale()[0]);var v=mb(n.markerGroup.node(),n.scaleSize);n.markerGroup.node().style._transform="scale(".concat(v,")")})},t.prototype.renderLabel=function(e){var n=jt(this.attributes,"label"),i=n.text,a=Pe(n,["text"]),s=this.attributes.classNamePrefix;this.labelGroup=e.maybeAppendByClassName(tn.labelGroup,"g").style("zIndex",0);var o=$n(tn.label.name,Wn.label,s),l=this.labelGroup.maybeAppendByClassName(tn.label,function(){return qi(i)});l.node().setAttribute("class",o),l.styles(a)},t.prototype.renderValue=function(e){var n=this,i=jt(this.attributes,"value"),a=i.text,s=Pe(i,["text"]),o=this.attributes.classNamePrefix;this.valueGroup=e.maybeAppendByClassName(tn.valueGroup,"g").style("zIndex",0),or(this.showValue,this.valueGroup,function(){var l=$n(tn.value.name,Wn.value,o),c=n.valueGroup.maybeAppendByClassName(tn.value,function(){return qi(a)});c.node().setAttribute("class",l),c.styles(s)})},t.prototype.createPoptip=function(){var e=this.attributes.poptip,n=e||{};n.render;var i=Pe(n,["render"]),a=new GH({style:on($H,i)});return this.poptipGroup=a,a},t.prototype.bindPoptip=function(e){var n=this,i=this.attributes.poptip;if(i){var a=this.poptipGroup||this.createPoptip();a.bind(e,function(){var s=n.attributes,o=s.labelText,l=s.valueText,c=s.markerFill,u=typeof o=="string"?o:o==null?void 0:o.attr("text"),h=typeof l=="string"?l:l==null?void 0:l.attr("text");if(typeof i.render=="function")return{html:i.render(at(at({},n.keyFields),{label:u,value:h,color:c}))};var d="";return(typeof u=="string"||typeof u=="number")&&(d+='<div class="component-poptip-label">'.concat(u,"</div>")),(typeof h=="string"||typeof h=="number")&&(d+='<div class="component-poptip-value">'.concat(h,"</div>")),{html:d}})}},t.prototype.renderFocus=function(e){var n=this,i=this.attributes,a=i.focus,s=i.focusMarkerSize,o=i.classNamePrefix,l={x:0,y:0,size:s,opacity:.6,symbol:"focus",stroke:"#aaaaaa",lineWidth:1};Dt(a)||(this.focusGroup=e.maybeAppendByClassName(tn.focusGroup,"g").style("zIndex",0),or(a,this.focusGroup,function(){var c=$n(tn.focus.name,Wn.focusIcon,o),u=new le({style:at(at({},l),{symbol:"focus"}),className:c}),h=new mi({style:{r:l.size/2,fill:"transparent"}}),d=n.focusGroup.node();d.appendChild(h),d.appendChild(u),u.update({opacity:0}),e.node().addEventListener("pointerenter",function(){u.update({opacity:1})}),e.node().addEventListener("pointerleave",function(){u.update({opacity:0})})}))},t.prototype.renderPoptip=function(e){var n=this,i=this.attributes.poptip;if(i){var a=e.maybeAppendByClassName(tn.value,"g").node(),s=e.maybeAppendByClassName(tn.label,"g").node();[a,s].forEach(function(o){o&&n.bindPoptip(o)})}},t.prototype.renderBackground=function(e){var n=this.shape,i=n.width,a=n.height,s=jt(this.attributes,"background");this.background=e.maybeAppendByClassName(tn.backgroundGroup,"g").style("zIndex",-1);var o=this.background.maybeAppendByClassName(tn.background,"rect");o.styles(at({width:i,height:a},s));var l=this.attributes.classNamePrefix,c=l===void 0?"":l;if(c){var u=$n(tn.background.name,Wn.background,c);o.node().setAttribute("class",u)}},t.prototype.adjustLayout=function(){var e=this.layout,n=e.labelWidth,i=e.valueWidth,a=e.height,s=q(e.position,4),o=s[0],l=s[1],c=s[2],u=s[3],h=a/2;this.markerGroup.styles({transform:"translate(".concat(o,", ").concat(h,")").concat(this.markerGroup.node().style._transform)}),this.labelGroup.styles({transform:"translate(".concat(l,", ").concat(h,")")}),this.focusGroup&&this.focusGroup.styles({transform:"translate(".concat(u,", ").concat(h,")")}),Xm(this.labelGroup.select(tn.label.class).node(),Math.ceil(n)),this.showValue&&(this.valueGroup.styles({transform:"translate(".concat(c,", ").concat(h,")")}),Xm(this.valueGroup.select(tn.value.class).node(),Math.ceil(i)))},t.prototype.render=function(e,n){var i=Ot(n),a=e.x,s=a===void 0?0:a,o=e.y,l=o===void 0?0:o;i.styles({transform:"translate(".concat(s,", ").concat(l,")")}),this.renderMarker(i),this.renderLabel(i),this.renderValue(i),this.renderBackground(i),this.renderPoptip(i),this.renderFocus(i),this.adjustLayout()},t})($e),Ca=Qr({page:"item-page",navigator:"navigator",item:"item"},"items"),NT=function(r,t,e){return e===void 0&&(e=!0),r?t(r):e},UH=(function(r){Ut(t,r);function t(e){var n=r.call(this,e,{data:[],gridRow:1/0,gridCol:void 0,padding:0,width:1e3,height:100,rowPadding:0,colPadding:0,layout:"flex",orientation:"horizontal",click:yd,mouseenter:yd,mouseleave:yd})||this;return n.navigatorShape=[0,0],n}return Object.defineProperty(t.prototype,"pageViews",{get:function(){return this.navigator.getContainer()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"grid",{get:function(){var e=this.attributes,n=e.gridRow,i=e.gridCol,a=e.data;if(!n&&!i)throw new Error("gridRow and gridCol can not be set null at the same time");return n&&i?[n,i]:n?[n,a.length]:[a.length,i]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderData",{get:function(){var e=this.attributes,n=e.data,i=e.layout,a=e.poptip,s=e.focus,o=e.focusMarkerSize,l=e.classNamePrefix,c=jt(this.attributes,"item"),u=n.map(function(h,d){var f=h.id,g=f===void 0?d:f,v=h.label,p=h.value;return{id:"".concat(g),index:d,style:at({layout:i,labelText:v,valueText:p,poptip:a,focus:s,focusMarkerSize:o,classNamePrefix:l},Object.fromEntries(Object.entries(c).map(function(y){var m=q(y,2),x=m[0],E=m[1];return[x,lr(E,[h,d,n])]})))}});return u},enumerable:!1,configurable:!0}),t.prototype.getGridLayout=function(){var e=this,n=this.attributes,i=n.orientation,a=n.width,s=n.rowPadding,o=n.colPadding,l=q(this.navigatorShape,1),c=l[0],u=q(this.grid,2),h=u[0],d=u[1],f=d*h,g=0;return this.pageViews.children.map(function(v,p){var y,m,x=Math.floor(p/f),E=p%f,_=e.ifHorizontal(d,h),M=[Math.floor(E/_),E%_];i==="vertical"&&M.reverse();var O=q(M,2),T=O[0],N=O[1],P=(a-c-(d-1)*o)/d,C=v.getBBox().height,R=q([0,0],2),I=R[0],j=R[1];return i==="horizontal"?(y=q([g,T*(C+s)],2),I=y[0],j=y[1],g=N===d-1?0:g+P+o):(m=q([N*(P+o),g],2),I=m[0],j=m[1],g=T===h-1?0:g+C+s),{page:x,index:p,row:T,col:N,pageIndex:E,width:P,height:C,x:I,y:j}})},t.prototype.getFlexLayout=function(){var e=this.attributes,n=e.width,i=e.height,a=e.rowPadding,s=e.colPadding,o=q(this.navigatorShape,1),l=o[0],c=q(this.grid,2),u=c[0],h=c[1],d=q([n-l,i],2),f=d[0],g=d[1],v=q([0,0,0,0,0,0,0,0],8),p=v[0],y=v[1],m=v[2],x=v[3],E=v[4],_=v[5],M=v[6],O=v[7];return this.pageViews.children.map(function(T,N){var P,C,R,I,j=T.getBBox(),G=j.width,H=j.height,Z=M===0?0:s,U=M+Z+G;if(U<=f&&NT(E,function(gt){return gt<h}))return P=q([M+Z,O,U],3),p=P[0],y=P[1],M=P[2],{width:G,height:H,x:p,y,page:m,index:N,pageIndex:x++,row:_,col:E++};C=q([_+1,0,0,O+H+a],4),_=C[0],E=C[1],M=C[2],O=C[3];var tt=O+H;return tt<=g&&NT(_,function(gt){return gt<u})?(R=q([M,O,G],3),p=R[0],y=R[1],M=R[2],{width:G,height:H,x:p,y,page:m,index:N,pageIndex:x++,row:_,col:E++}):(I=q([0,0,G,0,m+1,0,0,0],8),p=I[0],y=I[1],M=I[2],O=I[3],m=I[4],x=I[5],_=I[6],E=I[7],{width:G,height:H,x:p,y,page:m,index:N,pageIndex:x++,row:_,col:E++})})},Object.defineProperty(t.prototype,"itemsLayout",{get:function(){this.navigatorShape=[0,0];var e=this.attributes.layout==="grid"?this.getGridLayout:this.getFlexLayout,n=e.call(this);return n.slice(-1)[0].page>0?(this.navigatorShape=[55,0],e.call(this)):n},enumerable:!1,configurable:!0}),t.prototype.ifHorizontal=function(e,n){var i=this.attributes.orientation;return n1(i,e,n)},t.prototype.flattenPage=function(e){e.querySelectorAll(Ca.item.class).forEach(function(n){e.appendChild(n)}),e.querySelectorAll(Ca.page.class).forEach(function(n){var i=e.removeChild(n);i.destroy()})},t.prototype.renderItems=function(e){var n=this.attributes,i=n.click,a=n.mouseenter,s=n.mouseleave,o=n.classNamePrefix;this.flattenPage(e);var l=this.dispatchCustomEvent.bind(this),c=$n(Ca.item.name,Wn.item,o);Ot(e).selectAll(Ca.item.class).data(this.renderData,function(u){return u.id}).join(function(u){return u.append(function(h){var d=h.style,f=Pe(h,["style"]);return new VH({style:d},f)}).attr("className",c).on("click",function(){i==null||i(this),l("itemClick",{item:this})}).on("pointerenter",function(){a==null||a(this),l("itemMouseenter",{item:this})}).on("pointerleave",function(){s==null||s(this),l("itemMouseleave",{item:this})})},function(u){return u.each(function(h){var d=h.style;this.update(d)})},function(u){return u.remove()})},t.prototype.relayoutNavigator=function(){var e,n=this.attributes,i=n.layout,a=n.width,s=((e=this.pageViews.children[0])===null||e===void 0?void 0:e.getBBox().height)||0,o=q(this.navigatorShape,2),l=o[0],c=o[1];this.navigator.update(i==="grid"?{pageWidth:a-l,pageHeight:s-c}:{})},t.prototype.adjustLayout=function(){var e=this,n=Object.entries(KV(this.itemsLayout,"page")).map(function(a){var s=q(a,2),o=s[0],l=s[1];return{page:o,layouts:l}}),i=Nt([],q(this.navigator.getContainer().children),!1);n.forEach(function(a){var s=a.layouts,o=e.pageViews.appendChild(new gn({className:Ca.page.name}));s.forEach(function(l){var c=l.x,u=l.y,h=l.index,d=l.width,f=l.height,g=i[h];o.appendChild(g),Go(g,"__layout__",l),g.update({x:c,y:u,width:d,height:f})})}),this.relayoutNavigator()},t.prototype.renderNavigator=function(e){var n=this.attributes,i=n.orientation,a=n.classNamePrefix,s=jt(this.attributes,"nav"),o=on({orientation:i,classNamePrefix:a},s),l=this;return e.selectAll(Ca.navigator.class).data(["nav"]).join(function(c){return c.append(function(){return new IH({style:o})}).attr("className",Ca.navigator.name).each(function(){l.navigator=this})},function(c){return c.each(function(){this.update(o)})},function(c){return c.remove()}),this.navigator},t.prototype.getBBox=function(){return this.navigator.getBBox()},t.prototype.render=function(e,n){var i=this.attributes.data;if(!(!i||i.length===0)){var a=this.renderNavigator(Ot(n));this.renderItems(a.getContainer()),this.adjustLayout()}},t.prototype.dispatchCustomEvent=function(e,n){var i=new rn(e,{detail:n});this.dispatchEvent(i)},t})($e),YH=(function(r){Ut(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.update=function(e){this.attr(e)},t})(rs),HH=(function(r){Ut(t,r);function t(e){return r.call(this,e,NH)||this}return t.prototype.renderTitle=function(e,n,i){var a=this.attributes,s=a.showTitle,o=a.titleText,l=a.classNamePrefix,c=jt(this.attributes,"title"),u=q(Gi(c),2),h=u[0],d=u[1];this.titleGroup=e.maybeAppendByClassName(Pa.titleGroup,"g").styles(d);var f=at(at({width:n,height:i},h),{text:s?o:"",classNamePrefix:l});this.title=this.titleGroup.maybeAppendByClassName(Pa.title,function(){return new LH({style:f})}).update(f)},t.prototype.renderCustom=function(e){var n=this.attributes.data,i={innerHTML:this.attributes.render(n),pointerEvents:"auto"};e.maybeAppendByClassName(Pa.html,function(){return new YH({className:Pa.html.name,style:i})}).update(i)},t.prototype.renderItems=function(e,n){var i=n.x,a=n.y,s=n.width,o=n.height,l=jt(this.attributes,"title",!0),c=q(Gi(l),2),u=c[0],h=c[1],d=at(at({},u),{width:s,height:o,x:0,y:0});this.itemsGroup=e.maybeAppendByClassName(Pa.itemsGroup,"g").styles(at(at({},h),{transform:"translate(".concat(i,", ").concat(a,")")}));var f=this;this.itemsGroup.selectAll(Pa.items.class).data(["items"]).join(function(g){return g.append(function(){return new UH({style:d})}).attr("className",Pa.items.name).each(function(){f.items=Ot(this)})},function(g){return g.update(d)},function(g){return g.remove()})},t.prototype.adjustLayout=function(){var e=this.attributes.showTitle;if(e){var n=this.title.node().getAvailableSpace(),i=n.x,a=n.y;this.itemsGroup.node().style.transform="translate(".concat(i,", ").concat(a,")")}},Object.defineProperty(t.prototype,"availableSpace",{get:function(){var e=this.attributes,n=e.showTitle,i=e.width,a=e.height;return n?this.title.node().getAvailableSpace():new Yn(0,0,i,a)},enumerable:!1,configurable:!0}),t.prototype.getBBox=function(){var e,n,i=(e=this.title)===null||e===void 0?void 0:e.node(),a=(n=this.items)===null||n===void 0?void 0:n.node();return!i||!a?r.prototype.getBBox.call(this):PH(i,a)},t.prototype.render=function(e,n){var i=this.attributes,a=i.width,s=i.height,o=i.x,l=o===void 0?0:o,c=i.y,u=c===void 0?0:c,h=i.classNamePrefix,d=i.render,f=Ot(n),g=n.className||"legend-category";h?n.attr("className","".concat(g," ").concat(h,"legend")):n.className||n.attr("className","legend-category"),n.style.transform="translate(".concat(l,", ").concat(u,")"),d?this.renderCustom(f):(this.renderTitle(f,a,s),this.renderItems(f,this.availableSpace),this.adjustLayout())},t})($e),XH={backgroundFill:"#262626",backgroundLineCap:"round",backgroundLineWidth:1,backgroundStroke:"#333",backgroundZIndex:-1,formatter:function(r){return r.toString()},labelFill:"#fff",labelFontSize:12,labelTextBaseline:"middle",padding:[2,4],position:"right",radius:0,zIndex:999},$y=Qr({background:"background",labelGroup:"label-group",label:"label"},"indicator"),KH=(function(r){Ut(t,r);function t(e){var n=r.call(this,e,XH)||this;return n.point=[0,0],n.group=n.appendChild(new gn({})),n.isMutationObserved=!0,n}return t.prototype.renderBackground=function(){if(this.label){var e=this.attributes,n=e.position,i=e.padding,a=q(Pn(i),4),s=a[0],o=a[1],l=a[2],c=a[3],u=this.label.node().getLocalBounds(),h=u.min,d=u.max,f=new Yn(h[0]-c,h[1]-s,d[0]+o-h[0]+c,d[1]+l-h[1]+s),g=this.getPath(n,f),v=jt(this.attributes,"background");this.background=Ot(this.group).maybeAppendByClassName($y.background,"path").styles(at(at({},v),{d:g})),this.group.appendChild(this.label.node())}},t.prototype.renderLabel=function(){var e=this.attributes,n=e.formatter,i=e.labelText,a=jt(this.attributes,"label"),s=q(Gi(a),2),o=s[0],l=s[1];o.text;var c=Pe(o,["text"]);if(this.label=Ot(this.group).maybeAppendByClassName($y.labelGroup,"g").styles(l),!!i){var u=this.label.maybeAppendByClassName($y.label,function(){return qi(n(i))}).style("text",n(i).toString());u.selectAll("text").styles(c)}},t.prototype.adjustLayout=function(){var e=q(this.point,2),n=e[0],i=e[1],a=this.attributes,s=a.x,o=a.y;this.group.attr("transform","translate(".concat(s-n,", ").concat(o-i,")"))},t.prototype.getPath=function(e,n){var i=this.attributes.radius,a=n.x,s=n.y,o=n.width,l=n.height,c=[["M",a+i,s],["L",a+o-i,s],["A",i,i,0,0,1,a+o,s+i],["L",a+o,s+l-i],["A",i,i,0,0,1,a+o-i,s+l],["L",a+i,s+l],["A",i,i,0,0,1,a,s+l-i],["L",a,s+i],["A",i,i,0,0,1,a+i,s],["Z"]],u={top:4,right:6,bottom:0,left:2},h=u[e],d=this.createCorner([c[h].slice(-2),c[h+1].slice(-2)]);return c.splice.apply(c,Nt([h+1,1],q(d),!1)),c[0][0]="M",c},t.prototype.createCorner=function(e,n){n===void 0&&(n=10);var i=.8,a=hU.apply(void 0,Nt([],q(e),!1)),s=q(e,2),o=q(s[0],2),l=o[0],c=o[1],u=q(s[1],2),h=u[0],d=u[1],f=q(a?[h-l,[l,h]]:[d-c,[c,d]],2),g=f[0],v=q(f[1],2),p=v[0],y=v[1],m=g/2,x=g/Math.abs(g),E=n*x,_=E/2,M=E*Math.sqrt(3)/2*i,O=q([p,p+m-_,p+m,p+m+_,y],5),T=O[0],N=O[1],P=O[2],C=O[3],R=O[4];return a?(this.point=[P,c-M],[["L",T,c],["L",N,c],["L",P,c-M],["L",C,c],["L",R,c]]):(this.point=[l+M,P],[["L",l,T],["L",l,N],["L",l+M,P],["L",l,C],["L",l,R]])},t.prototype.applyVisibility=function(){var e=this.attributes.visibility;e==="hidden"?Ur(this):kl(this)},t.prototype.bindEvents=function(){this.label.on(Jt.BOUNDS_CHANGED,this.renderBackground)},t.prototype.render=function(){this.renderLabel(),this.renderBackground(),this.adjustLayout(),this.applyVisibility()},t})($e);function r1(r){return r===void 0&&(r=""),{CONTAINER:"".concat(r,"tooltip"),TITLE:"".concat(r,"tooltip-title"),LIST:"".concat(r,"tooltip-list"),LIST_ITEM:"".concat(r,"tooltip-list-item"),NAME:"".concat(r,"tooltip-list-item-name"),MARKER:"".concat(r,"tooltip-list-item-marker"),NAME_LABEL:"".concat(r,"tooltip-list-item-name-label"),VALUE:"".concat(r,"tooltip-list-item-value"),CROSSHAIR_X:"".concat(r,"tooltip-crosshair-x"),CROSSHAIR_Y:"".concat(r,"tooltip-crosshair-y")}}var PT={overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"};function ZH(r){var t;r===void 0&&(r="");var e=r1(r);return t={},t[".".concat(e.CONTAINER)]={position:"absolute",visibility:"visible","z-index":8,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)","background-color":"rgba(255, 255, 255, 0.96)","box-shadow":"0 6px 12px 0 rgba(0, 0, 0, 0.12)","border-radius":"4px",color:"rgba(0, 0, 0, 0.65)","font-size":"12px","line-height":"20px",padding:"12px","min-width":"120px","max-width":"360px","font-family":"Roboto-Regular"},t[".".concat(e.TITLE)]={color:"rgba(0, 0, 0, 0.45)"},t[".".concat(e.LIST)]={margin:"0px","list-style-type":"none",padding:"0px"},t[".".concat(e.LIST_ITEM)]={"list-style-type":"none",display:"flex","line-height":"2em","align-items":"center","justify-content":"space-between","white-space":"nowrap"},t[".".concat(e.MARKER)]={width:"8px",height:"8px","border-radius":"50%",display:"inline-block","margin-right":"4px"},t[".".concat(e.NAME)]={display:"flex","align-items":"center","max-width":"216px"},t[".".concat(e.NAME_LABEL)]=at({flex:1},PT),t[".".concat(e.VALUE)]=at({display:"inline-block",float:"right",flex:1,"text-align":"right","min-width":"28px","margin-left":"30px",color:"rgba(0, 0, 0, 0.85)"},PT),t[".".concat(e.CROSSHAIR_X)]={position:"absolute",width:"1px","background-color":"rgba(0, 0, 0, 0.25)"},t[".".concat(e.CROSSHAIR_Y)]={position:"absolute",height:"1px","background-color":"rgba(0, 0, 0, 0.25)"},t}var JH=(function(r){Ut(t,r);function t(e){var n=this,i,a,s=(a=(i=e.style)===null||i===void 0?void 0:i.template)===null||a===void 0?void 0:a.prefixCls,o=r1(s);return n=r.call(this,e,{data:[],x:0,y:0,visibility:"visible",title:"",position:"bottom-right",offset:[5,5],enterable:!1,container:{x:0,y:0},bounding:null,template:{prefixCls:"",container:'<div class="'.concat(o.CONTAINER,'"></div>'),title:'<div class="'.concat(o.TITLE,'"></div>'),item:'<li class="'.concat(o.LIST_ITEM,`" data-index={index}>
        <span class="`).concat(o.NAME,`">
          <span class="`).concat(o.MARKER,`" style="background:{color}"></span>
          <span class="`).concat(o.NAME_LABEL,`" title="{name}">{name}</span>
        </span>
        <span class="`).concat(o.VALUE,`" title="{value}">{value}</span>
      </li>`)},style:ZH(s)})||this,n.timestamp=-1,n.prevCustomContentKey=n.attributes.contentKey,n.initShape(),n.render(n.attributes,n),n}return Object.defineProperty(t.prototype,"HTMLTooltipElement",{get:function(){return this.element},enumerable:!1,configurable:!0}),t.prototype.getContainer=function(){return this.element},Object.defineProperty(t.prototype,"elementSize",{get:function(){var e=this.element.offsetWidth,n=this.element.offsetHeight;return{width:e,height:n}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"HTMLTooltipItemsElements",{get:function(){var e=this.attributes,n=e.data,i=e.template;return n.map(function(a,s){var o=a.name,l=o===void 0?"":o,c=a.color,u=c===void 0?"black":c,h=a.index,d=Pe(a,["name","color","index"]),f=at({name:l,color:u,index:h??s},d);return lm($3(i.item,f))})},enumerable:!1,configurable:!0}),t.prototype.render=function(e,n){this.renderHTMLTooltipElement(),this.updatePosition()},t.prototype.destroy=function(){var e;(e=this.element)===null||e===void 0||e.remove(),r.prototype.destroy.call(this)},t.prototype.show=function(e,n){var i=this;if(e!==void 0&&n!==void 0){var a=this.element.style.visibility==="hidden",s=function(){i.attributes.x=e??i.attributes.x,i.attributes.y=n??i.attributes.y,i.updatePosition()};a?this.closeTransition(s):s()}this.element.style.visibility="visible"},t.prototype.hide=function(e,n){e===void 0&&(e=0),n===void 0&&(n=0);var i=this.attributes.enterable;i&&this.isCursorEntered(e,n)||(this.element.style.visibility="hidden")},t.prototype.initShape=function(){var e=this.attributes.template;this.element=lm(e.container),this.id&&this.element.setAttribute("id",this.id)},t.prototype.renderCustomContent=function(){if(!(this.prevCustomContentKey!==void 0&&this.prevCustomContentKey===this.attributes.contentKey)){this.prevCustomContentKey=this.attributes.contentKey;var e=this.attributes.content;e&&(typeof e=="string"?this.element.innerHTML=e:nT(this.element,e))}},t.prototype.renderHTMLTooltipElement=function(){var e,n,i=this.attributes,a=i.template,s=i.title,o=i.enterable,l=i.style,c=i.content,u=r1(a.prefixCls),h=this.element;if(this.element.style.pointerEvents=o?"auto":"none",c)this.renderCustomContent();else{s?(h.innerHTML=a.title,h.getElementsByClassName(u.TITLE)[0].innerHTML=s):(n=(e=h.getElementsByClassName(u.TITLE))===null||e===void 0?void 0:e[0])===null||n===void 0||n.remove();var d=this.HTMLTooltipItemsElements,f=document.createElement("ul");f.className=u.LIST,nT(f,d);var g=this.element.querySelector(".".concat(u.LIST));g?g.replaceWith(f):h.appendChild(f)}vU(h,l)},t.prototype.getRelativeOffsetFromCursor=function(e){var n=this.attributes,i=n.position,a=n.offset,s=e||i,o=s.split("-"),l={left:[-1,0],right:[1,0],top:[0,-1],bottom:[0,1]},c=this.elementSize,u=c.width,h=c.height,d=[-u/2,-h/2];return o.forEach(function(f){var g=q(d,2),v=g[0],p=g[1],y=q(l[f],2),m=y[0],x=y[1];d=[v+(u/2+a[0])*m,p+(h/2+a[1])*x]}),d},t.prototype.setOffsetPosition=function(e){var n=q(e,2),i=n[0],a=n[1],s=this.attributes,o=s.x,l=o===void 0?0:o,c=s.y,u=c===void 0?0:c,h=s.container,d=h.x,f=h.y;this.element.style.left="".concat(+l+d+i,"px"),this.element.style.top="".concat(+u+f+a,"px")},t.prototype.updatePosition=function(){var e=this.attributes.showDelay,n=e===void 0?60:e,i=Date.now();this.timestamp>0&&i-this.timestamp<n||(this.timestamp=i,this.setOffsetPosition(this.autoPosition(this.getRelativeOffsetFromCursor())))},t.prototype.autoPosition=function(e){var n=q(e,2),i=n[0],a=n[1],s=this.attributes,o=s.x,l=s.y,c=s.bounding,u=s.position;if(!c)return[i,a];var h=this.element,d=h.offsetWidth,f=h.offsetHeight,g=q([+o+i,+l+a],2),v=g[0],p=g[1],y={left:"right",right:"left",top:"bottom",bottom:"top"},m=c.x,x=c.y,E=c.width,_=c.height,M={left:v<m,right:v+d>m+E,top:p<x,bottom:p+f>x+_},O=[];u.split("-").forEach(function(N){M[N]?O.push(y[N]):O.push(N)});var T=O.join("-");return this.getRelativeOffsetFromCursor(T)},t.prototype.isCursorEntered=function(e,n){if(this.element){var i=this.element.getBoundingClientRect(),a=i.x,s=i.y,o=i.width,l=i.height;return new Yn(a,s,o,l).isPointIn(e,n)}return!1},t.prototype.closeTransition=function(e){var n=this,i=this.element.style.transition;this.element.style.transition="none",e(),setTimeout(function(){n.element.style.transition=i},10)},t.tag="tooltip",t})($e),QH=(function(r){Ut(t,r);function t(e){var n=r.call(this,on({},t.defaultOptions,e))||this;return n.hoverColor="#f5f5f5",n.selectedColor="#e6f7ff",n.background=n.appendChild(new Nn({})),n.label=n.background.appendChild(new gn({})),n}return Object.defineProperty(t.prototype,"padding",{get:function(){return Pn(this.style.padding)},enumerable:!1,configurable:!0}),t.prototype.renderLabel=function(){var e=this.style,n=e.label,i=e.value,a=jt(this.attributes,"label");Ot(this.label).maybeAppend(".label",function(){return qi(n)}).attr("className","label").styles(a),this.label.attr("__data__",i)},t.prototype.renderBackground=function(){var e=this.label.getBBox(),n=q(this.padding,4),i=n[0],a=n[1],s=n[2],o=n[3],l=e.width,c=e.height,u=l+o+a,h=c+i+s,d=jt(this.attributes,"background"),f=this.style,g=f.width,v=g===void 0?0:g,p=f.height,y=p===void 0?0:p,m=f.selected;this.background.attr(at(at({},d),{width:Math.max(u,v),height:Math.max(h,y),fill:m?this.selectedColor:"#fff"})),this.label.attr({transform:"translate(".concat(o,", ").concat((h-c)/2,")")})},t.prototype.render=function(){this.renderLabel(),this.renderBackground()},t.prototype.bindEvents=function(){var e=this;this.addEventListener("pointerenter",function(){e.style.selected||e.background.attr("fill",e.hoverColor)}),this.addEventListener("pointerleave",function(){e.style.selected||e.background.attr("fill",e.style.backgroundFill)});var n=this;this.addEventListener("click",function(){var i=e.style,a=i.label,s=i.value,o=i.onClick;o==null||o(s,{label:a,value:s},n)})},t.defaultOptions={style:{value:"",label:"",cursor:"pointer"}},t})($e),tX=(function(r){Ut(t,r);function t(e){var n,i,a=r.call(this,on({},t.defaultOptions,e))||this;a.currentValue=(n=t.defaultOptions.style)===null||n===void 0?void 0:n.defaultValue,a.isPointerInSelect=!1,a.select=a.appendChild(new Nn({className:"select",style:{cursor:"pointer",width:0,height:0}})),a.dropdown=a.appendChild(new Nn({className:"dropdown"}));var s=a.style.defaultValue;return s&&(!((i=a.style.options)===null||i===void 0)&&i.some(function(o){return o.value===s}))&&(a.currentValue=s),a}return t.prototype.setValue=function(e){this.currentValue=e,this.render()},t.prototype.getValue=function(){return this.currentValue},Object.defineProperty(t.prototype,"dropdownPadding",{get:function(){return Pn(this.style.dropdownPadding)},enumerable:!1,configurable:!0}),t.prototype.renderSelect=function(){var e=this,n,i=this.style,a=i.x,s=i.y,o=i.width,l=i.height,c=i.bordered,u=i.showDropdownIcon,h=jt(this.attributes,"select"),d=jt(this.attributes,"placeholder");this.select.attr(at(at({x:a,y:s,width:o,height:l},h),{fill:"#fff",strokeWidth:c?1:0}));var f=this.dropdownPadding,g=10;u&&Ot(this.select).maybeAppend(".dropdown-icon","path").style("d","M-5,-3.5 L0,3.5 L5,-3.5").style("transform","translate(".concat(a+o-g-f[1]-f[3],", ").concat(s+l/2,")")).style("lineWidth",1).style("stroke",this.select.style.stroke);var v=(n=this.style.options)===null||n===void 0?void 0:n.find(function(x){return x.value===e.currentValue}),p=at({x:a+f[3]},d);Ot(this.select).selectAll(".placeholder").data(v?[]:[1]).join(function(x){return x.append("text").attr("className","placeholder").styles(p).style("y",function(){var E=this.getBBox();return s+(l-E.height)/2})},function(x){return x.styles(p)},function(x){return x.remove()});var y=jt(this.attributes,"optionLabel"),m=at({x:a+f[3]},y);Ot(this.select).selectAll(".value").data(v?[v]:[]).join(function(x){return x.append(function(E){return qi(E.label)}).attr("className","value").styles(m).style("y",function(){var E=this.getBBox();return s+(l-E.height)/2})},function(x){return x.styles(m)},function(x){return x.remove()})},t.prototype.renderDropdown=function(){var e=this,n,i,a=this.style,s=a.x,o=a.y,l=a.width,c=a.height,u=a.options,h=a.onSelect,d=a.open,f=jt(this.attributes,"dropdown"),g=jt(this.attributes,"option"),v=this.dropdownPadding;Ot(this.dropdown).maybeAppend(".dropdown-container","g").attr("className","dropdown-container").selectAll(".dropdown-item").data(u,function(m){return m.value}).join(function(m){return m.append(function(x){return new QH({className:"dropdown-item",style:at(at(at({},x),g),{width:l-v[1]-v[3],selected:x.value===e.currentValue,onClick:function(E,_,M){e.setValue(E),h==null||h(E,_,M),e.dispatchEvent(new rn("change",{detail:{value:E,option:_,item:M}})),Ur(e.dropdown)}})})}).each(function(x,E){var _,M=(_=this.parentNode)===null||_===void 0?void 0:_.children,O=M.reduce(function(T,N,P){return P<E&&(T+=N.getBBox().height),T},0);this.attr("transform","translate(".concat(v[3],", ").concat(v[0]+O,")"))})},function(m){return m.update(function(x){return{selected:x.value===e.currentValue}})},function(m){return m.remove()});var p=(i=(n=this.dropdown.getElementsByClassName("dropdown-container"))===null||n===void 0?void 0:n[0])===null||i===void 0?void 0:i.getBBox(),y=f.spacing;this.dropdown.attr(at({transform:"translate(".concat(s,", ").concat(o+c+y,")"),width:p.width+v[1]+v[3],height:p.height+v[0]+v[2]},f)),!d&&Ur(this.dropdown)},t.prototype.render=function(){this.renderSelect(),this.renderDropdown()},t.prototype.bindEvents=function(){var e=this;this.addEventListener("click",function(n){n.stopPropagation()}),this.select.addEventListener("click",function(){e.dropdown.style.visibility==="visible"?Ur(e.dropdown):kl(e.dropdown)}),this.addEventListener("pointerenter",function(){e.isPointerInSelect=!0}),this.addEventListener("pointerleave",function(){e.isPointerInSelect=!1}),document==null||document.addEventListener("click",function(){e.isPointerInSelect||Ur(e.dropdown)})},t.defaultOptions={style:{x:0,y:0,width:140,height:32,options:[],bordered:!0,defaultValue:"",selectRadius:8,selectStroke:"#d9d9d9",showDropdownIcon:!0,placeholderText:"",placeholderFontSize:12,placeholderTextBaseline:"top",placeholderFill:"#c2c2c2",dropdownFill:"#fff",dropdownStroke:"#d9d9d9",dropdownRadius:8,dropdownShadowBlur:4,dropdownShadowColor:"rgba(0, 0, 0, 0.08)",dropdownPadding:8,dropdownSpacing:10,optionPadding:[8,12],optionFontSize:12,optionTextBaseline:"top",optionBackgroundFill:"#fff",optionBackgroundRadius:4,optionLabelFontSize:12,optionLabelTextBaseline:"top"}},t})($e),ti=(function(r){Ut(t,r);function t(e){var n=r.call(this,on({},{style:{backgroundOpacity:t.backgroundOpacities.default}},t.defaultOptions,e))||this;return n.showBackground=!0,n.background=n.appendChild(new Nn({})),n.icon=n.appendChild(new gn({})),n}return Object.defineProperty(t.prototype,"label",{get:function(){return"BaseIcon"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineWidth",{get:function(){return Math.log10(this.attributes.size)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"padding",{get:function(){return Pn(this.attributes.size/5)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"iconSize",{get:function(){var e=this.attributes.size,n=q(this.padding,4),i=n[0],a=n[1],s=n[2],o=n[3];return Math.max(e-Math.max(o+a,i+s),this.lineWidth*2+1)},enumerable:!1,configurable:!0}),t.prototype.renderBackground=function(){var e=this.attributes,n=e.x,i=e.y,a=e.size,s=a/2,o=jt(this.attributes,"background");this.background.attr(at({x:n-s,y:i-s,width:a,height:a},o))},t.prototype.showIndicator=function(){if(this.label){var e=this.attributes.size,n=this.background.getBBox(),i=n.x,a=n.y;this.indicator.update({x:i+e/2,y:a-5,labelText:this.label,visibility:"visible"})}},t.prototype.hideIndicator=function(){this.indicator.update({visibility:"hidden"})},t.prototype.connectedCallback=function(){var e;r.prototype.connectedCallback.call(this);var n=this.attributes.size,i=this.background.getBBox(),a=i.x,s=i.y,o=(e=this.ownerDocument)===null||e===void 0?void 0:e.defaultView;o&&(this.indicator=o.appendChild(new KH({style:{x:a+n/2,y:s-n/2,visibility:"hidden",position:"top",radius:3,zIndex:100}})))},t.prototype.disconnectedCallback=function(){this.indicator.destroy()},t.prototype.render=function(){this.renderIcon(),this.showBackground&&this.renderBackground()},t.prototype.bindEvents=function(){var e=this,n=this.attributes.onClick;if(this.addEventListener("click",function(){n==null||n(e)}),this.showBackground){var i=function(){return e.background.attr({opacity:t.backgroundOpacities.default})},a=function(){return e.background.attr({opacity:t.backgroundOpacities.hover})},s=function(){return e.background.attr({opacity:t.backgroundOpacities.active})};this.addEventListener("pointerenter",function(){a(),e.showIndicator()}),this.addEventListener("pointerleave",function(){i(),e.hideIndicator()}),this.addEventListener("pointerdown",function(){s()}),this.addEventListener("pointerup",function(){i()})}},t.tag="IconBase",t.defaultOptions={style:{x:0,y:0,size:10,color:"#565758",backgroundRadius:4,backgroundFill:"#e2e2e2"}},t.backgroundOpacities={default:0,hover:.8,active:1},t})($e),rl=function(r,t){return t===void 0&&(t="#565758"),new pr({style:{fill:t,d:"M ".concat(r,",").concat(r," L -").concat(r,",0 L ").concat(r,",-").concat(r," Z"),transformOrigin:"center"}})},eX=(function(r){Ut(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.arcPath=function(e,n,i){var a=q([i,i],2),s=a[0],o=a[1],l=function(v){return[e+i*Math.cos(v),n+i*Math.sin(v)]},c=q(l(-5/4*Math.PI),2),u=c[0],h=c[1],d=q(l(1/4*Math.PI),2),f=d[0],g=d[1];return"M".concat(u,",").concat(h,",A").concat(s,",").concat(o,",0,1,1,").concat(f,",").concat(g)},Object.defineProperty(t.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.attributes,n=e.x,i=e.y,a=e.color,s=this.iconSize,o=this.lineWidth,l=o+.5;Ot(this.icon).maybeAppend(".reset","path").styles({stroke:a,lineWidth:o,d:this.arcPath(n,i,s/2-o),markerStart:rl(l,a)})},t})(ti),nX=(function(r){Ut(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return Object.defineProperty(t.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.attributes,n=e.x,i=e.y,a=e.color,s=this.iconSize,o=s/2,l=s/2/Math.pow(3,.5),c=[[n,i],[n,i-l],[n-o,i],[n,i+l],[n,i],[n+o,i-l],[n+o,i+l],[n,i]];Ot(this.icon).maybeAppend(".backward","polygon").styles({points:c,fill:a})},t})(ti),rX=(function(r){Ut(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return Object.defineProperty(t.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.attributes,n=e.x,i=e.y,a=e.color,s=this.iconSize,o=s/2,l=s/2/Math.pow(3,.5),c=[[n,i],[n,i-l],[n+o,i],[n,i+l],[n,i],[n-o,i-l],[n-o,i+l],[n,i]];Ot(this.icon).maybeAppend(".forward","polygon").styles({points:c,fill:a})},t})(ti),iX=(function(r){Ut(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return Object.defineProperty(t.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.attributes,n=e.x,i=e.y,a=e.color,s=this.iconSize,o=s/3*Math.pow(3,.5)*.8,l=[[n+o,i],[n-o/2,i-s/2*.8],[n-o/2,i+s/2*.8],[n+o,i]];Ot(this.icon).maybeAppend(".play","polygon").styles({points:l,fill:a})},t})(ti),aX=(function(r){Ut(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return Object.defineProperty(t.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.attributes,n=e.x,i=e.y,a=e.color,s=this.iconSize,o=s/3,l=[[n-o,i-s/2],[n-o,i+s/2],[n-o/2,i+s/2],[n-o/2,i-s/2],[n-o,i-s/2],[n+o/2,i-s/2],[n+o/2,i+s/2],[n+o,i+s/2],[n+o,i-s/2]];Ot(this.icon).maybeAppend(".pause","polygon").styles({points:l,fill:a})},t})(ti),sX=(function(r){Ut(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return Object.defineProperty(t.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.attributes,n=e.x,i=e.y,a=e.color,s=this,o=s.iconSize,l=s.lineWidth,c=l;Ot(this.icon).maybeAppend(".left-line","line").styles({x1:n-o/2,y1:i-o/2,x2:n-o/2,y2:i+o/2,stroke:a,lineWidth:l}),Ot(this.icon).maybeAppend(".right-line","line").styles({x1:n+o/2,y1:i-o/2,x2:n+o/2,y2:i+o/2,stroke:a,lineWidth:l}),Ot(this.icon).maybeAppend(".left-arrow","line").styles({x1:n,y1:i,x2:n-o/2+c*2,y2:i,stroke:a,lineWidth:l,markerEnd:rl(l*2,a)}),Ot(this.icon).maybeAppend(".right-arrow","line").styles({x1:n,y1:i,x2:n+o/2-c*2,y2:i,stroke:a,lineWidth:l,markerEnd:rl(l*2,a)})},t})(ti),oX=(function(r){Ut(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return Object.defineProperty(t.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.attributes,n=e.x,i=e.y,a=e.color,s=this,o=s.iconSize,l=s.lineWidth;Ot(this.icon).maybeAppend(".line","line").styles({x1:n,y1:i-o/2,x2:n,y2:i+o/2,stroke:a,lineWidth:l});var c=l;Ot(this.icon).maybeAppend(".left-arrow","line").styles({x1:n-o/2-c*2,y1:i,x2:n-c*2,y2:i,stroke:a,lineWidth:l,markerEnd:rl(l*2,a)}),Ot(this.icon).maybeAppend(".right-arrow","line").styles({x1:n+o/2+c*2,y1:i,x2:n+c*2,y2:i,stroke:a,lineWidth:l,markerEnd:rl(l*2,a)})},t})(ti),rR=function(r){return[[-r/2,-r/2],[-r/2,r/2],[r/2,r/2]]},lX=(function(r){Ut(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return Object.defineProperty(t.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.attributes,n=e.x,i=e.y,a=e.color,s=this,o=s.iconSize,l=s.lineWidth,c=l,u=(o-c*2-l)/4,h=(o-c*2-l)/2,d=q([n-o/2+c,i+o/2-c*2],2),f=d[0],g=d[1];Ot(this.icon).maybeAppend(".coordinate","polyline").styles({points:rR(o).map(function(v){var p=q(v,2),y=p[0],m=p[1];return[y+n,m+i]}),stroke:a,lineWidth:l}),Ot(this.icon).maybeAppend(".line","polyline").styles({points:[[f,g],[f+u,g-h],[f+u*2,g],[f+u*4,g-h*2]],stroke:a,lineWidth:l})},t})(ti),cX=(function(r){Ut(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return Object.defineProperty(t.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return[1,4,2,4,3]},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.data,n=this.attributes,i=n.x,a=n.y,s=n.color,o=this,l=o.iconSize,c=o.lineWidth,u=c,h=(l-u)/e.length,d=(l-u*2)/4,f=q([i-l/2+u*2,a+l/2-u],2),g=f[0],v=f[1];Ot(this.icon).maybeAppend(".coordinate","polyline").styles({points:rR(l).map(function(p){var y=q(p,2),m=y[0],x=y[1];return[m+i,x+a]}),stroke:s,lineWidth:c}),Ot(this.icon).maybeAppend(".bars","g").selectAll(".column").data(this.data.map(function(p,y){return{value:p,index:y}})).join(function(p){return p.append("line").attr("className","column").style("x1",function(y){var m=y.index;return g+h*m}).style("y1",v).style("x2",function(y){var m=y.index;return g+h*m}).style("y2",function(y){var m=y.value;return v-d*m}).styles({y1:v,stroke:s,lineWidth:c})})},t})(ti),uX=(function(r){Ut(t,r);function t(e){var n=r.call(this,on({},{style:{color:"#d8d9d9"}},e))||this;return n.showBackground=!1,n}return t.prototype.renderIcon=function(){var e=this.attributes,n=e.x,i=e.y,a=e.color,s=this,o=s.iconSize,l=s.lineWidth;Ot(this.icon).maybeAppend(".split","line").styles({x1:n,y1:i-o/2,x2:n,y2:i+o/2,stroke:a,lineWidth:l})},t})(ti),i1=(function(r){Ut(t,r);function t(){var e=r.apply(this,Nt([],q(arguments),!1))||this;return e.showBackground=!1,e}return Object.defineProperty(t.prototype,"padding",{get:function(){return Pn(0)},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.iconSize,n=this.attributes,i=n.x,a=n.y,s=n.speed,o=s===void 0?1:s,l=h1(this.attributes,["x","y","transform","transformOrigin","width","height","size","color","speed"]),c=qe(e,20,1/0),u=20,h=at(at({},l),{x:i-c/2,y:a-u/2,width:c,height:u,defaultValue:o,bordered:!1,showDropdownIcon:!1,selectRadius:2,dropdownPadding:this.padding,dropdownRadius:2,dropdownSpacing:e/5,placeholderFontSize:e/2,optionPadding:0,optionLabelFontSize:e/2,optionBackgroundRadius:1,options:[{label:"1x",value:1},{label:"1.5x",value:1.5},{label:"2x",value:2}]});Ot(this.icon).maybeAppend(".speed",function(){return new tX({style:h})}).attr("className","speed").each(function(){this.update(h)})},t.tag="SpeedSelect",t})(ti),Ob=(function(r){Ut(t,r);function t(e){var n=r.call(this,e)||this;return n.icon=n.appendChild(new gn({})),n.currentType=n.attributes.type,n}return t.prototype.getType=function(){return this.currentType},t.prototype.render=function(){var e=this,n=this.attributes;n.onChange;var i=Pe(n,["onChange"]);Ot(this.icon).selectAll(".icon").data([this.currentType]).join(function(a){return a.append(function(s){var o,l=(o=e.toggles.find(function(c){var u=q(c,1),h=u[0];return h===s}))===null||o===void 0?void 0:o[1];if(!l)throw new Error("Invalid type: ".concat(s));return new l({})}).attr("className","icon").styles(i,!1).update({})},function(a){return a.styles({restStyles:i}).update({})},function(a){return a.remove()})},t.prototype.bindEvents=function(){var e=this,n=this.attributes.onChange;this.addEventListener("click",function(i){i.preventDefault(),i.stopPropagation();var a=(e.toggles.findIndex(function(o){var l=q(o,1),c=l[0];return c===e.currentType})+1)%e.toggles.length,s=e.toggles[a][0];n==null||n(e.currentType),e.currentType=s,e.render()})},t.tag="ToggleIcon",t})($e),a1=(function(r){Ut(t,r);function t(e){var n=r.call(this,on({},{style:{type:"play"}},e))||this;return n.toggles=[["play",iX],["pause",aX]],n}return t})(Ob),s1=(function(r){Ut(t,r);function t(e){var n=r.call(this,on({},{style:{type:"range"}},e))||this;return n.toggles=[["range",sX],["value",oX]],n}return t})(Ob),o1=(function(r){Ut(t,r);function t(e){var n=r.call(this,on({},{style:{type:"column"}},e))||this;return n.toggles=[["line",lX],["column",cX]],n}return t})(Ob),hX={reset:eX,speed:i1,backward:nX,playPause:a1,forward:rX,selectionType:s1,chartType:o1,split:uX},dX=(function(r){Ut(t,r);function t(e){var n=r.call(this,on({},t.defaultOptions,e))||this;return n.background=n.appendChild(new Nn({})),n.functions=n.appendChild(new gn({})),n}return Object.defineProperty(t.prototype,"padding",{get:function(){return Pn(this.attributes.padding)},enumerable:!1,configurable:!0}),t.prototype.renderBackground=function(){var e=this.style,n=e.x,i=e.y,a=e.width,s=e.height,o=jt(this.attributes,"background");this.background.attr(at({x:n,y:i,width:a,height:s},o))},t.prototype.renderFunctions=function(){var e=this,n,i=this.attributes,a=i.functions,s=i.iconSize,o=i.iconSpacing,l=i.x,c=i.y,u=i.width,h=i.height,d=i.align,f=q(this.padding,4),g=f[1],v=f[3],p=a.reduce(function(x,E){return x.length&&E.length?x.concat.apply(x,Nt(["split"],q(E),!1)):x.concat.apply(x,Nt([],q(E),!1))},[]),y=p.length*(s+o)-o,m={left:v+s/2,center:(u-y)/2+s/2,right:u-y-v-g+s/2}[d]||0;(n=this.speedSelect)===null||n===void 0||n.destroy(),this.functions.removeChildren(),p.forEach(function(x,E){var _,M=hX[x],O={x:l+E*(s+o)+m,y:c+h/2,size:s};if(M===i1?(O.speed=e.attributes.speed,O.onSelect=function(N){return e.handleFunctionChange(x,{value:N})}):[a1,s1,o1].includes(M)?(O.onChange=function(N){return e.handleFunctionChange(x,{value:N})},M===a1&&(O.type=e.attributes.state==="play"?"pause":"play"),M===s1&&(O.type=e.attributes.selectionType==="range"?"value":"range"),M===o1&&(O.type=e.attributes.chartType==="line"?"column":"line")):O.onClick=function(){return e.handleFunctionChange(x,{value:x})},M===i1){var T=(_=e.ownerDocument)===null||_===void 0?void 0:_.defaultView;T&&(e.speedSelect=new M({style:at(at({},O),{zIndex:100})}),T.appendChild(e.speedSelect))}else e.functions.appendChild(new M({style:O}))})},t.prototype.disconnectedCallback=function(){var e;r.prototype.disconnectedCallback.call(this),(e=this.speedSelect)===null||e===void 0||e.destroy()},t.prototype.render=function(){this.renderBackground(),this.renderFunctions()},t.prototype.handleFunctionChange=function(e,n){var i=this.attributes.onChange;i==null||i(e,n)},t.defaultOptions={style:{x:0,y:0,width:300,height:40,padding:0,align:"center",iconSize:25,iconSpacing:0,speed:1,state:"pause",chartType:"line",selectionType:"range",backgroundFill:"#fbfdff",backgroundStroke:"#ebedf0",functions:[["reset","speed"],["backward","playPause","forward"],["selectionType","chartType"]]}},t})($e),fX=(function(r){Ut(t,r);function t(e){var n=r.call(this,on({},t.defaultOptions,e))||this;return n.bindEvents(),n}return t.prototype.bindEvents=function(){var e=this;this.addEventListener("mouseenter",function(){e.attr("lineWidth",Math.ceil(+(e.style.r||0)/2))}),this.addEventListener("mouseleave",function(){e.attr("lineWidth",0)})},t.defaultOptions={style:{r:5,fill:"#3f7cf7",lineWidth:0,stroke:"#3f7cf7",strokeOpacity:.5,cursor:"pointer"}},t})(mi),gX=(function(r){Ut(t,r);function t(e){return r.call(this,on({},t.defaultOptions,e))||this}return t.prototype.renderBackground=function(){var e=this.attributes,n=e.x,i=e.y,a=e.width,s=e.height,o=jt(this.attributes,"background");Ot(this).maybeAppend("background","rect").attr("className","background").styles(at({x:n-a/2,y:i-s/2,width:a,height:s},o))},t.prototype.renderIcon=function(){var e=this.attributes,n=e.x,i=e.y,a=e.iconSize,s=jt(this.attributes,"icon"),o=1,l=a/2;Ot(this).maybeAppend("icon-left-line","line").attr("className","icon-left-line").styles(at({x1:n-o,y1:i-l,x2:n-o,y2:i+l},s)),Ot(this).maybeAppend("icon-right-line","line").attr("className","icon-right-line").styles(at({x1:n+o,y1:i-l,x2:n+o,y2:i+l},s))},t.prototype.renderBorder=function(){var e=this.attributes,n=e.x,i=e.y,a=e.width,s=e.height,o=e.type,l=jt(this.attributes,"border"),c=o==="start"?+a/2:-a/2;Ot(this).maybeAppend("border","line").attr("className","border").styles(at({x1:c+n,y1:i-s/2,x2:c+n,y2:i+s/2},l))},t.prototype.render=function(){this.renderBackground(),this.renderIcon(),this.renderBorder()},t.defaultOptions={style:{x:0,y:0,width:10,height:50,iconSize:10,type:"start",backgroundFill:"#fff",backgroundFillOpacity:.5,iconStroke:"#9a9a9a",iconLineWidth:1,borderStroke:"#e8e8e8",borderLineWidth:1}},t})($e);function vX(r,t){return typeof r=="number"?iR(r):pX(r,t)}function pX(r,t){var e=new Date(r);switch(t){case"half-hour":case"hour":case"four-hour":return[0,6,12,18].includes(e.getHours())&&e.getMinutes()===0?Qn(e,`HH:mm
YYYY-MM-DD`):Qn(e,"HH:mm");case"half-day":return e.getHours()<12?`AM
`.concat(Qn(e,"YYYY-MM-DD")):"PM";case"day":return[1,10,20].includes(e.getDate())?Qn(e,`DD
YYYY-MM`):Qn(e,"DD");case"week":return e.getDate()<=7?Qn(e,`DD
YYYY-MM`):Qn(e,"DD");case"month":return[0,6].includes(e.getMonth())?Qn(e,`MM
YYYY`):Qn(e,"MM");case"season":return[0].includes(e.getMonth())?Qn(e,`MM
YYYY`):Qn(e,"MM");case"year":return Qn(e,"YYYY");default:return Qn(e,"YYYY-MM-DD HH:mm")}}function iR(r){var t=String(Math.floor(r/3600)).padStart(2,"0"),e=String(Math.floor(r%3600/60)).padStart(2,"0"),n=String(Math.floor(r%60)).padStart(2,"0");return r<3600?"".concat(e,":").concat(n):"".concat(t,":").concat(e,":").concat(n)}var yX=(function(r){Ut(t,r);function t(e){var n=r.call(this,on({},t.defaultOptions,e))||this;n.axis=n.appendChild(new MH({style:{type:"linear",startPos:[0,0],endPos:[0,0],data:[],showArrow:!1,animate:!1}})),n.timeline=n.appendChild(new kY({style:{onChange:function(h){n.handleSliderChange(h)}}})),n.controller=n.appendChild(new dX({})),n.states={},n.handleSliderChange=function(h){var d=(function(){var f=n.states.values;return Array.isArray(f)?Nt([],q(f),!1):f})();n.setBySliderValues(h),n.dispatchOnChange(d)};var i=n.attributes,a=i.selectionType,s=i.chartType,o=i.speed,l=i.state,c=i.playMode,u=i.values;return n.states={chartType:s,playMode:c,selectionType:a,speed:o,state:l},n.setByTimebarValues(u),n}return Object.defineProperty(t.prototype,"data",{get:function(){var e=this.attributes.data,n=function(i,a){return i.time<a.time?-1:i.time>a.time?1:0};return e.sort(n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"space",{get:function(){var e=this.attributes,n=e.x,i=e.y,a=e.width,s=e.height,o=e.type,l=e.controllerHeight,c=qe(+s-l,0,+s),u=new Yn(n,i+ +s-l,+a,l),h,d=0;o==="chart"?(d=35,h=new Yn(n,i+c-d,+a,d)):h=new Yn;var f=o==="time"?10:c,g=new Yn(n,i+(o==="time"?c:c-f),+a,f-d);return{axisBBox:h,controllerBBox:u,timelineBBox:g}},enumerable:!1,configurable:!0}),t.prototype.setBySliderValues=function(e){var n,i,a=this.data,s=q(Array.isArray(e)?e:[0,e],2),o=s[0],l=s[1],c=a.length,u=a[Math.floor(o*c)],h=a[Math.ceil(l*c)-(Array.isArray(e)?0:1)];this.states.values=[(n=u==null?void 0:u.time)!==null&&n!==void 0?n:a[0].time,(i=h==null?void 0:h.time)!==null&&i!==void 0?i:1/0]},t.prototype.setByTimebarValues=function(e){var n,i,a,s=this.data,o=q(Array.isArray(e)?e:[void 0,e],2),l=o[0],c=o[1],u=s.find(function(d){var f=d.time;return f===l}),h=s.find(function(d){var f=d.time;return f===c});this.states.values=[(n=u==null?void 0:u.time)!==null&&n!==void 0?n:(i=s[0])===null||i===void 0?void 0:i.time,(a=h==null?void 0:h.time)!==null&&a!==void 0?a:1/0]},t.prototype.setByIndex=function(e){var n,i,a,s,o=this.data,l=q(e,2),c=l[0],u=l[1];this.states.values=[(i=(n=o[c])===null||n===void 0?void 0:n.time)!==null&&i!==void 0?i:o[0].time,(s=(a=this.data[u])===null||a===void 0?void 0:a.time)!==null&&s!==void 0?s:1/0]},Object.defineProperty(t.prototype,"sliderValues",{get:function(){var e=this.states,n=e.values,i=e.selectionType,a=q(Array.isArray(n)?n:[void 0,n],2),s=a[0],o=a[1],l=this.data,c=l.length,u=i==="value",h=function(){var f=l.findIndex(function(g){var v=g.time;return v===s});return u?0:f>-1?f/c:0},d=function(){if(o===1/0)return 1;var f=l.findIndex(function(g){var v=g.time;return v===o});return f>-1?f/c:u?.5:1};return[h(),d()]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"values",{get:function(){var e=this.states,n=e.values,i=e.selectionType,a=q(Array.isArray(n)?n:[this.data[0].time,n],2),s=a[0],o=a[1];return i==="value"?o:[s,o]},enumerable:!1,configurable:!0}),t.prototype.getDatumByRatio=function(e){var n=this.data,i=n.length,a=Math.floor(e*(i-1));return n[a]},Object.defineProperty(t.prototype,"chartHandleIconShape",{get:function(){var e=this.states.selectionType,n=this.space.timelineBBox.height;return e==="range"?function(i){return new gX({style:{type:i,height:n,iconSize:n/6}})}:function(){return new Ka({style:{x1:0,y1:-n/2,x2:0,y2:n/2,lineWidth:2,stroke:"#c8c8c8"}})}},enumerable:!1,configurable:!0}),t.prototype.getChartStyle=function(e){var n=this,i=e.x,a=e.y,s=e.width,o=e.height,l=this.states,c=l.selectionType,u=l.chartType,h=this.data,d=this.attributes,f=d.type,g=d.labelFormatter,v=jt(this.attributes,"chart");v.type;var p=Pe(v,["type"]),y=c==="range";if(f==="time")return at({handleIconShape:function(){return new fX({})},selectionFill:"#2e7ff8",selectionFillOpacity:1,showLabelOnInteraction:!0,handleLabelDy:y?-15:0,autoFitLabel:y,handleSpacing:y?-15:0,trackFill:"#edeeef",trackLength:s,trackOpacity:.5,trackRadius:o/2,trackSize:o/2,type:c,values:this.sliderValues,formatter:function(E){if(g)return g(E);var _=n.getDatumByRatio(E).time;return typeof _=="number"?iR(_):Qn(_,"YYYY-MM-DD HH:mm:ss")},transform:"translate(".concat(i,", ").concat(a,")"),zIndex:1},p);var m=c==="range"?5:0,x=h.map(function(E){var _=E.value;return _});return at({handleIconOffset:m,handleIconShape:this.chartHandleIconShape,selectionFill:"#fff",selectionFillOpacity:.5,selectionType:"invert",sparklineSpacing:.1,sparklineColumnLineWidth:0,sparklineColor:"#d4e5fd",sparklineAreaOpacity:1,sparklineAreaLineWidth:0,sparklineData:x,sparklineType:u,sparklineScale:.8,trackLength:s,trackSize:o,type:c,values:this.sliderValues,transform:"translate(".concat(i,", ").concat(a,")"),zIndex:1},p)},t.prototype.renderChart=function(e){e===void 0&&(e=this.space.timelineBBox),this.timeline.update(this.getChartStyle(e))},t.prototype.updateSelection=function(){this.timeline.setValues(this.sliderValues,!0),this.handleSliderChange(this.sliderValues)},t.prototype.getAxisStyle=function(e){var n=this.data,i=this.attributes,a=i.interval,s=i.labelFormatter,o=jt(this.attributes,"axis"),l=e.x,c=e.y,u=e.width,h=Nt(Nt([],q(n),!1),[{time:0}],!1).map(function(f,g,v){var p=f.time;return{label:"".concat(p),value:g/(v.length-1),time:p}}),d=at({startPos:[l,c],endPos:[l+u,c],data:h,labelFilter:function(f,g){return g<h.length-1},labelFormatter:function(f){var g=f.time;return s?s(g):vX(g,a)}},o);return d},t.prototype.renderAxis=function(e){e===void 0&&(e=this.space.axisBBox);var n=this.attributes.type;n==="chart"&&this.axis.update(this.getAxisStyle(e))},t.prototype.renderController=function(e){e===void 0&&(e=this.space.controllerBBox);var n=this.attributes.type,i=this.states,a=i.state,s=i.speed,o=i.selectionType,l=i.chartType,c=jt(this.attributes,"controller"),u=this,h=at(at(at({},e),{iconSize:20,speed:s,state:a,selectionType:o,chartType:l,onChange:function(d,f){var g=f.value;switch(d){case"reset":u.internalReset();break;case"speed":u.handleSpeedChange(g);break;case"backward":u.internalBackward();break;case"playPause":g==="play"?u.internalPlay():u.internalPause();break;case"forward":u.internalForward();break;case"selectionType":u.handleSelectionTypeChange(g);break;case"chartType":u.handleChartTypeChange(g);break}}}),c);n==="time"&&(h.functions=[["reset","speed"],["backward","playPause","forward"],["selectionType"]]),this.controller.update(h)},t.prototype.dispatchOnChange=function(e){var n=this.data,i=this.attributes.onChange,a=this.states,s=a.values,o=a.selectionType,l=q(s,2),c=l[0],u=l[1],h=u===1/0?n.at(-1).time:u,d=o==="range"?[c,h]:h,f=function(g,v){return Array.isArray(g)?Array.isArray(v)?g[0]===v[0]&&(g[1]===v[1]||g[1]===1/0||v[1]===1/0):!1:Array.isArray(v)?!1:g===v};(!e||!f(e,d))&&(i==null||i(o==="range"?[c,h]:h))},t.prototype.internalReset=function(e){var n,i,a=this.states.selectionType;this.internalPause(),this.setBySliderValues(a==="range"?[0,1]:[0,0]),this.renderController(),this.updateSelection(),e||((i=(n=this.attributes)===null||n===void 0?void 0:n.onReset)===null||i===void 0||i.call(n),this.dispatchOnChange())},t.prototype.reset=function(){this.internalReset()},t.prototype.moveSelection=function(e,n){var i=this.data,a=i.length,s=this.states,o=s.values,l=s.selectionType,c=s.playMode,u=q(o,2),h=u[0],d=u[1],f=i.findIndex(function(x){var E=x.time;return E===h}),g=i.findIndex(function(x){var E=x.time;return E===d});g===-1&&(g=a);var v=e==="backward"?-1:1,p;l==="range"?c==="acc"?(p=[f,g+v],v===-1&&f===g&&(p=[f,a])):p=[f+v,g+v]:p=[f,g+v];var y=function(x){var E=q(x.sort(function(T,N){return T-N}),2),_=E[0],M=E[1],O=function(T){return qe(T,0,a)};return M>a?l==="value"?[0,0]:c==="acc"?[O(_),O(_)]:[0,O(M-_)]:_<0?c==="acc"?[0,O(M)]:[O(_+a-M),a]:[O(_),O(M)]},m=y(p);return this.setByIndex(m),this.updateSelection(),m},t.prototype.internalBackward=function(e){var n,i,a=this.moveSelection("backward",e);return e||((i=(n=this.attributes)===null||n===void 0?void 0:n.onBackward)===null||i===void 0||i.call(n),this.dispatchOnChange()),a},t.prototype.backward=function(){this.internalBackward()},t.prototype.internalPlay=function(e){var n=this,i,a,s=this.data,o=this.attributes.loop,l=this.states.speed,c=l===void 0?1:l;this.playInterval=window.setInterval(function(){var u=n.internalForward();u[1]===s.length&&!o&&(n.internalPause(),n.renderController())},1e3/c),this.states.state="play",!e&&((a=(i=this.attributes)===null||i===void 0?void 0:i.onPlay)===null||a===void 0||a.call(i))},t.prototype.play=function(){this.internalPlay()},t.prototype.internalPause=function(e){var n,i;clearInterval(this.playInterval),this.states.state="pause",!e&&((i=(n=this.attributes)===null||n===void 0?void 0:n.onPause)===null||i===void 0||i.call(n))},t.prototype.pause=function(){this.internalPause()},t.prototype.internalForward=function(e){var n,i,a=this.moveSelection("forward",e);return e||((i=(n=this.attributes)===null||n===void 0?void 0:n.onForward)===null||i===void 0||i.call(n),this.dispatchOnChange()),a},t.prototype.forward=function(){this.internalForward()},t.prototype.handleSpeedChange=function(e){var n,i;this.states.speed=e;var a=this.states.state;a==="play"&&(this.internalPause(!0),this.internalPlay(!0)),(i=(n=this.attributes)===null||n===void 0?void 0:n.onSpeedChange)===null||i===void 0||i.call(n,e)},t.prototype.handleSelectionTypeChange=function(e){var n,i;this.states.selectionType=e,this.renderChart(),(i=(n=this.attributes)===null||n===void 0?void 0:n.onSelectionTypeChange)===null||i===void 0||i.call(n,e)},t.prototype.handleChartTypeChange=function(e){var n,i;this.states.chartType=e,this.renderChart(),(i=(n=this.attributes)===null||n===void 0?void 0:n.onChartTypeChange)===null||i===void 0||i.call(n,e)},t.prototype.render=function(){var e=this.space,n=e.axisBBox,i=e.controllerBBox,a=e.timelineBBox;this.renderController(i),this.renderAxis(n),this.renderChart(a),this.states.state==="play"&&this.internalPlay()},t.prototype.destroy=function(){r.prototype.destroy.call(this),this.internalPause(!0)},t.defaultOptions={style:{x:0,y:0,axisLabelFill:"#6e6e6e",axisLabelTextAlign:"left",axisLabelTextBaseline:"top",axisLabelTransform:"translate(5, -12)",axisLineLineWidth:1,axisLineStroke:"#cacdd1",axisTickLength:15,axisTickLineWidth:1,axisTickStroke:"#cacdd1",chartShowLabel:!1,chartType:"line",controllerAlign:"center",controllerHeight:40,data:[],interval:"day",loop:!1,playMode:"acc",selectionType:"range",type:"time"}},t})($e);function Xh(r){const{width:t,height:e,renderer:n}=r,i=mX(r),a=new _m({width:t,height:e,container:i,renderer:n||new Xo});return[i,a]}function mX(r){var t;const{container:e,className:n,graphCanvas:i}=r;if(e)return typeof e=="string"?document.getElementById(e):e;const a=no(n,!1),{width:s,height:o,containerStyle:l}=r,[c,u]=bX(r);return Object.assign(a.style,Object.assign({position:"absolute",left:c+"px",top:u+"px",width:s+"px",height:o+"px"},l)),(t=i.getContainer())===null||t===void 0||t.appendChild(a),a}function bX(r){const{width:t,height:e,placement:n,graphCanvas:i}=r,[a,s]=i.getSize(),[o,l]=HA(n);return[o*(a-t),l*(s-e)]}var xX=function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(e[n[i]]=r[n[i]]);return e};class Kh extends En{constructor(t,e){super(t,Object.assign({},Kh.defaultOptions,e)),this.typePrefix="__data__",this.draw=!1,this.fieldMap={node:new Map,edge:new Map,combo:new Map},this.selectedItems=[],this.bindEvents=()=>{const{graph:n}=this.context;n.on(ft.AFTER_DRAW,this.createElement)},this.changeState=(n,i)=>{const{graph:a}=this.context,{typePrefix:s}=this,o=Mn(n,[s,"id"]),l=Mn(n,[s,"style","labelText"]),[c]=o.split("__"),u=this.fieldMap[c].get(l)||[];a.setElementState(Object.fromEntries(u==null?void 0:u.map(h=>[h,i])))},this.click=n=>{if(this.options.trigger==="hover")return;const i=Mn(n,[this.typePrefix,"id"]);this.selectedItems.includes(i)?(this.selectedItems=this.selectedItems.filter(a=>a!==i),this.changeState(n,[])):(this.selectedItems.push(i),this.changeState(n,"selected"))},this.mouseleave=n=>{this.options.trigger!=="click"&&(this.selectedItems=[],this.changeState(n,[]))},this.mouseenter=n=>{if(this.options.trigger==="click")return;const i=Mn(n,[this.typePrefix,"id"]);this.selectedItems.includes(i)?this.selectedItems=this.selectedItems.filter(a=>a!==i):(this.selectedItems.push(i),this.changeState(n,"active"))},this.setFieldMap=(n,i,a)=>{if(!n)return;const s=this.fieldMap[a];if(s)if(!s.has(n))s.set(n,[i]);else{const o=s.get(n);o&&(o.push(i),s.set(n,o))}},this.getEvents=()=>({mouseenter:this.mouseenter,mouseleave:this.mouseleave,click:this.click}),this.getMarkerData=(n,i)=>{if(!n)return[];const{model:a,element:s}=this.context,{nodes:o,edges:l,combos:c}=a.getData(),u={},h=p=>Tt(n)?n(p):n,d={node:"circle",edge:"line",combo:"rect"},f={circle:"circle",ellipse:"circle",image:"bowtie",rect:"square",star:"cross",triangle:"triangle",diamond:"diamond",cubic:"dot",line:"hyphen",polyline:"hyphen",quadratic:"hv","cubic-horizontal":"hyphen","cubic-vertical":"line"},g=(p,y)=>s==null?void 0:s.getElementComputedStyle(p,y),v=(p,y)=>{p.forEach(m=>{const{id:x}=m,E=Mn(m,["data",h(m)]),_=(s==null?void 0:s.getElementType(y,m))||"circle",M=g(y,m),O=(y==="edge"?M==null?void 0:M.stroke:M==null?void 0:M.fill)||"#1783ff";x&&E&&E.replace(/\s+/g,"")&&(this.setFieldMap(E,x,y),u[E]||(u[E]={id:`${y}__${x}`,label:E,marker:f[_]||d[y],elementType:y,lineWidth:1,stroke:O,fill:O}))})};switch(i){case"node":v(o,"node");break;case"edge":v(l,"edge");break;case"combo":v(c,"combo");break;default:return[]}return Object.values(u)},this.createElement=()=>{if(this.draw){this.updateElement();return}const n=this.options,{width:i,height:a,nodeField:s,edgeField:o,comboField:l,trigger:c,position:u,container:h,containerStyle:d,className:f}=n,g=xX(n,["width","height","nodeField","edgeField","comboField","trigger","position","container","containerStyle","className"]),v=this.getMarkerData(s,"node"),p=this.getMarkerData(o,"edge"),y=this.getMarkerData(l,"combo"),m=[...v,...y,...p],x=Object.assign({width:i,height:a,data:m,itemMarkerLineWidth:({lineWidth:M})=>M,itemMarker:({marker:M})=>M,itemMarkerStroke:({stroke:M})=>M,itemMarkerFill:({fill:M})=>M,gridCol:v.length},g,this.getEvents()),E=new HH({className:"legend",style:x});this.category=E,this.upsertCanvas().appendChild(E),this.draw=!0},this.bindEvents()}update(t){super.update(t),this.clear(),this.createElement()}clear(){var t,e;(t=this.canvas)===null||t===void 0||t.destroy(),(e=this.container)===null||e===void 0||e.remove(),this.canvas=void 0,this.container=void 0,this.draw=!1}updateElement(){this.category&&this.category.update({itemMarkerOpacity:({id:t})=>!this.selectedItems.length||this.selectedItems.includes(t)?1:.5,itemLabelOpacity:({id:t})=>!this.selectedItems.length||this.selectedItems.includes(t)?1:.5})}upsertCanvas(){if(this.canvas)return this.canvas;const t=this.context.canvas,[e,n]=t.getSize(),{width:i=e,height:a=n,position:s,container:o,containerStyle:l,className:c}=this.options,[u,h]=Xh({width:i,height:a,graphCanvas:t,container:o,containerStyle:l,placement:s,className:"legend"});return this.container=u,c&&u.classList.add(c),this.canvas=h,this.canvas}destroy(){this.clear(),this.context.graph.off(ft.AFTER_DRAW,this.createElement),super.destroy()}}Kh.defaultOptions={position:"bottom",trigger:"hover",orientation:"horizontal",layout:"flex",itemSpacing:4,rowPadding:10,colPadding:10,itemMarkerSize:16,itemLabelFontSize:16,width:240,height:160};class Zh extends En{constructor(t,e){super(t,Object.assign({},Zh.defaultOptions,e)),this.onDraw=n=>{var i;!((i=n==null?void 0:n.data)===null||i===void 0)&&i.render||this.onRender()},this.landmarkMap=new Map,this.mask=null,this.isMaskDragging=!1,this.onMaskDragStart=n=>{this.mask&&(this.isMaskDragging=!0,this.mask.setPointerCapture(n.pointerId),this.mask.addEventListener("pointermove",this.onMaskDrag),this.mask.addEventListener("pointerup",this.onMaskDragEnd),this.mask.addEventListener("pointercancel",this.onMaskDragEnd))},this.onMaskDrag=n=>{if(!this.mask||!this.isMaskDragging)return;const{size:[i,a]}=this.options,{movementX:s,movementY:o}=n,{left:l,top:c,width:u,height:h}=this.mask.style,[,,d,f]=this.maskBBox;let g=parseInt(l)+s,v=parseInt(c)+o,p=parseInt(u),y=parseInt(h);g<0&&(g=0),v<0&&(v=0),g+p>i&&(g=Hi(i-p,0)),v+y>a&&(v=Hi(a-y,0)),p<d&&(s>0?(g=Hi(g-s,0),p=Yi(p+s,i)):s<0&&(p=Yi(p-s,i))),y<f&&(o>0?(v=Hi(v-o,0),y=Yi(y+o,a)):o<0&&(y=Yi(y-o,a))),Object.assign(this.mask.style,{left:g+"px",top:v+"px",width:p+"px",height:y+"px"});const m=parseInt(l)-g,x=parseInt(c)-v;if(m===0&&x===0)return;const E=this.context.canvas.getCamera().getZoom(),_=this.canvas.getCamera().getZoom(),M=E/_;this.context.graph.translateBy([m*M,x*M],!1)},this.onMaskDragEnd=n=>{this.mask&&(this.isMaskDragging=!1,this.mask.releasePointerCapture(n.pointerId),this.mask.removeEventListener("pointermove",this.onMaskDrag),this.mask.removeEventListener("pointerup",this.onMaskDragEnd),this.mask.removeEventListener("pointercancel",this.onMaskDragEnd))},this.onTransform=OO(()=>{this.isMaskDragging||(this.updateMask(),this.setCamera())},32,{leading:!0}),this.setOnRender(),this.bindEvents()}update(t){this.unbindEvents(),super.update(t),"delay"in t&&this.setOnRender(),this.bindEvents()}setOnRender(){this.onRender=al(()=>{this.renderMinimap(),this.renderMask()},this.options.delay)}bindEvents(){const{graph:t}=this.context;t.on(ft.AFTER_DRAW,this.onDraw),t.on(ft.AFTER_RENDER,this.onRender),t.on(ft.AFTER_ANIMATE,this.onRender),t.on(ft.AFTER_TRANSFORM,this.onTransform)}unbindEvents(){const{graph:t}=this.context;t.off(ft.AFTER_DRAW,this.onDraw),t.off(ft.AFTER_RENDER,this.onRender),t.off(ft.AFTER_ANIMATE,this.onRender),t.off(ft.AFTER_TRANSFORM,this.onTransform)}renderMinimap(){const t=this.getElements(),e=this.initCanvas();this.setShapes(e,t)}getElements(){const{filter:t}=this.options,{model:e,element:n}=this.context,i=e.getData(),a={nodes:i.nodes.filter(c=>n==null?void 0:n.getElement(K(c))),edges:i.edges.filter(c=>{const u=n==null?void 0:n.getElement(K(c));return u&&AN(u)}),combos:i.combos.filter(c=>n==null?void 0:n.getElement(K(c)))};if(!t)return a;const{nodes:s,edges:o,combos:l}=a;return{nodes:s.filter(c=>t(K(c),"node")),edges:o.filter(c=>t(K(c),"edge")),combos:l.filter(c=>t(K(c),"combo"))}}setShapes(t,e){const{nodes:n,edges:i,combos:a}=e,{shape:s}=this.options,{element:o}=this.context,l=(c,u)=>{const h=K(c),d=o==null?void 0:o.getElement(h);if(!d)return;const f=d.getShape("key");let g;if(typeof s=="string"){const v=s;g=d.getShape(v).cloneNode()}else{const v=s(h,u,d);v===d?g=v.cloneNode(!0):g=v}g.setPosition(f.getPosition()),d.style.zIndex&&(g.style.zIndex=d.style.zIndex),g.id=d.id,t.appendChild(g)};t.removeChildren(),i.forEach(c=>l(c,"edge")),a.forEach(c=>l(c,"combo")),n.forEach(c=>l(c,"node"))}initCanvas(){const{renderer:t,size:[e,n]}=this.options;if(this.canvas){const{width:i,height:a}=this.canvas.getConfig();(e!==i||n!==a)&&this.canvas.resize(e,n),t&&this.canvas.setRenderer(t)}else{const{className:i,position:a,container:s,containerStyle:o}=this.options,[l,c]=Xh({renderer:t,width:e,height:n,placement:a,className:"minimap",container:s,containerStyle:o,graphCanvas:this.context.canvas});i&&l.classList.add(i),this.container=l,this.canvas=c}return this.setCamera(),this.canvas}createLandmark(t,e,n){const i=`${t.join(",")}-${e.join(",")}-${n}`;if(this.landmarkMap.has(i))return this.landmarkMap.get(i);const s=this.canvas.getCamera().createLandmark(i,{position:t,focalPoint:e,zoom:n});return this.landmarkMap.set(i,s),s}setCamera(){var t;const{canvas:e}=this.context,n=(t=this.canvas)===null||t===void 0?void 0:t.getCamera();if(!n)return;const{size:[i,a],padding:s}=this.options,[o,l,c,u]=Lr(s),{min:h,max:d,center:f}=e.getBounds("elements"),g=d[0]-h[0],v=d[1]-h[1],p=i-u-l,y=a-o-c,m=p/g,x=y/v,E=Math.min(m,x),_=this.createLandmark(f,f,E);n.gotoLandmark(_,0)}get maskBBox(){const{canvas:t}=this.context,e=t.getSize(),n=t.getCanvasByViewport([0,0]),i=t.getCanvasByViewport(e),a=this.canvas.canvas2Viewport(Vr(n)),s=this.canvas.canvas2Viewport(Vr(i)),o=s.x-a.x,l=s.y-a.y;return[a.x,a.y,o,l]}calculateMaskBBox(){const{size:[t,e]}=this.options;let[n,i,a,s]=this.maskBBox;return n<0&&(a=Yi(a+n,t),n=0),i<0&&(s=Yi(s+i,e),i=0),n+a>t&&(a=Hi(t-n,0)),i+s>e&&(s=Hi(e-i,0)),[Yi(n,t),Yi(i,e),Hi(a,0),Hi(s,0)]}renderMask(){const{maskStyle:t}=this.options;this.mask||(this.mask=document.createElement("div"),this.mask.addEventListener("pointerdown",this.onMaskDragStart),this.mask.draggable=!0,this.mask.addEventListener("dragstart",e=>e.preventDefault&&e.preventDefault())),this.container.appendChild(this.mask),Object.assign(this.mask.style,Object.assign(Object.assign({},t),{cursor:"move",position:"absolute",pointerEvents:"auto"})),this.updateMask()}updateMask(){if(!this.mask)return;const[t,e,n,i]=this.calculateMaskBBox();Object.assign(this.mask.style,{top:e+"px",left:t+"px",width:n+"px",height:i+"px"})}destroy(){var t,e,n;this.unbindEvents(),(t=this.canvas)===null||t===void 0||t.destroy(),(e=this.mask)===null||e===void 0||e.remove(),(n=this.container)===null||n===void 0||n.remove(),super.destroy()}}Zh.defaultOptions={size:[240,160],shape:"key",padding:10,position:"right-bottom",maskStyle:{border:"1px solid #ddd",background:"rgba(0, 0, 0, 0.1)"},containerStyle:{border:"1px solid #ddd",background:"#fff"},delay:128};const Yi=(r,t)=>Math.min(r,t),Hi=(r,t)=>Math.max(r,t);var Wy=function(r,t,e,n){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((n=n.apply(r,t||[])).next())})};const Vy={x1:0,y1:0,x2:0,y2:0,visibility:"hidden"};class Jh extends En{constructor(t,e){super(t,Object.assign({},Jh.defaultOptions,e)),this.initSnapline=()=>{const n=this.context.canvas.getLayer("transient");this.horizontalLine||(this.horizontalLine=n.appendChild(new Ka({style:Object.assign(Object.assign({},Vy),this.options.horizontalLineStyle)}))),this.verticalLine||(this.verticalLine=n.appendChild(new Ka({style:Object.assign(Object.assign({},Vy),this.options.verticalLineStyle)})))},this.isHorizontalSticking=!1,this.isVerticalSticking=!1,this.enableStick=!0,this.autoSnapToLine=(n,i,a)=>Wy(this,void 0,void 0,function*(){const{verticalX:s,horizontalY:o}=a,{tolerance:l}=this.options,{min:[c,u],max:[h,d],center:[f,g]}=i;let v=0,p=0;s!==null&&(Ln(h,s)<l&&(v=s-h),Ln(c,s)<l&&(v=s-c),Ln(f,s)<l&&(v=s-f),v!==0&&(this.isVerticalSticking=!0)),o!==null&&(Ln(d,o)<l&&(p=o-d),Ln(u,o)<l&&(p=o-u),Ln(g,o)<l&&(p=o-g),p!==0&&(this.isHorizontalSticking=!0)),(v!==0||p!==0)&&(yield this.context.graph.translateElementBy({[n]:[v,p]},!1))}),this.enableSnap=n=>{const{target:i}=n,a=.5;if(this.isHorizontalSticking||this.isVerticalSticking){const[s,o]=this.getDelta(n);if(this.isHorizontalSticking&&this.isVerticalSticking&&Math.abs(s)<=a&&Math.abs(o)<=a)return this.context.graph.translateElementBy({[i.id]:[-s,-o]},!1),!1;if(this.isHorizontalSticking&&Math.abs(o)<=a)return this.context.graph.translateElementBy({[i.id]:[0,-o]},!1),!1;if(this.isVerticalSticking&&Math.abs(s)<=a)return this.context.graph.translateElementBy({[i.id]:[-s,0]},!1),!1;this.isHorizontalSticking=!1,this.isVerticalSticking=!1,this.enableStick=!1,setTimeout(()=>{this.enableStick=!0},200)}return this.enableStick},this.calcSnaplineMetadata=(n,i)=>{const{tolerance:a,shape:s}=this.options,{min:[o,l],max:[c,u],center:[h,d]}=i;let f=null,g=null,v=null,p=null,y=null,m=null;return this.getNodes().some(x=>{if(Ge(n.id,x.id))return!1;const E=CT(x,s).getRenderBounds(),{min:[_,M],max:[O,T],center:[N,P]}=E;return f===null&&(Ln(N,h)<a?f=N:Ln(_,o)<a||Ln(_,c)<a?f=_:(Ln(O,c)<a||Ln(O,o)<a)&&(f=O),f!==null&&(g=Math.min(M,l),v=Math.max(T,u))),p===null&&(Ln(P,d)<a?p=P:Ln(M,l)<a||Ln(M,u)<a?p=M:(Ln(T,u)<a||Ln(T,l)<a)&&(p=T),p!==null&&(y=Math.min(_,o),m=Math.max(O,c))),f!==null&&p!==null}),{verticalX:f,verticalMinY:g,verticalMaxY:v,horizontalY:p,horizontalMinX:y,horizontalMaxX:m}},this.onDragStart=()=>{this.initSnapline()},this.onDrag=n=>Wy(this,void 0,void 0,function*(){const{target:i}=n;if(this.options.autoSnap&&!this.enableSnap(n))return;const a=CT(i,this.options.shape).getRenderBounds(),s=this.calcSnaplineMetadata(i,a);this.hideSnapline(),(s.verticalX!==null||s.horizontalY!==null)&&this.updateSnapline(s),this.options.autoSnap&&(yield this.autoSnapToLine(i.id,a,s))}),this.onDragEnd=()=>{this.hideSnapline()},this.bindEvents()}getNodes(){var t;const{filter:e}=this.options,i=(((t=this.context.element)===null||t===void 0?void 0:t.getNodes())||[]).filter(a=>{var s;return AN(a)&&((s=this.context.viewport)===null||s===void 0?void 0:s.isInViewport(a.getRenderBounds()))});return e?i.filter(a=>e(a)):i}hideSnapline(){this.horizontalLine.style.visibility="hidden",this.verticalLine.style.visibility="hidden"}getLineWidth(t){const{lineWidth:e}=this.options[`${t}LineStyle`];return+(e||Vy.lineWidth||1)/this.context.graph.getZoom()}updateSnapline(t){const{verticalX:e,verticalMinY:n,verticalMaxY:i,horizontalY:a,horizontalMinX:s,horizontalMaxX:o}=t,[l,c]=this.context.canvas.getSize(),{offset:u}=this.options;a!==null?Object.assign(this.horizontalLine.style,{x1:u===1/0?0:s-u,y1:a,x2:u===1/0?l:o+u,y2:a,visibility:"visible",lineWidth:this.getLineWidth("horizontal")}):this.horizontalLine.style.visibility="hidden",e!==null?Object.assign(this.verticalLine.style,{x1:e,y1:u===1/0?0:n-u,x2:e,y2:u===1/0?c:i+u,visibility:"visible",lineWidth:this.getLineWidth("vertical")}):this.verticalLine.style.visibility="hidden"}getDelta(t){const e=this.context.graph.getZoom();return Xr([t.dx,t.dy],e)}bindEvents(){return Wy(this,void 0,void 0,function*(){const{graph:t}=this.context;t.on(Cr.DRAG_START,this.onDragStart),t.on(Cr.DRAG,this.onDrag),t.on(Cr.DRAG_END,this.onDragEnd)})}unbindEvents(){const{graph:t}=this.context;t.off(Cr.DRAG_START,this.onDragStart),t.off(Cr.DRAG,this.onDrag),t.off(Cr.DRAG_END,this.onDragEnd)}destroyElements(){var t,e;(t=this.horizontalLine)===null||t===void 0||t.destroy(),(e=this.verticalLine)===null||e===void 0||e.destroy()}destroy(){this.destroyElements(),this.unbindEvents(),super.destroy()}}Jh.defaultOptions={tolerance:5,offset:20,autoSnap:!0,shape:"key",verticalLineStyle:{stroke:"#1783FF"},horizontalLineStyle:{stroke:"#1783FF"},filter:()=>!0};const Ln=(r,t)=>Math.abs(r-t),CT=(r,t)=>typeof t=="function"?t(r):r.getShape(t);var wX=function(r,t,e,n){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((n=n.apply(r,t||[])).next())})},EX=function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(e[n[i]]=r[n[i]]);return e};const SX=["timestamp","time","date","datetime"];class Qh extends En{get padding(){return Lr(this.options.padding)}constructor(t,e){super(t,Object.assign({},Qh.defaultOptions,e)),this.backup(),this.upsertTimebar()}play(){var t;(t=this.timebar)===null||t===void 0||t.play()}pause(){var t;(t=this.timebar)===null||t===void 0||t.pause()}forward(){var t;(t=this.timebar)===null||t===void 0||t.forward()}backward(){var t;(t=this.timebar)===null||t===void 0||t.backward()}reset(){var t;(t=this.timebar)===null||t===void 0||t.reset()}update(t){super.update(t),this.backup(),this.upsertTimebar()}backup(){this.originalData=RT(this.context.graph.getData())}upsertTimebar(){const{canvas:t}=this.context,e=this.options,{onChange:n,timebarType:i,data:a,x:s,y:o,width:l,height:c,mode:u}=e,h=EX(e,["onChange","timebarType","data","x","y","width","height","mode"]),d=t.getSize(),[f]=this.padding;this.upsertCanvas().ready.then(()=>{var g;const v=Object.assign(Object.assign({x:d[0]/2-l/2,y:f,onChange:p=>{const y=(cr(p)?p:[p,p]).map(m=>U3(m)?m.getTime():m);this.options.mode==="modify"?this.filterElements(y):this.hiddenElements(y),n==null||n(y)}},h),{data:a.map(p=>St(p)?{time:p,value:0}:p),width:l,height:c,type:i});this.timebar?this.timebar.update(v):(this.timebar=new yX({style:v}),(g=this.canvas)===null||g===void 0||g.appendChild(this.timebar))})}upsertCanvas(){if(this.canvas)return this.canvas;const{className:t,height:e,position:n}=this.options,i=this.context.canvas,[a]=i.getSize(),[s,,o]=this.padding,[l,c]=Xh({width:a,height:e+s+o,graphCanvas:i,className:"timebar",placement:n});return this.container=l,t&&l.classList.add(t),this.canvas=c,this.canvas}filterElements(t){return wX(this,void 0,void 0,function*(){var e;if(!this.originalData)return;const{elementTypes:n,getTime:i}=this.options,{graph:a,element:s}=this.context,o=RT(this.originalData);n.forEach(c=>{const u=`${c}s`;o[u]=(this.originalData[u]||[]).filter(h=>{const d=i(h);return!!LT(d,t)})});const l=[...o.nodes,...o.combos].map(c=>K(c));o.edges=o.edges.filter(c=>{const u=c.source,h=c.target;return l.includes(u)&&l.includes(h)}),a.setData(o),yield(e=s.draw({animation:!1,silence:!0}))===null||e===void 0?void 0:e.finished})}hiddenElements(t){const{graph:e}=this.context,{elementTypes:n,getTime:i}=this.options,a=[],s=[];n.forEach(o=>{var l;const c=`${o}s`;(((l=this.originalData)===null||l===void 0?void 0:l[c])||[]).forEach(h=>{const d=K(h),f=i(h);LT(f,t)?s.push(d):a.push(d)})}),e.hideElement(a,!1),e.showElement(s,!1)}destroy(){var t,e,n;const{graph:i}=this.context;this.originalData&&i.setData(Object.assign({},this.originalData)),(t=this.timebar)===null||t===void 0||t.destroy(),(e=this.canvas)===null||e===void 0||e.destroy(),(n=this.container)===null||n===void 0||n.remove(),this.originalData=void 0,this.container=void 0,this.timebar=void 0,this.canvas=void 0,super.destroy()}}Qh.defaultOptions={position:"bottom",enable:!0,timebarType:"time",className:"g6-timebar",width:450,height:60,zIndex:3,elementTypes:["node"],padding:10,mode:"modify",getTime:r=>_X(r,SX,void 0),loop:!1};const RT=r=>{const{nodes:t=[],edges:e=[],combos:n=[]}=r;return{nodes:[...t],edges:[...e],combos:[...n]}},LT=(r,t)=>{if(St(t))return r===t;const[e,n]=t;return r>=e&&r<=n},_X=(r,t,e)=>{var n;for(let i=0;i<t.length;i++){const a=t[i],s=(n=r.data)===null||n===void 0?void 0:n[a];if(s)return s}return e};var kX=function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(e[n[i]]=r[n[i]]);return e};const aR={fill:"#1D2129",wordWrap:!0,maxLines:1,textOverflow:"ellipsis",textBaseline:"top",textAlign:"start",x:0},MX=Object.assign(Object.assign({},aR),{fillOpacity:.9,fontSize:16,fontWeight:"bold"}),TX=Object.assign(Object.assign({},aR),{fillOpacity:.65,fontSize:12,fontWeight:"normal"}),OX={align:"left",spacing:8,size:44,padding:[16,24,0,24]},Uy="title",IT="subtitle";class AX extends En{get padding(){return Lr(this.options.padding)}constructor(t,e){const n=Object.assign({},OX,e);super(t,n),this.onRender=()=>{const i=this.updateCanvas();this.renderTitle(i)},this.bindEvents()}bindEvents(){const{graph:t}=this.context;t.on(ft.AFTER_RENDER,this.onRender),t.on(ft.AFTER_ANIMATE,this.onRender)}unbindEvents(){const{graph:t}=this.context;t.off(ft.AFTER_RENDER,this.onRender),t.off(ft.AFTER_ANIMATE,this.onRender)}destroy(){var t,e;this.unbindEvents(),(t=this.canvas)===null||t===void 0||t.destroy(),(e=this.container)===null||e===void 0||e.remove(),super.destroy()}updateCanvas(){const{size:t,className:e,align:n}=this.options,[i]=this.context.canvas.getSize(),[a=0,,s=0]=this.padding,o=t+a+s;if(this.canvas){const{width:l,height:c}=this.canvas.getConfig();(i!==l||o!==c)&&this.canvas.resize(i,o)}else{const l={left:"left-top",center:"top",right:"right-top"},[c,u]=Xh({width:i,height:o,placement:l[n]||l.left,className:"title-canvas",graphCanvas:this.context.canvas});e&&c.classList.add(e),this.container=c,this.canvas=u}return this.canvas}renderTitle(t){const e=new NX({options:this.options,ctx:this.context});t.removeChildren(),e.getTitle().forEach(n=>{n&&t.appendChild(n)})}}class NX{get padding(){return Lr(this.options.padding)}constructor(t){const{options:e,ctx:n}=t;this.options=e,this.context=n}getTitle(){const t=this.options,e=Uy,n=t[e],i=IT,a=t[i],{spacing:s=44,padding:o,align:l}=t,c=kX(t,[e+"",i+"","spacing","padding","align"]),u=n,h=a,d=Ue(c,Uy),f=Ue(c,IT),[g]=this.context.graph.getSize(),[v=0,p=0,,y=0]=this.padding,m=g,x=m-y-p;let E=null,_=y,M="left";switch(l){case"left":_=y,M="left";break;case"center":_=m/2,M="center";break;case"right":_=m-p,M="right";break;default:_=y,M="left"}const O=new xi({className:Uy,style:Object.assign(Object.assign(Object.assign(Object.assign({},MX),{wordWrapWidth:x-5,x:_,y:v,textAlign:M}),d),{text:u})}),T=O.getBBox();return h&&(E=new xi({className:"subTitle",style:Object.assign(Object.assign(Object.assign(Object.assign({},TX),{wordWrapWidth:x-5,x:_,y:T.height+s+v,textAlign:M}),f),{text:h})})),[O,E]}}function PX(r){const t={top:"unset",right:"unset",bottom:"unset",left:"unset"};return r.split("-").forEach(n=>{t[n]="8px"}),t.flexDirection=r.startsWith("top")||r.startsWith("bottom")?"row":"column",t}const CX=`
  .g6-toolbar {
    position: absolute;
    z-index: 100;
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: center;
    border-radius: 4px;
    box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.1);
    opacity: 0.65;
  }
  .g6-toolbar .g6-toolbar-item {
    display: inline-block;
    width: 16px;
    height: 16px;
    padding: 4px;
    cursor: pointer;
    box-sizing: content-box;
  }

  .g6-toolbar .g6-toolbar-item:hover {
    background-color: #f0f0f0;
  }

  .g6-toolbar .g6-toolbar-item svg {
    display: inline-block;
    width: 100%;
    height: 100%;
    pointer-events: none;
  }
`,RX=`
  <svg>
    <symbol id="zoom-in" viewBox="64 64 896 896">
      <path d="M637 443H519V309c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v134H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h118v134c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V519h118c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>
    </symbol>
    <symbol id="zoom-out" viewBox="64 64 896 896">
      <path d="M637 443H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h312c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>
    </symbol>
    <symbol id="edit" viewBox="64 64 896 896">
      <path d="M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"></path>
    </symbol>
    <symbol id="delete" viewBox="64 64 896 896">
      <path d="M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"></path>
    </symbol>
    <symbol id="redo" viewBox="64 64 896 896">
      <path d="M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"></path>
    </symbol>
    <symbol id="undo" viewBox="64 64 896 896">
      <path d="M511.4 124C290.5 124.3 112 303 112 523.9c0 128 60.2 242 153.8 315.2l-37.5 48c-4.1 5.3-.3 13 6.3 12.9l167-.8c5.2 0 9-4.9 7.7-9.9L369.8 727a8 8 0 00-14.1-3L315 776.1c-10.2-8-20-16.7-29.3-26a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-7.5 7.5-15.3 14.5-23.4 21.2a7.93 7.93 0 00-1.2 11.1l39.4 50.5c2.8 3.5 7.9 4.1 11.4 1.3C854.5 760.8 912 649.1 912 523.9c0-221.1-179.4-400.2-400.6-399.9z"></path>
    </symbol>
    <symbol id="export" viewBox="64 64 896 896">
      <path d="M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"></path>
    </symbol>
    <symbol id="auto-fit" viewBox="64 64 896 896">
      <path d="M952 474H829.8C812.5 327.6 696.4 211.5 550 194.2V72c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v122.2C327.6 211.5 211.5 327.6 194.2 474H72c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h122.2C211.5 696.4 327.6 812.5 474 829.8V952c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V829.8C696.4 812.5 812.5 696.4 829.8 550H952c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zM512 756c-134.8 0-244-109.2-244-244s109.2-244 244-244 244 109.2 244 244-109.2 244-244 244z"></path>
      <path d="M512 392c-32.1 0-62.1 12.4-84.8 35.2-22.7 22.7-35.2 52.7-35.2 84.8s12.5 62.1 35.2 84.8C449.9 619.4 480 632 512 632s62.1-12.5 84.8-35.2C619.4 574.1 632 544 632 512s-12.5-62.1-35.2-84.8A118.57 118.57 0 00512 392z"></path>
    </symbol>
    <symbol id="reset" viewBox="64 64 896 896">
      <path d="M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"></path>
    </symbol>
    <symbol id="exit-fullscreen" viewBox="0 0 1024 1024">
      <path d="M418.13333333 361.43786666c0 0.2048-0.13653333 0.4096-0.13653334 0.68266667C417.99679999 362.32533333 418.13333333 362.53013333 418.13333333 362.73493333 418.13333333 371.54133333 414.44693333 379.392 408.78079999 385.39946666 408.43946666 385.7408 408.30293333 386.21866666 408.02986666 386.49173333c-1.09226667 1.09226667-2.59413333 1.77493333-3.82293333 2.73066667C398.40426666 393.65973333 391.64586666 396.8 383.93173333 396.8 383.72693333 396.8 383.59039999 396.73173333 383.38559999 396.73173333S382.97599999 396.8 382.77119999 396.8L112.29866666 396.8C92.50133333 396.8 76.79999999 381.50826666 76.79999999 362.66666666 76.66346666 343.89333333 92.63786666 328.53333333 112.16213333 328.53333333l189.44 0L87.44959999 114.51733333C73.59146666 100.59093333 73.25013333 78.5408 86.63039999 65.29706666c13.17546667-13.44853333 35.36213333-12.97066667 49.152 0.88746667l214.08426667 214.08426667L349.86666666 90.89706666C349.79839999 71.23626666 365.22666666 55.46666666 383.99999999 55.46666666 402.77333333 55.33013333 418.13333333 71.30453333 418.13333333 90.8288L418.13333333 361.43786666zM928.90453333 328.53333333l-189.44 0 214.15253333-214.08426667c13.85813333-13.9264 14.19946667-35.90826667 0.88746667-49.22026666-13.17546667-13.44853333-35.36213333-12.97066667-49.152 0.88746666l-214.08426667 214.08426667L691.26826666 90.89706666C691.26826666 71.23626666 675.83999999 55.46666666 657.06666666 55.46666666 638.29333333 55.33013333 622.93333333 71.30453333 622.93333333 90.8288l0 270.60906666c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 362.32533333 622.93333333 362.53013333 622.93333333 362.73493333 622.93333333 371.54133333 626.61973333 379.392 632.28586666 385.39946666c0.34133333 0.34133333 0.47786667 0.8192 0.8192 1.09226667 1.09226667 1.09226667 2.59413333 1.77493333 3.8912 2.73066667C642.66239999 393.65973333 649.42079999 396.8 657.13493333 396.8c0.2048 0 0.34133333-0.06826667 0.54613333-0.06826667S658.09066666 396.8 658.29546666 396.8l270.5408 0C948.56533333 396.8 964.26666666 381.50826666 964.26666666 362.66666666 964.40319999 343.89333333 948.42879999 328.53333333 928.90453333 328.53333333zM418.13333333 635.73333333c0-8.8064-3.6864-16.5888-9.35253334-22.66453333C408.43946666 612.72746666 408.30293333 612.2496 408.02986666 611.90826666 406.86933333 610.88426666 405.43573333 610.2016 404.20693333 609.24586666 398.47253333 604.80853333 391.64586666 601.6 383.93173333 601.6 383.72693333 601.6 383.59039999 601.73653333 383.38559999 601.73653333S382.97599999 601.6 382.77119999 601.6L112.29866666 601.6C92.50133333 601.6 76.79999999 616.96 76.79999999 635.73333333 76.66346666 654.50666666 92.63786666 669.86666666 112.16213333 669.86666666l189.44 0-214.15253334 214.15253334c-13.85813333 13.85813333-14.19946667 35.84-0.88746666 49.22026666 13.17546667 13.44853333 35.36213333 12.9024 49.152-0.95573333l214.08426666-214.08426667 0 189.37173334c0 19.59253333 15.42826667 35.49866667 34.2016 35.36213333C402.77333333 943.2064 418.13333333 927.232 418.13333333 907.5712L418.13333333 637.09866666c0-0.27306667-0.13653333-0.47786667-0.13653334-0.68266666C417.99679999 636.14293333 418.13333333 635.93813333 418.13333333 635.73333333zM739.46453333 669.86666666l189.44 0c19.456 0 35.49866667-15.36 35.36213333-34.13333333C964.26666666 616.96 948.56533333 601.6 928.76799999 601.6L658.29546666 601.6C658.09066666 601.6 657.88586666 601.73653333 657.68106666 601.73653333S657.33973333 601.6 657.13493333 601.6C649.42079999 601.6 642.59413333 604.80853333 636.85973333 609.24586666 635.63093333 610.2016 634.19733333 610.88426666 633.03679999 611.90826666 632.76373333 612.2496 632.62719999 612.72746666 632.28586666 613.0688 626.61973333 619.14453333 622.93333333 626.92693333 622.93333333 635.73333333c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 636.6208 622.93333333 636.8256 622.93333333 637.09866666l0 270.5408C622.93333333 927.232 638.29333333 943.2064 657.06666666 942.93333333c18.77333333 0.13653333 34.2016-15.70133333 34.2016-35.36213333l0-189.37173334 214.08426667 214.08426667c13.78986667 13.85813333 35.90826667 14.40426667 49.152 0.95573333 13.312-13.312 12.97066667-35.36213333-0.88746667-49.22026666L739.46453333 669.86666666z"  ></path></symbol>
    <symbol id="request-fullscreen" viewBox="0 0 1024 1024">
      <path d="M69.818182 87.598545v273.128728a34.909091 34.909091 0 0 0 69.818182 0V163.653818l221.928727 222.021818a33.512727 33.512727 0 0 0 47.383273-47.383272L186.926545 116.363636h197.073455a34.909091 34.909091 0 0 0 0-69.818181H110.871273C85.364364 46.545455 69.818182 59.671273 69.818182 87.598545zM938.542545 46.545455H665.413818a34.909091 34.909091 0 0 0 0 69.818181h197.073455L640.465455 338.292364a33.512727 33.512727 0 0 0 47.383272 47.383272l221.928728-222.021818v197.073455a34.909091 34.909091 0 0 0 69.818181 0V87.598545c0-27.927273-15.453091-41.053091-40.96-41.05309z m-827.671272 907.636363h273.128727a34.909091 34.909091 0 0 0 0-69.818182H186.926545l222.021819-221.928727a33.512727 33.512727 0 0 0-47.383273-47.383273L139.636364 837.073455V640a34.909091 34.909091 0 0 0-69.818182 0v273.128727c0 27.927273 15.546182 41.053091 41.053091 41.053091z m868.724363-41.053091V640a34.909091 34.909091 0 0 0-69.818181 0v197.073455L687.941818 615.051636a33.512727 33.512727 0 0 0-47.383273 47.383273L862.487273 884.363636H665.413818a34.909091 34.909091 0 0 0 0 69.818182h273.128727c25.6 0 41.053091-13.125818 41.053091-41.053091z"  ></path></symbol>
  </svg>
`;var DT=function(r,t,e,n){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((n=n.apply(r,t||[])).next())})};class td extends En{constructor(t,e){super(t,Object.assign({},td.defaultOptions,e)),this.$element=no("toolbar",!1),this.onToolbarItemClick=i=>{const{onClick:a}=this.options;if(i.target instanceof Element&&i.target.className.includes("g6-toolbar-item")){const s=i.target.getAttribute("value");a==null||a(s,i.target)}};const n=this.context.canvas.getContainer();this.$element.style.display="flex",n.appendChild(this.$element),Ym("g6-toolbar-css","style",{},CX,document.head),Ym("g6-toolbar-svgicon","div",{display:"none"},RX),this.$element.addEventListener("click",this.onToolbarItemClick),this.update(e)}update(t){const e=Object.create(null,{update:{get:()=>super.update}});return DT(this,void 0,void 0,function*(){e.update.call(this,t);const{className:n,position:i,style:a}=this.options;this.$element.className=`g6-toolbar ${n||""}`,Object.assign(this.$element.style,a,PX(i)),this.$element.innerHTML=yield this.getDOMContent()})}destroy(){this.$element.removeEventListener("click",this.onToolbarItemClick),this.$element.remove(),super.destroy()}getDOMContent(){return DT(this,void 0,void 0,function*(){return(yield this.options.getItems()).map(e=>{var n;return`
          <div class="g6-toolbar-item" value="${e.value}" title="${(n=e.title)!==null&&n!==void 0?n:""}">
            <svg aria-hidden="true" focusable="false">
              <use xlink:href="#${e.id}"></use>
            </svg>
          </div>`}).join("")})}}td.defaultOptions={position:"top-left"};var FT=function(r,t,e,n){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((n=n.apply(r,t||[])).next())})};class ed extends En{constructor(t,e){super(t,Object.assign({},ed.defaultOptions,e)),this.currentTarget=null,this.tooltipElement=null,this.container=null,this.isEnable=(n,i)=>{const{enable:a}=this.options;return typeof a=="function"?a(n,i):a},this.onClick=n=>{const{target:{id:i}}=n;this.currentTarget===i?this.hide(n):this.show(n)},this.onPointerMove=n=>{const{target:i}=n;!this.currentTarget||i.id===this.currentTarget||this.show(n)},this.onPointerLeave=n=>{this.hide(n)},this.onCanvasMove=n=>{this.hide(n)},this.onPointerOver=n=>{this.show(n)},this.showById=n=>FT(this,void 0,void 0,function*(){const i={target:{id:n}};yield this.show(i)}),this.getElementData=(n,i)=>{const{model:a}=this.context;switch(i){case"node":return a.getNodeData([n]);case"edge":return a.getEdgeData([n]);case"combo":return a.getComboData([n]);default:return[]}},this.show=n=>FT(this,void 0,void 0,function*(){var i,a;const{client:s,target:{id:o}}=n;if(yl(n.target))return;const l=this.context.graph.getElementType(o),{getContent:c,title:u}=this.options,h=this.getElementData(o,l);if(!this.tooltipElement||!this.isEnable(n,h))return;let d={};if(c){if(d.content=yield c(n,h),!d.content)return}else{const v=this.context.graph.getElementRenderStyle(o),p=l==="node"?v.fill:v.stroke;d={title:u||l,data:h.map(y=>({name:"ID",value:y.id||`${y.source} -> ${y.target}`,color:p}))}}this.currentTarget=o;let f,g;if(s)f=s.x,g=s.y;else{const v=Mn(h,"0.style",{x:0,y:0});f=v.x,g=v.y}(a=(i=this.options).onOpenChange)===null||a===void 0||a.call(i,!0),this.tooltipElement.update(Object.assign(Object.assign(Object.assign({},this.tooltipStyleProps),{x:f,y:g,style:{".tooltip":{visibility:"visible"}}}),d))}),this.hide=n=>{var i,a,s,o,l;if(!n){(a=(i=this.options).onOpenChange)===null||a===void 0||a.call(i,!1),(s=this.tooltipElement)===null||s===void 0||s.hide(),this.currentTarget=null;return}if(!this.tooltipElement||!this.currentTarget)return;const{client:{x:c,y:u}}=n;(l=(o=this.options).onOpenChange)===null||l===void 0||l.call(o,!1),this.tooltipElement.hide(c,u),this.currentTarget=null},this.initTooltip=()=>{var n;const i=new JH({className:"tooltip",style:this.tooltipStyleProps});return(n=this.container)===null||n===void 0||n.appendChild(i.HTMLTooltipElement),i},this.render(),this.bindEvents()}getEvents(){return this.options.trigger==="click"?{"node:click":this.onClick,"edge:click":this.onClick,"combo:click":this.onClick,"canvas:click":this.onPointerLeave,contextmenu:this.onPointerLeave,drag:this.onPointerLeave}:{"node:pointerover":this.onPointerOver,"node:pointermove":this.onPointerMove,"canvas:pointermove":this.onCanvasMove,"edge:pointerover":this.onPointerOver,"edge:pointermove":this.onPointerMove,"combo:pointerover":this.onPointerOver,"combo:pointermove":this.onPointerMove,contextmenu:this.onPointerLeave,"node:drag":this.onPointerLeave}}update(t){var e;this.unbindEvents(),super.update(t),this.tooltipElement&&((e=this.container)===null||e===void 0||e.removeChild(this.tooltipElement.HTMLTooltipElement)),this.tooltipElement=this.initTooltip(),this.bindEvents()}render(){const{canvas:t}=this.context,e=t.getContainer();e&&(this.container=e,this.tooltipElement=this.initTooltip())}unbindEvents(){const{graph:t}=this.context,e=this.getEvents();Object.keys(e).forEach(n=>{t.off(n,e[n])})}bindEvents(){const{graph:t}=this.context,e=this.getEvents();Object.keys(e).forEach(n=>{t.on(n,e[n])})}get tooltipStyleProps(){const{canvas:t}=this.context,{center:e}=t.getBounds(),n=t.getContainer(),{top:i,left:a}=n.getBoundingClientRect(),{style:s,position:o,enterable:l,container:c={x:-a,y:-i},title:u,offset:h}=this.options,[d,f]=e,[g,v]=t.getSize();return{x:d,y:f,container:c,title:u,bounding:{x:0,y:0,width:g,height:v},position:o,enterable:l,offset:h,style:s}}destroy(){var t;this.unbindEvents(),this.tooltipElement&&((t=this.container)===null||t===void 0||t.removeChild(this.tooltipElement.HTMLTooltipElement)),super.destroy()}}ed.defaultOptions={trigger:"hover",position:"top-right",enterable:!1,enable:!0,offset:[10,10],style:{".tooltip":{visibility:"hidden"}}};var sR=function(r,t,e,n){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((n=n.apply(r,t||[])).next())})};let xs;function oR(r,t){return xs||(xs=document.createElement("canvas")),xs.width=r,xs.height=t,xs.getContext("2d").clearRect(0,0,r,t),xs}function LX(r,t,e,n){return sR(this,void 0,void 0,function*(){const i=oR(r,t),a=i.getContext("2d"),{rotate:s,opacity:o,textFill:l,textFontSize:c,textFontFamily:u,textFontVariant:h,textFontWeight:d,textAlign:f,textBaseline:g}=n;return a.textAlign=f,a.textBaseline=g,a.translate(r/2,t/2),a.font=`${c}px ${u} ${h} ${d}`,s&&a.rotate(s),o&&(a.globalAlpha=o),l&&(a.fillStyle=l,a.fillText(`${e}`,0,0)),i.toDataURL()})}function IX(r,t,e,n){return sR(this,void 0,void 0,function*(){const i=oR(r,t),a=i.getContext("2d"),{rotate:s,opacity:o}=n;s&&a.rotate(s),o&&(a.globalAlpha=o);const l=new Image;return l.crossOrigin="anonymous",l.src=e,new Promise(c=>{l.onload=function(){const u=r>l.width?(r-l.width)/2:0,h=t>l.height?(t-l.height)/2:0;a.drawImage(l,0,0,l.width,l.height,u,h,r-u*2,t-h*2),c(i.toDataURL())}})})}var DX=function(r,t,e,n){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((n=n.apply(r,t||[])).next())})},FX=function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(e[n[i]]=r[n[i]]);return e};class nd extends En{constructor(t,e){super(t,Object.assign({},nd.defaultOptions,e)),this.$element=no("watermark"),this.context.canvas.getContainer().appendChild(this.$element),this.update(e)}update(t){const e=Object.create(null,{update:{get:()=>super.update}});return DX(this,void 0,void 0,function*(){e.update.call(this,t);const n=this.options,{width:i,height:a,text:s,imageURL:o}=n,l=FX(n,["width","height","text","imageURL"]);Object.keys(l).forEach(u=>{u.startsWith("background")&&(this.$element.style[u]=t[u])});const c=o?yield IX(i,a,o,l):yield LX(i,a,s,l);this.$element.style.backgroundImage=`url(${c})`})}destroy(){super.destroy(),this.$element.remove()}}nd.defaultOptions={width:200,height:100,opacity:.2,rotate:Math.PI/12,text:"",textFill:"#000",textFontSize:16,textAlign:"center",textBaseline:"middle",backgroundRepeat:"repeat"};const BX=["#7E92B5","#F4664A","#FFBE3A"],zX={type:"group",color:["#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]},jX={type:"group",color:["#99ADD1","#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]};function lR(r){const{bgColor:t,textColor:e,nodeColor:n,nodeColorDisabled:i,nodeStroke:a,nodeHaloStrokeOpacityActive:s=.15,nodeHaloStrokeOpacitySelected:o=.25,nodeOpacityDisabled:l=.06,nodeIconOpacityInactive:c=.85,nodeOpacityInactive:u=.25,nodeBadgePalette:h=BX,nodePaletteOptions:d=zX,edgeColor:f,edgeColorDisabled:g,edgePaletteOptions:v=jX,comboColor:p,comboColorDisabled:y,comboStroke:m,comboStrokeDisabled:x,edgeColorInactive:E}=r;return{background:t,node:{palette:d,style:{donutOpacity:1,badgeBackgroundOpacity:1,badgeFill:"#fff",badgeFontSize:8,badgePadding:[0,4],badgePalette:h,fill:n,fillOpacity:1,halo:!1,iconFill:"#fff",iconOpacity:1,labelBackground:!1,labelBackgroundFill:t,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelFill:e,labelFillOpacity:.85,labelLineHeight:16,labelPadding:[0,2],labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelOffsetY:2,lineWidth:0,portFill:n,portLineWidth:1,portStroke:a,portStrokeOpacity:.65,size:32,stroke:a,strokeOpacity:1,zIndex:2},state:{selected:{halo:!0,haloLineWidth:24,haloStrokeOpacity:o,labelFontSize:12,labelFontWeight:"bold",lineWidth:4,stroke:a},active:{halo:!0,haloLineWidth:12,haloStrokeOpacity:s},highlight:{labelFontWeight:"bold",lineWidth:4,stroke:a,strokeOpacity:.85},inactive:{badgeBackgroundOpacity:u,donutOpacity:u,fillOpacity:u,iconOpacity:c,labelFill:e,labelFillOpacity:u,strokeOpacity:u},disabled:{badgeBackgroundOpacity:.25,donutOpacity:l,fill:i,fillOpacity:l,iconFill:i,iconOpacity:.25,labelFill:e,labelFillOpacity:.25,strokeOpacity:l}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"node-expand",collapse:"node-collapse",update:[{fields:["x","y","fill","stroke"]}],translate:[{fields:["x","y"]}]}},edge:{palette:v,style:{badgeBackgroundFill:f,badgeFill:"#fff",badgeFontSize:8,badgeOffsetX:10,badgeBackgroundOpacity:1,fillOpacity:1,halo:!1,haloLineWidth:12,haloStrokeOpacity:1,increasedLineWidthForHitTesting:2,labelBackground:!1,labelBackgroundFill:t,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[4,4,4,4],labelFill:e,labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelPlacement:"center",labelTextBaseline:"middle",lineWidth:1,stroke:f,strokeOpacity:1,zIndex:1},state:{selected:{halo:!0,haloStrokeOpacity:.25,labelFontSize:14,labelFontWeight:"bold",lineWidth:3},active:{halo:!0,haloStrokeOpacity:.15},highlight:{labelFontWeight:"bold",lineWidth:3},inactive:{stroke:E,fillOpacity:.08,labelOpacity:.25,strokeOpacity:.08,badgeBackgroundOpacity:.25},disabled:{stroke:g,fillOpacity:.45,strokeOpacity:.45,labelOpacity:.25,badgeBackgroundOpacity:.45}},animation:{enter:"fade",exit:"fade",expand:"path-in",collapse:"path-out",show:"fade",hide:"fade",update:[{fields:["sourceNode","targetNode"]},{fields:["stroke"],shape:"key"}],translate:[{fields:["sourceNode","targetNode"]}]}},combo:{style:{collapsedMarkerFill:t,collapsedMarkerFontSize:12,collapsedMarkerFillOpacity:1,collapsedSize:32,collapsedFillOpacity:1,fill:p,halo:!1,haloLineWidth:12,haloStroke:m,haloStrokeOpacity:.25,labelBackground:!1,labelBackgroundFill:t,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[2,4,2,4],labelFill:e,labelFontSize:12,labelFontWeight:400,labelOpacity:1,lineDash:0,lineWidth:1,fillOpacity:.04,strokeOpacity:1,padding:10,stroke:m},state:{selected:{halo:!0,labelFontSize:14,labelFontWeight:700,lineWidth:4},active:{halo:!0},highlight:{labelFontWeight:700,lineWidth:4},inactive:{fillOpacity:.65,labelOpacity:.25,strokeOpacity:.65},disabled:{fill:y,fillOpacity:.25,labelOpacity:.25,stroke:x,strokeOpacity:.25}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"combo-expand",collapse:"combo-collapse",update:[{fields:["x","y"]},{fields:["fill","stroke","lineWidth"],shape:"key"}],translate:[{fields:["x","y"]}]}}}}const qX={type:"group",color:["#637088","#0F55A6","#008383","#9C5D38","#8B53A6","#4E40A6","#8F6608","#3E801D","#A65383","#175E75","#0F8248"]},GX={bgColor:"#000000",comboColor:"#fdfdfd",comboColorDisabled:"#d0e4ff",comboStroke:"#99add1",comboStrokeDisabled:"#969696",edgeColor:"#637088",edgeColorDisabled:"#637088",edgeColorInactive:"#D0E4FF",edgePaletteOptions:qX,nodeColor:"#1783ff",nodeColorDisabled:"#D0E4FF",nodeHaloStrokeOpacityActive:.25,nodeHaloStrokeOpacitySelected:.45,nodeIconOpacityInactive:.45,nodeOpacityDisabled:.25,nodeOpacityInactive:.45,nodeStroke:"#d0e4ff",textColor:"#ffffff"},$X=lR(GX),WX={bgColor:"#ffffff",comboColor:"#99ADD1",comboColorDisabled:"#f0f0f0",comboStroke:"#99add1",comboStrokeDisabled:"#d9d9d9",edgeColor:"#99add1",edgeColorDisabled:"#d9d9d9",edgeColorInactive:"#1B324F",nodeColor:"#1783ff",nodeColorDisabled:"#1B324F",nodeHaloStrokeOpacityActive:.15,nodeHaloStrokeOpacitySelected:.25,nodeIconOpacityInactive:.85,nodeOpacityDisabled:.06,nodeOpacityInactive:.25,nodeStroke:"#000000",textColor:"#000000"},VX=lR(WX);class Ea extends N1{beforeDraw(t,e){return t}afterLayout(t,e){}}class UX extends Ea{beforeDraw(t){const{model:e}=this.context,n=t.add.combos,i=a=>{const s=[];return a.forEach((o,l)=>{const u=e.getAncestorsData(l,"combo").map(h=>K(h)).reverse();s.push([l,o,u.length])}),new Map(s.sort(([,,o],[,,l])=>l-o).map(([o,l])=>[o,l]))};return t.add.combos=i(n),t.update.combos=i(t.update.combos),t}}function mr(r,t,e,n,i){const a=K(n),s=`${e}s`,o=i?n:r.add[s].get(a)||r.update[s].get(a)||r.remove[s].get(a)||n;Object.entries(r).forEach(([l,c])=>{t===l?c[s].set(a,o):c[s].delete(a)})}function Wc(r,t){return Object.keys(r).every(e=>r[e]===t[e])}class YX extends Ea{beforeDraw(t,e){if(e.stage==="visibility"||!this.context.model.model.hasTreeStructure(ge))return t;const{model:n}=this.context,{add:i,update:a}=t,s=[...t.update.combos.entries(),...t.add.combos.entries()];for(;s.length;){const[o,l]=s.pop();if(ir(l)){const c=n.getDescendantsData(o),u=c.map(K),{internal:h,external:d}=Rm(u,f=>n.getRelatedEdgesData(f));c.forEach(f=>{const g=K(f),v=s.findIndex(([y])=>y===g);v!==-1&&s.splice(v,1);const p=n.getElementType(g);mr(t,"remove",p,f)}),h.forEach(f=>mr(t,"remove","edge",f)),d.forEach(f=>{var g;const v=K(f);((g=this.context.element)===null||g===void 0?void 0:g.getElement(v))?a.edges.set(v,f):i.edges.set(v,f)})}else{const c=n.getChildrenData(o),u=c.map(K),{edges:h}=Rm(u,d=>n.getRelatedEdgesData(d));[...c,...h].forEach(d=>{var f;const g=K(d),v=n.getElementType(g);((f=this.context.element)===null||f===void 0?void 0:f.getElement(g))?mr(t,"update",v,d):mr(t,"add",v,d),v==="combo"&&s.push([g,d])})}}return t}}const BT=(r,t,e,n)=>{const i=`${e}s`,a=K(n);!r.add[i].has(a)&&!r.update[i].has(a)&&r[t][i].set(K(n),n)};class HX extends Ea{getElement(t){return this.context.element.getElement(t)}handleExpand(t,e){if(BT(e,"add","node",t),ir(t))return;const n=K(t);BT(e,"add","node",t),this.context.model.getRelatedEdgesData(n).forEach(s=>{mr(e,"add","edge",s)}),this.context.model.getChildrenData(n).forEach(s=>{this.handleExpand(s,e)})}beforeDraw(t){const{graph:e,model:n}=this.context;if(!n.model.hasTreeStructure(vr))return t;const{add:{nodes:i,edges:a},update:{nodes:s}}=t,o=new Map,l=new Map;i.forEach((u,h)=>{ir(u)&&o.set(h,u)}),a.forEach(u=>{if(e.getElementType(u.source)!=="node")return;const h=e.getNodeData(u.source);ir(h)&&o.set(u.source,h)}),s.forEach((u,h)=>{const d=this.getElement(h);if(!d)return;const f=d.attributes.collapsed;ir(u)?f||o.set(h,u):f&&l.set(h,u)});const c=new Set;return o.forEach((u,h)=>{n.getDescendantsData(h).forEach(f=>{const g=K(f);if(c.has(g))return;mr(t,"remove","node",f),n.getRelatedEdgesData(g).forEach(p=>{mr(t,"remove","edge",p)}),c.add(g)})}),l.forEach((u,h)=>{if(n.getAncestorsData(h,vr).some(ir)){mr(t,"remove","node",u);return}this.handleExpand(u,t)}),t}}function XX(r,t,e){km[r][t]&&wi.warn(`The extension ${t} of ${r} has been registered before, and will be overridden.`),Object.assign(km[r],{[t]:e})}/*!
 * @antv/g-plugin-dragndrop
 * @description A G plugin for Drag n Drop implemented with PointerEvents
 * @version 2.0.38
 * @date 7/30/2025, 1:35:41 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var cR=(function(){function r(t){ot(this,r),this.dragndropPluginOptions=t}return lt(r,[{key:"apply",value:function(e){var n=this,i=e.renderingService,a=e.renderingContext,s=a.root.ownerDocument,o=s.defaultView,l=function(u){var h=u.target,d=h===s,f=d&&n.dragndropPluginOptions.isDocumentDraggable?s:h.closest&&h.closest("[draggable=true]");if(f){var g=!1,v=u.timeStamp,p=[u.clientX,u.clientY],y=null,m=[u.clientX,u.clientY],x=(function(){var _=fa(bn().mark(function M(O){var T,N,P,C,R,I;return bn().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(g){j.next=2;break}if(T=O.timeStamp-v,N=er([O.clientX,O.clientY],p),!(T<=n.dragndropPluginOptions.dragstartTimeThreshold||N<=n.dragndropPluginOptions.dragstartDistanceThreshold)){j.next=1;break}return j.abrupt("return");case 1:O.type="dragstart",f.dispatchEvent(O),g=!0;case 2:if(O.type="drag",O.dx=O.clientX-m[0],O.dy=O.clientY-m[1],f.dispatchEvent(O),m=[O.clientX,O.clientY],d){j.next=4;break}return P=n.dragndropPluginOptions.overlap==="pointer"?[O.canvasX,O.canvasY]:h.getBounds().center,j.next=3,s.elementsFromPoint(P[0],P[1]);case 3:C=j.sent,R=C[C.indexOf(h)+1],I=(R==null?void 0:R.closest("[droppable=true]"))||(n.dragndropPluginOptions.isDocumentDroppable?s:null),y!==I&&(y&&(O.type="dragleave",O.target=y,y.dispatchEvent(O)),I&&(O.type="dragenter",O.target=I,I.dispatchEvent(O)),y=I,y&&(O.type="dragover",O.target=y,y.dispatchEvent(O)));case 4:case"end":return j.stop()}},M)}));return function(O){return _.apply(this,arguments)}})();o.addEventListener("pointermove",x);var E=function(M){if(g){M.detail={preventClick:!0};var O=M.clone();y&&(O.type="drop",O.target=y,y.dispatchEvent(O)),O.type="dragend",f.dispatchEvent(O),g=!1}o.removeEventListener("pointermove",x)};h.addEventListener("pointerup",E,{once:!0}),h.addEventListener("pointerupoutside",E,{once:!0})}};i.hooks.init.tap(r.tag,function(){o.addEventListener("pointerdown",l)}),i.hooks.destroy.tap(r.tag,function(){o.removeEventListener("pointerdown",l)})}}])})();cR.tag="Dragndrop";var KX=(function(r){function t(){var e,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ot(this,t),e=Yt(this,t),e.name="dragndrop",e.options=n,e}return Ht(t,r),lt(t,[{key:"init",value:function(){this.addRenderingPlugin(new cR(Vt({overlap:"pointer",isDocumentDraggable:!1,isDocumentDroppable:!1,dragstartDistanceThreshold:0,dragstartTimeThreshold:0},this.options)))}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}},{key:"setOptions",value:function(n){Object.assign(this.plugins[0].dragndropPluginOptions,n)}}])})(pa),zT=function(r,t,e,n){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((n=n.apply(r,t||[])).next())})},jT=function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(e[n[i]]=r[n[i]]);return e};const qT=["main"],GT=["background","main","label","transient"];function ZX(r){return r.main}class $T{getConfig(){return this.config}getLayer(t="main"){return this.extends.layers[t]||ZX(this.getLayers())}getLayers(){return this.extends.layers}getRenderer(t){return this.extends.renderers[t]}getCamera(t="main"){return this.getLayer(t).getCamera()}getRoot(t="main"){return this.getLayer(t).getRoot()}getContextService(t="main"){return this.getLayer(t).getContextService()}setCursor(t){this.config.cursor=t,this.getLayer().setCursor(t)}get document(){return this.getLayer().document}get context(){return this.getLayer().context}constructor(t){this.config={enableMultiLayer:!0},Object.assign(this.config,t);const e=this.config,{renderer:n,background:i,cursor:a,enableMultiLayer:s}=e,o=jT(e,["renderer","background","cursor","enableMultiLayer"]),l=s?GT:qT,c=WT(n,l),u=Object.fromEntries(l.map(h=>{const d=new _m(Object.assign(Object.assign({},o),{supportsMutipleCanvasesInOneContainer:s,renderer:c[h],background:s?h==="background"?i:void 0:i}));return[h,d]}));VT(u),this.extends={config:this.config,renderer:n,renderers:c,layers:u}}get ready(){return Promise.all(Object.entries(this.getLayers()).map(([,t])=>t.ready))}resize(t,e){Object.assign(this.extends.config,{width:t,height:e}),Object.values(this.getLayers()).forEach(n=>{const i=n.getCamera(),a=i.getPosition(),s=i.getFocalPoint();n.resize(t,e),i.setPosition(a),i.setFocalPoint(s)})}getBounds(t){return hl(Object.values(this.getLayers()).map(e=>t?e.getRoot().childNodes.find(i=>i.classList.includes(t)):e.getRoot()).filter(e=>(e==null?void 0:e.childNodes.length)>0).map(e=>e.getBounds()))}getContainer(){const t=this.extends.config.container;return typeof t=="string"?document.getElementById(t):t}getSize(){return[this.extends.config.width||0,this.extends.config.height||0]}appendChild(t,e){var n;const i=((n=t.style)===null||n===void 0?void 0:n.$layer)||"main";return this.getLayer(i).appendChild(t,e)}setRenderer(t){if(t===this.extends.renderer)return;const e=WT(t,this.config.enableMultiLayer?GT:qT);this.extends.renderers=e,Object.entries(e).forEach(([n,i])=>this.getLayer(n).setRenderer(i)),VT(this.getLayers())}getCanvasByViewport(t){return On(this.getLayer().viewport2Canvas(Vr(t)))}getViewportByCanvas(t){return On(this.getLayer().canvas2Viewport(Vr(t)))}getViewportByClient(t){return On(this.getLayer().client2Viewport(Vr(t)))}getClientByViewport(t){return On(this.getLayer().viewport2Client(Vr(t)))}getClientByCanvas(t){return this.getClientByViewport(this.getViewportByCanvas(t))}getCanvasByClient(t){const e=this.getLayer(),n=e.client2Viewport(Vr(t));return On(e.viewport2Canvas(n))}toDataURL(){return zT(this,arguments,void 0,function*(t={}){const e=globalThis.devicePixelRatio||1,{mode:n="viewport"}=t,i=jT(t,["mode"]);let[a,s,o,l]=[0,0,0,0];if(n==="viewport")[o,l]=this.getSize();else if(n==="overall"){const y=this.getBounds(),m=ya(y);[a,s]=y.min,[o,l]=m}const c=lm('<div id="virtual-image"></div>'),u=new _m({width:o,height:l,renderer:new Xo,devicePixelRatio:e,container:c,background:this.extends.config.background});yield u.ready,u.appendChild(this.getLayer("background").getRoot().cloneNode(!0)),u.appendChild(this.getRoot().cloneNode(!0));const h=this.getLayer("label").getRoot().cloneNode(!0),d=u.viewport2Canvas({x:0,y:0}),f=this.getCanvasByViewport([0,0]);h.translate([f[0]-d.x,f[1]-d.y]),h.scale(1/this.getCamera().getZoom()),u.appendChild(h),u.appendChild(this.getLayer("transient").getRoot().cloneNode(!0));const g=this.getCamera(),v=u.getCamera();if(n==="viewport")v.setZoom(g.getZoom()),v.setPosition(g.getPosition()),v.setFocalPoint(g.getFocalPoint());else if(n==="overall"){const[y,m,x]=v.getPosition(),[E,_,M]=v.getFocalPoint();v.setPosition([y+a,m+s,x]),v.setFocalPoint([E+a,_+s,M])}const p=u.getContextService();return new Promise(y=>{u.addEventListener(gr.RERENDER,()=>zT(this,void 0,void 0,function*(){yield new Promise(x=>setTimeout(x,300));const m=yield p.toDataURL(i);y(m)}))})})}destroy(){Object.values(this.getLayers()).forEach(t=>{t.getCamera().cancelLandmarkAnimation(),t.destroy()})}}function WT(r,t){return Object.fromEntries(t.map(e=>{const n=(r==null?void 0:r(e))||new Xo;return n instanceof Xo&&n.setConfig({enableDirtyRectangleRendering:!1}),e==="main"?n.registerPlugin(new KX({isDocumentDraggable:!0,isDocumentDroppable:!0,dragstartDistanceThreshold:10,dragstartTimeThreshold:100})):n.unregisterPlugin(n.getPlugin("dom-interaction")),[e,n]}))}function VT(r){Object.entries(r).forEach(([t,e])=>{const n=e.getContextService().getDomElement();n!=null&&n.style&&(n.style.gridArea="1 / 1 / 2 / 2",n.style.outline="none",n.tabIndex=1,t!=="main"&&(n.style.pointerEvents="none")),n!=null&&n.parentElement&&(n.parentElement.style.display="grid",n.parentElement.style.isolation="isolate")})}const ws=r=>r?parseInt(r):0;function JX(r){const t=getComputedStyle(r),e=r.clientWidth||ws(t.width),n=r.clientHeight||ws(t.height),i=ws(t.paddingLeft)+ws(t.paddingRight),a=ws(t.paddingTop)+ws(t.paddingBottom);return[e-i,n-a]}function UT(r){if(!r)return[0,0];let t=640,e=480;const[n,i]=JX(r);t=n||t,e=i||e;const a=1,s=1;return[Math.max(St(t)?t:a,a),Math.max(St(e)?e:s,s)]}class rd{constructor(t){this.type=t}}class an extends rd{constructor(t,e){super(t),this.data=e}}class Nr extends rd{constructor(t,e,n,i){super(t),this.animationType=e,this.animation=n,this.data=i}}class Es extends rd{constructor(t,e,n){super(t),this.elementType=e,this.data=n}}class Pc extends rd{constructor(t,e){super(t),this.data=e}}function hn(r,t){r.emit(t.type,t)}function QX(r){if(!r)return null;if(r instanceof bA)return{type:"canvas",element:r};let t=r;for(;t;){if(pl(t))return{type:"node",element:t};if(TN(t))return{type:"edge",element:t};if(j1(t))return{type:"combo",element:t};t=t.parentElement}return null}function YT(r){var t;return((t=r==null?void 0:r.style)===null||t===void 0?void 0:t.zIndex)||0}const zo="cachedStyle",Ab=r=>`__${r}__`;function tK(r,t){const e=Array.isArray(t)?t:[t];Mn(r,zo)||Go(r,zo,{}),e.forEach(n=>{Go(Mn(r,zo),Ab(n),r.attributes[n])})}function HT(r,t){return Mn(r,[zo,Ab(t)])}function eK(r,t){return Ab(t)in(Mn(r,zo)||{})}class nK{constructor(t){this.tasks=[],this.animations=new Set,this.context=t}getTasks(){const t=[...this.tasks];return this.tasks=[],t}add(t,e){this.tasks.push([t,e])}animate(t,e,n){var i,a,s;(i=e==null?void 0:e.before)===null||i===void 0||i.call(e);const o=this.getTasks().map(([c,u])=>{var h,d,f;const{element:g,elementType:v,stage:p}=c,y=SB(this.context.options,v,p,t);(h=u==null?void 0:u.before)===null||h===void 0||h.call(u);const m=y.length?kB(g,this.inferStyle(c,n),y):null;return m?((d=u==null?void 0:u.beforeAnimate)===null||d===void 0||d.call(u,m),m.finished.then(()=>{var x,E;(x=u==null?void 0:u.afterAnimate)===null||x===void 0||x.call(u,m),(E=u==null?void 0:u.after)===null||E===void 0||E.call(u),this.animations.delete(m)})):(f=u==null?void 0:u.after)===null||f===void 0||f.call(u),m}).filter(Boolean);o.forEach(c=>this.animations.add(c));const l=M1(o);return l?((a=e==null?void 0:e.beforeAnimate)===null||a===void 0||a.call(e,l),l.finished.then(()=>{var c,u;(c=e==null?void 0:e.afterAnimate)===null||c===void 0||c.call(e,l),(u=e==null?void 0:e.after)===null||u===void 0||u.call(e),this.release()})):(s=e==null?void 0:e.after)===null||s===void 0||s.call(e),l}inferStyle(t,e){var n,i;const{element:a,elementType:s,stage:o,originalStyle:l,updatedStyle:c={}}=t;t.modifiedStyle||(t.modifiedStyle=Object.assign(Object.assign({},l),c));const{modifiedStyle:u}=t,h={},d={};if(o==="enter")Object.assign(h,{opacity:0});else if(o==="exit")Object.assign(d,{opacity:0});else if(o==="show")Object.assign(h,{opacity:0}),Object.assign(d,{opacity:(n=HT(a,"opacity"))!==null&&n!==void 0?n:Yo("opacity")});else if(o==="hide")Object.assign(h,{opacity:(i=HT(a,"opacity"))!==null&&i!==void 0?i:Yo("opacity")}),Object.assign(d,{opacity:0});else if(o==="collapse"){const{collapse:f}=e||{},{target:g,descendants:v,position:p}=f;if(s==="node"){if(v.includes(a.id)){const[y,m,x]=p;Object.assign(d,{x:y,y:m,z:x})}}else if(s==="combo"){if(a.id===g||v.includes(a.id)){const[y,m]=p;Object.assign(d,{x:y,y:m,childrenNode:l.childrenNode})}}else s==="edge"&&Object.assign(d,{sourceNode:u.sourceNode,targetNode:u.targetNode})}else if(o==="expand"){const{expand:f}=e||{},{target:g,descendants:v,position:p}=f;if(s==="node"){if(a.id===g||v.includes(a.id)){const[y,m,x]=p;Object.assign(h,{x:y,y:m,z:x})}}else if(s==="combo"){if(a.id===g||v.includes(a.id)){const[y,m,x]=p;Object.assign(h,{x:y,y:m,z:x,childrenNode:u.childrenNode})}}else s==="edge"&&Object.assign(h,{sourceNode:u.sourceNode,targetNode:u.targetNode})}return[Object.keys(h).length>0?Object.assign({},l,h):l,Object.keys(d).length>0?Object.assign({},u,d):u]}stop(){this.animations.forEach(t=>t.cancel())}clear(){this.tasks=[]}release(){var t,e;const{canvas:n}=this.context,i=(e=(t=n.document)===null||t===void 0?void 0:t.timeline)===null||e===void 0?void 0:e.animationsWithPromises;i&&(n.document.timeline.animationsWithPromises=i.filter(a=>a.playState!=="finished"))}destroy(){this.stop(),this.animations.clear(),this.tasks=[]}}class rK{constructor(t){this.batchCount=0,this.context=t}emit(t){const{graph:e}=this.context;e.emit(t.type,t)}startBatch(t=!0){this.batchCount++,this.batchCount===1&&this.emit(new an(ft.BATCH_START,{initiate:t}))}endBatch(){this.batchCount--,this.batchCount===0&&this.emit(new an(ft.BATCH_END))}get isBatching(){return this.batchCount>0}destroy(){this.context=null}}class iK extends A1{constructor(t){super(t),this.currentTarget=null,this.currentTargetType=null,this.category="behavior",this.forwardCanvasEvents=e=>{const{target:n}=e,i=QX(n);if(!i)return;const{graph:a,canvas:s}=this.context,{type:o,element:l}=i;if("destroyed"in l&&(yl(l)||l.destroyed))return;const{type:c,detail:u,button:h}=e,d=Object.assign(Object.assign({},e),{target:l,targetType:o,originalTarget:n});c===rt.POINTER_MOVE&&(this.currentTarget!==l&&(this.currentTarget&&a.emit(`${this.currentTargetType}:${rt.POINTER_LEAVE}`,Object.assign(Object.assign({},d),{type:rt.POINTER_LEAVE,target:this.currentTarget,targetType:this.currentTargetType})),l&&(Object.assign(d,{type:rt.POINTER_ENTER}),a.emit(`${o}:${rt.POINTER_ENTER}`,d))),this.currentTarget=l,this.currentTargetType=o),c===rt.CLICK&&h===2||(a.emit(`${o}:${c}`,d),a.emit(c,d)),c===rt.CLICK&&u===2&&(Object.assign(d,{type:rt.DBLCLICK}),a.emit(`${o}:${rt.DBLCLICK}`,d),a.emit(rt.DBLCLICK,d)),c===rt.POINTER_DOWN&&h===2&&(Object.assign(d,{type:rt.CONTEXT_MENU,preventDefault:()=>{var f;(f=s.getContainer())===null||f===void 0||f.addEventListener(rt.CONTEXT_MENU,g=>g.preventDefault(),{once:!0})}}),a.emit(`${o}:${rt.CONTEXT_MENU}`,d),a.emit(rt.CONTEXT_MENU,d))},this.forwardContainerEvents=e=>{this.context.graph.emit(e.type,e)},this.forwardEvents(),this.setBehaviors(this.context.options.behaviors||[])}setBehaviors(t){this.setExtensions(t)}forwardEvents(){const t=this.context.canvas.getContainer();t&&[Os.KEY_DOWN,Os.KEY_UP].forEach(n=>{t.addEventListener(n,this.forwardContainerEvents)});const e=this.context.canvas.document;e&&[rt.CLICK,rt.DBLCLICK,rt.POINTER_OVER,rt.POINTER_LEAVE,rt.POINTER_ENTER,rt.POINTER_MOVE,rt.POINTER_OUT,rt.POINTER_DOWN,rt.POINTER_UP,rt.CONTEXT_MENU,rt.DRAG_START,rt.DRAG,rt.DRAG_END,rt.DRAG_ENTER,rt.DRAG_OVER,rt.DRAG_LEAVE,rt.DROP,rt.WHEEL].forEach(n=>{e.addEventListener(n,this.forwardCanvasEvents)})}destroy(){const t=this.context.canvas.getContainer();t&&[Os.KEY_DOWN,Os.KEY_UP].forEach(e=>{t.removeEventListener(e,this.forwardContainerEvents)}),this.context.canvas.document.removeAllEventListeners(),super.destroy()}}var il=function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(e[n[i]]=r[n[i]]);return e};function Xi(r,t){const{data:e,style:n}=r,i=il(r,["data","style"]),{data:a,style:s}=t,o=il(t,["data","style"]),l=Object.assign(Object.assign({},i),o);return(e||a)&&Object.assign(l,{data:Object.assign(Object.assign({},e),a)}),(n||s)&&Object.assign(l,{style:Object.assign(Object.assign({},n),s)}),l}function Yy(r){const{data:t,style:e}=r,i=il(r,["data","style"]);return t&&(i.data=Object.assign({},t)),e&&(i.style=Object.assign({},e)),i}function Ss(r={},t={}){const{states:e=[],data:n={},style:i={},children:a=[]}=r,s=il(r,["states","data","style","children"]),{states:o=[],data:l={},style:c={},children:u=[]}=t,h=il(t,["states","data","style","children"]),d=(g,v)=>g.length!==v.length?!1:g.every((p,y)=>p===v[y]),f=(g,v)=>{const p=Object.keys(g),y=Object.keys(v);return p.length!==y.length?!1:p.every(m=>g[m]===v[m])};return!(!f(s,h)||!d(a,u)||!d(e,o)||!f(n,l)||!f(i,c))}var aK=function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(e[n[i]]=r[n[i]]);return e};function Hy(r){const{id:t=K(r),style:e,data:n}=r,i=aK(r,["id","style","data"]),a=Object.assign(Object.assign({},r),{style:Object.assign({},e),data:Object.assign({},n)});return PB(r)?Object.assign({id:t,data:a},i):{id:t,data:a}}function yn(r){return r.data}function sK(r){if(r.hasTreeStructure(vr))return;r.attachTreeStructure(vr);const t=r.getAllEdges();for(const e of t){const{source:n,target:i}=e;r.setParent(i,n,vr)}}class oK{constructor(){this.latestRemovedComboIds=new Set,this.comboIds=new Set,this.changes=[],this.batchCount=0,this.isTraceless=!1,this.enableUpdateNodeLikeHierarchy=!0,this.model=new vn}pushChange(t){if(this.isTraceless)return;const{type:e}=t;if(e===Oe.NodeUpdated||e===Oe.EdgeUpdated||e===Oe.ComboUpdated){const{value:n,original:i}=t;this.changes.push({value:Yy(n),original:Yy(i),type:e})}else this.changes.push({value:Yy(t.value),type:e})}getChanges(){return this.changes}clearChanges(){this.changes=[]}batch(t){this.batchCount++,this.model.batch(t),this.batchCount--}isBatching(){return this.batchCount>0}silence(t){this.isTraceless=!0,t(),this.isTraceless=!1}isCombo(t){return this.comboIds.has(t)||this.latestRemovedComboIds.has(t)}getData(){return{nodes:this.getNodeData(),edges:this.getEdgeData(),combos:this.getComboData()}}getNodeData(t){return this.model.getAllNodes().reduce((e,n)=>{const i=yn(n);return this.isCombo(K(i))||(t===void 0||t.includes(K(i)))&&e.push(i),e},[])}getEdgeDatum(t){return yn(this.model.getEdge(t))}getEdgeData(t){return this.model.getAllEdges().reduce((e,n)=>{const i=yn(n);return(t===void 0||t.includes(K(i)))&&e.push(i),e},[])}getComboData(t){return this.model.getAllNodes().reduce((e,n)=>{const i=yn(n);return this.isCombo(K(i))&&(t===void 0||t.includes(K(i)))&&e.push(i),e},[])}getRootsData(t=vr){return this.model.getRoots(t).map(yn)}getAncestorsData(t,e){const{model:n}=this;return!n.hasNode(t)||!n.hasTreeStructure(e)?[]:n.getAncestors(t,e).map(yn)}getDescendantsData(t){const e=this.getElementDataById(t),n=[];return Ds(e,i=>{i!==e&&n.push(i)},i=>this.getChildrenData(K(i)),"TB"),n}getParentData(t,e){const{model:n}=this;if(!e){wi.warn("The hierarchy structure key is not specified");return}if(!n.hasNode(t)||!n.hasTreeStructure(e))return;const i=n.getParent(t,e);return i?yn(i):void 0}getChildrenData(t){const e=this.getElementType(t)==="node"?vr:ge,{model:n}=this;return!n.hasNode(t)||!n.hasTreeStructure(e)?[]:n.getChildren(t,e).map(yn)}getElementsDataByType(t){return t==="node"?this.getNodeData():t==="edge"?this.getEdgeData():t==="combo"?this.getComboData():[]}getElementDataById(t){return this.getElementType(t)==="edge"?this.getEdgeDatum(t):this.getNodeLikeDatum(t)}getNodeLikeDatum(t){const e=this.model.getNode(t);return yn(e)}getNodeLikeData(t){return this.model.getAllNodes().reduce((e,n)=>{const i=yn(n);return t?t.includes(K(i))&&e.push(i):e.push(i),e},[])}getElementDataByState(t,e){return this.getElementsDataByType(t).filter(i=>{var a;return(a=i.states)===null||a===void 0?void 0:a.includes(e)})}getElementState(t){var e;return((e=this.getElementDataById(t))===null||e===void 0?void 0:e.states)||[]}hasNode(t){return this.model.hasNode(t)&&!this.isCombo(t)}hasEdge(t){return this.model.hasEdge(t)}hasCombo(t){return this.model.hasNode(t)&&this.isCombo(t)}getRelatedEdgesData(t,e="both"){return this.model.getRelatedEdges(t,e).map(yn)}getNeighborNodesData(t){return this.model.getNeighbors(t).map(yn)}setData(t){const{nodes:e=[],edges:n=[],combos:i=[]}=t,{nodes:a,edges:s,combos:o}=this.getData(),l=ca(a,e,h=>K(h),Ss),c=ca(s,n,h=>K(h),Ss),u=ca(o,i,h=>K(h),Ss);this.batch(()=>{const h={nodes:l.enter,edges:c.enter,combos:u.enter};this.addData(h),this.computeZIndex(h,"add",!0);const d={nodes:l.update,edges:c.update,combos:u.update};this.updateData(d),this.computeZIndex(d,"update",!0);const f={nodes:l.exit.map(K),edges:c.exit.map(K),combos:u.exit.map(K)};this.removeData(f)})}addData(t){const{nodes:e,edges:n,combos:i}=t;this.batch(()=>{this.addComboData(i),this.addNodeData(e),this.addEdgeData(n)}),this.computeZIndex(t,"add")}addNodeData(t=[]){t.length&&(this.model.addNodes(t.map(e=>(this.pushChange({value:e,type:Oe.NodeAdded}),Hy(e)))),this.updateNodeLikeHierarchy(t),this.computeZIndex({nodes:t},"add"))}addEdgeData(t=[]){t.length&&(this.model.addEdges(t.map(e=>(this.pushChange({value:e,type:Oe.EdgeAdded}),Hy(e)))),this.computeZIndex({edges:t},"add"))}addComboData(t=[]){if(!t.length)return;const{model:e}=this;e.hasTreeStructure(ge)||e.attachTreeStructure(ge),e.addNodes(t.map(n=>(this.comboIds.add(K(n)),this.pushChange({value:n,type:Oe.ComboAdded}),Hy(n)))),this.updateNodeLikeHierarchy(t),this.computeZIndex({combos:t},"add")}addChildrenData(t,e){const n=this.getNodeLikeDatum(t),i=e.map(K);this.addNodeData(e),this.updateNodeData([{id:t,children:[...n.children||[],...i]}]),this.addEdgeData(i.map(a=>({source:t,target:a})))}computeZIndex(t,e,n=!1){!n&&this.isBatching()||this.batch(()=>{const{nodes:i=[],edges:a=[],combos:s=[]}=t;s.forEach(o=>{var l,c,u;const h=K(o);if(e==="add"&&St((l=o.style)===null||l===void 0?void 0:l.zIndex)||e==="update"&&!("combo"in o))return;const d=this.getParentData(h,ge),f=d?((u=(c=d.style)===null||c===void 0?void 0:c.zIndex)!==null&&u!==void 0?u:0)+1:0;this.preventUpdateNodeLikeHierarchy(()=>{this.updateComboData([{id:h,style:{zIndex:f}}])})}),i.forEach(o=>{var l,c,u;const h=K(o);if(e==="add"&&St((l=o.style)===null||l===void 0?void 0:l.zIndex)||e==="update"&&!("combo"in o)&&!("children"in o))return;let d=0;const f=this.getParentData(h,ge);if(f)d=(((c=f.style)===null||c===void 0?void 0:c.zIndex)||0)+1;else{const g=this.getParentData(h,vr);g&&(d=((u=g==null?void 0:g.style)===null||u===void 0?void 0:u.zIndex)||0)}this.preventUpdateNodeLikeHierarchy(()=>{this.updateNodeData([{id:h,style:{zIndex:d}}])})}),a.forEach(o=>{var l,c,u,h,d;if(St((l=o.style)===null||l===void 0?void 0:l.zIndex))return;let{id:f,source:g,target:v}=o;if(!f)f=K(o);else{const m=this.getEdgeDatum(f);g=m.source,v=m.target}if(!g||!v)return;const p=((u=(c=this.getNodeLikeDatum(g))===null||c===void 0?void 0:c.style)===null||u===void 0?void 0:u.zIndex)||0,y=((d=(h=this.getNodeLikeDatum(v))===null||h===void 0?void 0:h.style)===null||d===void 0?void 0:d.zIndex)||0;this.updateEdgeData([{id:K(o),style:{zIndex:Math.max(p,y)-1}}])})})}getFrontZIndex(t){var e;const n=this.getElementType(t),i=this.getElementDataById(t),a=this.getData();if(Object.assign(a,{[`${n}s`]:a[`${n}s`].filter(s=>K(s)!==t)}),n==="combo"&&!ir(i)){const s=new Set(this.getAncestorsData(t,ge).map(K));a.nodes=a.nodes.filter(o=>!s.has(K(o))),a.combos=a.combos.filter(o=>!s.has(K(o))),a.edges=a.edges.filter(({source:o,target:l})=>!s.has(o)&&!s.has(l))}return Math.max(((e=i.style)===null||e===void 0?void 0:e.zIndex)||0,0,...Object.values(a).flat().map(s=>{var o;return(((o=s==null?void 0:s.style)===null||o===void 0?void 0:o.zIndex)||0)+1}))}updateNodeLikeHierarchy(t){if(!this.enableUpdateNodeLikeHierarchy)return;const{model:e}=this;t.forEach(n=>{const i=K(n),a=cc(n);a!==void 0&&(e.hasTreeStructure(ge)||e.attachTreeStructure(ge),a===null&&this.refreshComboData(i),this.setParent(i,cc(n),ge));const s=n.children||[];if(s.length){e.hasTreeStructure(vr)||e.attachTreeStructure(vr);const o=s.filter(l=>e.hasNode(l));o.forEach(l=>this.setParent(l,i,vr)),o.length!==s.length&&this.updateNodeData([{id:i,children:o}])}})}preventUpdateNodeLikeHierarchy(t){this.enableUpdateNodeLikeHierarchy=!1,t(),this.enableUpdateNodeLikeHierarchy=!0}updateData(t){const{nodes:e,edges:n,combos:i}=t;this.batch(()=>{this.updateNodeData(e),this.updateComboData(i),this.updateEdgeData(n)}),this.computeZIndex(t,"update")}updateNodeData(t=[]){if(!t.length)return;const{model:e}=this;this.batch(()=>{const n=[];t.forEach(i=>{const a=K(i),s=yn(e.getNode(a));if(Ss(s,i))return;const o=Xi(s,i);this.pushChange({value:o,original:s,type:Oe.NodeUpdated}),e.mergeNodeData(a,o),n.push(o)}),this.updateNodeLikeHierarchy(n)}),this.computeZIndex({nodes:t},"update")}refreshData(){const{nodes:t,edges:e,combos:n}=this.getData();t.forEach(i=>{this.pushChange({value:i,original:i,type:Oe.NodeUpdated})}),e.forEach(i=>{this.pushChange({value:i,original:i,type:Oe.EdgeUpdated})}),n.forEach(i=>{this.pushChange({value:i,original:i,type:Oe.ComboUpdated})})}syncNodeLikeDatum(t){const{model:e}=this,n=K(t);if(!e.hasNode(n))return;const i=yn(e.getNode(n)),a=Xi(i,t);e.mergeNodeData(n,a)}syncEdgeDatum(t){const{model:e}=this,n=K(t);if(!e.hasEdge(n))return;const i=yn(e.getEdge(n)),a=Xi(i,t);e.mergeEdgeData(n,a)}updateEdgeData(t=[]){if(!t.length)return;const{model:e}=this;this.batch(()=>{t.forEach(n=>{const i=K(n),a=yn(e.getEdge(i));if(Ss(a,n))return;n.source&&a.source!==n.source&&e.updateEdgeSource(i,n.source),n.target&&a.target!==n.target&&e.updateEdgeTarget(i,n.target);const s=Xi(a,n);this.pushChange({value:s,original:a,type:Oe.EdgeUpdated}),e.mergeEdgeData(i,s)})}),this.computeZIndex({edges:t},"update")}updateComboData(t=[]){if(!t.length)return;const{model:e}=this;e.batch(()=>{const n=[];t.forEach(i=>{const a=K(i),s=yn(e.getNode(a));if(Ss(s,i))return;const o=Xi(s,i);this.pushChange({value:o,original:s,type:Oe.ComboUpdated}),e.mergeNodeData(a,o),n.push(o)}),this.updateNodeLikeHierarchy(n)}),this.computeZIndex({combos:t},"update")}setParent(t,e,n,i=!0){if(t===e)return;const a=this.getNodeLikeDatum(t),s=cc(a);if(s!==e&&n===ge){const o={id:t,combo:e};this.isCombo(t)?this.syncNodeLikeDatum(o):this.syncNodeLikeDatum(o)}this.model.setParent(t,e,n),i&&n===ge&&F3([s,e]).forEach(o=>{o!==void 0&&this.refreshComboData(o)})}refreshComboData(t){const e=this.getComboData([t])[0],n=this.getAncestorsData(t,ge);e&&this.pushChange({value:e,original:e,type:Oe.ComboUpdated}),n.forEach(i=>{this.pushChange({value:i,original:i,type:Oe.ComboUpdated})})}getElementPosition(t){const e=this.getElementDataById(t);return dn(e)}translateNodeLikeBy(t,e){this.isCombo(t)?this.translateComboBy(t,e):this.translateNodeBy(t,e)}translateNodeLikeTo(t,e){this.isCombo(t)?this.translateComboTo(t,e):this.translateNodeTo(t,e)}translateNodeBy(t,e){const n=this.getElementPosition(t),i=qt(n,[...e,0].slice(0,3));this.translateNodeTo(t,i)}translateNodeTo(t,e){const[n=0,i=0,a=0]=e;this.preventUpdateNodeLikeHierarchy(()=>{this.updateNodeData([{id:t,style:{x:n,y:i,z:a}}])})}translateComboBy(t,e){const[n=0,i=0,a=0]=e;if([n,i,a].some(isNaN)||[n,i,a].every(l=>l===0))return;const s=this.getComboData([t])[0];if(!s)return;const o=new Set;Ds(s,l=>{const c=K(l);if(o.has(c))return;o.add(c);const[u,h,d]=dn(l),f=Xi(l,{style:{x:u+n,y:h+i,z:d+a}});this.pushChange({value:f,original:l,type:this.isCombo(c)?Oe.ComboUpdated:Oe.NodeUpdated}),this.model.mergeNodeData(c,f)},l=>this.getChildrenData(K(l)),"BT")}translateComboTo(t,e){var n;if(e.some(isNaN))return;const[i=0,a=0,s=0]=e,o=(n=this.getComboData([t]))===null||n===void 0?void 0:n[0];if(!o)return;const[l,c,u]=dn(o),h=i-l,d=a-c,f=s-u;Ds(o,g=>{const v=K(g),[p,y,m]=dn(g),x=Xi(g,{style:{x:p+h,y:y+d,z:m+f}});this.pushChange({value:x,original:g,type:this.isCombo(v)?Oe.ComboUpdated:Oe.NodeUpdated}),this.model.mergeNodeData(v,x)},g=>this.getChildrenData(K(g)),"BT")}removeData(t){const{nodes:e,edges:n,combos:i}=t;this.batch(()=>{this.removeEdgeData(n),this.removeNodeData(e),this.removeComboData(i),this.latestRemovedComboIds=new Set(i)})}removeNodeData(t=[]){t.length&&this.batch(()=>{t.forEach(e=>{this.removeEdgeData(this.getRelatedEdgesData(e).map(K)),this.pushChange({value:this.getNodeData([e])[0],type:Oe.NodeRemoved}),this.removeNodeLikeHierarchy(e)}),this.model.removeNodes(t)})}removeEdgeData(t=[]){t.length&&(t.forEach(e=>this.pushChange({value:this.getEdgeData([e])[0],type:Oe.EdgeRemoved})),this.model.removeEdges(t))}removeComboData(t=[]){t.length&&this.batch(()=>{t.forEach(e=>{this.pushChange({value:this.getComboData([e])[0],type:Oe.ComboRemoved}),this.removeNodeLikeHierarchy(e),this.comboIds.delete(e)}),this.model.removeNodes(t)})}removeNodeLikeHierarchy(t){if(this.model.hasTreeStructure(ge)){const e=cc(this.getNodeLikeDatum(t));this.setParent(t,void 0,ge,!1),this.model.getChildren(t,ge).forEach(n=>{const i=yn(n),a=K(i);this.setParent(K(i),e,ge,!1);const s=Xi(i,{id:K(i),combo:e});this.pushChange({value:s,original:i,type:this.isCombo(a)?Oe.ComboUpdated:Oe.NodeUpdated}),this.model.mergeNodeData(K(i),s)}),Rt(e)||this.refreshComboData(e)}}getElementType(t){if(this.model.hasNode(t))return this.isCombo(t)?"combo":"node";if(this.model.hasEdge(t))return"edge";throw new Error(Ii(`Unknown element type of id: ${t}`))}destroy(){const{model:t}=this,e=t.getAllNodes(),n=t.getAllEdges();t.removeEdges(n.map(i=>i.id)),t.removeNodes(e.map(i=>i.id)),this.context={}}}var mo=function(r,t,e,n){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((n=n.apply(r,t||[])).next())})};class lK{constructor(t){this.elementMap={},this.shapeTypeMap={},this.paletteStyle={},this.defaultStyle={},this.stateStyle={},this.visibilityCache=new WeakMap,this.context=t}init(){this.initContainer()}initContainer(){if(!this.container||this.container.destroyed){const{canvas:t}=this.context;this.container=t.appendChild(new gn({className:"elements"}))}}emit(t,e){e.silence||hn(this.context.graph,t)}forEachElementData(t){Qa.forEach(e=>{const n=this.context.model.getElementsDataByType(e);t(e,n)})}getElementType(t,e){var n;const{options:i,graph:a}=this.context,s=((n=i[t])===null||n===void 0?void 0:n.type)||e.type;return s?typeof s=="string"?s:s.call(a,e):t==="edge"?"line":"circle"}getTheme(t){return PA(this.context.options)[t]||{}}getThemeStyle(t){return this.getTheme(t).style||{}}getThemeStateStyle(t,e){const{state:n={}}=this.getTheme(t);return Object.assign({},...e.map(i=>n[i]||{}))}computePaletteStyle(){const{options:t}=this.context;this.paletteStyle={},this.forEachElementData((e,n)=>{var i,a;const s=Object.assign({},Kx((i=this.getTheme(e))===null||i===void 0?void 0:i.palette),Kx((a=t[e])===null||a===void 0?void 0:a.palette));s!=null&&s.field&&Object.assign(this.paletteStyle,k5(n,s))})}getPaletteStyle(t,e){const n=this.paletteStyle[e];return n?t==="edge"?{stroke:n}:{fill:n}:{}}computeElementDefaultStyle(t,e){var n;const{options:i}=this.context,a=((n=i[t])===null||n===void 0?void 0:n.style)||{};"transform"in a&&Array.isArray(a.transform)&&(a.transform=[...a.transform]),this.defaultStyle[K(e.datum)]=Xx(a,e)}computeElementsDefaultStyle(t){const{graph:e}=this.context;this.forEachElementData((n,i)=>{const a=i.length;for(let s=0;s<a;s++){const o=i[s];(t===void 0||t.includes(K(o)))&&this.computeElementDefaultStyle(n,{datum:o,graph:e})}})}getDefaultStyle(t){return this.defaultStyle[t]||{}}getElementState(t){try{const{model:e}=this.context;return e.getElementState(t)}catch{return[]}}getElementStateStyle(t,e,n){var i,a;const{options:s}=this.context,o=((a=(i=s[t])===null||i===void 0?void 0:i.state)===null||a===void 0?void 0:a[e])||{};return Xx(o,n)}computeElementStatesStyle(t,e,n){this.stateStyle[K(n.datum)]=Object.assign({},...e.map(i=>this.getElementStateStyle(t,i,n)))}computeElementsStatesStyle(t){const{graph:e}=this.context;this.forEachElementData((n,i)=>{const a=i.length;for(let s=0;s<a;s++){const o=i[s];if(t===void 0||t.includes(K(o))){const l=this.getElementState(K(o));this.computeElementStatesStyle(n,l,{datum:o,graph:e})}}})}getStateStyle(t){return this.stateStyle[t]||{}}computeStyle(t,e){t&&["translate","zIndex"].includes(t)||(this.computePaletteStyle(),this.computeElementsDefaultStyle(e),this.computeElementsStatesStyle(e))}getElement(t){return this.elementMap[t]}getNodes(){return this.context.model.getNodeData().map(({id:t})=>this.elementMap[t])}getEdges(){return this.context.model.getEdgeData().map(t=>this.elementMap[K(t)])}getCombos(){return this.context.model.getComboData().map(({id:t})=>this.elementMap[t])}getElementComputedStyle(t,e){const n=K(e),i=this.getThemeStyle(t),a=this.getPaletteStyle(t,n),s=e.style||{},o=this.getDefaultStyle(n),l=this.getThemeStateStyle(t,this.getElementState(n)),c=this.getStateStyle(n),u=Object.assign({},i,a,s,o,l,c);if(t==="combo"){const h=this.context.model.getChildrenData(n),f=!!u.collapsed?[]:h.map(K).filter(g=>this.getElement(g));Object.assign(u,{childrenNode:f,childrenData:h})}return u}getDrawData(t){this.init();const e=this.computeChangesAndDrawData(t);if(!e)return null;const{type:n="draw",stage:i=n}=t;return this.markDestroyElement(e.drawData),this.computeStyle(i),{type:n,stage:i,data:e}}draw(t={animation:!0}){const e=this.getDrawData(t);if(!e)return;const{data:{drawData:{add:n,update:i,remove:a}}}=e;return this.destroyElements(a,t),this.createElements(n,t),this.updateElements(i,t),this.setAnimationTask(t,e)}preLayoutDraw(){return mo(this,arguments,void 0,function*(t={animation:!0}){var e,n;const i=this.getDrawData(t);if(!i)return;const{data:{drawData:a}}=i;yield(n=(e=this.context.layout)===null||e===void 0?void 0:e.preLayout)===null||n===void 0?void 0:n.call(e,a);const{add:s,update:o,remove:l}=a;return this.destroyElements(l,t),this.createElements(s,t),this.updateElements(o,t),this.setAnimationTask(t,i)})}setAnimationTask(t,e){const{animation:n,silence:i}=t,{data:{dataChanges:a,drawData:s},stage:o,type:l}=e;return this.context.animation.animate(n,i?{}:{before:()=>this.emit(new an(ft.BEFORE_DRAW,{dataChanges:a,animation:n,stage:o,render:l==="render"}),t),beforeAnimate:c=>this.emit(new Nr(ft.BEFORE_ANIMATE,tr.DRAW,c,s),t),afterAnimate:c=>this.emit(new Nr(ft.AFTER_ANIMATE,tr.DRAW,c,s),t),after:()=>this.emit(new an(ft.AFTER_DRAW,{dataChanges:a,animation:n,stage:o,render:l==="render",firstRender:this.context.graph.rendered===!1}),t)})}computeChangesAndDrawData(t){const{model:e}=this.context,n=e.getChanges(),i=vb(n);if(i.length===0)return null;const{NodeAdded:a=[],NodeUpdated:s=[],NodeRemoved:o=[],EdgeAdded:l=[],EdgeUpdated:c=[],EdgeRemoved:u=[],ComboAdded:h=[],ComboUpdated:d=[],ComboRemoved:f=[]}=Nu(i,y=>y.type),g=y=>new Map(y.map(m=>{const x=m.value;return[K(x),x]})),v={add:{nodes:g(a),edges:g(l),combos:g(h)},update:{nodes:g(s),edges:g(c),combos:g(d)},remove:{nodes:g(o),edges:g(u),combos:g(f)}},p=this.transformData(v,t);return e.clearChanges(),{dataChanges:n,drawData:p}}transformData(t,e){const n=this.context.transform.getTransformInstance();return Object.values(n).reduce((i,a)=>a.beforeDraw(i,e),t)}createElement(t,e,n){var i;const a=K(e);if(this.getElement(a))return;const o=this.getElementType(t,e),l=this.getElementComputedStyle(t,e),c=zi(t,o);if(!c)return wi.warn(`The element ${o} of ${t} is not registered.`);this.emit(new Es(ft.BEFORE_ELEMENT_CREATE,t,e),n);const u=this.container.appendChild(new c({id:a,context:this.context,style:l}));this.shapeTypeMap[a]=o,this.elementMap[a]=u;const{stage:h="enter"}=n;(i=this.context.animation)===null||i===void 0||i.add({element:u,elementType:t,stage:h,originalStyle:Object.assign({},u.attributes),updatedStyle:l},{after:()=>{var d;this.emit(new Es(ft.AFTER_ELEMENT_CREATE,t,e),n),(d=u.onCreate)===null||d===void 0||d.call(u)}})}createElements(t,e){const{nodes:n,edges:i,combos:a}=t;[["node",n],["combo",a],["edge",i]].forEach(([o,l])=>{l.forEach(c=>this.createElement(o,c,e))})}getUpdateStageStyle(t,e,n){const{stage:i="update"}=n;if(i==="translate")if(t==="node"||t==="combo"){const{style:{x:a=0,y:s=0,z:o=0}={}}=e;return{x:a,y:s,z:o}}else return{};return this.getElementComputedStyle(t,e)}updateElement(t,e,n){var i;const a=K(e),{stage:s="update"}=n,o=this.getElement(a);if(!o)return()=>null;this.emit(new Es(ft.BEFORE_ELEMENT_UPDATE,t,e),n);const l=this.getElementType(t,e),c=this.getUpdateStageStyle(t,e,n);this.shapeTypeMap[a]!==l&&(o.destroy(),delete this.shapeTypeMap[a],delete this.elementMap[a],this.createElement(t,e,{animation:!1,silence:!0}));const u=s!=="visibility"?s:c.visibility==="hidden"?"hide":"show";u==="hide"&&delete c.visibility,(i=this.context.animation)===null||i===void 0||i.add({element:o,elementType:t,stage:u,originalStyle:Object.assign({},o.attributes),updatedStyle:c},{before:()=>{const h=this.elementMap[a];s!=="collapse"&&Im(h,c),s==="visibility"&&(eK(h,"opacity")||tK(h,"opacity"),this.visibilityCache.set(h,u==="show"?"visible":"hidden"),u==="show"&&Za(h,"visible"))},after:()=>{var h;const d=this.elementMap[a];s==="collapse"&&Im(d,c),u==="hide"&&Za(d,this.visibilityCache.get(d)),this.emit(new Es(ft.AFTER_ELEMENT_UPDATE,t,e),n),(h=d.onUpdate)===null||h===void 0||h.call(d)}})}updateElements(t,e){const{nodes:n,edges:i,combos:a}=t;[["node",n],["combo",a],["edge",i]].forEach(([o,l])=>{l.forEach(c=>this.updateElement(o,c,e))})}markDestroyElement(t){Object.values(t.remove).forEach(e=>{e.forEach(n=>{const i=K(n),a=this.getElement(i);a&&Ez(a)})})}destroyElement(t,e,n){var i;const{stage:a="exit"}=n,s=K(e),o=this.elementMap[s];if(!o)return()=>null;this.emit(new Es(ft.BEFORE_ELEMENT_DESTROY,t,e),n),(i=this.context.animation)===null||i===void 0||i.add({element:o,elementType:t,stage:a,originalStyle:Object.assign({},o.attributes),updatedStyle:{}},{after:()=>{var l;this.clearElement(s),o.destroy(),(l=o.onDestroy)===null||l===void 0||l.call(o),this.emit(new Es(ft.AFTER_ELEMENT_DESTROY,t,e),n)}})}destroyElements(t,e){const{nodes:n,edges:i,combos:a}=t;[["combo",a],["edge",i],["node",n]].forEach(([o,l])=>{l.forEach(c=>this.destroyElement(o,c,e))})}clearElement(t){delete this.paletteStyle[t],delete this.defaultStyle[t],delete this.stateStyle[t],delete this.elementMap[t],delete this.shapeTypeMap[t]}alignLayoutResultToElement(t,e){var n,i;const a=(n=t.nodes)===null||n===void 0?void 0:n.find(s=>K(s)===e);if(a){const s=dn(this.context.model.getNodeLikeDatum(e)),o=dn(a),l=fe(s,o);(i=t.nodes)===null||i===void 0||i.forEach(c=>{var u,h,d;!((u=c.style)===null||u===void 0)&&u.x&&(c.style.x+=l[0]),!((h=c.style)===null||h===void 0)&&h.y&&(c.style.y+=l[1]),!((d=c.style)===null||d===void 0)&&d.z&&(c.style.z+=l[2]||0)})}}collapseNode(t,e){return mo(this,void 0,void 0,function*(){var n;const{animation:i}=e,{model:a}=this.context,s=this.computeChangesAndDrawData({stage:"collapse",animation:i});if(!s)return;const{drawData:o}=s,{add:l,remove:c,update:u}=o;this.markDestroyElement(o);const h={animation:i,stage:"collapse",data:o};this.destroyElements(c,h),this.createElements(l,h),this.updateElements(u,h),yield(n=this.context.animation.animate(i,{beforeAnimate:d=>this.emit(new Nr(ft.BEFORE_ANIMATE,tr.COLLAPSE,d,o),h),afterAnimate:d=>this.emit(new Nr(ft.AFTER_ANIMATE,tr.COLLAPSE,d,o),h)},{collapse:{target:t,descendants:Array.from(c.nodes).map(([,d])=>K(d)),position:dn(u.nodes.get(t))}}))===null||n===void 0?void 0:n.finished})}expandNode(t,e){return mo(this,void 0,void 0,function*(){var n;const{model:i,layout:a}=this.context,{animation:s,align:o}=e,l=dn(i.getNodeData([t])[0]),c=this.computeChangesAndDrawData({stage:"expand",animation:s});if(this.createElements(c.drawData.add,{animation:!1,stage:"expand",target:t}),this.context.animation.clear(),this.computeStyle("expand"),!c)return;const{drawData:u}=c,{update:h,add:d}=u,f={animation:s,stage:"expand",data:u};d.edges.forEach(g=>h.edges.set(K(g),g)),d.nodes.forEach(g=>h.nodes.set(K(g),g)),this.updateElements(h,f),yield(n=this.context.animation.animate(s,{beforeAnimate:g=>this.emit(new Nr(ft.BEFORE_ANIMATE,tr.EXPAND,g,u),f),afterAnimate:g=>this.emit(new Nr(ft.AFTER_ANIMATE,tr.EXPAND,g,u),f)},{expand:{target:t,descendants:Array.from(d.nodes).map(([,g])=>K(g)),position:l}}))===null||n===void 0?void 0:n.finished})}collapseCombo(t,e){return mo(this,void 0,void 0,function*(){var n;const{model:i,element:a}=this.context;if(i.getAncestorsData(t,ge).some(v=>ir(v)))return;const s=a.getElement(t),o=s.getComboPosition(Object.assign(Object.assign({},s.attributes),{collapsed:!0})),l=this.computeChangesAndDrawData({stage:"collapse",animation:e});if(!l)return;const{dataChanges:c,drawData:u}=l;this.markDestroyElement(u);const{update:h,remove:d}=u,f={animation:e,stage:"collapse",data:u};this.destroyElements(d,f),this.updateElements(h,f);const g=v=>Array.from(v).map(([,p])=>K(p));yield(n=this.context.animation.animate(e,{before:()=>this.emit(new an(ft.BEFORE_DRAW,{dataChanges:c,animation:e}),f),beforeAnimate:v=>this.emit(new Nr(ft.BEFORE_ANIMATE,tr.COLLAPSE,v,u),f),afterAnimate:v=>this.emit(new Nr(ft.AFTER_ANIMATE,tr.COLLAPSE,v,u),f),after:()=>this.emit(new an(ft.AFTER_DRAW,{dataChanges:c,animation:e}),f)},{collapse:{target:t,descendants:[...g(d.nodes),...g(d.combos)],position:o}}))===null||n===void 0?void 0:n.finished})}expandCombo(t,e){return mo(this,void 0,void 0,function*(){var n;const{model:i}=this.context,a=dn(i.getComboData([t])[0]);this.computeStyle("expand");const s=this.computeChangesAndDrawData({stage:"expand",animation:e});if(!s)return;const{dataChanges:o,drawData:l}=s,{add:c,update:u}=l,h={animation:e,stage:"expand",data:l,target:t};this.createElements(c,h),this.updateElements(u,h);const d=f=>Array.from(f).map(([,g])=>K(g));yield(n=this.context.animation.animate(e,{before:()=>this.emit(new an(ft.BEFORE_DRAW,{dataChanges:o,animation:e}),h),beforeAnimate:f=>this.emit(new Nr(ft.BEFORE_ANIMATE,tr.EXPAND,f,l),h),afterAnimate:f=>this.emit(new Nr(ft.AFTER_ANIMATE,tr.EXPAND,f,l),h),after:()=>this.emit(new an(ft.AFTER_DRAW,{dataChanges:o,animation:e}),h)},{expand:{target:t,descendants:[...d(c.nodes),...d(c.combos)],position:a}}))===null||n===void 0?void 0:n.finished})}clear(){this.container.destroy(),this.initContainer(),this.elementMap={},this.shapeTypeMap={},this.defaultStyle={},this.stateStyle={},this.paletteStyle={}}destroy(){this.clear(),this.container.destroy(),this.context={}}}var _s=function(r,t,e,n){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((n=n.apply(r,t||[])).next())})},cK=function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(e[n[i]]=r[n[i]]);return e};class uK{get presetOptions(){return{animation:!!CA(this.context.options,!0)}}get options(){const{options:t}=this.context;return t.layout}constructor(t){this.instances=[],this.context=t}getLayoutInstance(){return this.instances}preLayout(t){return _s(this,void 0,void 0,function*(){var e,n,i,a;const{graph:s,model:o}=this.context,{add:l}=t;hn(s,new an(ft.BEFORE_LAYOUT,{type:"pre"}));const c=yield(e=this.context.layout)===null||e===void 0?void 0:e.simulate();(n=c==null?void 0:c.nodes)===null||n===void 0||n.forEach(u=>{const h=K(u),d=l.nodes.get(h);o.syncNodeLikeDatum(u),d&&Object.assign(d.style,u.style)}),(i=c==null?void 0:c.edges)===null||i===void 0||i.forEach(u=>{const h=K(u),d=l.edges.get(h);o.syncEdgeDatum(u),d&&Object.assign(d.style,u.style)}),(a=c==null?void 0:c.combos)===null||a===void 0||a.forEach(u=>{const h=K(u),d=l.combos.get(h);o.syncNodeLikeDatum(u),d&&Object.assign(d.style,u.style)}),hn(s,new an(ft.AFTER_LAYOUT,{type:"pre"})),this.transformDataAfterLayout("pre",t)})}postLayout(){return _s(this,arguments,void 0,function*(t=this.options){if(!t)return;const e=Array.isArray(t)?t:[t],{graph:n}=this.context;hn(n,new an(ft.BEFORE_LAYOUT,{type:"post"}));for(let i=0;i<e.length;i++){const a=e[i],s=this.getLayoutData(a),o=Object.assign(Object.assign({},this.presetOptions),a);hn(n,new an(ft.BEFORE_STAGE_LAYOUT,{options:o,index:i}));const l=yield this.stepLayout(s,o,i);hn(n,new an(ft.AFTER_STAGE_LAYOUT,{options:o,index:i})),a.animation||this.updateElementPosition(l,!1)}hn(n,new an(ft.AFTER_LAYOUT,{type:"post"})),this.transformDataAfterLayout("post")})}transformDataAfterLayout(t,e){const n=this.context.transform.getTransformInstance();Object.values(n).forEach(i=>i.afterLayout(t,e))}simulate(){return _s(this,void 0,void 0,function*(){if(!this.options)return{};const t=Array.isArray(this.options)?this.options:[this.options];let e={};for(let n=0;n<t.length;n++){const i=t[n],a=this.getLayoutData(i);e=yield this.stepLayout(a,Object.assign(Object.assign(Object.assign({},this.presetOptions),i),{animation:!1}),n)}return e})}stepLayout(t,e,n){return _s(this,void 0,void 0,function*(){return Az(e)?yield this.treeLayout(t,e,n):yield this.graphLayout(t,e,n)})}graphLayout(t,e,n){return _s(this,void 0,void 0,function*(){const{animation:i,enableWorker:a,iterations:s=300}=e,o=this.initGraphLayout(e);if(!o)return{};if(this.instances[n]=o,this.instance=o,a){const c=o;return this.supervisor=new y7(c.graphData2LayoutModel(t),c.instance,{iterations:s}),Fc(yield this.supervisor.execute())}if(Gm(o))return i?yield o.execute(t,{onTick:c=>{this.updateElementPosition(c,!1)}}):(o.execute(t),o.stop(),o.tick(s));const l=yield o.execute(t);if(i){const c=this.updateElementPosition(l,i);yield c==null?void 0:c.finished}return l})}treeLayout(t,e,n){return _s(this,void 0,void 0,function*(){const{type:i,animation:a}=e,s=zi("layout",i);if(!s)return{};const{nodes:o=[],edges:l=[]}=t,c=new vn({nodes:o.map(g=>({id:K(g),data:g.data||{}})),edges:l.map(g=>({id:K(g),source:g.source,target:g.target,data:g.data||{}}))});sK(c);const u={nodes:[],edges:[]},h={nodes:[],edges:[]};c.getRoots(vr).forEach(g=>{Ds(g,x=>{x.children=c.getSuccessors(x.id)},x=>c.getSuccessors(x.id),"TB");const v=s(g,e),{x:p,y,z:m=0}=v;Ds(v,x=>{const{id:E,x:_,y:M,z:O=0}=x;u.nodes.push({id:E,style:{x:p,y,z:m}}),h.nodes.push({id:E,style:{x:_,y:M,z:O}})},x=>x.children,"TB")});const f=this.inferTreeLayoutOffset(h);if(XT(h,f),a){XT(u,f),this.updateElementPosition(u,!1);const g=this.updateElementPosition(h,a);yield g==null?void 0:g.finished}return h})}inferTreeLayoutOffset(t){var e;let[n,i]=[1/0,-1/0],[a,s]=[1/0,-1/0];(e=t.nodes)===null||e===void 0||e.forEach(v=>{const{x:p=0,y=0}=v.style||{};n=Math.min(n,p),i=Math.max(i,p),a=Math.min(a,y),s=Math.max(s,y)});const{canvas:o}=this.context,l=o.getSize(),[c,u]=o.getCanvasByViewport([0,0]),[h,d]=o.getCanvasByViewport(l);if(n>=c&&i<=h&&a>=u&&s<=d)return[0,0];const f=(c+h)/2,g=(u+d)/2;return[f-(n+i)/2,g-(a+s)/2]}stopLayout(){this.instance&&Gm(this.instance)&&(this.instance.stop(),this.instance=void 0),this.supervisor&&(this.supervisor.stop(),this.supervisor=void 0),this.animationResult&&(this.animationResult.finish(),this.animationResult=void 0)}getLayoutData(t){const{nodeFilter:e=()=>!0,comboFilter:n=()=>!0,preLayout:i=!1,isLayoutInvisibleNodes:a=!1}=t,{nodes:s,edges:o,combos:l}=this.context.model.getData(),{element:c,model:u}=this.context,h=y=>c.getElement(y),d=i?y=>{var m;return!a&&(((m=y.style)===null||m===void 0?void 0:m.visibility)==="hidden"||u.getAncestorsData(y.id,vr).some(ir)||u.getAncestorsData(y.id,ge).some(ir))?!1:e(y)}:y=>{const m=K(y),x=h(m);return!x||yl(x)?!1:e(y)},f=s.filter(d),g=l.filter(n),v=new Map(f.map(y=>[K(y),y]));g.forEach(y=>v.set(K(y),y));const p=o.filter(({source:y,target:m})=>v.has(y)&&v.has(m));return{nodes:f,edges:p,combos:g}}initGraphLayout(t){var e;const{element:n,viewport:i}=this.context,{type:a,enableWorker:s,animation:o,iterations:l}=t,c=cK(t,["type","enableWorker","animation","iterations"]),[u,h]=i.getCanvasSize(),d=[u/2,h/2],f=(e=t==null?void 0:t.nodeSize)!==null&&e!==void 0?e:(m=>{const x=n==null?void 0:n.getElement(m.id);return x?x.attributes.size:n==null?void 0:n.getElementComputedStyle("node",m).size}),g=zi("layout",a);if(!g)return wi.warn(`The layout of ${a} is not registered.`);const v=Object.getPrototypeOf(g.prototype)===th.prototype?g:Pz(g,this.context),p=new v(this.context),y={nodeSize:f,width:u,height:h,center:d};switch(p.id){case"d3-force":case"d3-force-3d":Object.assign(y,{center:{x:u/2,y:h/2,z:0}});break}return An(p.options,y,c),p}updateElementPosition(t,e){const{model:n,element:i}=this.context;return i?(n.updateData(t),i.draw({animation:e,silence:!0})):null}destroy(){var t;this.stopLayout(),this.context={},(t=this.supervisor)===null||t===void 0||t.kill(),this.supervisor=void 0,this.instance=void 0,this.instances=[],this.animationResult=void 0}}const XT=(r,t)=>{var e;const[n,i]=t;(e=r.nodes)===null||e===void 0||e.forEach(a=>{if(a.style){const{x:s=0,y:o=0}=a.style;a.style.x=s+n,a.style.y=o+i}else a.style={x:n,y:i}})};function hK(r){return[dK].reduce((e,n)=>n(e),r)}function dK(r){return!r.layout||Array.isArray(r.layout)||"preLayout"in r.layout||["antv-dagre","combo-combined","compact-box","circular","concentric","dagre","fishbone","grid","indented","mds","radial","random","snake","dendrogram","mindmap"].includes(r.layout.type)&&(r.layout.preLayout=!0),r}class fK extends A1{constructor(t){super(t),this.category="plugin",this.setPlugins(this.context.options.plugins||[])}setPlugins(t){this.setExtensions(t)}getPluginInstance(t){const e=this.extensionMap[t];if(e)return e;wi.warn(`Cannot find the plugin ${t}, will try to find it by type.`);const n=this.extensions.find(i=>i.type===t);if(n)return this.extensionMap[n.key]}}const Cc=["update-related-edges","collapse-expand-node","collapse-expand-combo","get-edge-actual-ends","arrange-draw-order"];class gK extends A1{constructor(t){super(t),this.category="transform",this.setTransforms(this.context.options.transforms||[])}getTransforms(){}setTransforms(t){this.setExtensions([...Cc.slice(0,Cc.length-1),...t,Cc[Cc.length-1]])}getTransformInstance(t){return t?this.extensionMap[t]:this.extensionMap}}var bo=function(r,t,e,n){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((n=n.apply(r,t||[])).next())})};class vK{get padding(){return Lr(this.context.options.padding)}get paddingOffset(){const[t,e,n,i]=this.padding,[a,s,o]=[(i-e)/2,(t-n)/2,0];return[a,s,o]}constructor(t){this.landmarkCounter=0,this.context=t;const[e,n]=this.paddingOffset,{zoom:i,rotation:a,x:s=e,y:o=n}=t.options;this.transform({mode:"absolute",scale:i,translate:[s,o],rotate:a},!1)}get camera(){const{canvas:t}=this.context;return new Proxy(t.getCamera(),{get:(e,n)=>{const a=Object.entries(t.getLayers()).filter(([o])=>!["main"].includes(o)).map(([,o])=>o.getCamera()),s=e[n];if(typeof s=="function")return(...o)=>{const l=s.apply(e,o);return a.forEach(c=>{c[n].apply(c,o)}),l}}})}createLandmark(t){return this.camera.createLandmark(`landmark-${this.landmarkCounter++}`,t)}getAnimation(t){const e=CA(this.context.options,t);return e?Ya(Object.assign({},e),["easing","duration"]):!1}getCanvasSize(){const{canvas:t}=this.context,{width:e=0,height:n=0}=t.getConfig();return[e,n]}getCanvasCenter(){const{canvas:t}=this.context,{width:e=0,height:n=0}=t.getConfig();return[e/2,n/2,0]}getViewportCenter(){const[t,e]=this.camera.getPosition();return[t,e,0]}getGraphCenter(){return this.context.graph.getViewportByCanvas(this.getCanvasCenter())}getZoom(){return this.camera.getZoom()}getRotation(){return this.camera.getRoll()}getTranslateOptions(t){const{camera:e}=this,{mode:n,translate:i=[]}=t,a=this.getZoom(),s=e.getPosition(),o=e.getFocalPoint(),[l,c]=this.getCanvasCenter(),[u=0,h=0,d=0]=i,f=Xr([-u,-h,-d],a);return n==="relative"?{position:qt(s,f),focalPoint:qt(o,f)}:{position:qt([l,c,s[2]],f),focalPoint:qt([l,c,o[2]],f)}}getRotateOptions(t){const{mode:e,rotate:n=0}=t;return{roll:e==="relative"?this.camera.getRoll()+n:n}}getZoomOptions(t){const{zoomRange:e}=this.context.options,n=this.camera.getZoom(),{mode:i,scale:a=1}=t;return qe(i==="relative"?n*a:a,...e)}transform(t,e){return bo(this,void 0,void 0,function*(){const{graph:n}=this.context,{translate:i,rotate:a,scale:s,origin:o}=t;this.cancelAnimation();const l=this.getAnimation(e);if(hn(n,new Pc(ft.BEFORE_TRANSFORM,t)),!a&&s&&!i&&o&&!l){this.camera.setZoomByViewportPoint(this.getZoomOptions(t),o),hn(n,new Pc(ft.AFTER_TRANSFORM,t));return}const c={};if(i&&Object.assign(c,this.getTranslateOptions(t)),St(a)&&Object.assign(c,this.getRotateOptions(t)),St(s)&&Object.assign(c,{zoom:this.getZoomOptions(t)}),l)return hn(n,new Nr(ft.BEFORE_ANIMATE,tr.TRANSFORM,null,t)),new Promise(u=>{this.transformResolver=u,this.camera.gotoLandmark(this.createLandmark(c),Object.assign(Object.assign({},l),{onfinish:()=>{hn(n,new Nr(ft.AFTER_ANIMATE,tr.TRANSFORM,null,t)),hn(n,new Pc(ft.AFTER_TRANSFORM,t)),this.transformResolver=void 0,u()}}))});this.camera.gotoLandmark(this.createLandmark(c),{duration:0}),hn(n,new Pc(ft.AFTER_TRANSFORM,t))})}fitView(t,e){return bo(this,void 0,void 0,function*(){const[n,i,a,s]=this.padding,{when:o="always",direction:l="both"}=t||{},[c,u]=this.context.canvas.getSize(),h=c-s-i,d=u-n-a,f=this.context.canvas.getBounds(),g=this.getBBoxInViewport(f),[v,p]=ya(g),y=l==="x"&&v>=h||l==="y"&&p>=d||l==="both"&&v>=h&&p>=d;if(o==="overflow"&&!y)return yield this.fitCenter({animation:e});const m=h/v,x=d/p,E=l==="x"?m:l==="y"?x:Math.min(m,x),_=this.getAnimation(e);Number.isFinite(E)&&(yield this.transform({mode:"relative",scale:E,translate:qt(fe(this.getCanvasCenter(),this.getBBoxInViewport(f).center),Xr(this.paddingOffset,E))},_))})}fitCenter(t){return bo(this,void 0,void 0,function*(){const e=this.context.canvas.getBounds();yield this.focus(e,t)})}focusElements(t){return bo(this,arguments,void 0,function*(e,n={}){const{element:i}=this.context;if(!i)return;const a=o=>n.shapes?o.getShape(n.shapes).getRenderBounds():o.getRenderBounds(),s=hl(e.map(o=>a(i.getElement(o))));yield this.focus(s,n)})}focus(t,e){return bo(this,void 0,void 0,function*(){const n=this.context.graph.getViewportByCanvas(t.center),i=e.position||this.getCanvasCenter(),a=fe(i,n);yield this.transform({mode:"relative",translate:qt(a,this.paddingOffset)},e.animation)})}getBBoxInViewport(t){const{min:e,max:n}=t,{graph:i}=this.context,[a,s]=i.getViewportByCanvas(e),[o,l]=i.getViewportByCanvas(n),c=new be;return c.setMinMax([a,s,0],[o,l,0]),c}isInViewport(t,e=!1,n=0){const{graph:i}=this.context,a=this.getCanvasSize(),[s,o]=i.getCanvasByViewport([0,0]),[l,c]=i.getCanvasByViewport(a);let u=new be;return u.setMinMax([s,o,0],[l,c,0]),n&&(u=ma(u,n)),$s(t)?Hr(t,u):e?LB(t,u):u.intersects(t)}cancelAnimation(){var t,e;!((t=this.camera.landmarks)===null||t===void 0)&&t.length&&this.camera.cancelLandmarkAnimation(),(e=this.transformResolver)===null||e===void 0||e.call(this)}}var me=function(r,t,e,n){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((n=n.apply(r,t||[])).next())})};class id extends Qu{constructor(t){var e;super(),this.options={},this.rendered=!1,this.destroyed=!1,this.context={model:new oK},this.isCollapsingExpanding=!1,this.onResize=al(()=>{this.resize()},300),this._setOptions(Object.assign({},id.defaultOptions,t),!0),this.context.graph=this,this.options.autoResize&&((e=globalThis.addEventListener)===null||e===void 0||e.call(globalThis,"resize",this.onResize))}getOptions(){return this.options}setOptions(t){this._setOptions(t,!1)}_setOptions(t,e){if(this.updateCanvas(t),Object.assign(this.options,hK(t)),e){const{data:d}=t;d&&this.addData(d);return}const{behaviors:n,combo:i,data:a,edge:s,layout:o,node:l,plugins:c,theme:u,transforms:h}=t;n&&this.setBehaviors(n),a&&this.setData(a),l&&this.setNode(l),s&&this.setEdge(s),i&&this.setCombo(i),o&&this.setLayout(o),u&&this.setTheme(u),c&&this.setPlugins(c),h&&this.setTransforms(h)}getSize(){return this.context.canvas?this.context.canvas.getSize():[this.options.width||0,this.options.height||0]}setSize(t,e){t&&(this.options.width=t),e&&(this.options.height=e),this.resize(t,e)}setZoomRange(t){this.options.zoomRange=t}getZoomRange(){return this.options.zoomRange}setNode(t){this.options.node=t,this.context.model.refreshData()}setEdge(t){this.options.edge=t,this.context.model.refreshData()}setCombo(t){this.options.combo=t,this.context.model.refreshData()}getTheme(){return this.options.theme}setTheme(t){this.options.theme=Tt(t)?t(this.getTheme()):t}setLayout(t){this.options.layout=Tt(t)?t(this.getLayout()):t}getLayout(){return this.options.layout}setBehaviors(t){var e;this.options.behaviors=Tt(t)?t(this.getBehaviors()):t,(e=this.context.behavior)===null||e===void 0||e.setBehaviors(this.options.behaviors)}updateBehavior(t){this.setBehaviors(e=>e.map(n=>typeof n=="object"&&n.key===t.key?Object.assign(Object.assign({},n),t):n))}getBehaviors(){return this.options.behaviors||[]}setPlugins(t){var e;this.options.plugins=Tt(t)?t(this.getPlugins()):t,(e=this.context.plugin)===null||e===void 0||e.setPlugins(this.options.plugins)}updatePlugin(t){this.setPlugins(e=>e.map(n=>typeof n=="object"&&n.key===t.key?Object.assign(Object.assign({},n),t):n))}getPlugins(){return this.options.plugins||[]}getPluginInstance(t){return this.context.plugin.getPluginInstance(t)}setTransforms(t){var e;this.options.transforms=Tt(t)?t(this.getTransforms()):t,(e=this.context.transform)===null||e===void 0||e.setTransforms(this.options.transforms)}updateTransform(t){this.setTransforms(e=>e.map(n=>typeof n=="object"&&n.key===t.key?Object.assign(Object.assign({},n),t):n)),this.context.model.refreshData()}getTransforms(){return this.options.transforms||[]}getData(){return this.context.model.getData()}hasNode(t){return this.context.model.hasNode(t)}hasEdge(t){return this.context.model.hasEdge(t)}hasCombo(t){return this.context.model.hasCombo(t)}getElementData(t){return Array.isArray(t)?t.map(e=>this.context.model.getElementDataById(e)):this.context.model.getElementDataById(t)}getNodeData(t){return t===void 0?this.context.model.getNodeData():Array.isArray(t)?this.context.model.getNodeData(t):this.context.model.getNodeLikeDatum(t)}getEdgeData(t){return t===void 0?this.context.model.getEdgeData():Array.isArray(t)?this.context.model.getEdgeData(t):this.context.model.getEdgeDatum(t)}getComboData(t){return t===void 0?this.context.model.getComboData():Array.isArray(t)?this.context.model.getComboData(t):this.context.model.getNodeLikeDatum(t)}setData(t){this.context.model.setData(Tt(t)?t(this.getData()):t)}addData(t){this.context.model.addData(Tt(t)?t(this.getData()):t)}addNodeData(t){this.context.model.addNodeData(Tt(t)?t(this.getNodeData()):t)}addEdgeData(t){this.context.model.addEdgeData(Tt(t)?t(this.getEdgeData()):t)}addComboData(t){this.context.model.addComboData(Tt(t)?t(this.getComboData()):t)}addChildrenData(t,e){this.context.model.addChildrenData(t,e)}updateData(t){this.context.model.updateData(Tt(t)?t(this.getData()):t)}updateNodeData(t){this.context.model.updateNodeData(Tt(t)?t(this.getNodeData()):t)}updateEdgeData(t){this.context.model.updateEdgeData(Tt(t)?t(this.getEdgeData()):t)}updateComboData(t){this.context.model.updateComboData(Tt(t)?t(this.getComboData()):t)}removeData(t){this.context.model.removeData(Tt(t)?t(this.getData()):t)}removeNodeData(t){this.context.model.removeNodeData(Tt(t)?t(this.getNodeData()):t)}removeEdgeData(t){this.context.model.removeEdgeData(Tt(t)?t(this.getEdgeData()):t)}removeComboData(t){this.context.model.removeComboData(Tt(t)?t(this.getComboData()):t)}getElementType(t){return this.context.model.getElementType(t)}getRelatedEdgesData(t,e="both"){return this.context.model.getRelatedEdgesData(t,e)}getNeighborNodesData(t){return this.context.model.getNeighborNodesData(t)}getAncestorsData(t,e){return this.context.model.getAncestorsData(t,e)}getParentData(t,e){return this.context.model.getParentData(t,e)}getChildrenData(t){return this.context.model.getChildrenData(t)}getDescendantsData(t){return this.context.model.getDescendantsData(t)}getElementDataByState(t,e){return this.context.model.getElementDataByState(t,e)}initCanvas(){return me(this,void 0,void 0,function*(){var t;if(this.context.canvas)return yield this.context.canvas.ready;const{container:e="container",width:n,height:i,renderer:a,cursor:s,background:o,canvas:l,devicePixelRatio:c=(t=globalThis.devicePixelRatio)!==null&&t!==void 0?t:1}=this.options;if(e instanceof $T)this.context.canvas=e,s&&e.setCursor(s),a&&e.setRenderer(a),yield e.ready;else{const u=ae(e)?document.getElementById(e):e,h=UT(u);this.emit(ft.BEFORE_CANVAS_INIT,{container:u,width:n,height:i});const d=Object.assign(Object.assign({},l),{container:u,width:n||h[0],height:i||h[1],background:o,renderer:a,cursor:s,devicePixelRatio:c}),f=new $T(d);this.context.canvas=f,yield f.ready,this.emit(ft.AFTER_CANVAS_INIT,{canvas:f})}})}updateCanvas(t){var e,n;const{renderer:i,cursor:a,height:s,width:o}=t,l=this.context.canvas;l&&(i&&(this.emit(ft.BEFORE_RENDERER_CHANGE,{renderer:this.options.renderer}),l.setRenderer(i),this.emit(ft.AFTER_RENDERER_CHANGE,{renderer:i})),a&&l.setCursor(a),(St(o)||St(s))&&this.setSize((e=o??this.options.width)!==null&&e!==void 0?e:0,(n=s??this.options.height)!==null&&n!==void 0?n:0))}initRuntime(){this.context.options=this.options,this.context.batch||(this.context.batch=new rK(this.context)),this.context.plugin||(this.context.plugin=new fK(this.context)),this.context.viewport||(this.context.viewport=new vK(this.context)),this.context.transform||(this.context.transform=new gK(this.context)),this.context.element||(this.context.element=new lK(this.context)),this.context.animation||(this.context.animation=new nK(this.context)),this.context.layout||(this.context.layout=new uK(this.context)),this.context.behavior||(this.context.behavior=new iK(this.context))}prepare(){return me(this,void 0,void 0,function*(){if(yield Promise.resolve(),this.destroyed){console.error(Ii("The graph instance has been destroyed"));return}yield this.initCanvas(),this.initRuntime()})}render(){return me(this,void 0,void 0,function*(){if(yield this.prepare(),hn(this,new an(ft.BEFORE_RENDER)),this.options.layout)if(!this.rendered&&Nz(this.options.layout)){const t=yield this.context.element.preLayoutDraw({type:"render"});yield Promise.all([t==null?void 0:t.finished,this.autoFit()])}else{const t=this.context.element.draw({type:"render"});yield Promise.all([t==null?void 0:t.finished,this.context.layout.postLayout()]),yield this.autoFit()}else{const t=this.context.element.draw({type:"render"});yield Promise.all([t==null?void 0:t.finished,this.autoFit()])}this.rendered=!0,hn(this,new an(ft.AFTER_RENDER))})}draw(){return me(this,void 0,void 0,function*(){var t;yield this.prepare(),yield(t=this.context.element.draw())===null||t===void 0?void 0:t.finished})}layout(t){return me(this,void 0,void 0,function*(){yield this.context.layout.postLayout(t)})}stopLayout(){this.context.layout.stopLayout()}clear(){return me(this,void 0,void 0,function*(){const{model:t,element:e}=this.context;t.setData({}),t.clearChanges(),e==null||e.clear()})}destroy(){var t;hn(this,new an(ft.BEFORE_DESTROY));const{layout:e,animation:n,element:i,model:a,canvas:s,behavior:o,plugin:l}=this.context;l==null||l.destroy(),o==null||o.destroy(),e==null||e.destroy(),n==null||n.destroy(),i==null||i.destroy(),a.destroy(),s==null||s.destroy(),this.options={},this.context={},this.off(),(t=globalThis.removeEventListener)===null||t===void 0||t.call(globalThis,"resize",this.onResize),this.destroyed=!0,hn(this,new an(ft.AFTER_DESTROY))}getCanvas(){return this.context.canvas}resize(t,e){var n;const i=UT((n=this.context.canvas)===null||n===void 0?void 0:n.getContainer()),a=[t||i[0],e||i[1]];if(!this.context.canvas)return;const s=this.context.canvas.getSize();Ge(a,s)||(hn(this,new an(ft.BEFORE_SIZE_CHANGE,{size:a})),this.context.canvas.resize(...a),hn(this,new an(ft.AFTER_SIZE_CHANGE,{size:a})))}fitView(t,e){return me(this,void 0,void 0,function*(){var n;yield(n=this.context.viewport)===null||n===void 0?void 0:n.fitView(t,e)})}fitCenter(t){return me(this,void 0,void 0,function*(){var e;yield(e=this.context.viewport)===null||e===void 0?void 0:e.fitCenter({animation:t})})}autoFit(){return me(this,void 0,void 0,function*(){const{autoFit:t}=this.context.options;if(t)if(ae(t))t==="view"?yield this.fitView():t==="center"&&(yield this.fitCenter());else{const{type:e,animation:n}=t;e==="view"?yield this.fitView(t.options,n):e==="center"&&(yield this.fitCenter(n))}})}focusElement(t,e){return me(this,void 0,void 0,function*(){var n;yield(n=this.context.viewport)===null||n===void 0?void 0:n.focusElements(Array.isArray(t)?t:[t],{animation:e})})}zoomBy(t,e,n){return me(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"relative",scale:t,origin:n},e)})}zoomTo(t,e,n){return me(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"absolute",scale:t,origin:n},e)})}getZoom(){return this.context.viewport.getZoom()}rotateBy(t,e,n){return me(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"relative",rotate:t,origin:n},e)})}rotateTo(t,e,n){return me(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"absolute",rotate:t,origin:n},e)})}getRotation(){return this.context.viewport.getRotation()}translateBy(t,e){return me(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"relative",translate:t},e)})}translateTo(t,e){return me(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"absolute",translate:t},e)})}getPosition(){return fe([0,0],this.getCanvasByViewport([0,0]))}translateElementBy(t,e){return me(this,arguments,void 0,function*(n,i,a=!0){var s,o;const[l,c]=Ze(n)?[n,(s=i)!==null&&s!==void 0?s:!0]:[{[n]:i},a];Object.entries(l).forEach(([u,h])=>this.context.model.translateNodeLikeBy(u,h)),yield(o=this.context.element.draw({animation:c,stage:"translate"}))===null||o===void 0?void 0:o.finished})}translateElementTo(t,e){return me(this,arguments,void 0,function*(n,i,a=!0){var s,o;const[l,c]=Ze(n)?[n,(s=i)!==null&&s!==void 0?s:!0]:[{[n]:i},a];Object.entries(l).forEach(([u,h])=>this.context.model.translateNodeLikeTo(u,h)),yield(o=this.context.element.draw({animation:c,stage:"translate"}))===null||o===void 0?void 0:o.finished})}getElementPosition(t){return this.context.model.getElementPosition(t)}getElementRenderStyle(t){return h1(this.context.element.getElement(t).attributes,["context"])}setElementVisibility(t,e){return me(this,arguments,void 0,function*(n,i,a=!0){var s,o;const[l,c]=Ze(n)?[n,(s=i)!==null&&s!==void 0?s:!0]:[{[n]:i},a],u={nodes:[],edges:[],combos:[]};Object.entries(l).forEach(([f,g])=>{const v=this.getElementType(f);u[`${v}s`].push({id:f,style:{visibility:g}})});const{model:h,element:d}=this.context;h.preventUpdateNodeLikeHierarchy(()=>{h.updateData(u)}),yield(o=d.draw({animation:c,stage:"visibility"}))===null||o===void 0?void 0:o.finished})}showElement(t,e){return me(this,void 0,void 0,function*(){const n=Array.isArray(t)?t:[t];yield this.setElementVisibility(Object.fromEntries(n.map(i=>[i,"visible"])),e)})}hideElement(t,e){return me(this,void 0,void 0,function*(){const n=Array.isArray(t)?t:[t];yield this.setElementVisibility(Object.fromEntries(n.map(i=>[i,"hidden"])),e)})}getElementVisibility(t){var e,n;const i=this.context.element.getElement(t);return(n=(e=i==null?void 0:i.style)===null||e===void 0?void 0:e.visibility)!==null&&n!==void 0?n:"visible"}setElementZIndex(t,e){return me(this,void 0,void 0,function*(){var n;const i={nodes:[],edges:[],combos:[]},a=Ze(t)?t:{[t]:e};Object.entries(a).forEach(([l,c])=>{const u=this.getElementType(l);i[`${u}s`].push({id:l,style:{zIndex:c}})});const{model:s,element:o}=this.context;s.preventUpdateNodeLikeHierarchy(()=>s.updateData(i)),yield(n=o.draw({animation:!1,stage:"zIndex"}))===null||n===void 0?void 0:n.finished})}frontElement(t){return me(this,void 0,void 0,function*(){const e=Array.isArray(t)?t:[t],{model:n}=this.context,i={};e.map(a=>{const s=n.getFrontZIndex(a);if(n.getElementType(a)==="combo"){const l=n.getAncestorsData(a,ge).at(-1)||this.getComboData(a),c=[l,...n.getDescendantsData(K(l))],u=s-YT(l);c.forEach(d=>{i[K(d)]=this.getElementZIndex(K(d))+u});const{internal:h}=Rm(c.map(K),d=>n.getRelatedEdgesData(d));h.forEach(d=>{const f=K(d);i[f]=this.getElementZIndex(f)+u})}else i[a]=s}),yield this.setElementZIndex(i)})}getElementZIndex(t){return YT(this.context.model.getElementDataById(t))}setElementState(t,e){return me(this,arguments,void 0,function*(n,i,a=!0){var s,o;const[l,c]=Ze(n)?[n,(s=i)!==null&&s!==void 0?s:!0]:[{[n]:i},a],u=d=>d?Array.isArray(d)?d:[d]:[],h={nodes:[],edges:[],combos:[]};Object.entries(l).forEach(([d,f])=>{const g=this.getElementType(d);h[`${g}s`].push({id:d,states:u(f)})}),this.updateData(h),yield(o=this.context.element.draw({animation:c,stage:"state"}))===null||o===void 0?void 0:o.finished})}getElementState(t){return this.context.model.getElementState(t)}getElementRenderBounds(t){return this.context.element.getElement(t).getRenderBounds()}collapseElement(t){return me(this,arguments,void 0,function*(e,n=!0){const{model:i,element:a}=this.context;if(ir(i.getNodeLikeData([e])[0])||this.isCollapsingExpanding)return;typeof n=="boolean"&&(n={animation:n,align:!0});const s=i.getElementType(e);yield this.frontElement(e),this.isCollapsingExpanding=!0,i.updateData(s==="node"?{nodes:[{id:e,style:{collapsed:!0}}]}:{combos:[{id:e,style:{collapsed:!0}}]}),s==="node"?yield a.collapseNode(e,n):s==="combo"&&(yield a.collapseCombo(e,!!n.animation)),this.isCollapsingExpanding=!1})}expandElement(t){return me(this,arguments,void 0,function*(e,n=!0){const{model:i,element:a}=this.context;if(!ir(i.getNodeLikeData([e])[0])||this.isCollapsingExpanding)return;typeof n=="boolean"&&(n={animation:n,align:!0});const s=i.getElementType(e);this.isCollapsingExpanding=!0,i.updateData(s==="node"?{nodes:[{id:e,style:{collapsed:!1}}]}:{combos:[{id:e,style:{collapsed:!1}}]}),s==="node"?yield a.expandNode(e,n):s==="combo"&&(yield a.expandCombo(e,!!n.animation)),this.isCollapsingExpanding=!1})}setElementCollapsibility(t,e){const n=this.getElementType(t);n==="node"?this.updateNodeData([{id:t,style:{collapsed:e}}]):n==="combo"&&this.updateComboData([{id:t,style:{collapsed:e}}])}toDataURL(){return me(this,arguments,void 0,function*(t={}){return this.context.canvas.toDataURL(t)})}getCanvasByViewport(t){return this.context.canvas.getCanvasByViewport(t)}getViewportByCanvas(t){return this.context.canvas.getViewportByCanvas(t)}getClientByCanvas(t){return this.context.canvas.getClientByCanvas(t)}getCanvasByClient(t){return this.context.canvas.getCanvasByClient(t)}getViewportCenter(){return this.context.viewport.getViewportCenter()}getCanvasCenter(){return this.context.viewport.getCanvasCenter()}on(t,e,n){return super.on(t,e,n)}once(t,e){return super.once(t,e)}off(t,e){return super.off(t,e)}}id.defaultOptions={autoResize:!1,theme:"light",rotation:0,zoom:1,zoomRange:[.01,10]};class pK extends Ea{beforeDraw(t){const{add:e,update:n}=t,{model:i}=this.context;return[...e.edges.entries(),...n.edges.entries()].forEach(([,a])=>{uR(i,a)}),t}}const uR=(r,t)=>{const{source:e,target:n}=t,i=r.getElementDataById(e),a=r.getElementDataById(n),s=lw(i,h=>r.getParentData(h,ge)),o=lw(a,h=>r.getParentData(h,ge)),l=K(s),c=K(o),u={sourceNode:l,targetNode:c};return t.style?Object.assign(t.style,u):t.style=u,t},yK=(r,t,e)=>{const[n,i]=t,[a,s]=e;if(i===n)return a;const o=(r-n)/(i-n);return a+o*(s-a)},mK=(r,t,e)=>{const[n,i]=t,[a,s]=e,o=Math.log(r-n+1)/Math.log(i-n+1);return a+o*(s-a)},bK=(r,t,e,n=2)=>{const[i,a]=t,[s,o]=e,l=Math.pow((r-i)/(a-i),n);return s+l*(o-s)},xK=(r,t,e)=>{const[n,i]=t,[a,s]=e,o=Math.sqrt((r-n)/(i-n));return a+o*(s-a)};class ad extends Ea{constructor(t,e){super(t,An({},ad.defaultOptions,e)),this.assignSizeByCentrality=(n,i,a,s,o,l)=>{const c=[i,a],u=[s[0],o[0]],h=[s[1],o[1]],d=[s[2],o[2]],f=(g,v)=>{if(typeof l=="function")return l(g,c,v);switch(l){case"linear":return yK(g,c,v);case"log":return mK(g,c,v);case"pow":return bK(g,c,v,2);case"sqrt":return xK(g,c,v);default:return v[0]}};return[f(n,u),f(n,h),f(n,d)]}}beforeDraw(t){const{model:e}=this.context,n=e.getNodeData(),i=br(this.options.maxSize),a=br(this.options.minSize),s=this.getCentralities(this.options.centrality),o=s.size>0?Math.max(...s.values()):0,l=s.size>0?Math.min(...s.values()):0;return n.forEach(c=>{var u;const h=this.assignSizeByCentrality(s.get(K(c))||0,l,o,a,i,this.options.scale),d=(u=this.context.element)===null||u===void 0?void 0:u.getElement(K(c)),f={size:h};this.assignLabelStyle(f,h,c,d),(!d||!Wc(f,d.attributes))&&mr(t,d?"update":"add","node",An(c,{style:f}),!0)}),t}assignLabelStyle(t,e,n,i){var a;const s=i?i.config.style:(a=this.context.element)===null||a===void 0?void 0:a.getElementComputedStyle("node",n);if(Object.assign(t,Ya(s,["labelFontSize","labelLineHeight"])),this.options.mapLabelSize){const o=this.getLabelSizeByNodeSize(e,1/0,Number(t.labelFontSize));Object.assign(t,{labelFontSize:o,labelLineHeight:o+RB(t.labelPadding)})}return t}getLabelSizeByNodeSize(t,e,n){const i=Math.min(...t)/2,[a,s]=Array.isArray(this.options.mapLabelSize)?this.options.mapLabelSize:[n,e];return Math.min(s,Math.max(i,a))}getCentralities(t){const{model:e}=this.context,n=e.getData();if(typeof t=="function")return t(n);const i=e.getRelatedEdgesData.bind(e);return $A(n,i,t)}}ad.defaultOptions={centrality:{type:"degree"},maxSize:80,minSize:20,scale:"linear",mapLabelSize:!1};class sd extends Ea{constructor(t,e){super(t,Object.assign({},sd.defaultOptions,e))}get ref(){return this.context.model.getRootsData()[0]}afterLayout(){var t;const e=dn(this.ref),{graph:n,model:i}=this.context;(t=i.getData().nodes)===null||t===void 0||t.forEach(s=>{var o;if(K(s)===K(this.ref))return;const l=VA(fe(dn(s),e)),c=Math.abs(l)>Math.PI/2,u=!s.children||s.children.length===0,h=K(s),d=(o=this.context.element)===null||o===void 0?void 0:o.getElement(h);if(!d||!d.isVisible())return;const f=br(n.getElementRenderStyle(h).size)[0]/2,g=(u?1:-1)*(f+this.options.offset),v=[["translate",g*Math.cos(l),g*Math.sin(l)],["rotate",c?nr(l)+180:nr(l)]];i.updateNodeData([{id:K(s),style:{labelTextAlign:c===u?"right":"left",labelTextBaseline:"middle",labelTransform:v}}])}),n.draw()}}sd.defaultOptions={offset:5};const wK="quadratic",KT=["top","top-right","right","right-bottom","bottom","bottom-left","left","left-top"];class od extends Ea{constructor(t,e){super(t,Object.assign({},od.defaultOptions,e)),this.cacheMergeStyle=new Map,this.getAffectedParallelEdges=n=>{const{add:{edges:i},update:{nodes:a,edges:s,combos:o},remove:{edges:l}}=n,{model:c}=this.context,u=new Map,h=(g,v)=>{c.getRelatedEdgesData(v).forEach(y=>!u.has(K(y))&&u.set(K(y),y))};a.forEach(h),o.forEach(h);const d=g=>{const v=new Set(n.remove.edges.keys()),p=c.getEdgeData().filter(y=>!v.has(K(y))).map(y=>uR(c,y));EK(g,p).forEach(y=>{const m=K(y);u.has(m)||u.set(m,y)})};if(l.size&&l.forEach(d),i.size&&i.forEach(d),s.size){const g=SC(vb(c.getChanges())).update.edges;s.forEach(v=>{var p;d(v);const y=(p=g.find(m=>K(m.value)===K(v)))===null||p===void 0?void 0:p.original;y&&!Nb(v,y)&&d(y)})}ui(this.options.edges)||u.forEach((g,v)=>!this.options.edges.includes(v)&&u.delete(v));const f=c.getEdgeData().map(K);return new Map([...u].sort((g,v)=>f.indexOf(g[0])-f.indexOf(v[0])))},this.applyBundlingStyle=(n,i,a)=>{const{edgeMap:s,reverses:o}=ZT(i);s.forEach(l=>{l.forEach((c,u,h)=>{var d;const f=h.length,g=c.style||{};if(c.source===c.target){const y=KT.length;g.loopPlacement=KT[u%y],g.loopDist=Math.floor(u/y)*a+50}else if(f===1)g.curveOffset=0;else{const y=(u%2===0?1:-1)*(o[`${c.source}|${c.target}|${u}`]?-1:1);g.curveOffset=f%2===1?y*Math.ceil(u/2)*a*2:y*(Math.floor(u/2)*a*2+a)}const v=Object.assign(c,{type:wK,style:g}),p=(d=this.context.element)===null||d===void 0?void 0:d.getElement(K(c));(!p||!Wc(v.style,p.attributes))&&mr(n,p?"update":"add","edge",v,!0)})})},this.resetEdgeStyle=n=>{const i=n.style||{},a=this.cacheMergeStyle.get(K(n))||{};return Object.keys(a).forEach(s=>{Ge(i[s],a[s])&&(n[s]?i[s]=n[s]:delete i[s])}),Object.assign(n,{style:i})},this.applyMergingStyle=(n,i)=>{const{edgeMap:a,reverses:s}=ZT(i);a.forEach(o=>{var l;if(o.length===1){const u=o[0],h=(l=this.context.element)===null||l===void 0?void 0:l.getElement(K(u)),d=this.resetEdgeStyle(u);(!h||!Wc(d,h.attributes))&&mr(n,h?"update":"add","edge",d);return}const c=o.map(({source:u,target:h,style:d={}},f)=>{const{startArrow:g,endArrow:v}=d,p={},[y,m]=s[`${u}|${h}|${f}`]?["endArrow","startArrow"]:["startArrow","endArrow"];return qo(g)&&(p[y]=g),qo(v)&&(p[m]=v),p}).reduce((u,h)=>Object.assign(Object.assign({},u),h),{});o.forEach((u,h,d)=>{var f;if(h!==0){mr(n,"remove","edge",u);return}const g=Object.assign({},Tt(this.options.style)?this.options.style(d):this.options.style,{childrenData:d});this.cacheMergeStyle.set(K(u),g);const v=Object.assign(Object.assign({},u),{type:"line",style:Object.assign(Object.assign(Object.assign({},u.style),c),g)}),p=(f=this.context.element)===null||f===void 0?void 0:f.getElement(K(u));(!p||!Wc(v.style,p.attributes))&&mr(n,p?"update":"add","edge",v,!0)})})}}beforeDraw(t){const e=this.getAffectedParallelEdges(t);return e.size===0||(this.options.mode==="bundle"?this.applyBundlingStyle(t,e,this.options.distance):this.applyMergingStyle(t,e)),t}}od.defaultOptions={mode:"bundle",distance:15};const ZT=r=>{const t=new Map,e=new Set,n={},i=new Map;for(const[a,s]of r){if(e.has(a))continue;const{source:o,target:l}=s,c=`${o}-${l}`;t.has(c)||(t.set(c,[]),i.set(c,new Set));const u=t.get(c),h=i.get(c);u&&h&&!h.has(a)&&(u.push(s),h.add(a),e.add(a));for(const[d,f]of r)if(!(e.has(d)||d===a)&&Nb(s,f)){const g=t.get(c),v=i.get(c);g&&v&&!v.has(d)&&(g.push(f),v.add(d),o===f.target&&l===f.source&&(n[`${f.source}|${f.target}|${g.length-1}`]=!0),e.add(d))}}return{edgeMap:t,reverses:n}},EK=(r,t,e)=>t.filter(n=>Nb(n,r)),Nb=(r,t)=>{const{sourceNode:e,targetNode:n}=r.style||{},{sourceNode:i,targetNode:a}=t.style||{};return e===i&&n===a||e===a&&n===i};class SK extends Ea{beforeDraw(t,e){const{stage:n}=e;if(n==="visibility")return t;const{model:i}=this.context,{update:{nodes:a,edges:s,combos:o}}=t,l=(c,u)=>{i.getRelatedEdgesData(u).forEach(d=>!s.has(K(d))&&s.set(K(d),d))};return a.forEach(l),o.forEach(l),t}}const _K={animation:{"combo-collapse":DA,"combo-expand":NB,"node-collapse":LA,"node-expand":OB,"path-in":IA,"path-out":AB,fade:MB,translate:TB},behavior:{"brush-select":dl,"click-select":zu,"collapse-expand":Ku,"create-edge":Zu,"drag-canvas":Ju,"drag-element-force":Rz,"drag-element":ml,"fix-element-size":eh,"focus-element":nh,"hover-activate":rh,"lasso-select":Iz,"auto-adapt-label":Du,"optimize-viewport-transform":ih,"scroll-canvas":ah,"zoom-canvas":sh},combo:{circle:R4,rect:L4},edge:{cubic:ss,line:_N,polyline:Hu,quadratic:Xu,"cubic-horizontal":Vu,"cubic-radial":Uu,"cubic-vertical":Yu},layout:{"antv-dagre":F8,"combo-combined":H9,"compact-box":xc.compactBox,"d3-force":xq,"force-atlas2":BW,circular:j8,concentric:jm,dagre:Oh,dendrogram:xc.dendrogram,fishbone:Ah,force:QN,fruchterman:qW,grid:$W,indented:xc.indented,mds:eP,mindmap:xc.mindmap,radial:JW,random:a7,snake:Nh},node:{circle:vl,diamond:D5,ellipse:Gu,hexagon:q5,html:$u,image:yN,rect:P4,star:C4,donut:qu,triangle:Wu},palette:{spectral:w7,tableau:E7,oranges:S7,greens:_7,blues:k7},theme:{dark:$X,light:VX},plugin:{"bubble-sets":Rh,"edge-bundling":Ih,"edge-filter-lens":Dh,"grid-line":zh,background:Ph,contextmenu:Lh,fisheye:Fh,fullscreen:Bh,history:jh,hull:Gh,legend:Kh,minimap:Zh,snapline:Jh,timebar:Qh,title:AX,toolbar:td,tooltip:ed,watermark:nd},transform:{"arrange-draw-order":UX,"collapse-expand-combo":YX,"collapse-expand-node":HX,"get-edge-actual-ends":pK,"map-node-size":ad,"place-radial-labels":sd,"process-parallel-edges":od,"update-related-edges":SK},shape:{circle:mi,ellipse:cl,group:gn,html:rs,image:L1,line:Ka,path:pr,polygon:is,polyline:Lu,rect:Nn,text:as,label:xi,badge:Hs}};function kK(){Object.entries(_K).forEach(([r,t])=>{Object.entries(t).forEach(([e,n])=>{XX(r,e,n)})})}kK();const MK={class:"space-y-8"},TK={class:"rounded-3xl border border-gray-200 bg-white p-8 shadow-theme-md dark:border-gray-800 dark:bg-gray-900"},OK={class:"mt-4 flex flex-col gap-6 lg:flex-row lg:items-center lg:justify-between"},AK={class:"rounded-3xl border border-gray-200 bg-white p-6 dark:border-gray-800 dark:bg-gray-900"},NK={class:"flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between"},PK={class:"flex flex-wrap gap-3"},CK={class:"inline-flex items-center gap-2 text-sm text-gray-600 dark:text-gray-300"},RK={class:"inline-flex items-center gap-2 text-sm text-gray-600 dark:text-gray-300"},LK={class:"mt-5 grid gap-6 lg:grid-cols-12"},IK={class:"col-span-12 lg:col-span-8"},DK={class:"relative h-[480px] rounded-2xl bg-gradient-to-br from-indigo-50 via-white to-sky-50 p-2 dark:from-indigo-950 dark:via-gray-900 dark:to-slate-950"},FK={key:0,class:"absolute right-4 top-4 w-64 rounded-2xl border border-gray-200 bg-white/90 p-4 text-sm shadow-lg backdrop-blur dark:border-gray-700 dark:bg-gray-900/90"},BK={class:"flex items-start justify-between"},zK={class:"mt-1 text-lg font-semibold text-gray-900 dark:text-white"},jK={class:"text-xs text-gray-500 dark:text-gray-400"},qK={class:"mt-3 space-y-2 text-gray-700 dark:text-gray-200"},GK={class:"flex justify-between"},$K={class:"font-medium"},WK={class:"flex justify-between"},VK={class:"font-medium"},UK={class:"flex justify-between"},YK={class:"font-medium"},HK={class:"col-span-12 space-y-4 lg:col-span-4"},XK={class:"rounded-2xl border border-gray-200 bg-white p-5 shadow-sm dark:border-gray-800 dark:bg-gray-900"},KK={class:"mt-4 space-y-4"},ZK={class:"text-base font-medium text-gray-900 dark:text-white"},JK={class:"text-xs text-gray-500 dark:text-gray-400"},QK={class:"text-lg font-semibold text-gray-900 dark:text-white"},tZ={class:"rounded-2xl border border-gray-200 bg-white p-5 shadow-sm dark:border-gray-800 dark:bg-gray-900"},eZ={class:"mt-4 space-y-3"},nZ={class:"font-semibold text-gray-900 dark:text-white"},rZ={class:"grid gap-6 lg:grid-cols-12"},iZ={class:"col-span-12 rounded-3xl border border-gray-200 bg-white p-6 dark:border-gray-800 dark:bg-gray-900 lg:col-span-5"},aZ={class:"mt-4 space-y-3"},sZ={class:"text-base font-semibold text-gray-900 dark:text-white"},oZ={class:"text-sm"},lZ={class:"mt-2 text-xs text-gray-400"},cZ={class:"col-span-12 rounded-3xl border border-gray-200 bg-white p-6 dark:border-gray-800 dark:bg-gray-900 lg:col-span-7"},uZ={class:"mt-6 h-72 rounded-2xl border border-dashed border-gray-200 p-6 dark:border-gray-700"},hZ={class:"flex h-full flex-col justify-between"},dZ={class:"relative h-40"},fZ={class:"absolute inset-0"},EZ=MR({__name:"GraphInsight",setup(r){const t=ai(null),e=ai(null),n=ai({nodes:[],links:[]}),i=ai("12h"),a=ai(1e4),s=ai(null),o=ai(null),l=ai({visible:!1,x:0,y:0,content:""}),c=ai([{title:"Nodes",subtitle:"Live count",value:"--"},{title:"Edges",subtitle:"Live count",value:"--"},{title:"Avg degree",subtitle:"2E / N",value:"--"},{title:"Refresh rate",subtitle:"Configurable",value:"10 s"}]),u=ai([{title:"Supply chain latency (mock)",description:"09:20 node latency +32%, awaiting real alert feed",color:"bg-red-500"},{title:"Data fusion conflict (mock)",description:"External source mismatch, replace with real alert source",color:"bg-amber-400"},{title:"LLM degradation (mock)",description:"Confidence dropped, hook to eval service",color:"bg-emerald-400"}]),h=[{name:"Monitor energy-retail path",detail:"Verify anomalies vs new strategy and produce trace report.",owner:"Graph Ops"},{name:"Data fusion patch",detail:"Vote on conflicting attributes, keep fusion accuracy > 98%.",owner:"Data Fusion"},{name:"LLM tuning batch",detail:"Collect real questions and validate citation quality.",owner:"LLM Studio"}],d={default:"#2563eb",entity:"#1d4ed8",user:"#0ea5e9",event:"#f97316",risk:"#f43f5e"},f=N=>d[N||""]||d.default,g=N=>{if(!N||Number.isNaN(N))return{lineWidth:1.2,opacity:.6};const P=Math.max(.5,Math.min(N,5));return{lineWidth:1+P,opacity:.35+P*.1}},v=()=>{var C,R;const N=new Map;return(((R=(C=e.value)==null?void 0:C.getData())==null?void 0:R.nodes)||[]).forEach(I=>{N.set(String(I.id),{x:I.x,y:I.y})}),N},p=N=>{const P=N.nodes.length,C=N.links.length,R=P?(C*2/P).toFixed(1):"--";c.value=[{title:"Nodes",subtitle:"Live count",value:P||"--"},{title:"Edges",subtitle:"Live count",value:C||"--"},{title:"Avg degree",subtitle:"2E / N",value:R},{title:"Refresh rate",subtitle:"Configurable",value:`${a.value/1e3} s`}]},y=(N,P)=>{var H,Z;const C=((H=t.value)==null?void 0:H.clientWidth)||800,R=((Z=t.value)==null?void 0:Z.clientHeight)||600,I=Math.max(120,Math.min(C,R)/2.5),j=N.nodes.map((U,tt)=>{var gt,xt;return{id:String(U.id),data:U,x:((gt=P.get(String(U.id)))==null?void 0:gt.x)??C/2+I*Math.cos(2*Math.PI*tt/Math.max(N.nodes.length,1)),y:((xt=P.get(String(U.id)))==null?void 0:xt.y)??R/2+I*Math.sin(2*Math.PI*tt/Math.max(N.nodes.length,1)),style:{size:28,fill:f(U.type),stroke:"#0f172a",lineWidth:1.2,shadowColor:"rgba(59,130,246,0.4)",shadowBlur:12,labelText:U.name||`Node ${U.id}`,labelFill:"#0f172a",labelFontSize:12,labelFontWeight:600,labelPlacement:"bottom"}}}),G=N.links.map(U=>{const tt=g(U.weight);return{id:`${U.source}-${U.target}`,source:String(U.source),target:String(U.target),data:U,style:{stroke:"#1e293b",labelText:U.weight!=null?`w=${U.weight}`:"",endArrow:!0,...tt}}});return{nodes:j,edges:G}},m=()=>{const N=e.value;N&&(N.on("node:click",P=>{var G;const C=(G=P.item)==null?void 0:G.getModel();if(!C)return;const R=n.value.links.filter(H=>String(H.source)===C.id||String(H.target)===C.id),I=R.map(H=>H.weight||0),j=I.length?(I.reduce((H,Z)=>H+Z,0)/I.length).toFixed(2):"--";o.value={...C.data,id:C.id,degree:R.length,avgWeight:j}}),N.on("edge:mouseenter",P=>{var I,j;if(P.canvasX===void 0||P.canvasY===void 0)return;const C=(I=P.item)==null?void 0:I.getModel(),R=((j=C==null?void 0:C.data)==null?void 0:j.weight)??(C==null?void 0:C.weight)??"--";l.value={visible:!0,x:P.canvasX+12,y:P.canvasY+12,content:`Weight: ${R}`}}),N.on("edge:mouseleave",()=>{l.value={visible:!1,x:0,y:0,content:""}}))},x=()=>{if(!t.value)return;e.value&&(e.value.destroy(),e.value=null);const{clientWidth:N,clientHeight:P}=t.value;e.value=new id({container:t.value,width:N,height:P,autoFit:"view",padding:32,layout:{type:"force",preventOverlap:!0,damping:.88,maxIteration:500,animation:!0,stopThreshold:.5,linkDistance:200,nodeStrength:-120},behaviors:[{type:"drag-canvas",key:"drag-canvas"},{type:"drag-node",key:"drag-node"},{type:"zoom-canvas",key:"zoom-canvas"}],node:{style:{cursor:"pointer"}},edge:{style:{cursor:"pointer"}}}),m()},E=N=>{if(!e.value)return;const P=y(N,v());e.value.setData(P),e.value.render(),e.value.layout()},_=async()=>{try{const N=await fetch(`/graph/all?window=${i.value}`);if(!N.ok)throw new Error("request failed");const P=await N.json();n.value={nodes:P.nodes||[],links:P.links||[]}}catch(N){n.value={nodes:[{id:"u1",name:"User A",type:"user"},{id:"u2",name:"User B",type:"user"},{id:"p1",name:"Product X",type:"entity"},{id:"p2",name:"Product Y",type:"entity"},{id:"evt1",name:"Order",type:"event"},{id:"risk1",name:"Risk alert",type:"risk"}],links:[{source:"u1",target:"evt1",weight:.8},{source:"u2",target:"evt1",weight:.6},{source:"evt1",target:"p1",weight:1.2},{source:"evt1",target:"p2",weight:.5},{source:"u1",target:"risk1",weight:2.2},{source:"risk1",target:"p1",weight:1.6}]},console.warn("Using mock graph data because /graph/all failed:",N)}p(n.value),E(n.value)},M=()=>{_()},O=()=>{s.value&&clearInterval(s.value),s.value=window.setInterval(()=>{_()},a.value)},T=()=>{if(!t.value||!e.value)return;const{clientWidth:N,clientHeight:P}=t.value;e.value.setSize(N,P)};return TR(()=>{x(),_(),O(),window.addEventListener("resize",T)}),OR(()=>{var N;s.value&&clearInterval(s.value),window.removeEventListener("resize",T),(N=e.value)==null||N.destroy()}),Lb(a,()=>{c.value=c.value.map(N=>N.title==="Refresh rate"?{...N,value:`${a.value/1e3} s`}:N),O()}),Lb(i,()=>{_()}),(N,P)=>{const C=PR("router-link");return Ti(),AR(LR,null,{default:Ib(()=>[wt("div",MK,[wt("section",TK,[P[5]||(P[5]=wt("p",{class:"text-sm uppercase tracking-[0.4em] text-gray-400"}," Graph Insight Dashboard ",-1)),wt("div",OK,[P[4]||(P[4]=wt("div",null,[wt("h1",{class:"text-3xl font-semibold text-gray-900 dark:text-white"}," Graph insight overview "),wt("p",{class:"mt-3 max-w-3xl text-base text-gray-600 dark:text-gray-400"}," Track graph health across metrics, structure evolution and alerts; supports custom time windows and tags. ")],-1)),NR(C,{to:"/graph-chat",class:"inline-flex items-center justify-center rounded-2xl bg-gradient-to-r from-indigo-600 to-sky-500 px-6 py-3 font-semibold text-white shadow-lg transition hover:shadow-xl"},{default:Ib(()=>[...P[3]||(P[3]=[dd(" Open Graph QA -> ",-1)])]),_:1})])]),wt("section",AK,[wt("div",NK,[P[10]||(P[10]=wt("div",null,[wt("p",{class:"text-sm font-semibold text-gray-600 dark:text-gray-300"}," Structure evolution "),wt("p",{class:"text-xs text-emerald-500"},"Real-time refresh / source: /graph/all")],-1)),wt("div",PK,[wt("label",CK,[P[7]||(P[7]=dd(" Time window ",-1)),Db(wt("select",{"onUpdate:modelValue":P[0]||(P[0]=R=>i.value=R),class:"rounded-xl border border-gray-200 bg-white px-3 py-2 text-sm dark:border-gray-700 dark:bg-gray-800"},[...P[6]||(P[6]=[wt("option",{value:"1h"},"Last 1 hour",-1),wt("option",{value:"6h"},"Last 6 hours",-1),wt("option",{value:"12h"},"Last 12 hours",-1),wt("option",{value:"24h"},"Last 24 hours",-1)])],512),[[Fb,i.value]])]),wt("label",RK,[P[9]||(P[9]=dd(" Refresh ",-1)),Db(wt("select",{"onUpdate:modelValue":P[1]||(P[1]=R=>a.value=R),class:"rounded-xl border border-gray-200 bg-white px-3 py-2 text-sm dark:border-gray-700 dark:bg-gray-800"},[...P[8]||(P[8]=[wt("option",{value:5e3},"5 s",-1),wt("option",{value:1e4},"10 s",-1),wt("option",{value:3e4},"30 s",-1),wt("option",{value:6e4},"60 s",-1)])],512),[[Fb,a.value,void 0,{number:!0}]])]),wt("button",{class:"inline-flex items-center gap-2 rounded-xl bg-gradient-to-r from-indigo-600 to-sky-500 px-4 py-2 text-sm font-semibold text-white shadow-lg transition hover:shadow-xl",onClick:M}," Refresh now ")])]),wt("div",LK,[wt("div",IK,[wt("div",DK,[wt("div",{ref_key:"graphRef",ref:t,class:"h-full w-full rounded-xl bg-white/70 dark:bg-white/5"},null,512),o.value?(Ti(),Vi("div",FK,[wt("div",BK,[wt("div",null,[P[11]||(P[11]=wt("p",{class:"text-xs uppercase tracking-[0.2em] text-gray-400"},"Node detail",-1)),wt("p",zK,Zn(o.value.name),1),wt("p",jK,"Type: "+Zn(o.value.type||"unknown"),1)]),wt("button",{class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-200",onClick:P[2]||(P[2]=R=>o.value=null)}," Close ")]),wt("div",qK,[wt("div",GK,[P[12]||(P[12]=wt("span",null,"Node ID",-1)),wt("span",$K,Zn(o.value.id),1)]),wt("div",WK,[P[13]||(P[13]=wt("span",null,"Degree",-1)),wt("span",VK,Zn(o.value.degree),1)]),wt("div",UK,[P[14]||(P[14]=wt("span",null,"Avg weight",-1)),wt("span",YK,Zn(o.value.avgWeight),1)])])])):Bb("",!0),l.value.visible?(Ti(),Vi("div",{key:1,class:"pointer-events-none absolute z-20 rounded-lg border border-indigo-200 bg-white px-3 py-2 text-xs text-gray-700 shadow-lg dark:border-indigo-800 dark:bg-gray-800 dark:text-gray-200",style:CR({left:`${l.value.x}px`,top:`${l.value.y}px`})},Zn(l.value.content),5)):Bb("",!0)]),P[15]||(P[15]=wt("p",{class:"mt-3 text-xs text-gray-500 dark:text-gray-400"}," Hover edges to see weight and description, click nodes to open detail. ",-1))]),wt("div",HK,[wt("div",XK,[P[16]||(P[16]=wt("p",{class:"text-sm font-semibold text-gray-600 dark:text-gray-300"},"Metrics snapshot (mock, hook-ready)",-1)),wt("div",KK,[(Ti(!0),Vi(Cl,null,Pl(c.value,R=>(Ti(),Vi("div",{key:R.title,class:"flex items-center justify-between"},[wt("div",null,[wt("p",ZK,Zn(R.title),1),wt("p",JK,Zn(R.subtitle),1)]),wt("p",QK,Zn(R.value),1)]))),128))])]),wt("div",tZ,[P[17]||(P[17]=wt("p",{class:"text-sm font-semibold text-gray-600 dark:text-gray-300"},"Alerts (mock)",-1)),wt("ul",eZ,[(Ti(!0),Vi(Cl,null,Pl(u.value,R=>(Ti(),Vi("li",{key:R.title,class:"flex items-start gap-3 rounded-xl bg-gray-50 p-3 text-sm text-gray-700 dark:bg-white/5 dark:text-gray-300"},[wt("span",{class:RR(["mt-1 inline-flex h-2.5 w-2.5 rounded-full",R.color])},null,2),wt("div",null,[wt("p",nZ,Zn(R.title),1),wt("p",null,Zn(R.description),1)])]))),128))])])])])]),wt("section",rZ,[wt("div",iZ,[P[18]||(P[18]=wt("p",{class:"text-sm font-semibold text-gray-500 dark:text-gray-400"}," Task board (placeholder) ",-1)),wt("ul",aZ,[(Ti(),Vi(Cl,null,Pl(h,R=>wt("li",{key:R.name,class:"rounded-2xl border border-gray-100 p-4 text-gray-700 dark:border-gray-800 dark:text-gray-300"},[wt("p",sZ,Zn(R.name),1),wt("p",oZ,Zn(R.detail),1),wt("p",lZ," Owner: "+Zn(R.owner),1)])),64))])]),wt("div",cZ,[P[21]||(P[21]=wt("p",{class:"text-sm font-semibold text-gray-500 dark:text-gray-400"}," Metrics timeline (placeholder, hook for real-time curves) ",-1)),wt("div",uZ,[wt("div",hZ,[P[20]||(P[20]=wt("div",{class:"flex justify-between text-xs text-gray-400"},[wt("span",null,"00:00"),wt("span",null,"12:00"),wt("span",null,"24:00")],-1)),wt("div",dZ,[wt("div",fZ,[(Ti(),Vi(Cl,null,Pl(4,R=>wt("div",{key:R,class:"h-1/4 border-t border-dashed border-gray-200 dark:border-gray-800"})),64))]),P[19]||(P[19]=wt("svg",{viewBox:"0 0 400 160",class:"h-full w-full text-indigo-500 dark:text-indigo-300"},[wt("path",{fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round",d:"M0 120 Q50 40 100 100 T200 80 T300 140 T400 60"})],-1))])])])])])])]),_:1})}}});export{EZ as default};
